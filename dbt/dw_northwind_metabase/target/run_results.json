{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-29T19:29:27.500981Z", "invocation_id": "b3e652d9-3429-4d9e-a679-079bc3363763", "invocation_started_at": "2025-11-29T19:29:24.342586Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.394179Z", "completed_at": "2025-11-29T19:29:26.411808Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.412495Z", "completed_at": "2025-11-29T19:29:26.412518Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021904945373535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_analytic_events", "compiled": true, "compiled_code": "\n\n-- Eventos de analytics (produto/app) para an\u00e1lises de comportamento.\nselect\n    'METABASE'                               as source_system,\n    ae.id                                    as source_event_id,\n    'METABASE_EVT_' || ae.id                 as event_nk,\n    case\n        when acc.id is not null then 'METABASE_ACCOUNT_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    ae.account_id                            as source_account_id,\n    ae.event                                 as event_name,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    -- Date parsing: Handles localized format (e.g., \"julho 28, 2025, 11:18 AM\")\n    case\n        when ae.\"timestamp\" ~ '^\\d{4}-\\d{2}-\\d{2}' then ae.\"timestamp\"::timestamp\n        else\n            to_timestamp(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(lower(ae.\"timestamp\"), \n                    'janeiro', 'january'),\n                    'fevereiro', 'february'),\n                    'mar\u00e7o', 'march'),\n                    'abril', 'april'),\n                    'maio', 'may'),\n                    'junho', 'june'),\n                    'julho', 'july'),\n                    'agosto', 'august'),\n                    'setembro', 'september'),\n                    'outubro', 'october'),\n                    'novembro', 'november'),\n                    'dezembro', 'december'),\n                'fmmonth dd, yyyy, hh12:mi am'\n            )\n    end                                      as event_timestamp,\n    ae.page_url                              as page_url,\n    ae.button_label                          as button_label,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"analyticevents\" ae\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(ae.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.405916Z", "completed_at": "2025-11-29T19:29:26.413695Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.415126Z", "completed_at": "2025-11-29T19:29:26.415143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02354145050048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_channel", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de canais/fonte (B2B x B2C/SaaS).\nselect\n    row_number() over (order by channel_nk) as channel_sk,\n    channel_nk,\n    channel_name,\n    business_model\nfrom (\n    values\n        ('CHANNEL_NORTHWIND', 'Northwind ERP', 'B2B'),\n        ('CHANNEL_METABASE', 'Metabase Sample', 'B2C/SaaS')\n) as channels(channel_nk, channel_name, business_model)", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.402015Z", "completed_at": "2025-11-29T19:29:26.417705Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.420435Z", "completed_at": "2025-11-29T19:29:26.420445Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029237747192382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_accounts", "compiled": true, "compiled_code": "\n\n-- Contas Metabase (SaaS/B2C).\nwith base as (\n    select\n        p.id,\n        p.first_name,\n        p.last_name,\n        p.email,\n        p.plan,\n        p.source,\n        p.seats,\n        p.latitude,\n        p.longitude,\n        p.country,\n        p.trial_converted,\n        p.active_subscription,\n        p.legacy_plan,\n        p.created_at,\n        p.trial_ends_at,\n        p.canceled_at,\n        p.created_at::text    as created_at_txt,\n        p.trial_ends_at::text as trial_ends_at_txt,\n        p.canceled_at::text   as canceled_at_txt,\n        -- PT-BR -> ENG para evitar falha de parse\n        regexp_replace(\n            replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(\n                translate(lower(p.created_at::text), '\u00e7\u00e1\u00e0\u00e2\u00e3\u00e4\u00e9\u00e8\u00ea\u00eb\u00ed\u00ec\u00ee\u00ef\u00f3\u00f2\u00f4\u00f5\u00f6\u00fa\u00f9\u00fb\u00fc','caaaaaeeeeiiiioooouuuu'),\n                'janeiro','jan'),\n                'fevereiro','feb'),\n                'marco','mar'),\n                'abril','apr'),\n                'maio','may'),\n                'junho','jun'),\n                'julho','jul'),\n                'agosto','aug'),\n                'setembro','sep'),\n                'outubro','oct'),\n                'novembro','nov'),\n                'dezembro','dec'),\n            ' *[-+]\\\\d{2}:?\\\\d{2}$','') as created_at_en,\n        regexp_replace(\n            replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(\n                translate(lower(p.trial_ends_at::text), '\u00e7\u00e1\u00e0\u00e2\u00e3\u00e4\u00e9\u00e8\u00ea\u00eb\u00ed\u00ec\u00ee\u00ef\u00f3\u00f2\u00f4\u00f5\u00f6\u00fa\u00f9\u00fb\u00fc','caaaaaeeeeiiiioooouuuu'),\n                'janeiro','jan'),\n                'fevereiro','feb'),\n                'marco','mar'),\n                'abril','apr'),\n                'maio','may'),\n                'junho','jun'),\n                'julho','jul'),\n                'agosto','aug'),\n                'setembro','sep'),\n                'outubro','oct'),\n                'novembro','nov'),\n                'dezembro','dec'),\n            ' *[-+]\\\\d{2}:?\\\\d{2}$','') as trial_ends_at_en,\n        regexp_replace(\n            replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(\n                translate(lower(p.canceled_at::text), '\u00e7\u00e1\u00e0\u00e2\u00e3\u00e4\u00e9\u00e8\u00ea\u00eb\u00ed\u00ec\u00ee\u00ef\u00f3\u00f2\u00f4\u00f5\u00f6\u00fa\u00f9\u00fb\u00fc','caaaaaeeeeiiiioooouuuu'),\n                'janeiro','jan'),\n                'fevereiro','feb'),\n                'marco','mar'),\n                'abril','apr'),\n                'maio','may'),\n                'junho','jun'),\n                'julho','jul'),\n                'agosto','aug'),\n                'setembro','sep'),\n                'outubro','oct'),\n                'novembro','nov'),\n                'dezembro','dec'),\n            ' *[-+]\\\\d{2}:?\\\\d{2}$','') as canceled_at_en\n    from \"dw_northwind_metabase\".\"public\".\"accounts\" p\n)\nselect\n    'METABASE'                                as source_system,\n    b.id                                      as source_customer_id,\n    'METABASE_ACCOUNT_' || b.id               as customer_nk,\n    concat_ws(' ', b.first_name, b.last_name) as customer_name,\n    b.email                                   as email,\n    b.first_name                              as first_name,\n    b.last_name                               as last_name,\n    b.plan                                    as plan,\n    b.source                                  as source,\n    b.source                                  as segment,\n    b.seats                                   as seats,\n    nullif(trim(b.latitude), '')              as latitude,\n    nullif(trim(b.longitude), '')             as longitude,\n    nullif(trim(b.country), '')               as country,\n    b.trial_converted                         as trial_converted,\n    b.active_subscription                     as active_subscription,\n    b.legacy_plan                             as legacy_plan,\n    -- datas em texto (ISO ou PT-BR) com valida\u00e7\u00e3o de padr\u00e3o\n    case\n        when b.created_at_txt ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}' then b.created_at::timestamptz\n        when b.created_at_txt ~ '^[A-Za-z\u00c0-\u00ff]' and b.created_at_en ~ '^[a-z]{3} \\\\d{1,2}, \\\\d{4}, \\\\d{1,2}:\\\\d{2} [ap]m$'\n            then to_timestamp(b.created_at_en, 'Mon DD, YYYY, HH12:MI AM')::timestamptz\n        else null\n    end                                     as created_at,\n    case\n        when b.trial_ends_at_txt ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}' then b.trial_ends_at::timestamptz\n        when b.trial_ends_at_txt ~ '^[A-Za-z\u00c0-\u00ff]' and b.trial_ends_at_en ~ '^[a-z]{3} \\\\d{1,2}, \\\\d{4}, \\\\d{1,2}:\\\\d{2} [ap]m$'\n            then to_timestamp(b.trial_ends_at_en, 'Mon DD, YYYY, HH12:MI AM')::timestamptz\n        else null\n    end                                     as trial_ends_at,\n    case\n        when b.canceled_at_txt ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}' then b.canceled_at::timestamptz\n        when b.canceled_at_txt ~ '^[A-Za-z\u00c0-\u00ff]' and b.canceled_at_en ~ '^[a-z]{3} \\\\d{1,2}, \\\\d{4}, \\\\d{1,2}:\\\\d{2} [ap]m$'\n            then to_timestamp(b.canceled_at_en, 'Mon DD, YYYY, HH12:MI AM')::timestamptz\n        else null\n    end                                     as canceled_at,\n    current_timestamp                        as dw_load_ts\nfrom base b", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.408277Z", "completed_at": "2025-11-29T19:29:26.419363Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.421999Z", "completed_at": "2025-11-29T19:29:26.422007Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02984762191772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_date", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de datas gerada via s\u00e9rie cont\u00ednua (apoia an\u00e1lises hist\u00f3ricas).\nwith calendar as (\n    select\n        day::date as date_day\n    from generate_series('1990-01-01'::date, '2035-12-31'::date, interval '1 day') as gs(day)\n)\nselect\n    row_number() over (order by date_day)         as date_sk,\n    date_day,\n    extract(year from date_day)::int              as year,\n    extract(quarter from date_day)::int           as quarter,\n    extract(month from date_day)::int             as month,\n    to_char(date_day, 'TMMonth')                  as month_name,\n    extract(day from date_day)::int               as day_of_month,\n    to_char(date_day, 'IW')::int                  as iso_week,\n    extract(dow from date_day)::int               as day_of_week,\n    to_char(date_day, 'Dy')                       as day_name,\n    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend\nfrom calendar", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.423903Z", "completed_at": "2025-11-29T19:29:26.443588Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.444353Z", "completed_at": "2025-11-29T19:29:26.444365Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025931358337402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_feedback", "compiled": true, "compiled_code": "\n\n-- Feedbacks recebidos via canais de suporte Metabase.\nselect\n    'METABASE'                               as source_system,\n    f.id                                     as source_feedback_id,\n    'METABASE_FB_' || f.id                   as feedback_nk,\n    -- Associa\u00e7\u00e3o com cliente/conta via chave natural.\n    case\n        when acc.id is not null then 'METABASE_ACCOUNT_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    f.account_id                             as source_account_id,\n    f.email                                  as contact_email,\n    cast(f.rating as numeric(5,2))           as rating_score,\n    f.rating_mapped                          as rating_label,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when f.date_received ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then f.date_received::timestamp\n        else null\n    end                                      as date_received,\n    f.body                                   as feedback_text,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"feedback\" f\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(f.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.429701Z", "completed_at": "2025-11-29T19:29:26.445605Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.446966Z", "completed_at": "2025-11-29T19:29:26.446978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02431964874267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_invoices", "compiled": true, "compiled_code": "\n\n-- Faturas SaaS (Metabase) com valores normalizados e v\u00ednculo ao cliente.\nselect\n    'METABASE'                               as source_system,\n    i.id                                     as source_invoice_id,\n    'METABASE_' || i.id                      as invoice_nk,\n    -- Associa\u00e7\u00e3o com cliente/conta via chave natural.\n    case\n        when acc.id is not null then 'METABASE_ACCOUNT_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    i.account_id                             as source_account_id,\n    i.plan                                   as plan_name,\n    cast(i.payment as numeric(12,4))         as payment_amount,\n    i.expected_invoice                       as expected_invoice_flag,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    -- Date parsing: Handles localized format (e.g., \"julho 28, 2025, 11:18 AM\")\n    case\n        when i.date_received ~ '^\\d{4}-\\d{2}-\\d{2}' then i.date_received::timestamp\n        else\n            to_timestamp(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(lower(i.date_received), \n                    'janeiro', 'january'),\n                    'fevereiro', 'february'),\n                    'mar\u00e7o', 'march'),\n                    'abril', 'april'),\n                    'maio', 'may'),\n                    'junho', 'june'),\n                    'julho', 'july'),\n                    'agosto', 'august'),\n                    'setembro', 'september'),\n                    'outubro', 'october'),\n                    'novembro', 'november'),\n                    'dezembro', 'december'),\n                'fmmonth dd, yyyy, hh12:mi am'\n            )\n    end                                      as date_received,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"invoices\" i\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(i.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.439505Z", "completed_at": "2025-11-29T19:29:26.447895Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.450723Z", "completed_at": "2025-11-29T19:29:26.450735Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021710634231567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_people", "compiled": true, "compiled_code": "\n\n-- Registros da tabela people (usados pelos pedidos B2C que n\u00e3o mapeiam para accounts).\nwith base as (\n    select\n        p.id,\n        p.name,\n        p.address,\n        p.city,\n        p.state,\n        p.zip,\n        p.source,\n        p.created_at,\n        trim(p.created_at::text) as created_at_txt,\n        -- normaliza m\u00eas PT-BR para abrevia\u00e7\u00e3o em EN e remove sufixo de fuso (ex.: -03)\n        regexp_replace(\n            replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(\n                translate(lower(p.created_at::text), '\u00e7\u00e1\u00e0\u00e2\u00e3\u00e4\u00e9\u00e8\u00ea\u00eb\u00ed\u00ec\u00ee\u00ef\u00f3\u00f2\u00f4\u00f5\u00f6\u00fa\u00f9\u00fb\u00fc','caaaaaeeeeiiiioooouuuu'),\n                'janeiro','jan'),\n                'fevereiro','feb'),\n                'marco','mar'),\n                'abril','apr'),\n                'maio','may'),\n                'junho','jun'),\n                'julho','jul'),\n                'agosto','aug'),\n                'setembro','sep'),\n                'outubro','oct'),\n                'novembro','nov'),\n                'dezembro','dec'),\n            ' *[-+]\\\\d{2}:?\\\\d{2}$','') as created_at_en\n    from \"dw_northwind_metabase\".\"public\".\"people\" p\n)\nselect\n    'METABASE'                               as source_system,\n    b.id                                     as source_customer_id,\n    'METABASE_PERSON_' || b.id               as customer_nk,\n    b.name                                   as customer_name,\n    null::varchar                            as contact_name,\n    null::varchar                            as contact_title,\n    split_part(b.name, ' ', 1)               as first_name,\n    nullif(split_part(b.name, ' ', 2), '')   as last_name,\n    b.address                                as address,\n    b.city                                   as city,\n    b.state                                  as region,\n    null::varchar                            as country,\n    b.zip::varchar                           as postal_code,\n    null::varchar                            as plan,\n    b.source                                 as segment,\n    null::int                                as seats,\n    null::boolean                            as trial_converted,\n    null::boolean                            as active_subscription,\n    null::boolean                            as legacy_plan,\n    -- created_at em texto PT-BR ou ISO\n    case\n        when b.created_at_txt ~ '^\\d{4}-\\d{2}-\\d{2}' then b.created_at::timestamptz\n        when b.created_at_txt ~ '^[A-Za-z\u00c0-\u00ff]' and b.created_at_en ~ '^[a-z]{3} \\d{1,2}, \\d{4}, \\d{1,2}:\\d{2} [ap]m$'\n            then to_timestamp(b.created_at_en, 'Mon DD, YYYY, HH12:MI AM')::timestamptz\n        else null\n    end                                           as created_at,\n    null::timestamp                          as trial_ends_at,\n    null::timestamp                          as canceled_at,\n    current_timestamp                        as dw_load_ts\nfrom base b", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.434674Z", "completed_at": "2025-11-29T19:29:26.449853Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.453231Z", "completed_at": "2025-11-29T19:29:26.453240Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024860143661499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_orders", "compiled": true, "compiled_code": "\n-- Orders from Metabase Sample (B2C/SaaS).\nwith account_name_map as (\n    select lower(concat_ws(' ', first_name, last_name)) as full_name_key,\n           min(id) as account_id\n    from \"dw_northwind_metabase\".\"public\".\"accounts\"\n    where first_name is not null and last_name is not null\n    group by 1\n),\npeople_name_map as (\n    select lower(name) as full_name_key,\n           min(id) as person_id\n    from \"dw_northwind_metabase\".\"public\".\"people\"\n    where name is not null\n    group by 1\n),\nproduct_map as (\n    select lower(title) as title_key,\n           min(id) as product_id,\n           min('METABASE_' || id) as product_nk,\n           min('METABASE_SUP_' || lower(replace(coalesce(vendor,'UNKNOWN'),' ','_'))) as supplier_nk,\n           min('METABASE_CAT_' || lower(replace(coalesce(category,'UNKNOWN'),' ','_'))) as category_nk\n    from \"dw_northwind_metabase\".\"public\".\"products\"\n    group by 1\n)\nselect\n    'METABASE' as source_system,\n    o.id       as source_order_id,\n    'METABASE_' || o.id as order_nk,\n    case\n        when people_map.person_id is not null then 'METABASE_PERSON_' || people_map.person_id::varchar\n        when acc_map.account_id   is not null then 'METABASE_ACCOUNT_' || acc_map.account_id::varchar\n        else 'METABASE_ORPHAN_' || upper(trim(o.user_id))\n    end as customer_nk,\n    coalesce(prod_map.product_nk, 'METABASE_' || upper(trim(o.product_id))) as product_nk,\n    coalesce(prod_map.supplier_nk, 'METABASE_SUP_UNKNOWN')                  as supplier_nk,\n    coalesce(prod_map.category_nk, 'METABASE_CAT_UNKNOWN')                  as category_nk,\n    null::varchar as employee_nk,\n    null::varchar as order_state,\n    -- Date parsing: ISO only (orders created_at vem em ISO na base padr\u00e3o).\n    -- Date parsing: Handles localized format (e.g., \"julho 28, 2025, 11:18 AM\")\n    -- Converts Portuguese months to English and casts to timestamp using the correct format mask.\n    case\n        when o.created_at ~ '^\\d{4}-\\d{2}-\\d{2}' then o.created_at::timestamptz\n        else\n            to_timestamp(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(lower(o.created_at), \n                    'janeiro', 'january'),\n                    'fevereiro', 'february'),\n                    'mar\u00e7o', 'march'),\n                    'abril', 'april'),\n                    'maio', 'may'),\n                    'junho', 'june'),\n                    'julho', 'july'),\n                    'agosto', 'august'),\n                    'setembro', 'september'),\n                    'outubro', 'october'),\n                    'novembro', 'november'),\n                    'dezembro', 'december'),\n                'fmmonth dd, yyyy, hh12:mi am'\n            )\n    end as order_date,\n    cast(null as timestamp) as shipped_date,\n    cast(o.quantity as numeric(12,4)) as quantity,\n    case when o.quantity is not null and o.quantity <> 0 then (o.subtotal / o.quantity) else null end::numeric(12,4) as unit_price,\n    cast(o.discount____ as numeric(12,4)) as discount_pct,\n    cast(o.total as numeric(14,4)) as total_amount,\n    current_timestamp as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"orders\" o\nleft join account_name_map acc_map   on lower(o.user_id) = acc_map.full_name_key\nleft join people_name_map people_map on lower(o.user_id) = people_map.full_name_key\nleft join product_map prod_map       on lower(o.product_id) = prod_map.title_key", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.454530Z", "completed_at": "2025-11-29T19:29:26.465091Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.469943Z", "completed_at": "2025-11-29T19:29:26.469957Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0216524600982666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_products", "compiled": true, "compiled_code": "\n\n-- Cat\u00e1logo de produtos Metabase Sample (B2C/SaaS) com atributos de pre\u00e7o e rating.\nselect\n    'METABASE'                               as source_system,\n    p.id                                     as source_product_id,\n    'METABASE_' || p.id                      as product_nk,\n    'METABASE_SUP_' || lower(replace(coalesce(p.vendor,'UNKNOWN'),' ','_')) as supplier_nk,\n    'METABASE_CAT_' || lower(replace(coalesce(p.category,'UNKNOWN'),' ','_')) as category_nk,\n    p.title                                  as product_name,\n    p.category                               as category_name,\n    p.vendor                                 as vendor_name,\n    cast(p.price as numeric(12,4))           as unit_price,\n    cast(p.rating as numeric(5,2))           as rating,\n    case\n        when p.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then p.created_at::timestamp\n        else null\n    end                                     as created_at,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"products\" p", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.459672Z", "completed_at": "2025-11-29T19:29:26.470959Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.476001Z", "completed_at": "2025-11-29T19:29:26.476011Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02344369888305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_reviews", "compiled": true, "compiled_code": "\n\nwith product_map as (\n    select\n        lower(title) as title_key,\n        min(id)      as product_id\n    from \"dw_northwind_metabase\".\"public\".\"products\"\n    group by 1\n)\n-- Reviews p\u00fablicos dos produtos Metabase Sample.\nselect\n    'METABASE'                               as source_system,\n    r._mb_row_id                             as source_review_id,\n    'METABASE_RV_' || r._mb_row_id           as review_nk,\n    -- Associa\u00e7\u00e3o com produto via chave natural.\n    case\n        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar\n        else 'METABASE_' || upper(trim(r.product_id))\n    end                                      as product_nk,\n    r.product_id                             as source_product_id,\n    r.reviewer                               as reviewer_name,\n    cast(r.rating as numeric(5,2))           as rating_score,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    -- Date parsing: Handles localized format (e.g., \"julho 28, 2025, 11:18 AM\")\n    case\n        when r.created_at ~ '^\\d{4}-\\d{2}-\\d{2}' then r.created_at::timestamp\n        else\n            to_timestamp(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(\n                replace(lower(r.created_at), \n                    'janeiro', 'january'),\n                    'fevereiro', 'february'),\n                    'mar\u00e7o', 'march'),\n                    'abril', 'april'),\n                    'maio', 'may'),\n                    'junho', 'june'),\n                    'julho', 'july'),\n                    'agosto', 'august'),\n                    'setembro', 'september'),\n                    'outubro', 'october'),\n                    'novembro', 'november'),\n                    'dezembro', 'december'),\n                'fmmonth dd, yyyy, hh12:mi am'\n            )\n    end                                      as created_at,\n    r.body                                   as review_text,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"reviews\" r\nleft join product_map prod_map\n       on lower(r.product_id) = prod_map.title_key", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.466366Z", "completed_at": "2025-11-29T19:29:26.488510Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.489359Z", "completed_at": "2025-11-29T19:29:26.489371Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030518293380737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_categories", "compiled": true, "compiled_code": "\n\n-- Categorias Northwind com NK padronizada.\nselect\n    'NORTHWIND'                               as source_system,\n    c.categoryid                              as source_category_id,\n    'NORTHWIND_CAT_' || c.categoryid          as category_nk,\n    c.categoryname                            as category_name,\n    c.description                             as category_description,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"category\" c", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.471536Z", "completed_at": "2025-11-29T19:29:26.491227Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.493612Z", "completed_at": "2025-11-29T19:29:26.493624Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030025005340576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_customers", "compiled": true, "compiled_code": "\n\n-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).\nselect\n    'NORTHWIND'                               as source_system,\n    custid                                    as source_customer_id,\n    'NORTHWIND_' || custid                    as customer_nk,\n    companyname                               as customer_name,\n    contactname                               as contact_name,\n    contacttitle                              as contact_title,\n    address                                   as address,\n    city                                      as city,\n    coalesce(nullif(region, ''), 'N/A')       as region,\n    country                                   as country,\n    postalcode                                as postal_code,\n    phone                                     as phone,\n    fax                                       as fax,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"customer\"", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.479797Z", "completed_at": "2025-11-29T19:29:26.491794Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.494587Z", "completed_at": "2025-11-29T19:29:26.494602Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01783919334411621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_employees", "compiled": true, "compiled_code": "\n\n-- Colaboradores Northwind com atributos de localiza\u00e7\u00e3o e datas chave.\nselect\n    'NORTHWIND'                                   as source_system,\n    e.empid                                       as source_employee_id,\n    'NORTHWIND_' || e.empid                       as employee_nk,\n    e.firstname                                   as first_name,\n    e.lastname                                    as last_name,\n    e.title                                       as job_title,\n    e.titleofcourtesy                             as courtesy_title,\n    cast(e.birthdate as date)                     as birth_date,\n    cast(e.hiredate as date)                      as hire_date,\n\n    e.city                                        as city,\n    coalesce(nullif(e.region, ''), 'N/A')         as region,\n    e.country                                     as country,\n    e.postalcode                                  as postal_code,\n    e.phone                                       as phone,\n    e.extension                                   as phone_extension,\n    e.mgrid                                       as manager_empid,\n    current_timestamp                             as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"employee\" e", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.484312Z", "completed_at": "2025-11-29T19:29:26.493083Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.496327Z", "completed_at": "2025-11-29T19:29:26.496342Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01783585548400879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_order_details", "compiled": true, "compiled_code": "\n\n-- Itens de pedido Northwind com m\u00e9tricas preparadas para a fato de vendas.\nselect\n    'NORTHWIND'                                      as source_system,\n    od.orderid                                       as source_order_id,\n    'NORTHWIND_' || od.orderid                       as order_nk,\n    'NORTHWIND_' || od.productid                     as product_nk,\n    'NORTHWIND_SUP_' || p.supplierid                 as supplier_nk,\n    'NORTHWIND_CAT_' || p.categoryid                 as category_nk,\n    cast(od.qty as numeric(12,4))                    as quantity,\n    cast(od.unitprice as numeric(12,4))              as unit_price,\n    cast(od.discount as numeric(5,4))                as discount_pct,\n    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,\n    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,\n    current_timestamp                                as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"orderdetail\" od\njoin \"dw_northwind_metabase\".\"public\".\"product\" p\n  on od.productid = p.productid", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.498846Z", "completed_at": "2025-11-29T19:29:26.516630Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.530898Z", "completed_at": "2025-11-29T19:29:26.530935Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03861546516418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_orders", "compiled": true, "compiled_code": "\n\n-- Normaliza os pedidos (cabe\u00e7alho) da Northwind gerando NKs padronizadas.\nselect\n    'NORTHWIND'                                 as source_system,\n    o.orderid                                   as source_order_id,\n    'NORTHWIND_' || o.orderid                   as order_nk,\n    'NORTHWIND_' || o.custid                    as customer_nk,\n    case\n        when o.empid is not null then 'NORTHWIND_' || o.empid\n        else 'NORTHWIND_EMP_UNKNOWN'\n    end                                         as employee_nk,\n    'NORTHWIND_' || o.shipperid                 as shipper_nk,\n    cast(o.orderdate as date)                   as order_date,\n    cast(o.requireddate as date)                as required_date,\n    cast(o.shippeddate as date)                 as shipped_date,\n    cast(o.freight as numeric(12,2))            as freight_amount,\n    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,\n    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,\n    o.shipcity                                  as ship_city,\n    current_timestamp                           as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"salesorder\" o", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.506888Z", "completed_at": "2025-11-29T19:29:26.535107Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.544038Z", "completed_at": "2025-11-29T19:29:26.544059Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04063749313354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_products", "compiled": true, "compiled_code": "\n\n-- Cat\u00e1logo Northwind com categoria, fornecedor e indicadores de estoque.\nselect\n    'NORTHWIND'                                   as source_system,\n    p.productid                                   as source_product_id,\n    'NORTHWIND_' || p.productid                   as product_nk,\n    'NORTHWIND_SUP_' || p.supplierid              as supplier_nk,\n    'NORTHWIND_CAT_' || p.categoryid              as category_nk,\n    p.productname                                 as product_name,\n    c.categoryname                                as category_name,\n    s.companyname                                 as supplier_name,\n    p.quantityperunit                             as package_details,\n    cast(p.unitprice as numeric(12,4))            as unit_price,\n    p.unitsinstock                                as units_in_stock,\n    p.unitsonorder                                as units_on_order,\n    p.reorderlevel                                as reorder_level,\n    p.discontinued = '1'                          as is_discontinued,\n    null::numeric(5,2)                            as rating_score,\n    null::timestamp                               as product_created_at,\n    current_timestamp                             as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"product\" p\nleft join \"dw_northwind_metabase\".\"public\".\"category\" c\n       on p.categoryid = c.categoryid\nleft join \"dw_northwind_metabase\".\"public\".\"supplier\" s\n       on p.supplierid = s.supplierid", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.512629Z", "completed_at": "2025-11-29T19:29:26.540922Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.544889Z", "completed_at": "2025-11-29T19:29:26.544897Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04088854789733887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_suppliers", "compiled": true, "compiled_code": "\n\n-- Fornecedores Northwind com NK padronizada.\nselect\n    'NORTHWIND'                               as source_system,\n    s.supplierid                              as source_supplier_id,\n    'NORTHWIND_SUP_' || s.supplierid          as supplier_nk,\n    s.companyname                             as supplier_name,\n    s.contactname                             as contact_name,\n    s.contacttitle                            as contact_title,\n    s.city                                    as city,\n    coalesce(nullif(s.region, ''), 'N/A')     as region,\n    s.country                                 as country,\n    s.phone                                   as phone,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"supplier\" s", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.517041Z", "completed_at": "2025-11-29T19:29:26.545862Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.548701Z", "completed_at": "2025-11-29T19:29:26.548713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0441892147064209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\nwhere event_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.535736Z", "completed_at": "2025-11-29T19:29:26.551169Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.553174Z", "completed_at": "2025-11-29T19:29:26.553184Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019977092742919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\nwhere event_nk is not null\ngroup by event_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.554550Z", "completed_at": "2025-11-29T19:29:26.580389Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.581784Z", "completed_at": "2025-11-29T19:29:26.581797Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03200364112854004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.559667Z", "completed_at": "2025-11-29T19:29:26.581092Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.583033Z", "completed_at": "2025-11-29T19:29:26.583045Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03264474868774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.565838Z", "completed_at": "2025-11-29T19:29:26.586219Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.588335Z", "completed_at": "2025-11-29T19:29:26.588346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034462690353393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_nk is not null\ngroup by channel_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.574231Z", "completed_at": "2025-11-29T19:29:26.586796Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.589181Z", "completed_at": "2025-11-29T19:29:26.589195Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02410149574279785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_sk is not null\ngroup by channel_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.590290Z", "completed_at": "2025-11-29T19:29:26.611965Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.613310Z", "completed_at": "2025-11-29T19:29:26.613336Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028041601181030273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.594907Z", "completed_at": "2025-11-29T19:29:26.612447Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.614628Z", "completed_at": "2025-11-29T19:29:26.614641Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027521133422851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.601711Z", "completed_at": "2025-11-29T19:29:26.617234Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.619501Z", "completed_at": "2025-11-29T19:29:26.619511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020262956619262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.605940Z", "completed_at": "2025-11-29T19:29:26.618477Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.620883Z", "completed_at": "2025-11-29T19:29:26.620891Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021101951599121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.623474Z", "completed_at": "2025-11-29T19:29:26.643087Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.643778Z", "completed_at": "2025-11-29T19:29:26.643799Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02495098114013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.627754Z", "completed_at": "2025-11-29T19:29:26.645684Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.647018Z", "completed_at": "2025-11-29T19:29:26.647028Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026825904846191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_sk is not null\ngroup by date_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.633516Z", "completed_at": "2025-11-29T19:29:26.649310Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.655959Z", "completed_at": "2025-11-29T19:29:26.655969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02882862091064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feedback_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\nwhere feedback_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.638643Z", "completed_at": "2025-11-29T19:29:26.654921Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.657353Z", "completed_at": "2025-11-29T19:29:26.657360Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025708675384521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    feedback_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\nwhere feedback_nk is not null\ngroup by feedback_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.650160Z", "completed_at": "2025-11-29T19:29:26.664431Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.665897Z", "completed_at": "2025-11-29T19:29:26.665908Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019825458526611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.658627Z", "completed_at": "2025-11-29T19:29:26.671397Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.677163Z", "completed_at": "2025-11-29T19:29:26.677173Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022866010665893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere invoice_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.666750Z", "completed_at": "2025-11-29T19:29:26.680141Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.685740Z", "completed_at": "2025-11-29T19:29:26.685749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022877216339111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoice_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere invoice_nk is not null\ngroup by invoice_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.671884Z", "completed_at": "2025-11-29T19:29:26.687185Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.692575Z", "completed_at": "2025-11-29T19:29:26.692584Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02888965606689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.681355Z", "completed_at": "2025-11-29T19:29:26.694546Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.695886Z", "completed_at": "2025-11-29T19:29:26.695893Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01828622817993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.688522Z", "completed_at": "2025-11-29T19:29:26.702394Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.707530Z", "completed_at": "2025-11-29T19:29:26.707540Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026897907257080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.697163Z", "completed_at": "2025-11-29T19:29:26.709781Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.715635Z", "completed_at": "2025-11-29T19:29:26.715649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022438526153564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.702979Z", "completed_at": "2025-11-29T19:29:26.716538Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.718241Z", "completed_at": "2025-11-29T19:29:26.718251Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022917747497558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere order_nk is not null\ngroup by order_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.710289Z", "completed_at": "2025-11-29T19:29:26.723702Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.725476Z", "completed_at": "2025-11-29T19:29:26.725484Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018627643585205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.719170Z", "completed_at": "2025-11-29T19:29:26.733355Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.739136Z", "completed_at": "2025-11-29T19:29:26.739146Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024173736572265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.726853Z", "completed_at": "2025-11-29T19:29:26.740185Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.745922Z", "completed_at": "2025-11-29T19:29:26.745936Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02285623550415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.733896Z", "completed_at": "2025-11-29T19:29:26.748994Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.752341Z", "completed_at": "2025-11-29T19:29:26.752351Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026249408721923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere review_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.740926Z", "completed_at": "2025-11-29T19:29:26.751556Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.757932Z", "completed_at": "2025-11-29T19:29:26.757942Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025607585906982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere review_nk is not null\ngroup by review_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.753317Z", "completed_at": "2025-11-29T19:29:26.766338Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.768061Z", "completed_at": "2025-11-29T19:29:26.768071Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020971298217773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_category", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de categorias (SCD1 simples).\nwith unioned as (\n    select distinct\n        category_nk,\n        category_name,\n        category_description\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"\n\n    union\n\n    select distinct\n        category_nk,\n        coalesce(category_name, 'UNKNOWN') as category_name,\n        null::varchar as category_description\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n)\nselect\n    row_number() over (order by category_nk) as category_sk,\n    category_nk,\n    category_name,\n    category_description\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.759570Z", "completed_at": "2025-11-29T19:29:26.778765Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.780475Z", "completed_at": "2025-11-29T19:29:26.780486Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02995133399963379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_categories_category_nk.441428ad52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"\nwhere category_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.768924Z", "completed_at": "2025-11-29T19:29:26.788470Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.790171Z", "completed_at": "2025-11-29T19:29:26.790181Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025321245193481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_categories_category_nk.79139c5f53", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"\nwhere category_nk is not null\ngroup by category_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.773564Z", "completed_at": "2025-11-29T19:29:26.789028Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.790949Z", "completed_at": "2025-11-29T19:29:26.790959Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02530503273010254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_customers", "compiled": true, "compiled_code": "\n\n-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para snapshots SCD2.\nwith northwind as (\n    select\n        source_system,\n        customer_nk,\n        cast(source_customer_id as varchar)           as source_customer_id,\n        customer_name,\n        contact_name,\n        contact_title,\n        null::varchar                                as first_name,\n        null::varchar                                as last_name,\n        address,\n        city,\n        region,\n        country,\n        postal_code,\n        null::varchar                                as plan,\n        'B2B'::varchar                               as segment,\n        null::int                                    as seats,\n        null::boolean                                as trial_converted,\n        null::boolean                                as active_subscription,\n        null::boolean                                as legacy_plan,\n        current_timestamp                            as created_at,\n        null::timestamp                              as trial_ends_at,\n        null::timestamp                              as canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\n),\nmetabase as (\n    select\n        source_system,\n        customer_nk,\n        cast(source_customer_id as varchar)           as source_customer_id,\n        customer_name,\n        null::varchar                                as contact_name,\n        null::varchar                                as contact_title,\n        first_name,\n        last_name,\n        null::varchar                                as address,\n        null::varchar                                as city,\n        null::varchar                                as region,\n        country,\n        null::varchar                                as postal_code,\n        plan,\n        segment,\n        seats,\n        trial_converted,\n        active_subscription,\n        legacy_plan,\n        created_at,\n        trial_ends_at,\n        canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\n),\nmetabase_people as (\n    select\n        source_system,\n        customer_nk,\n        cast(source_customer_id as varchar)           as source_customer_id,\n        customer_name,\n        contact_name,\n        contact_title,\n        first_name,\n        last_name,\n        address,\n        city,\n        region,\n        country,\n        postal_code,\n        plan,\n        segment,\n        seats,\n        trial_converted,\n        active_subscription,\n        legacy_plan,\n        created_at,\n        trial_ends_at,\n        canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\n)\nselect * from northwind\nunion all\nselect * from metabase\nunion all\nselect * from metabase_people\nunion all\nselect\n    'NORTHWIND'                          as source_system,\n    'NORTHWIND_ORPHAN_UNKNOWN'           as customer_nk,\n    null::varchar                        as source_customer_id,\n    'Cliente Desconhecido Northwind'     as customer_name,\n    null::varchar                        as contact_name,\n    null::varchar                        as contact_title,\n    null::varchar                        as first_name,\n    null::varchar                        as last_name,\n    null::varchar                        as address,\n    null::varchar                        as city,\n    null::varchar                        as region,\n    null::varchar                        as country,\n    null::varchar                        as postal_code,\n    null::varchar                        as plan,\n    'B2B'::varchar                       as segment,\n    null::int                            as seats,\n    null::boolean                        as trial_converted,\n    null::boolean                        as active_subscription,\n    null::boolean                        as legacy_plan,\n    timestamp '1900-01-01'               as created_at,\n    null::timestamp                      as trial_ends_at,\n    null::timestamp                      as canceled_at,\n    timestamp '1900-01-01'               as dw_load_ts\nunion all\nselect\n    'METABASE'                           as source_system,\n    'METABASE_ACCOUNT_ORPHAN_UNKNOWN'    as customer_nk,\n    null::varchar                        as source_customer_id,\n    'Cliente Desconhecido Metabase'      as customer_name,\n    null::varchar                        as contact_name,\n    null::varchar                        as contact_title,\n    null::varchar                        as first_name,\n    null::varchar                        as last_name,\n    null::varchar                        as address,\n    null::varchar                        as city,\n    null::varchar                        as region,\n    null::varchar                        as country,\n    null::varchar                        as postal_code,\n    null::varchar                        as plan,\n    null::varchar                        as segment,\n    null::int                            as seats,\n    null::boolean                        as trial_converted,\n    null::boolean                        as active_subscription,\n    null::boolean                        as legacy_plan,\n    timestamp '1900-01-01'               as created_at,\n    null::timestamp                      as trial_ends_at,\n    null::timestamp                      as canceled_at,\n    timestamp '1900-01-01'               as dw_load_ts", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.784337Z", "completed_at": "2025-11-29T19:29:26.798032Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.800104Z", "completed_at": "2025-11-29T19:29:26.800116Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018768310546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.791758Z", "completed_at": "2025-11-29T19:29:26.802015Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.810507Z", "completed_at": "2025-11-29T19:29:26.810515Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027173280715942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.807333Z", "completed_at": "2025-11-29T19:29:26.810009Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.812019Z", "completed_at": "2025-11-29T19:29:26.812026Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012657880783081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.employees_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    employee_nk,\n    source_system,\n    source_employee_id,\n    first_name,\n    last_name,\n    job_title,\n    courtesy_title,\n    birth_date,\n    hire_date,\n    city,\n    region,\n    country,\n    postal_code,\n    phone,\n    phone_extension,\n    manager_empid,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"employees_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.803339Z", "completed_at": "2025-11-29T19:29:26.820468Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.822035Z", "completed_at": "2025-11-29T19:29:26.822045Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02335953712463379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.815628Z", "completed_at": "2025-11-29T19:29:26.833438Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.834695Z", "completed_at": "2025-11-29T19:29:26.834705Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02347564697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\nwhere employee_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.828156Z", "completed_at": "2025-11-29T19:29:26.841615Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.843607Z", "completed_at": "2025-11-29T19:29:26.843627Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022856473922729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.823281Z", "completed_at": "2025-11-29T19:29:26.842499Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.844512Z", "completed_at": "2025-11-29T19:29:26.844519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029867172241210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\nwhere employee_nk is not null\ngroup by employee_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.837129Z", "completed_at": "2025-11-29T19:29:26.850714Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.852906Z", "completed_at": "2025-11-29T19:29:26.852919Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019120216369628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.845283Z", "completed_at": "2025-11-29T19:29:26.854933Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.865756Z", "completed_at": "2025-11-29T19:29:26.865766Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024760007858276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_geography", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de geografia consolidando localidades presentes nas diferentes fontes.\nwith unioned as (\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        upper(coalesce(region, 'N/A'))  as region,\n        upper(coalesce(city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\n\n    union\n\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        'N/A'                           as region,\n        'N/A'                           as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\n\n    union\n\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        upper(coalesce(region, 'N/A'))  as region,\n        upper(coalesce(city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\n\n    union\n\n    select distinct\n        upper(coalesce(ship_country, 'N/A')) as country,\n        upper(coalesce(ship_region, 'N/A'))  as region,\n        upper(coalesce(ship_city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\n)\nselect\n    row_number() over (order by country, region, city) as geography_sk,\n    country,\n    region,\n    city\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.856040Z", "completed_at": "2025-11-29T19:29:26.870115Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.876112Z", "completed_at": "2025-11-29T19:29:26.876128Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02465224266052246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.862131Z", "completed_at": "2025-11-29T19:29:26.875626Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.880777Z", "completed_at": "2025-11-29T19:29:26.880786Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028528213500976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.870942Z", "completed_at": "2025-11-29T19:29:26.885639Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.893899Z", "completed_at": "2025-11-29T19:29:26.893909Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02747344970703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere order_nk is not null\ngroup by order_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.877454Z", "completed_at": "2025-11-29T19:29:26.893396Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.894902Z", "completed_at": "2025-11-29T19:29:26.894909Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025955677032470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_products", "compiled": true, "compiled_code": "\n\nwith stg_northwind as (\n    select\n        source_system,\n        source_product_id,\n        product_nk,\n        supplier_nk,\n        category_nk,\n        product_name,\n        category_name,\n        supplier_name,\n        package_details,\n        unit_price,\n        units_in_stock,\n        units_on_order,\n        reorder_level,\n        is_discontinued,\n        null::decimal as rating_score, -- Northwind n\u00e3o tem rating\n        product_created_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\n),\n\nstg_metabase as (\n    select\n        source_system,\n        source_product_id,\n        product_nk,\n        supplier_nk,\n        category_nk,\n        product_name,\n        category_name,\n        vendor_name as supplier_name,\n        null::varchar as package_details,\n        unit_price,\n        null::integer as units_in_stock,\n        null::integer as units_on_order,\n        null::integer as reorder_level,\n        false as is_discontinued,\n        rating as rating_score, -- Padroniza para rating_score\n        created_at as product_created_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n),\n\nunioned as (\n    select * from stg_northwind\n    union all\n    select * from stg_metabase\n)\n\nselect\n    source_system,\n    source_product_id,\n    product_nk,\n    supplier_nk,\n    category_nk,\n    product_name,\n    category_name,\n    supplier_name,\n    package_details,\n    unit_price,\n    units_in_stock,\n    units_on_order,\nreorder_level,\n    is_discontinued,\n    rating_score, -- A coluna j\u00e1 est\u00e1 com o nome padronizado\n    product_created_at,\n    dw_load_ts\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.886131Z", "completed_at": "2025-11-29T19:29:26.899160Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.901099Z", "completed_at": "2025-11-29T19:29:26.901108Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018360137939453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_suppliers", "compiled": true, "compiled_code": "\n\n-- Unifica fornecedores das fontes Northwind e Metabase (vendor).\nselect\n    supplier_nk,\n    source_system,\n    cast(source_supplier_id as varchar) as source_supplier_id,\n    supplier_name,\n    contact_name,\n    contact_title,\n    city,\n    region,\n    country,\n    phone,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"\n\nunion all\n\nselect\n    supplier_nk,\n    source_system,\n    source_supplier_id,\n    supplier_name,\n    null::varchar as contact_name,\n    null::varchar as contact_title,\n    null::varchar as city,\n    null::varchar as region,\n    null::varchar as country,\n    null::varchar as phone,\n    dw_load_ts\nfrom (\n    select\n        supplier_nk,\n        'METABASE' as source_system,\n        null::varchar as source_supplier_id,\n        coalesce(vendor_name, 'UNKNOWN') as supplier_name,\n        min(dw_load_ts) as dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n    group by 1,2,3,4\n) m", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.889339Z", "completed_at": "2025-11-29T19:29:26.900184Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.905610Z", "completed_at": "2025-11-29T19:29:26.905617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02183985710144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.901919Z", "completed_at": "2025-11-29T19:29:26.915027Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.925631Z", "completed_at": "2025-11-29T19:29:26.925649Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028600454330444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_suppliers_supplier_nk.fdebdf43ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"\nwhere supplier_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.906416Z", "completed_at": "2025-11-29T19:29:26.925156Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.926828Z", "completed_at": "2025-11-29T19:29:26.926835Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02861928939819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.920979Z", "completed_at": "2025-11-29T19:29:26.930963Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.933151Z", "completed_at": "2025-11-29T19:29:26.933161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020615577697753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_category_category_nk.9a0ca90757", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.915776Z", "completed_at": "2025-11-29T19:29:26.932144Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.938603Z", "completed_at": "2025-11-29T19:29:26.938613Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026746273040771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_suppliers_supplier_nk.9dfad0db8c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"\nwhere supplier_nk is not null\ngroup by supplier_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.934045Z", "completed_at": "2025-11-29T19:29:26.945609Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.947901Z", "completed_at": "2025-11-29T19:29:26.947913Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01888728141784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_category_category_sk.3ef7ab8615", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.939374Z", "completed_at": "2025-11-29T19:29:26.947188Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.957069Z", "completed_at": "2025-11-29T19:29:26.957079Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027144432067871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_category_category_nk.a563adfca4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_nk is not null\ngroup by category_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.952997Z", "completed_at": "2025-11-29T19:29:26.956478Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.958612Z", "completed_at": "2025-11-29T19:29:26.958620Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013624429702758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.customers_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    customer_nk,\n    source_system,\n    source_customer_id,\n    customer_name,\n    contact_name,\n    contact_title,\n    first_name,\n    last_name,\n    address,\n    city,\n    region,\n    country,\n    postal_code,\n    plan,\n    segment,\n    seats,\n    trial_converted,\n    active_subscription,\n    legacy_plan,\n    created_at,\n    trial_ends_at,\n    canceled_at,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"customers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.948898Z", "completed_at": "2025-11-29T19:29:26.962108Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.964771Z", "completed_at": "2025-11-29T19:29:26.964781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02034282684326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_category_category_sk.76b1e39575", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_sk is not null\ngroup by category_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.965657Z", "completed_at": "2025-11-29T19:29:26.985827Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.987017Z", "completed_at": "2025-11-29T19:29:26.987027Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027100801467895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.970237Z", "completed_at": "2025-11-29T19:29:26.986412Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.987927Z", "completed_at": "2025-11-29T19:29:26.987935Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026538372039794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.974796Z", "completed_at": "2025-11-29T19:29:26.989681Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.992082Z", "completed_at": "2025-11-29T19:29:26.992094Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028580665588378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_system\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere source_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.980843Z", "completed_at": "2025-11-29T19:29:26.990124Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:26.992978Z", "completed_at": "2025-11-29T19:29:26.992990Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013652563095092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:26.996545Z", "completed_at": "2025-11-29T19:29:27.011693Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.016761Z", "completed_at": "2025-11-29T19:29:27.016775Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026332378387451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_employee", "compiled": true, "compiled_code": "\n\n-- Dimens?o SCD2 de colaboradores: todas as vers?es do snapshot employees_snapshot.\nselect\n    row_number() over (order by employee_nk, coalesce(dbt_valid_from, timestamp '1900-01-01')) as employee_sk,\n    employee_nk,\n    source_system,\n    source_employee_id,\n    concat_ws(' ', first_name, last_name) as employee_name,\n    first_name,\n    last_name,\n    job_title,\n    courtesy_title,\n    birth_date,\n    hire_date,\n    city,\n    region,\n    country,\n    postal_code,\n    phone,\n    phone_extension,\n    manager_empid,\n    dbt_valid_from,\n    dbt_valid_to,\n    case when dbt_valid_to is null then true else false end as current_flag\nfrom (\n    with source as (\n        -- Seleciona todos os dados da tabela de snapshot de colaboradores\n        select * from \"dw_northwind_metabase\".\"snapshots\".\"employees_snapshot\"\n    ),\n    first_seen as (\n        -- Identifica a primeira vez que cada colaborador apareceu.\n        select\n            employee_nk,\n            min(dbt_valid_from) as first_valid_from\n        from source\n        group by employee_nk\n    )\n    select\n        s.employee_nk,\n        s.source_system,\n        s.source_employee_id::varchar,\n        s.first_name,\n        s.last_name,\n        s.job_title,\n        s.courtesy_title,\n        s.birth_date,\n        s.hire_date,\n        s.city,\n        s.region,\n        s.country,\n        s.postal_code,\n        s.phone,\n        s.phone_extension,\n        s.manager_empid::varchar,\n        -- L\u00f3gica de \"Backdating\": define a data inicial como 1900-01-01 para a primeira vers\u00e3o,\n        -- mas APENAS se a data for anterior ao corte da carga inicial.\n        case\n            when s.dbt_valid_from = f.first_valid_from\n                 and s.dbt_valid_from <= cast('2025-11-23 00:00:00' as timestamp)\n            then timestamp '1900-01-01'\n            else s.dbt_valid_from\n        end as dbt_valid_from,\n        s.dbt_valid_to\n    from source s\n    join first_seen f on s.employee_nk = f.employee_nk\n    union all\n    select\n        'NORTHWIND_EMP_UNKNOWN' as employee_nk,\n        'NORTHWIND'             as source_system,\n        null::varchar           as source_employee_id,\n        null::varchar           as first_name,\n        null::varchar           as last_name,\n        null::varchar           as job_title,\n        null::varchar           as courtesy_title,\n        null::date              as birth_date,\n        null::date              as hire_date,\n        null::varchar           as city,\n        null::varchar           as region,\n        null::varchar           as country,\n        null::varchar           as postal_code,\n        null::varchar           as phone,\n        null::varchar           as phone_extension,\n        null::varchar           as manager_empid,\n        timestamp '1900-01-01'  as dbt_valid_from,\n        null::timestamp         as dbt_valid_to\n    union all\n    select\n        'METABASE_EMP_UNKNOWN'  as employee_nk,\n        'METABASE'              as source_system,\n        null::varchar           as source_employee_id,\n        null::varchar           as first_name,\n        null::varchar           as last_name,\n        null::varchar           as job_title,\n        null::varchar           as courtesy_title,\n        null::date              as birth_date,\n        null::date              as hire_date,\n        null::varchar           as city,\n        null::varchar           as region,\n        null::varchar           as country,\n        null::varchar           as postal_code,\n        null::varchar           as phone,\n        null::varchar           as phone_extension,\n        null::varchar           as manager_empid,\n        timestamp '1900-01-01'  as dbt_valid_from,\n        null::timestamp         as dbt_valid_to\n) base", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.000737Z", "completed_at": "2025-11-29T19:29:27.012169Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.017585Z", "completed_at": "2025-11-29T19:29:27.017595Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026345252990722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geography_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"\nwhere geography_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.012684Z", "completed_at": "2025-11-29T19:29:27.015968Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.018376Z", "completed_at": "2025-11-29T19:29:27.018386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013525724411010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.products_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    product_nk,\n    source_system,\n    source_product_id,\n    supplier_nk,\n    category_nk,\n    product_name,\n    category_name,\n    supplier_name,\n    package_details,\n    unit_price,\n    units_in_stock,\n    units_on_order,\n    reorder_level,\n    rating_score,\n    product_created_at,\n    is_discontinued,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_products\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"products_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.007479Z", "completed_at": "2025-11-29T19:29:27.020978Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.023530Z", "completed_at": "2025-11-29T19:29:27.023539Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019129276275634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    geography_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"\nwhere geography_sk is not null\ngroup by geography_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.034696Z", "completed_at": "2025-11-29T19:29:27.038348Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.040121Z", "completed_at": "2025-11-29T19:29:27.040133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016025066375732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.suppliers_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    supplier_nk,\n    source_system,\n    source_supplier_id,\n    supplier_name,\n    contact_name,\n    contact_title,\n    city,\n    region,\n    country,\n    phone,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"suppliers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.029927Z", "completed_at": "2025-11-29T19:29:27.046484Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.048316Z", "completed_at": "2025-11-29T19:29:27.048330Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025724172592163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_products_product_nk.f50228595e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.026321Z", "completed_at": "2025-11-29T19:29:27.049542Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.051495Z", "completed_at": "2025-11-29T19:29:27.051505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029571533203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_products_product_nk.bdcda5f3c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.040873Z", "completed_at": "2025-11-29T19:29:27.059613Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.061664Z", "completed_at": "2025-11-29T19:29:27.061676Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02762889862060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_suppliers_supplier_nk.6c165af711", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"\nwhere supplier_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.052541Z", "completed_at": "2025-11-29T19:29:27.067413Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.072618Z", "completed_at": "2025-11-29T19:29:27.072629Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025152921676635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_suppliers_supplier_nk.1fff00cf7f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"\nwhere supplier_nk is not null\ngroup by supplier_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.062973Z", "completed_at": "2025-11-29T19:29:27.074835Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.076694Z", "completed_at": "2025-11-29T19:29:27.076707Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0184934139251709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_customer", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o SCD2 de clientes: mant\u00e9m todas as vers\u00f5es do snapshot.\nwith source as (\n    -- Seleciona todos os dados da tabela de snapshot de clientes\n    select * from \"dw_northwind_metabase\".\"snapshots\".\"customers_snapshot\"\n),\nfirst_seen as (\n    -- Identifica a primeira vez que cada cliente (customer_nk) apareceu no sistema.\n    -- Agrupa por chave natural e encontra a menor data de validade (min).\n    select\n        customer_nk,\n        min(dbt_valid_from) as first_valid_from\n    from source\n    group by customer_nk\n)\nselect\n    -- Gera uma chave substituta (SK) sequencial para cada vers\u00e3o do cliente.\n    -- row_number(): numera as linhas ordenadas pela chave natural e data de validade.\n    -- coalesce(): garante que se a data for nula (o que n\u00e3o deve ocorrer), usa 1900-01-01.\n    row_number() over (order by s.customer_nk, coalesce(s.dbt_valid_from, timestamp '1900-01-01')) as customer_sk,\n    s.customer_nk,\n    s.source_system,\n    s.source_customer_id,\n    s.customer_name,\n    s.contact_name,\n    s.contact_title,\n    s.first_name,\n    s.last_name,\n    s.address,\n    s.city,\n    s.region,\n    s.country,\n    s.postal_code,\n    s.plan,\n    s.segment,\n    s.seats,\n    s.trial_converted,\n    s.active_subscription,\n    s.legacy_plan,\n    s.created_at,\n    s.trial_ends_at,\n    s.canceled_at,\n    -- L\u00f3gica de \"Backdating\" (Retroa\u00e7\u00e3o de Data):\n    -- Se esta for a primeira vers\u00e3o do cliente (data igual \u00e0 primeira data vista)\n    -- E a data for anterior \u00e0 data de corte da carga inicial (data_hora_carga_inicial),\n    -- for\u00e7amos a data de in\u00edcio para '1900-01-01'.\n    -- Isso garante que vendas antigas (ex: 1998) consigam se conectar a este registro,\n    -- mas preserva a data real de entrada para novos clientes no futuro.\n    case\n        when s.dbt_valid_from = f.first_valid_from\n             and s.dbt_valid_from <= cast('2025-11-23 00:00:00' as timestamp)\n        then timestamp '1900-01-01'\n        else s.dbt_valid_from\n    end as dbt_valid_from,\n    s.dbt_valid_to,\n    -- Flag para indicar se \u00e9 o registro mais atual (se data fim for nula).\n    case when s.dbt_valid_to is null then true else false end as current_flag\nfrom source s\n-- Faz o join com a CTE first_seen para ter acesso \u00e0 data da primeira apari\u00e7\u00e3o\njoin first_seen f on s.customer_nk = f.customer_nk", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.068561Z", "completed_at": "2025-11-29T19:29:27.083190Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.089967Z", "completed_at": "2025-11-29T19:29:27.089978Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02900552749633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.084637Z", "completed_at": "2025-11-29T19:29:27.092919Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.101136Z", "completed_at": "2025-11-29T19:29:27.101145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025156736373901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_nk is not null\ngroup by employee_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.078321Z", "completed_at": "2025-11-29T19:29:27.093427Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.101943Z", "completed_at": "2025-11-29T19:29:27.101952Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028519630432128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.094423Z", "completed_at": "2025-11-29T19:29:27.109518Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.111007Z", "completed_at": "2025-11-29T19:29:27.111020Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020251750946044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_sk is not null\ngroup by employee_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.104597Z", "completed_at": "2025-11-29T19:29:27.121690Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.122868Z", "completed_at": "2025-11-29T19:29:27.122879Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02908635139465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_product", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o SCD2 de produtos: mant\u00e9m todas as vers\u00f5es do snapshot.\nwith source as (\n    -- Seleciona todos os dados da tabela de snapshot de produtos\n    select * from \"dw_northwind_metabase\".\"snapshots\".\"products_snapshot\"\n),\nfirst_seen as (\n    -- Identifica a primeira vez que cada produto (product_nk) apareceu no sistema.\n    -- Agrupa por chave natural e encontra a menor data de validade (min).\n    select\n        product_nk,\n        min(dbt_valid_from) as first_valid_from\n    from source\n    group by product_nk\n)\nselect\n    -- Gera uma chave substituta (SK) sequencial para cada vers\u00e3o do produto.\n    row_number() over (order by s.product_nk, coalesce(s.dbt_valid_from, timestamp '1900-01-01')) as product_sk,\n    s.product_nk,\n    s.source_system,\n    s.source_product_id,\n    s.supplier_nk,\n    s.category_nk,\n    s.product_name,\n    s.category_name,\n    s.supplier_name,\n    s.package_details,\n    s.unit_price,\n    s.units_in_stock,\n    s.units_on_order,\n    s.reorder_level,\n    s.rating_score,\n    s.product_created_at,\n    s.is_discontinued,\n    -- L\u00f3gica de \"Backdating\" (Retroa\u00e7\u00e3o de Data):\n    -- Se esta for a primeira vers\u00e3o do produto E for anterior ao corte,\n    -- for\u00e7amos a data de in\u00edcio para '1900-01-01'.\n    -- Isso permite vincular pedidos antigos a este produto.\n    case\n        when s.dbt_valid_from = f.first_valid_from\n             and s.dbt_valid_from <= cast('2025-11-23 00:00:00' as timestamp)\n        then timestamp '1900-01-01'\n        else s.dbt_valid_from\n    end as dbt_valid_from,\n    s.dbt_valid_to,\n    -- Flag para indicar se \u00e9 o registro mais atual.\n    case when s.dbt_valid_to is null then true else false end as current_flag\nfrom source s\n-- Faz o join com a CTE first_seen para comparar as datas\njoin first_seen f on s.product_nk = f.product_nk", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.115797Z", "completed_at": "2025-11-29T19:29:27.128725Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.129934Z", "completed_at": "2025-11-29T19:29:27.129945Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02124500274658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_analytic_events", "compiled": true, "compiled_code": "\n\n-- Fato de eventos de produto / analytics.\nwith source as (\n    select\n        event_nk,\n        source_system,\n        source_event_id,\n        customer_nk,\n        source_account_id,\n        event_name,\n        event_timestamp,\n        page_url,\n        button_label,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\n),\nfinal as (\n    select\n        -- Surrogate Keys\n        coalesce(dc.customer_sk, -1) as dim_customer_sk,\n        \n        -- Degenerate Dimensions & Metrics\n        s.event_nk,\n        s.customer_nk,\n        s.source_system,\n        s.source_event_id,\n        s.event_name,\n        s.event_timestamp,\n        s.page_url,\n        s.button_label,\n        s.dw_load_ts\n    from source s\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n        on s.customer_nk = dc.customer_nk\n       and s.event_timestamp >= coalesce(dc.dbt_valid_from, timestamp '1900-01-01')\n       and s.event_timestamp <  coalesce(dc.dbt_valid_to,   timestamp '9999-12-31')\n)\nselect * from final", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.111937Z", "completed_at": "2025-11-29T19:29:27.131002Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.132971Z", "completed_at": "2025-11-29T19:29:27.132985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02492523193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_supplier", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o SCD2 de fornecedores: mant\u00e9m todas as vers\u00f5es do snapshot.\nwith source as (\n    -- Seleciona todos os dados da tabela de snapshot de fornecedores\n    select * from \"dw_northwind_metabase\".\"snapshots\".\"suppliers_snapshot\"\n),\nfirst_seen as (\n    -- Identifica a primeira vez que cada fornecedor apareceu.\n    select\n        supplier_nk,\n        min(dbt_valid_from) as first_valid_from\n    from source\n    group by supplier_nk\n)\nselect\n    -- Gera a chave substituta (SK)\n    row_number() over (order by s.supplier_nk, coalesce(s.dbt_valid_from, timestamp '1900-01-01')) as supplier_sk,\n    s.supplier_nk,\n    s.source_system,\n    s.source_supplier_id,\n    s.supplier_name,\n    s.contact_name,\n    s.contact_title,\n    s.city,\n    s.region,\n    s.country,\n    s.phone,\n    -- L\u00f3gica de \"Backdating\": define a data inicial como 1900-01-01 para a primeira vers\u00e3o,\n    -- mas APENAS se a data for anterior ao corte da carga inicial.\n    case\n        when s.dbt_valid_from = f.first_valid_from\n             and s.dbt_valid_from <= cast('2025-11-23 00:00:00' as timestamp)\n        then timestamp '1900-01-01'\n        else s.dbt_valid_from\n    end as dbt_valid_from,\n    s.dbt_valid_to,\n    -- Flag de registro atual\n    case when s.dbt_valid_to is null then true else false end as current_flag\nfrom source s\njoin first_seen f on s.supplier_nk = f.supplier_nk", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.124800Z", "completed_at": "2025-11-29T19:29:27.138930Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.140644Z", "completed_at": "2025-11-29T19:29:27.140654Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018376588821411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_feedback", "compiled": true, "compiled_code": "\n\n-- Fato de feedback (NPS / avalia\u00e7\u00f5es de suporte).\nwith source as (\n    select\n        feedback_nk,\n        source_system,\n        source_feedback_id,\n        customer_nk,\n        source_account_id,\n        contact_email,\n        rating_score,\n        rating_label,\n        date_received,\n        feedback_text,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\n),\nfinal as (\n    select\n        -- Surrogate Keys\n        coalesce(dc.customer_sk, -1) as dim_customer_sk,\n        \n        -- Degenerate Dimensions & Metrics\n        s.feedback_nk,\n        s.customer_nk,\n        s.source_system,\n        s.source_feedback_id,\n        s.contact_email,\n        s.rating_score,\n        s.rating_label,\n        s.date_received,\n        s.feedback_text,\n        s.dw_load_ts\n    from source s\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n        on s.customer_nk = dc.customer_nk\n       and s.date_received >= coalesce(dc.dbt_valid_from, timestamp '1900-01-01')\n       and s.date_received <  coalesce(dc.dbt_valid_to,   timestamp '9999-12-31')\n)\nselect * from final", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.134167Z", "completed_at": "2025-11-29T19:29:27.148214Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.149846Z", "completed_at": "2025-11-29T19:29:27.149856Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020673274993896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_invoices", "compiled": true, "compiled_code": "\n\n-- Fato de faturamento SaaS (faturas Metabase).\nwith source as (\n    select\n        invoice_nk,\n        source_system,\n        source_invoice_id,\n        customer_nk,\n        source_account_id,\n        plan_name,\n        payment_amount,\n        expected_invoice_flag,\n        date_received,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\n),\nfinal as (\n    select\n        -- Surrogate Keys\n        coalesce(dc.customer_sk, -1) as dim_customer_sk,\n        \n        -- Degenerate Dimensions & Metrics\n        s.invoice_nk,\n        s.customer_nk,\n        s.source_system,\n        s.source_invoice_id,\n        s.plan_name,\n        s.payment_amount,\n        s.expected_invoice_flag,\n        s.date_received,\n        s.dw_load_ts\n    from source s\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n        on s.customer_nk = dc.customer_nk\n       and s.date_received >= coalesce(dc.dbt_valid_from, timestamp '1900-01-01')\n       and s.date_received <  coalesce(dc.dbt_valid_to,   timestamp '9999-12-31')\n)\nselect * from final", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.144036Z", "completed_at": "2025-11-29T19:29:27.160699Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.162096Z", "completed_at": "2025-11-29T19:29:27.162108Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02274322509765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_customer_customer_name.a25ec89461", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.150631Z", "completed_at": "2025-11-29T19:29:27.164734Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.172693Z", "completed_at": "2025-11-29T19:29:27.172716Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030097484588623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_customer_customer_nk.80aba6ef88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.156390Z", "completed_at": "2025-11-29T19:29:27.171979Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.174086Z", "completed_at": "2025-11-29T19:29:27.174097Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025033950805664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_customer_customer_sk.69b9dd095b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\nwhere customer_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.165383Z", "completed_at": "2025-11-29T19:29:27.181098Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.182753Z", "completed_at": "2025-11-29T19:29:27.182765Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02158522605895996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_customer_customer_nk.234a03fb58", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.175257Z", "completed_at": "2025-11-29T19:29:27.187655Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.191958Z", "completed_at": "2025-11-29T19:29:27.191968Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020800113677978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_customer_customer_sk.c225f6f263", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\nwhere customer_sk is not null\ngroup by customer_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.184013Z", "completed_at": "2025-11-29T19:29:27.194980Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.200639Z", "completed_at": "2025-11-29T19:29:27.200649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020560741424560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_reviews", "compiled": true, "compiled_code": "\n\n-- Fato de reviews p\u00fablicos (produtos Metabase).\nwith source as (\n    select\n        review_nk,\n        source_system,\n        source_review_id,\n        product_nk,\n        source_product_id,\n        reviewer_name,\n        rating_score,\n        created_at,\n        review_text,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\n),\nfinal as (\n    select\n        -- Surrogate Keys\n        coalesce(dp.product_sk, -1) as dim_product_sk,\n        \n        -- Degenerate Dimensions & Metrics\n        s.review_nk,\n        s.product_nk,\n        s.source_system,\n        s.source_review_id,\n        s.reviewer_name,\n        s.rating_score,\n        s.created_at,\n        s.review_text,\n        s.dw_load_ts\n    from source s\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n        on s.product_nk = dp.product_nk\n       and s.created_at >= coalesce(dp.dbt_valid_from, timestamp '1900-01-01')\n       and s.created_at <  coalesce(dp.dbt_valid_to,   timestamp '9999-12-31')\n)\nselect * from final", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.188514Z", "completed_at": "2025-11-29T19:29:27.201803Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.206937Z", "completed_at": "2025-11-29T19:29:27.206946Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02543783187866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.195417Z", "completed_at": "2025-11-29T19:29:27.209312Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.210840Z", "completed_at": "2025-11-29T19:29:27.210853Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018342256546020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.202419Z", "completed_at": "2025-11-29T19:29:27.216078Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.217679Z", "completed_at": "2025-11-29T19:29:27.217689Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023458242416381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.211823Z", "completed_at": "2025-11-29T19:29:27.224262Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.225810Z", "completed_at": "2025-11-29T19:29:27.225820Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017882347106933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_sk is not null\ngroup by product_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.218465Z", "completed_at": "2025-11-29T19:29:27.236263Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.241923Z", "completed_at": "2025-11-29T19:29:27.241932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0316925048828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\nwhere event_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.226564Z", "completed_at": "2025-11-29T19:29:27.243391Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.249735Z", "completed_at": "2025-11-29T19:29:27.249745Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026829957962036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.237252Z", "completed_at": "2025-11-29T19:29:27.251043Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.253170Z", "completed_at": "2025-11-29T19:29:27.253179Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028158903121948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\nwhere event_nk is not null\ngroup by event_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.244556Z", "completed_at": "2025-11-29T19:29:27.259528Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.264811Z", "completed_at": "2025-11-29T19:29:27.264821Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023490190505981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_sales", "compiled": true, "compiled_code": "\n\nwith sales_unioned as (\n    -- Fato de vendas unificada (B2B + B2C) com m\u00e9tricas financeiras padronizadas.\n    with northwind as (\n        select\n            'NORTHWIND'                          as source_system,\n            od.source_order_id,\n            od.order_nk,\n            o.customer_nk,\n            od.supplier_nk,\n            od.category_nk,\n            od.product_nk,\n            o.employee_nk,\n            o.shipper_nk,\n            'CHANNEL_NORTHWIND'                  as channel_nk,\n            o.order_date,\n            o.shipped_date,\n            od.quantity,\n            od.unit_price,\n            od.discount_pct,\n            od.gross_amount,\n            od.net_amount,\n            od.dw_load_ts\n        from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\" od\n        join \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\" o\n          on od.order_nk = o.order_nk\n    ),\n    metabase as (\n        select\n            'METABASE'                           as source_system,\n            source_order_id,\n            order_nk,\n            customer_nk,\n            supplier_nk,\n            category_nk,\n            product_nk,\n            employee_nk,\n            null::varchar                        as shipper_nk,\n            'CHANNEL_METABASE'                   as channel_nk,\n            order_date,\n            shipped_date,\n            quantity,\n            unit_price,\n            discount_pct,\n            (quantity * unit_price)::numeric(14,4)                         as gross_amount,\n            total_amount                                                   as net_amount,\n            dw_load_ts\n        from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\n    )\n    select * from northwind\n    union all\n    select * from metabase\n),\n\nfinal as (\n    select\n        -- Surrogate Keys (SKs)\n        coalesce(dc.customer_sk, -1)          as dim_customer_sk,\n        coalesce(dp.product_sk, -1)           as dim_product_sk,\n        coalesce(ds.supplier_sk, -1)          as dim_supplier_sk,\n        coalesce(dcat.category_sk, -1)        as dim_category_sk,\n        coalesce(de.employee_sk, -1)          as dim_employee_sk,\n        coalesce(dch.channel_sk, -1)          as dim_channel_sk,\n        -- Degenerate Dimensions (Order and Source System)\n        s.order_nk,\n        s.source_system,\n        s.source_order_id,\n        -- Fact Metrics\n        s.order_date,\n        s.shipped_date,\n        s.quantity,\n        s.unit_price,\n        s.discount_pct,\n        s.gross_amount,\n        s.net_amount,\n        s.dw_load_ts\n\n    from sales_unioned s\n\n    -- Jun\u00e7\u00e3o \u201cas of\u201d com dimens\u00f5es SCD2 (mant\u00eam dbt_valid_from/dbt_valid_to)\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n        on s.customer_nk = dc.customer_nk\n       and s.order_date >= coalesce(dc.dbt_valid_from, timestamp '1900-01-01')\n       and s.order_date <  coalesce(dc.dbt_valid_to,   timestamp '9999-12-31')\n\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n        on s.product_nk = dp.product_nk\n       and s.order_date >= coalesce(dp.dbt_valid_from, timestamp '1900-01-01')\n       and s.order_date <  coalesce(dp.dbt_valid_to,   timestamp '9999-12-31')\n\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\" ds\n        on s.supplier_nk = ds.supplier_nk\n       and s.order_date >= coalesce(ds.dbt_valid_from, timestamp '1900-01-01')\n       and s.order_date <  coalesce(ds.dbt_valid_to,   timestamp '9999-12-31')\n\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\" dcat\n        on dp.category_nk = dcat.category_nk\n\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\" de\n        on s.employee_nk = de.employee_nk\n       and s.order_date >= coalesce(de.dbt_valid_from, timestamp '1900-01-01')\n       and s.order_date <  coalesce(de.dbt_valid_to,   timestamp '9999-12-31')\n\n    -- Jun\u00e7\u00e3o com dim_channel (n\u00e3o \u00e9 um snapshot)\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\" dch on s.channel_nk = dch.channel_nk\n)\n\nselect * from final", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.254715Z", "completed_at": "2025-11-29T19:29:27.271075Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.272412Z", "completed_at": "2025-11-29T19:29:27.272422Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02202749252319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_supplier_supplier_nk.d28dc32fe6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.260658Z", "completed_at": "2025-11-29T19:29:27.274011Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.279920Z", "completed_at": "2025-11-29T19:29:27.279928Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025955677032470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_supplier_supplier_sk.2431bdc298", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.267059Z", "completed_at": "2025-11-29T19:29:27.279484Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.281182Z", "completed_at": "2025-11-29T19:29:27.281191Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021160602569580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_supplier_supplier_nk.a66ac359fa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_nk is not null\ngroup by supplier_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.275101Z", "completed_at": "2025-11-29T19:29:27.284280Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.289633Z", "completed_at": "2025-11-29T19:29:27.289642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018042325973510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_supplier_supplier_sk.cced48ade4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_sk is not null\ngroup by supplier_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.284937Z", "completed_at": "2025-11-29T19:29:27.301103Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.302596Z", "completed_at": "2025-11-29T19:29:27.302635Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02213144302368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feedback_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\nwhere feedback_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.291001Z", "completed_at": "2025-11-29T19:29:27.305079Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.310547Z", "completed_at": "2025-11-29T19:29:27.310556Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027152061462402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.296728Z", "completed_at": "2025-11-29T19:29:27.309493Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.311461Z", "completed_at": "2025-11-29T19:29:27.311468Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02285599708557129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    feedback_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\nwhere feedback_nk is not null\ngroup by feedback_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.305756Z", "completed_at": "2025-11-29T19:29:27.314386Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.321018Z", "completed_at": "2025-11-29T19:29:27.321028Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019389867782592773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_saas", "compiled": true, "compiled_code": "\n\n-- Data mart para faturamento SaaS (Metabase invoices) com joins SCD2 usando o intervalo completo.\nwith invoices as (\n    select\n        fi.invoice_nk,\n        fi.customer_nk,\n        fi.plan_name,\n        fi.payment_amount,\n        fi.expected_invoice_flag,\n        fi.date_received::date as invoice_date,\n        dc.customer_name,\n        dc.segment,\n        dc.plan,\n        dd.year,\n        dd.month,\n        dd.month_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\" fi\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fi.dim_customer_sk = dc.customer_sk\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\" dd\n           on fi.date_received::date = dd.date_day\n)\nselect *\nfrom invoices", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_saas\".\"dm_saas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.315109Z", "completed_at": "2025-11-29T19:29:27.333809Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.335456Z", "completed_at": "2025-11-29T19:29:27.335470Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025637388229370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.327458Z", "completed_at": "2025-11-29T19:29:27.345072Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.350646Z", "completed_at": "2025-11-29T19:29:27.350657Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03024768829345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.323494Z", "completed_at": "2025-11-29T19:29:27.345577Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.351433Z", "completed_at": "2025-11-29T19:29:27.351441Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03171277046203613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere invoice_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.336424Z", "completed_at": "2025-11-29T19:29:27.352349Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.353861Z", "completed_at": "2025-11-29T19:29:27.353872Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020807743072509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoice_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere invoice_nk is not null\ngroup by invoice_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.346003Z", "completed_at": "2025-11-29T19:29:27.355845Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.357820Z", "completed_at": "2025-11-29T19:29:27.357829Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014174699783325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_product_analytics", "compiled": true, "compiled_code": "\n\n-- Mart 360 de produto com joins SCD2 usando o intervalo completo.\nwith events as (\n    select\n        'ANALYTIC_EVENT'   as record_type,\n        fa.event_nk        as record_nk,\n        fa.customer_nk,\n        null::varchar      as product_nk,\n        fa.event_name      as metric_name,\n        1::numeric         as metric_value,\n        fa.event_timestamp as metric_timestamp,\n        fa.page_url        as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar      as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\" fa\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fa.dim_customer_sk = dc.customer_sk\n),\nreviews as (\n    select\n        'REVIEW'           as record_type,\n        fr.review_nk       as record_nk,\n        null::varchar      as customer_nk,\n        fr.product_nk,\n        'rating_score'     as metric_name,\n        fr.rating_score    as metric_value,\n        fr.created_at      as metric_timestamp,\n        fr.review_text     as context_info,\n        null::varchar      as customer_name,\n        null::varchar      as segment,\n        dp.product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\" fr\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n           on fr.dim_product_sk = dp.product_sk\n),\nfeedback as (\n    select\n        'FEEDBACK'         as record_type,\n        ff.feedback_nk     as record_nk,\n        ff.customer_nk,\n        null::varchar      as product_nk,\n        'rating_score'     as metric_name,\n        ff.rating_score    as metric_value,\n        ff.date_received   as metric_timestamp,\n        ff.feedback_text   as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar      as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\" ff\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on ff.dim_customer_sk = dc.customer_sk\n)\nselect * from events\nunion all\nselect * from reviews\nunion all\nselect * from feedback", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_product_analytics\".\"dm_product_analytics\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.359025Z", "completed_at": "2025-11-29T19:29:27.381720Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.383375Z", "completed_at": "2025-11-29T19:29:27.383393Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028880834579467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.363337Z", "completed_at": "2025-11-29T19:29:27.382562Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.384714Z", "completed_at": "2025-11-29T19:29:27.384726Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029577970504760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere review_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.368880Z", "completed_at": "2025-11-29T19:29:27.385729Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.388246Z", "completed_at": "2025-11-29T19:29:27.388257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02985548973083496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\n    where product_nk is not null\n),\n\nparent as (\n    select product_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.376215Z", "completed_at": "2025-11-29T19:29:27.387139Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.390013Z", "completed_at": "2025-11-29T19:29:27.390024Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021804094314575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere review_nk is not null\ngroup by review_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.393998Z", "completed_at": "2025-11-29T19:29:27.413109Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.413855Z", "completed_at": "2025-11-29T19:29:27.413868Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024615049362182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_sales", "compiled": true, "compiled_code": "\n\n-- Data mart consolidado de vendas.\n-- As jun\u00e7\u00f5es s\u00e3o simples e diretas, pois o fact_sales j\u00e1 resolveu as chaves substitutas (SKs) corretas para cada venda.\nselect\n    -- Fato\n    fs.order_nk,\n    fs.source_system,\n    fs.order_date,\n    fs.quantity,\n    fs.gross_amount,\n    fs.net_amount,\n    -- Dimens\u00f5es\n    dc.customer_name,\n    dc.city as customer_city,\n    dc.segment,\n    dc.country as customer_country,\n    dp.product_name,\n    dcat.category_name,\n    ds.supplier_name,\n    de.employee_name,\n    de.job_title,\n    dch.channel_name\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\" fs\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc on fs.dim_customer_sk = dc.customer_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp on fs.dim_product_sk = dp.product_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\" ds on fs.dim_supplier_sk = ds.supplier_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\" dcat on fs.dim_category_sk = dcat.category_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\" de on fs.dim_employee_sk = de.employee_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\" dch on fs.dim_channel_sk = dch.channel_sk", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.399069Z", "completed_at": "2025-11-29T19:29:27.415714Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.417038Z", "completed_at": "2025-11-29T19:29:27.417050Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026332378387451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere channel_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.404623Z", "completed_at": "2025-11-29T19:29:27.418122Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.420399Z", "completed_at": "2025-11-29T19:29:27.420408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027039051055908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.408654Z", "completed_at": "2025-11-29T19:29:27.418641Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.421315Z", "completed_at": "2025-11-29T19:29:27.421323Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0229189395904541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.422058Z", "completed_at": "2025-11-29T19:29:27.447039Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.448094Z", "completed_at": "2025-11-29T19:29:27.448105Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03190898895263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.436123Z", "completed_at": "2025-11-29T19:29:27.458161Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.458683Z", "completed_at": "2025-11-29T19:29:27.458696Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030475616455078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where channel_nk is not null\n),\n\nparent as (\n    select channel_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.429351Z", "completed_at": "2025-11-29T19:29:27.460307Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.461826Z", "completed_at": "2025-11-29T19:29:27.461836Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03557538986206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_category_nk__category_nk__ref_dim_category_.f77453a776", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where category_nk is not null\n),\n\nparent as (\n    select category_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.442090Z", "completed_at": "2025-11-29T19:29:27.463140Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.470128Z", "completed_at": "2025-11-29T19:29:27.470139Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0414118766784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.451160Z", "completed_at": "2025-11-29T19:29:27.471103Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.472769Z", "completed_at": "2025-11-29T19:29:27.472778Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023099660873413086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_employee_nk__employee_nk__ref_dim_employee_.d99c1a5c6d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select employee_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where employee_nk is not null\n),\n\nparent as (\n    select employee_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.464550Z", "completed_at": "2025-11-29T19:29:27.475226Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.483025Z", "completed_at": "2025-11-29T19:29:27.483035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02199101448059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where product_nk is not null\n),\n\nparent as (\n    select product_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.475681Z", "completed_at": "2025-11-29T19:29:27.491523Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.492124Z", "completed_at": "2025-11-29T19:29:27.492146Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020716190338134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_supplier_nk__supplier_nk__ref_dim_supplier_.a82039abd4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select supplier_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where supplier_nk is not null\n),\n\nparent as (\n    select supplier_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.488121Z", "completed_at": "2025-11-29T19:29:27.493343Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.493940Z", "completed_at": "2025-11-29T19:29:27.493949Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011630773544311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2c", "compiled": true, "compiled_code": "\n\n-- Data mart focado nas vendas Metabase (B2C/SaaS).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'METABASE'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2c\".\"dm_b2c\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-29T19:29:27.484004Z", "completed_at": "2025-11-29T19:29:27.495475Z"}, {"name": "execute", "started_at": "2025-11-29T19:29:27.496186Z", "completed_at": "2025-11-29T19:29:27.496195Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02213311195373535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2b", "compiled": true, "compiled_code": "\n\n-- Data mart focado no fluxo Northwind (B2B).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'NORTHWIND'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2b\".\"dm_b2b\"", "batch_results": null}], "elapsed_time": 1.8257355690002441, "args": {"indirect_selection": "eager", "send_anonymous_usage_stats": true, "show_resource_report": false, "exclude": [], "macro_debugging": false, "partial_parse_file_diff": true, "require_nested_cumulative_type_params": false, "require_yaml_configuration_for_mf_time_spines": false, "static": false, "write_json": true, "log_level": "info", "vars": {}, "profiles_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "validate_macro_args": false, "print": true, "state_modified_compare_vars": false, "defer": false, "log_level_file": "debug", "static_parser": true, "invocation_command": "dbt docs generate", "warn_error_options": {"error": [], "warn": [], "silence": []}, "skip_nodes_if_on_run_start_fails": false, "require_generic_test_arguments_property": true, "favor_state": false, "require_resource_names_without_spaces": true, "cache_selected_only": false, "populate_cache": true, "show_all_deprecations": false, "use_colors_file": true, "log_format": "default", "log_path": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs", "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "which": "generate", "source_freshness_run_project_hooks": true, "compile": true, "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "use_colors": true, "project_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "quiet": false, "partial_parse": true, "empty_catalog": false, "log_file_max_bytes": 10485760, "printer_width": 80, "require_all_warnings_handled_by_warn_error": false, "version_check": true, "upload_to_artifacts_ingest_api": false, "introspect": true}}