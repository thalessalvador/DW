{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-10T04:34:12.456368Z", "invocation_id": "7463e9a6-69c2-4c08-a274-bc02176fa49b", "invocation_started_at": "2025-11-10T04:34:09.651646Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.572651Z", "completed_at": "2025-11-10T04:34:11.594692Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.596362Z", "completed_at": "2025-11-10T04:34:11.596393Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03032970428466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_analytic_events", "compiled": true, "compiled_code": "\n\n-- Eventos de analytics (produto/app) para an\u00e1lises de comportamento.\nselect\n    'METABASE'                               as source_system,\n    ae.id                                    as source_event_id,\n    'METABASE_EVT_' || ae.id                 as event_nk,\n    case\n        when acc.id is not null then 'METABASE_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    ae.account_id                            as source_account_id,\n    ae.event                                 as event_name,\n    case\n        when ae.\"timestamp\" ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then ae.\"timestamp\"::timestamp\n        else null\n    end                                      as event_timestamp,\n    ae.page_url                              as page_url,\n    ae.button_label                          as button_label,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"analyticevents\" ae\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(ae.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.582271Z", "completed_at": "2025-11-10T04:34:11.595408Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.598155Z", "completed_at": "2025-11-10T04:34:11.598174Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030833959579467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_date", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de datas gerada via s\u00e9rie cont\u00ednua (apoia an\u00e1lises hist\u00f3ricas).\nwith calendar as (\n    select\n        day::date as date_day\n    from generate_series('1990-01-01'::date, '2035-12-31'::date, interval '1 day') as gs(day)\n)\nselect\n    row_number() over (order by date_day)         as date_sk,\n    date_day,\n    extract(year from date_day)::int              as year,\n    extract(quarter from date_day)::int           as quarter,\n    extract(month from date_day)::int             as month,\n    to_char(date_day, 'TMMonth')                  as month_name,\n    extract(day from date_day)::int               as day_of_month,\n    to_char(date_day, 'IW')::int                  as iso_week,\n    extract(dow from date_day)::int               as day_of_week,\n    to_char(date_day, 'Dy')                       as day_name,\n    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend\nfrom calendar", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.585907Z", "completed_at": "2025-11-10T04:34:11.599448Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.602699Z", "completed_at": "2025-11-10T04:34:11.602715Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034378767013549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_accounts", "compiled": true, "compiled_code": "\n\n-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.\nselect\n    'METABASE'                             as source_system,\n    a.id                                   as source_customer_id,\n    'METABASE_' || a.id                    as customer_nk,\n    a.email                                as customer_name,\n    a.first_name                           as first_name,\n    a.last_name                            as last_name,\n    upper(coalesce(a.country, 'N/A'))      as country,\n    a.plan                                 as plan,\n    a.source                               as segment,\n    cast(a.seats as integer)               as seats,\n    a.trial_converted                      as trial_converted,\n    a.active_subscription                  as active_subscription,\n    a.legacy_plan                          as legacy_plan,\n    case\n        when a.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then a.created_at::timestamp\n        else null\n    end                                   as created_at,\n    case\n        when a.trial_ends_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then a.trial_ends_at::timestamp\n        else null\n    end                                   as trial_ends_at,\n    case\n        when a.canceled_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then a.canceled_at::timestamp\n        else null\n    end                                   as canceled_at,\n    current_timestamp                      as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"accounts\" a", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.589810Z", "completed_at": "2025-11-10T04:34:11.601216Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.604501Z", "completed_at": "2025-11-10T04:34:11.604511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03537344932556152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_channel", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de canais/fonte (B2B x B2C/SaaS).\nselect\n    row_number() over (order by channel_nk) as channel_sk,\n    channel_nk,\n    channel_name,\n    business_model\nfrom (\n    values\n        ('CHANNEL_NORTHWIND', 'Northwind ERP', 'B2B'),\n        ('CHANNEL_METABASE', 'Metabase Sample', 'B2C/SaaS')\n) as channels(channel_nk, channel_name, business_model)", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.609604Z", "completed_at": "2025-11-10T04:34:11.631785Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.632737Z", "completed_at": "2025-11-10T04:34:11.632753Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029067516326904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_feedback", "compiled": true, "compiled_code": "\n\n-- Feedbacks recebidos via canais de suporte Metabase.\nselect\n    'METABASE'                               as source_system,\n    f.id                                     as source_feedback_id,\n    'METABASE_FB_' || f.id                   as feedback_nk,\n    case\n        when acc.id is not null then 'METABASE_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    f.account_id                             as source_account_id,\n    f.email                                  as contact_email,\n    cast(f.rating as numeric(5,2))           as rating_score,\n    f.rating_mapped                          as rating_label,\n    case\n        when f.date_received ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then f.date_received::timestamp\n        else null\n    end                                      as date_received,\n    f.body                                   as feedback_text,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"feedback\" f\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(f.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.616082Z", "completed_at": "2025-11-10T04:34:11.636413Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.641693Z", "completed_at": "2025-11-10T04:34:11.641707Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03648638725280762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_invoices", "compiled": true, "compiled_code": "\n\n-- Faturas SaaS (Metabase) com valores normalizados e v\u00ednculo ao cliente.\nselect\n    'METABASE'                               as source_system,\n    i.id                                     as source_invoice_id,\n    'METABASE_' || i.id                      as invoice_nk,\n    case\n        when acc.id is not null then 'METABASE_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    i.account_id                             as source_account_id,\n    i.plan                                   as plan_name,\n    cast(i.payment as numeric(12,4))         as payment_amount,\n    i.expected_invoice                       as expected_invoice_flag,\n    case\n        when i.date_received ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then i.date_received::timestamp\n        else null\n    end                                      as date_received,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"invoices\" i\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(i.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.621520Z", "completed_at": "2025-11-10T04:34:11.641098Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.643241Z", "completed_at": "2025-11-10T04:34:11.643254Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034368038177490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_orders", "compiled": true, "compiled_code": "\n\nwith account_name_map as (\n    select\n        lower(concat_ws(' ', first_name, last_name)) as full_name_key,\n        min(id)                                      as account_id\n    from \"dw_northwind_metabase\".\"public\".\"accounts\"\n    where first_name is not null and last_name is not null\n    group by 1\n),\npeople_name_map as (\n    select\n        lower(name) as full_name_key,\n        min(id)     as person_id\n    from \"dw_northwind_metabase\".\"public\".\"people\"\n    where name is not null\n    group by 1\n),\nproduct_map as (\n    select\n        lower(title) as title_key,\n        min(id)      as product_id\n    from \"dw_northwind_metabase\".\"public\".\"products\"\n    group by 1\n)\n-- Pedidos/eventos comerciais da base Metabase Sample.\nselect\n    'METABASE'                               as source_system,\n    o.id                                     as source_order_id,\n    'METABASE_' || o.id                      as order_nk,\n    case\n        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar\n        when people_map.person_id is not null then 'METABASE_PERSON_' || people_map.person_id::varchar\n        else 'METABASE_ORPHAN_' || upper(trim(o.user_id))\n    end                                       as customer_nk,\n    case\n        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar\n        else 'METABASE_' || upper(trim(o.product_id))\n    end                                       as product_nk,\n    null::varchar                            as order_state,\n    case\n        when o.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then o.created_at::timestamp\n        else null\n    end                                     as order_date,\n    cast(null as timestamp)                  as shipped_date,\n    cast(o.quantity as numeric(12,4))        as quantity,\n    (\n        case\n            when o.quantity is not null and o.quantity <> 0\n                then (o.subtotal / o.quantity)\n            else null\n        end\n    )::numeric(12,4)                         as unit_price,\n    cast(o.discount____ as numeric(12,4))    as discount_pct,\n    cast(o.total as numeric(14,4))           as total_amount,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"orders\" o\nleft join account_name_map acc_map\n       on lower(o.user_id) = acc_map.full_name_key\nleft join people_name_map people_map\n       on acc_map.account_id is null\n      and lower(o.user_id) = people_map.full_name_key\nleft join product_map prod_map\n       on lower(o.product_id) = prod_map.title_key", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.627346Z", "completed_at": "2025-11-10T04:34:11.642662Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.644846Z", "completed_at": "2025-11-10T04:34:11.644857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02968001365661621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_people", "compiled": true, "compiled_code": "\n\n-- Registros da tabela people (usados pelos pedidos B2C que n\u00e3o mapeiam para accounts).\nselect\n    'METABASE'                               as source_system,\n    p.id                                     as source_customer_id,\n    'METABASE_PERSON_' || p.id               as customer_nk,\n    p.name                                   as customer_name,\n    null::varchar                            as contact_name,\n    null::varchar                            as contact_title,\n    split_part(p.name, ' ', 1)               as first_name,\n    nullif(split_part(p.name, ' ', 2), '')   as last_name,\n    p.address                                as address,\n    p.city                                   as city,\n    p.state                                  as region,\n    null::varchar                            as country,\n    p.zip::varchar                           as postal_code,\n    null::varchar                            as plan,\n    p.source                                 as segment,\n    null::int                                as seats,\n    null::boolean                            as trial_converted,\n    null::boolean                            as active_subscription,\n    null::boolean                            as legacy_plan,\n    null::timestamp                          as created_at,\n    null::timestamp                          as trial_ends_at,\n    null::timestamp                          as canceled_at,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"people\" p", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.637129Z", "completed_at": "2025-11-10T04:34:11.647804Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.649863Z", "completed_at": "2025-11-10T04:34:11.649872Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014913797378540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_products", "compiled": true, "compiled_code": "\n\n-- Cat\u00e1logo de produtos Metabase Sample (B2C/SaaS) com atributos de pre\u00e7o e rating.\nselect\n    'METABASE'                               as source_system,\n    p.id                                     as source_product_id,\n    'METABASE_' || p.id                      as product_nk,\n    p.title                                  as product_name,\n    p.category                               as category_name,\n    p.vendor                                 as vendor_name,\n    cast(p.price as numeric(12,4))           as unit_price,\n    cast(p.rating as numeric(5,2))           as rating_score,\n    case\n        when p.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then p.created_at::timestamp\n        else null\n    end                                     as created_at,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"products\" p", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.651526Z", "completed_at": "2025-11-10T04:34:11.664421Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.669414Z", "completed_at": "2025-11-10T04:34:11.669425Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022559642791748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_reviews", "compiled": true, "compiled_code": "\n\nwith product_map as (\n    select\n        lower(title) as title_key,\n        min(id)      as product_id\n    from \"dw_northwind_metabase\".\"public\".\"products\"\n    group by 1\n)\n-- Reviews p\u00fablicos dos produtos Metabase Sample.\nselect\n    'METABASE'                               as source_system,\n    r._mb_row_id                             as source_review_id,\n    'METABASE_RV_' || r._mb_row_id           as review_nk,\n    case\n        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar\n        else 'METABASE_' || upper(trim(r.product_id))\n    end                                      as product_nk,\n    r.product_id                             as source_product_id,\n    r.reviewer                               as reviewer_name,\n    cast(r.rating as numeric(5,2))           as rating_score,\n    case\n        when r.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then r.created_at::timestamp\n        else null\n    end                                      as created_at,\n    r.body                                   as review_text,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"reviews\" r\nleft join product_map prod_map\n       on lower(r.product_id) = prod_map.title_key", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.660234Z", "completed_at": "2025-11-10T04:34:11.671364Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.673493Z", "completed_at": "2025-11-10T04:34:11.673504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02299642562866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_employees", "compiled": true, "compiled_code": "\n\n-- Colaboradores Northwind com atributos de localiza\u00e7\u00e3o e datas chave.\nselect\n    'NORTHWIND'                                   as source_system,\n    e.empid                                       as source_employee_id,\n    'NORTHWIND_' || e.empid                       as employee_nk,\n    e.firstname                                   as first_name,\n    e.lastname                                    as last_name,\n    e.title                                       as job_title,\n    e.titleofcourtesy                             as courtesy_title,\n    cast(e.birthdate as date)                     as birth_date,\n    cast(e.hiredate as date)                      as hire_date,\n    e.city                                        as city,\n    coalesce(nullif(e.region, ''), 'N/A')         as region,\n    e.country                                     as country,\n    e.postalcode                                  as postal_code,\n    e.phone                                       as phone,\n    e.extension                                   as phone_extension,\n    e.mgrid                                       as manager_empid,\n    current_timestamp                             as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"employee\" e", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.656837Z", "completed_at": "2025-11-10T04:34:11.671871Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.674463Z", "completed_at": "2025-11-10T04:34:11.674476Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02585768699645996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_customers", "compiled": true, "compiled_code": "\n\n-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).\nselect\n    'NORTHWIND'                               as source_system,\n    custid                                    as source_customer_id,\n    'NORTHWIND_' || custid                    as customer_nk,\n    companyname                               as customer_name,\n    contactname                               as contact_name,\n    contacttitle                              as contact_title,\n    address                                   as address,\n    city                                      as city,\n    coalesce(nullif(region, ''), 'N/A')       as region,\n    country                                   as country,\n    postalcode                                as postal_code,\n    phone                                     as phone,\n    fax                                       as fax,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"customer\"", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.665160Z", "completed_at": "2025-11-10T04:34:11.675471Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.677652Z", "completed_at": "2025-11-10T04:34:11.677661Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018031597137451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_order_details", "compiled": true, "compiled_code": "\n\n-- Itens de pedido Northwind com m\u00e9tricas preparadas para a fato de vendas.\nselect\n    'NORTHWIND'                                      as source_system,\n    od.orderid                                       as source_order_id,\n    'NORTHWIND_' || od.orderid                       as order_nk,\n    'NORTHWIND_' || od.productid                     as product_nk,\n    cast(od.qty as numeric(12,4))                    as quantity,\n    cast(od.unitprice as numeric(12,4))              as unit_price,\n    cast(od.discount as numeric(5,4))                as discount_pct,\n    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,\n    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,\n    current_timestamp                                as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"orderdetail\" od", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.678532Z", "completed_at": "2025-11-10T04:34:11.693332Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.694592Z", "completed_at": "2025-11-10T04:34:11.694602Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0223081111907959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_orders", "compiled": true, "compiled_code": "\n\n-- Normaliza os pedidos (cabe\u00e7alho) da Northwind gerando NKs padronizadas.\nselect\n    'NORTHWIND'                                 as source_system,\n    o.orderid                                   as source_order_id,\n    'NORTHWIND_' || o.orderid                   as order_nk,\n    'NORTHWIND_' || o.custid                    as customer_nk,\n    'NORTHWIND_' || o.empid                     as employee_nk,\n    'NORTHWIND_' || o.shipperid                 as shipper_nk,\n    cast(o.orderdate as date)                   as order_date,\n    cast(o.requireddate as date)                as required_date,\n    cast(o.shippeddate as date)                 as shipped_date,\n    cast(o.freight as numeric(12,2))            as freight_amount,\n    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,\n    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,\n    o.shipcity                                  as ship_city,\n    current_timestamp                           as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"salesorder\" o", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.685316Z", "completed_at": "2025-11-10T04:34:11.723823Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.731646Z", "completed_at": "2025-11-10T04:34:11.731657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05007672309875488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_products", "compiled": true, "compiled_code": "\n\n-- Cat\u00e1logo Northwind com categoria, fornecedor e indicadores de estoque.\nselect\n    'NORTHWIND'                                   as source_system,\n    p.productid                                   as source_product_id,\n    'NORTHWIND_' || p.productid                   as product_nk,\n    p.productname                                 as product_name,\n    c.categoryname                                as category_name,\n    s.companyname                                 as supplier_name,\n    p.quantityperunit                             as package_details,\n    cast(p.unitprice as numeric(12,4))            as unit_price,\n    p.unitsinstock                                as units_in_stock,\n    p.unitsonorder                                as units_on_order,\n    p.reorderlevel                                as reorder_level,\n    p.discontinued = '1'                          as is_discontinued,\n    current_timestamp                             as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"product\" p\nleft join \"dw_northwind_metabase\".\"public\".\"category\" c\n       on p.categoryid = c.categoryid\nleft join \"dw_northwind_metabase\".\"public\".\"supplier\" s\n       on p.supplierid = s.supplierid", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.689821Z", "completed_at": "2025-11-10T04:34:11.724400Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.732454Z", "completed_at": "2025-11-10T04:34:11.732461Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05037403106689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_analytic_events", "compiled": true, "compiled_code": "\n\n-- Fato de eventos de produto / analytics.\nselect\n    event_nk,\n    source_system,\n    source_event_id,\n    customer_nk,\n    source_account_id,\n    event_name,\n    event_timestamp,\n    page_url,\n    button_label,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.695521Z", "completed_at": "2025-11-10T04:34:11.733183Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.735084Z", "completed_at": "2025-11-10T04:34:11.735096Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.050643205642700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\nwhere event_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.724988Z", "completed_at": "2025-11-10T04:34:11.737514Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.739642Z", "completed_at": "2025-11-10T04:34:11.739656Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017974853515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\nwhere event_nk is not null\ngroup by event_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.744337Z", "completed_at": "2025-11-10T04:34:11.760986Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.762700Z", "completed_at": "2025-11-10T04:34:11.762714Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02630615234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.740598Z", "completed_at": "2025-11-10T04:34:11.761888Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.764147Z", "completed_at": "2025-11-10T04:34:11.764155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02828383445739746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.749888Z", "completed_at": "2025-11-10T04:34:11.763677Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.765612Z", "completed_at": "2025-11-10T04:34:11.765620Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026815414428710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.755009Z", "completed_at": "2025-11-10T04:34:11.767305Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.769464Z", "completed_at": "2025-11-10T04:34:11.769472Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01575922966003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_sk is not null\ngroup by date_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.772912Z", "completed_at": "2025-11-10T04:34:11.792862Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.793744Z", "completed_at": "2025-11-10T04:34:11.793759Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025557518005371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.787900Z", "completed_at": "2025-11-10T04:34:11.802011Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.805127Z", "completed_at": "2025-11-10T04:34:11.805137Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027164936065673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.782563Z", "completed_at": "2025-11-10T04:34:11.804047Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.806161Z", "completed_at": "2025-11-10T04:34:11.806170Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03502178192138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.778634Z", "completed_at": "2025-11-10T04:34:11.804597Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.807032Z", "completed_at": "2025-11-10T04:34:11.807040Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03687548637390137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.797498Z", "completed_at": "2025-11-10T04:34:11.809600Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.812520Z", "completed_at": "2025-11-10T04:34:11.812530Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016625404357910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_nk is not null\ngroup by channel_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.815193Z", "completed_at": "2025-11-10T04:34:11.835597Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.837478Z", "completed_at": "2025-11-10T04:34:11.837495Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02751016616821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_sk is not null\ngroup by channel_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.819386Z", "completed_at": "2025-11-10T04:34:11.836378Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.838843Z", "completed_at": "2025-11-10T04:34:11.838855Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02757096290588379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_feedback", "compiled": true, "compiled_code": "\n\n-- Fato de feedback (NPS / avalia\u00e7\u00f5es de suporte).\nselect\n    feedback_nk,\n    source_system,\n    source_feedback_id,\n    customer_nk,\n    source_account_id,\n    contact_email,\n    rating_score,\n    rating_label,\n    date_received,\n    feedback_text,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.830419Z", "completed_at": "2025-11-10T04:34:11.840490Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.842625Z", "completed_at": "2025-11-10T04:34:11.842634Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013817787170410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    feedback_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\nwhere feedback_nk is not null\ngroup by feedback_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.822494Z", "completed_at": "2025-11-10T04:34:11.841036Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.843569Z", "completed_at": "2025-11-10T04:34:11.843577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03170204162597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feedback_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\nwhere feedback_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.847927Z", "completed_at": "2025-11-10T04:34:11.867583Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.869194Z", "completed_at": "2025-11-10T04:34:11.869206Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025057077407836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_invoices", "compiled": true, "compiled_code": "\n\n-- Fato de faturamento SaaS (faturas Metabase).\nselect\n    invoice_nk,\n    source_system,\n    source_invoice_id,\n    customer_nk,\n    source_account_id,\n    plan_name,\n    payment_amount,\n    expected_invoice_flag,\n    date_received,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.851087Z", "completed_at": "2025-11-10T04:34:11.868282Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.871087Z", "completed_at": "2025-11-10T04:34:11.871098Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026551485061645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.857364Z", "completed_at": "2025-11-10T04:34:11.872549Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.874720Z", "completed_at": "2025-11-10T04:34:11.874730Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02785468101501465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere invoice_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.861998Z", "completed_at": "2025-11-10T04:34:11.875580Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.877660Z", "completed_at": "2025-11-10T04:34:11.877675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030295133590698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoice_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere invoice_nk is not null\ngroup by invoice_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.885304Z", "completed_at": "2025-11-10T04:34:11.901896Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.902931Z", "completed_at": "2025-11-10T04:34:11.902946Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026552915573120117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.880497Z", "completed_at": "2025-11-10T04:34:11.906588Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.909721Z", "completed_at": "2025-11-10T04:34:11.909732Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033817291259765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.890759Z", "completed_at": "2025-11-10T04:34:11.908282Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.914899Z", "completed_at": "2025-11-10T04:34:11.914909Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03560972213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere order_nk is not null\ngroup by order_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.896016Z", "completed_at": "2025-11-10T04:34:11.908984Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.915697Z", "completed_at": "2025-11-10T04:34:11.915705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026474952697753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.910603Z", "completed_at": "2025-11-10T04:34:11.922005Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.927200Z", "completed_at": "2025-11-10T04:34:11.927209Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021733760833740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.923511Z", "completed_at": "2025-11-10T04:34:11.942207Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.942880Z", "completed_at": "2025-11-10T04:34:11.942891Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024116992950439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.927966Z", "completed_at": "2025-11-10T04:34:11.944358Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.945623Z", "completed_at": "2025-11-10T04:34:11.945638Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026018619537353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.931515Z", "completed_at": "2025-11-10T04:34:11.947120Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.953843Z", "completed_at": "2025-11-10T04:34:11.953853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03334403038024902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_reviews", "compiled": true, "compiled_code": "\n\n-- Fato de reviews p\u00fablicos (produtos Metabase).\nselect\n    review_nk,\n    source_system,\n    source_review_id,\n    product_nk,\n    source_product_id,\n    reviewer_name,\n    rating_score,\n    created_at,\n    review_text,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.937661Z", "completed_at": "2025-11-10T04:34:11.948502Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.955140Z", "completed_at": "2025-11-10T04:34:11.955148Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01883101463317871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.949076Z", "completed_at": "2025-11-10T04:34:11.964195Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.969079Z", "completed_at": "2025-11-10T04:34:11.969090Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024273395538330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere review_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.958467Z", "completed_at": "2025-11-10T04:34:11.975289Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.976929Z", "completed_at": "2025-11-10T04:34:11.976940Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022435426712036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere review_nk is not null\ngroup by review_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.965584Z", "completed_at": "2025-11-10T04:34:11.979947Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.986932Z", "completed_at": "2025-11-10T04:34:11.986943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02912616729736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_employee", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de colaboradores (Northwind) para an\u00e1lises B2B.\nselect\n    row_number() over (order by employee_nk)   as employee_sk,\n    employee_nk,\n    source_system,\n    source_employee_id,\n    first_name,\n    last_name,\n    job_title,\n    courtesy_title,\n    birth_date,\n    hire_date,\n    city,\n    region,\n    country,\n    postal_code,\n    phone,\n    phone_extension,\n    manager_empid,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.970035Z", "completed_at": "2025-11-10T04:34:11.986417Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:11.988450Z", "completed_at": "2025-11-10T04:34:11.988459Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025351524353027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\nwhere employee_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.981403Z", "completed_at": "2025-11-10T04:34:11.997958Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.004466Z", "completed_at": "2025-11-10T04:34:12.004477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026682138442993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\nwhere employee_nk is not null\ngroup by employee_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.990060Z", "completed_at": "2025-11-10T04:34:12.005683Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.012119Z", "completed_at": "2025-11-10T04:34:12.012131Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.031487464904785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_customers", "compiled": true, "compiled_code": "\n\n-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.\nwith northwind as (\n    select\n        source_system,\n        customer_nk,\n        source_customer_id,\n        customer_name,\n        contact_name,\n        contact_title,\n        null::varchar                                as first_name,\n        null::varchar                                as last_name,\n        address,\n        city,\n        region,\n        country,\n        postal_code,\n        null::varchar                                as plan,\n        null::varchar                                as segment,\n        null::int                                    as seats,\n        null::boolean                                as trial_converted,\n        null::boolean                                as active_subscription,\n        null::boolean                                as legacy_plan,\n        current_timestamp                            as created_at,\n        null::timestamp                              as trial_ends_at,\n        null::timestamp                              as canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\n),\nmetabase as (\n    select\n        source_system,\n        customer_nk,\n        source_customer_id,\n        customer_name,\n        null::varchar                                as contact_name,\n        null::varchar                                as contact_title,\n        first_name,\n        last_name,\n        null::varchar                                as address,\n        null::varchar                                as city,\n        null::varchar                                as region,\n        country,\n        null::varchar                                as postal_code,\n        plan,\n        segment,\n        seats,\n        trial_converted,\n        active_subscription,\n        legacy_plan,\n        created_at,\n        trial_ends_at,\n        canceled_at,\n    dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\n),\nmetabase_people as (\n    select\n        source_system,\n        customer_nk,\n        source_customer_id,\n        customer_name,\n        contact_name,\n        contact_title,\n        first_name,\n        last_name,\n        address,\n        city,\n        region,\n        country,\n        postal_code,\n        plan,\n        segment,\n        seats,\n        trial_converted,\n        active_subscription,\n        legacy_plan,\n        created_at,\n        trial_ends_at,\n        canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\n)\nselect * from northwind\nunion all\nselect * from metabase\nunion all\nselect * from metabase_people", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:11.999452Z", "completed_at": "2025-11-10T04:34:12.015151Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.017482Z", "completed_at": "2025-11-10T04:34:12.017495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022219181060791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.006241Z", "completed_at": "2025-11-10T04:34:12.023928Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.025658Z", "completed_at": "2025-11-10T04:34:12.025667Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029593706130981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.018386Z", "completed_at": "2025-11-10T04:34:12.032481Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.034664Z", "completed_at": "2025-11-10T04:34:12.034682Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02132868766784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.026539Z", "completed_at": "2025-11-10T04:34:12.041490Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.047953Z", "completed_at": "2025-11-10T04:34:12.047964Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.031261444091796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.035987Z", "completed_at": "2025-11-10T04:34:12.050401Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.052319Z", "completed_at": "2025-11-10T04:34:12.052349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021462202072143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.042984Z", "completed_at": "2025-11-10T04:34:12.057523Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.059279Z", "completed_at": "2025-11-10T04:34:12.059289Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025587081909179688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_geography", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de geografia consolidando localidades presentes nas diferentes fontes.\nwith unioned as (\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        upper(coalesce(region, 'N/A'))  as region,\n        upper(coalesce(city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\n\n    union\n\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        'N/A'                           as region,\n        'N/A'                           as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\n\n    union\n\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        upper(coalesce(region, 'N/A'))  as region,\n        upper(coalesce(city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\n\n    union\n\n    select distinct\n        upper(coalesce(ship_country, 'N/A')) as country,\n        upper(coalesce(ship_region, 'N/A'))  as region,\n        upper(coalesce(ship_city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\n)\nselect\n    row_number() over (order by country, region, city) as geography_sk,\n    country,\n    region,\n    city\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.053262Z", "completed_at": "2025-11-10T04:34:12.066687Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.073478Z", "completed_at": "2025-11-10T04:34:12.073491Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024732351303100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_sales", "compiled": true, "compiled_code": "\n\n-- Fato de vendas unificada (B2B + B2C) com m\u00e9tricas financeiras padronizadas.\nwith northwind as (\n    select\n        'NORTHWIND'                          as source_system,\n        od.source_order_id,\n        od.order_nk,\n        o.customer_nk,\n        od.product_nk,\n        o.employee_nk,\n        o.shipper_nk,\n        'CHANNEL_NORTHWIND'                  as channel_nk,\n        o.order_date,\n        o.shipped_date,\n        od.quantity,\n        od.unit_price,\n        od.discount_pct,\n        od.gross_amount,\n        od.net_amount,\n        od.dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\" od\n    join \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\" o\n      on od.order_nk = o.order_nk\n),\nmetabase as (\n    select\n        'METABASE'                           as source_system,\n        source_order_id,\n        order_nk,\n        customer_nk,\n        product_nk,\n        null::varchar                        as employee_nk,\n        null::varchar                        as shipper_nk,\n        'CHANNEL_METABASE'                   as channel_nk,\n        order_date,\n        shipped_date,\n        quantity,\n        unit_price,\n        discount_pct,\n        (quantity * unit_price)::numeric(14,4)                         as gross_amount,\n        total_amount                                                   as net_amount,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\n)\nselect * from northwind\nunion all\nselect * from metabase", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.060102Z", "completed_at": "2025-11-10T04:34:12.075452Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.081809Z", "completed_at": "2025-11-10T04:34:12.081819Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030280351638793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.068036Z", "completed_at": "2025-11-10T04:34:12.083980Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.085771Z", "completed_at": "2025-11-10T04:34:12.085781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02139425277709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.076785Z", "completed_at": "2025-11-10T04:34:12.093876Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.099384Z", "completed_at": "2025-11-10T04:34:12.099394Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0321660041809082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere order_nk is not null\ngroup by order_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.086717Z", "completed_at": "2025-11-10T04:34:12.102481Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.108480Z", "completed_at": "2025-11-10T04:34:12.108491Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025950193405151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_product", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de produtos combinando cat\u00e1logo Northwind (B2B) e Metabase (B2C/SaaS).\nwith unioned as (\n    select\n        product_nk,\n        source_system,\n        source_product_id,\n        product_name,\n        category_name,\n        supplier_name,\n        null::varchar                        as vendor_name,\n        package_details,\n        unit_price,\n        units_in_stock,\n        units_on_order,\n        reorder_level,\n        null::numeric(5,2)                   as rating_score,\n        null::timestamp                      as product_created_at,\n        is_discontinued,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\n\n    union all\n\n    select\n        product_nk,\n        source_system,\n        source_product_id,\n        product_name,\n        category_name,\n        null::varchar                        as supplier_name,\n        vendor_name,\n        null::varchar                        as package_details,\n        unit_price,\n        null::integer                        as units_in_stock,\n        null::integer                        as units_on_order,\n        null::integer                        as reorder_level,\n        rating_score,\n        created_at                           as product_created_at,\n        false                                 as is_discontinued,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n)\nselect\n    row_number() over (order by product_nk)    as product_sk,\n    *\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.095104Z", "completed_at": "2025-11-10T04:34:12.109932Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.116346Z", "completed_at": "2025-11-10T04:34:12.116356Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03129267692565918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.103902Z", "completed_at": "2025-11-10T04:34:12.117903Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.119983Z", "completed_at": "2025-11-10T04:34:12.119994Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019854068756103516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.111151Z", "completed_at": "2025-11-10T04:34:12.127429Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.128993Z", "completed_at": "2025-11-10T04:34:12.129002Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02606964111328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\nwhere event_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.122103Z", "completed_at": "2025-11-10T04:34:12.135369Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.140650Z", "completed_at": "2025-11-10T04:34:12.140660Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023520708084106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\nwhere event_nk is not null\ngroup by event_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.130221Z", "completed_at": "2025-11-10T04:34:12.142973Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.148387Z", "completed_at": "2025-11-10T04:34:12.148405Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02744579315185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feedback_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\nwhere feedback_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.136408Z", "completed_at": "2025-11-10T04:34:12.149294Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.150828Z", "completed_at": "2025-11-10T04:34:12.150839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021211624145507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    feedback_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\nwhere feedback_nk is not null\ngroup by feedback_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.143505Z", "completed_at": "2025-11-10T04:34:12.158341Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.160266Z", "completed_at": "2025-11-10T04:34:12.160276Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02451348304748535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.152281Z", "completed_at": "2025-11-10T04:34:12.166132Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.172743Z", "completed_at": "2025-11-10T04:34:12.172754Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02510976791381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere invoice_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.161215Z", "completed_at": "2025-11-10T04:34:12.176488Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.183049Z", "completed_at": "2025-11-10T04:34:12.183070Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026090383529663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoice_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere invoice_nk is not null\ngroup by invoice_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.167595Z", "completed_at": "2025-11-10T04:34:12.182383Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.189701Z", "completed_at": "2025-11-10T04:34:12.189724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03020191192626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.177331Z", "completed_at": "2025-11-10T04:34:12.193070Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.195727Z", "completed_at": "2025-11-10T04:34:12.195742Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02219867706298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere review_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.184527Z", "completed_at": "2025-11-10T04:34:12.197844Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.207470Z", "completed_at": "2025-11-10T04:34:12.207481Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03177165985107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere review_nk is not null\ngroup by review_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.203733Z", "completed_at": "2025-11-10T04:34:12.216665Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.222469Z", "completed_at": "2025-11-10T04:34:12.222480Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027582883834838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.199174Z", "completed_at": "2025-11-10T04:34:12.217219Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.223462Z", "completed_at": "2025-11-10T04:34:12.223471Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029600143432617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.210813Z", "completed_at": "2025-11-10T04:34:12.224403Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.228236Z", "completed_at": "2025-11-10T04:34:12.228257Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020153522491455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_nk is not null\ngroup by employee_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.217822Z", "completed_at": "2025-11-10T04:34:12.231111Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.233315Z", "completed_at": "2025-11-10T04:34:12.233332Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023322582244873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_sk is not null\ngroup by employee_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.234602Z", "completed_at": "2025-11-10T04:34:12.237657Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.244153Z", "completed_at": "2025-11-10T04:34:12.244162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014477252960205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.customers_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    customer_nk,\n    source_system,\n    source_customer_id,\n    customer_name,\n    contact_name,\n    contact_title,\n    first_name,\n    last_name,\n    address,\n    city,\n    region,\n    country,\n    postal_code,\n    plan,\n    segment,\n    seats,\n    trial_converted,\n    active_subscription,\n    legacy_plan,\n    created_at,\n    trial_ends_at,\n    canceled_at,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"customers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.238172Z", "completed_at": "2025-11-10T04:34:12.251472Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.256838Z", "completed_at": "2025-11-10T04:34:12.256848Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026556015014648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.245747Z", "completed_at": "2025-11-10T04:34:12.264725Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.265882Z", "completed_at": "2025-11-10T04:34:12.265893Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03188514709472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.252643Z", "completed_at": "2025-11-10T04:34:12.267419Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.273202Z", "completed_at": "2025-11-10T04:34:12.273213Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02824091911315918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_system\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere source_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.259858Z", "completed_at": "2025-11-10T04:34:12.274643Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.276432Z", "completed_at": "2025-11-10T04:34:12.276443Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024559974670410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.268810Z", "completed_at": "2025-11-10T04:34:12.283120Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.284772Z", "completed_at": "2025-11-10T04:34:12.284782Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019699811935424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geography_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"\nwhere geography_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.277767Z", "completed_at": "2025-11-10T04:34:12.291161Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.296266Z", "completed_at": "2025-11-10T04:34:12.296276Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022272348403930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    geography_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"\nwhere geography_sk is not null\ngroup by geography_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.285641Z", "completed_at": "2025-11-10T04:34:12.298349Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.303563Z", "completed_at": "2025-11-10T04:34:12.303573Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02646780014038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere channel_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.291792Z", "completed_at": "2025-11-10T04:34:12.304767Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.306300Z", "completed_at": "2025-11-10T04:34:12.306312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02229142189025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.298898Z", "completed_at": "2025-11-10T04:34:12.312409Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.314101Z", "completed_at": "2025-11-10T04:34:12.314111Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018558263778686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.307267Z", "completed_at": "2025-11-10T04:34:12.324891Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.326420Z", "completed_at": "2025-11-10T04:34:12.326430Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02345442771911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.314905Z", "completed_at": "2025-11-10T04:34:12.332413Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.334101Z", "completed_at": "2025-11-10T04:34:12.334114Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02303314208984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where channel_nk is not null\n),\n\nparent as (\n    select channel_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.327167Z", "completed_at": "2025-11-10T04:34:12.341603Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.343016Z", "completed_at": "2025-11-10T04:34:12.343024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02954578399658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.334990Z", "completed_at": "2025-11-10T04:34:12.350863Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.352417Z", "completed_at": "2025-11-10T04:34:12.352427Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021277904510498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.343772Z", "completed_at": "2025-11-10T04:34:12.359500Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.364718Z", "completed_at": "2025-11-10T04:34:12.364727Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03146791458129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\n    where product_nk is not null\n),\n\nparent as (\n    select product_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.353203Z", "completed_at": "2025-11-10T04:34:12.367110Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.373799Z", "completed_at": "2025-11-10T04:34:12.373808Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024182558059692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where product_nk is not null\n),\n\nparent as (\n    select product_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.360051Z", "completed_at": "2025-11-10T04:34:12.372618Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.374627Z", "completed_at": "2025-11-10T04:34:12.374635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022818803787231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.367571Z", "completed_at": "2025-11-10T04:34:12.376077Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.379690Z", "completed_at": "2025-11-10T04:34:12.379701Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015566825866699219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_sk is not null\ngroup by product_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.376578Z", "completed_at": "2025-11-10T04:34:12.381040Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.381607Z", "completed_at": "2025-11-10T04:34:12.381614Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008446455001831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_customer", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.\nwith latest as (\n    select\n        *\n    from \"dw_northwind_metabase\".\"snapshots\".\"customers_snapshot\"\n    where dbt_valid_to is null\n)\nselect\n    row_number() over (order by customer_nk)       as customer_sk,\n    customer_nk,\n    source_system,\n    source_customer_id,\n    customer_name,\n    contact_name,\n    contact_title,\n    first_name,\n    last_name,\n    address,\n    city,\n    region,\n    country,\n    postal_code,\n    plan,\n    segment,\n    seats,\n    trial_converted,\n    active_subscription,\n    legacy_plan,\n    created_at,\n    trial_ends_at,\n    canceled_at,\n    dbt_valid_from,\n    dbt_valid_to,\n    case when dbt_valid_to is null then true else false end as current_flag\nfrom latest", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.392015Z", "completed_at": "2025-11-10T04:34:12.407247Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.409282Z", "completed_at": "2025-11-10T04:34:12.409293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023977041244506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_saas", "compiled": true, "compiled_code": "\n\n-- Data mart para faturamento SaaS (Metabase invoices) com enriquecimento de cliente e calend\u00e1rio.\nwith invoices as (\n    select\n        fi.invoice_nk,\n        fi.customer_nk,\n        fi.plan_name,\n        fi.payment_amount,\n        fi.expected_invoice_flag,\n        fi.date_received::date as invoice_date,\n        dc.customer_name,\n        dc.segment,\n        dc.plan,\n        dd.year,\n        dd.month,\n        dd.month_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\" fi\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fi.customer_nk = dc.customer_nk\n          and dc.current_flag\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\" dd\n           on fi.date_received::date = dd.date_day\n)\nselect *\nfrom invoices", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_saas\".\"dm_saas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.388531Z", "completed_at": "2025-11-10T04:34:12.408038Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.410182Z", "completed_at": "2025-11-10T04:34:12.410193Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025394439697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_sales", "compiled": true, "compiled_code": "\n\n-- Data mart consolidado de vendas usando a fato unificada.\nselect\n    fs.*,\n    dc.customer_name,\n    dp.product_name,\n    dp.category_name,\n    dp.vendor_name\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\" fs\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n       on fs.customer_nk = dc.customer_nk\n      and dc.current_flag\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n       on fs.product_nk = dp.product_nk", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.401536Z", "completed_at": "2025-11-10T04:34:12.408639Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.411434Z", "completed_at": "2025-11-10T04:34:12.411444Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025161027908325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_product_analytics", "compiled": true, "compiled_code": "\n\n-- Mart que combina eventos de uso, reviews e feedbacks para an\u00e1lises 360\u00ba do produto.\nwith events as (\n    select\n        'ANALYTIC_EVENT'                              as record_type,\n        fa.event_nk                                   as record_nk,\n        fa.customer_nk,\n        null::varchar                                 as product_nk,\n        fa.event_name                                 as metric_name,\n        1::numeric                                    as metric_value,\n        fa.event_timestamp                            as metric_timestamp,\n        fa.page_url                                   as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar                                 as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\" fa\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fa.customer_nk = dc.customer_nk\n          and dc.current_flag\n),\nreviews as (\n    select\n        'REVIEW'                                      as record_type,\n        fr.review_nk                                  as record_nk,\n        null::varchar                                 as customer_nk,\n        fr.product_nk,\n        'rating_score'                                as metric_name,\n        fr.rating_score                               as metric_value,\n        fr.created_at                                 as metric_timestamp,\n        fr.review_text                                as context_info,\n        null::varchar                                 as customer_name,\n        null::varchar                                 as segment,\n        dp.product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\" fr\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n           on fr.product_nk = dp.product_nk\n),\nfeedback as (\n    select\n        'FEEDBACK'                                    as record_type,\n        ff.feedback_nk                                as record_nk,\n        ff.customer_nk,\n        null::varchar                                 as product_nk,\n        'rating_score'                                as metric_name,\n        ff.rating_score                               as metric_value,\n        ff.date_received                              as metric_timestamp,\n        ff.feedback_text                              as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar                                 as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\" ff\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on ff.customer_nk = dc.customer_nk\n          and dc.current_flag\n)\nselect * from events\nunion all\nselect * from reviews\nunion all\nselect * from feedback", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_product_analytics\".\"dm_product_analytics\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.395569Z", "completed_at": "2025-11-10T04:34:12.410986Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.413332Z", "completed_at": "2025-11-10T04:34:12.413339Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02747058868408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.435469Z", "completed_at": "2025-11-10T04:34:12.439394Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.440568Z", "completed_at": "2025-11-10T04:34:12.440581Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022028684616088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2b", "compiled": true, "compiled_code": "\n\n-- Data mart focado no fluxo Northwind (B2B).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'NORTHWIND'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2b\".\"dm_b2b\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.424760Z", "completed_at": "2025-11-10T04:34:12.440008Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.441884Z", "completed_at": "2025-11-10T04:34:12.441896Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026996135711669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.419751Z", "completed_at": "2025-11-10T04:34:12.443393Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.445010Z", "completed_at": "2025-11-10T04:34:12.445030Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030244827270507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.430307Z", "completed_at": "2025-11-10T04:34:12.444420Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.446297Z", "completed_at": "2025-11-10T04:34:12.446305Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029211997985839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T04:34:12.447673Z", "completed_at": "2025-11-10T04:34:12.451431Z"}, {"name": "execute", "started_at": "2025-11-10T04:34:12.451994Z", "completed_at": "2025-11-10T04:34:12.452001Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0063283443450927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2c", "compiled": true, "compiled_code": "\n\n-- Data mart focado nas vendas Metabase (B2C/SaaS).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'METABASE'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2c\".\"dm_b2c\"", "batch_results": null}], "elapsed_time": 1.5658564567565918, "args": {"warn_error_options": {"error": [], "warn": [], "silence": []}, "compile": true, "favor_state": false, "require_all_warnings_handled_by_warn_error": false, "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "upload_to_artifacts_ingest_api": false, "which": "generate", "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "exclude": [], "send_anonymous_usage_stats": true, "defer": false, "use_colors": true, "log_level_file": "debug", "log_file_max_bytes": 10485760, "log_path": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs", "static_parser": true, "use_fast_test_edges": false, "require_generic_test_arguments_property": true, "show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "indirect_selection": "eager", "project_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "require_batched_execution_for_custom_microbatch_strategy": false, "profiles_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "vars": {}, "quiet": false, "show_resource_report": false, "populate_cache": true, "macro_debugging": false, "require_resource_names_without_spaces": true, "write_json": true, "require_nested_cumulative_type_params": false, "introspect": true, "invocation_command": "dbt docs generate", "empty_catalog": false, "cache_selected_only": false, "select": [], "static": false, "source_freshness_run_project_hooks": true, "state_modified_compare_more_unrendered_values": false, "use_colors_file": true, "validate_macro_args": false, "printer_width": 80, "partial_parse_file_diff": true, "log_format": "default", "log_level": "info", "print": true, "version_check": true, "log_format_file": "debug", "partial_parse": true}}