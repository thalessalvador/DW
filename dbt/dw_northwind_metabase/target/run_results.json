{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-20T21:51:13.667525Z", "invocation_id": "1f94586a-cebc-45ab-a764-44cc4b984eec", "invocation_started_at": "2025-11-20T21:51:11.047104Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.806082Z", "completed_at": "2025-11-20T21:51:12.821539Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.822008Z", "completed_at": "2025-11-20T21:51:12.822029Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019475698471069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_analytic_events", "compiled": true, "compiled_code": "\n\n-- Eventos de analytics (produto/app) para an\u00e1lises de comportamento.\nselect\n    'METABASE'                               as source_system,\n    ae.id                                    as source_event_id,\n    'METABASE_EVT_' || ae.id                 as event_nk,\n    case\n        when acc.id is not null then 'METABASE_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    ae.account_id                            as source_account_id,\n    ae.event                                 as event_name,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when ae.\"timestamp\" ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then ae.\"timestamp\"::timestamp\n        else null\n    end                                      as event_timestamp,\n    ae.page_url                              as page_url,\n    ae.button_label                          as button_label,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"analyticevents\" ae\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(ae.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.813405Z", "completed_at": "2025-11-20T21:51:12.823317Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.824908Z", "completed_at": "2025-11-20T21:51:12.824919Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021836519241333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_accounts", "compiled": true, "compiled_code": "\n\n-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.\nselect\n    'METABASE'                             as source_system,\n    a.id                                   as source_customer_id,\n    'METABASE_' || a.id                    as customer_nk,\n    a.email                                as customer_name,\n    a.first_name                           as first_name,\n    a.last_name                            as last_name,\n    upper(coalesce(a.country, 'N/A'))      as country,\n    a.plan                                 as plan,\n    a.source                               as segment,\n    cast(a.seats as integer)               as seats,\n    a.trial_converted                      as trial_converted,\n    a.active_subscription                  as active_subscription,\n    a.legacy_plan                          as legacy_plan,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when a.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then a.created_at::timestamp\n        else null\n    end                                   as created_at,\n    case\n        when a.trial_ends_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then a.trial_ends_at::timestamp\n        else null\n    end                                   as trial_ends_at,\n    case\n        when a.canceled_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then a.canceled_at::timestamp\n        else null\n    end                                   as canceled_at,\n    current_timestamp                      as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"accounts\" a", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.816442Z", "completed_at": "2025-11-20T21:51:12.823804Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.825645Z", "completed_at": "2025-11-20T21:51:12.825658Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022110700607299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_channel", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de canais/fonte (B2B x B2C/SaaS).\nselect\n    row_number() over (order by channel_nk) as channel_sk,\n    channel_nk,\n    channel_name,\n    business_model\nfrom (\n    values\n        ('CHANNEL_NORTHWIND', 'Northwind ERP', 'B2B'),\n        ('CHANNEL_METABASE', 'Metabase Sample', 'B2C/SaaS')\n) as channels(channel_nk, channel_name, business_model)", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.818606Z", "completed_at": "2025-11-20T21:51:12.826515Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.828233Z", "completed_at": "2025-11-20T21:51:12.828240Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024221420288085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_date", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de datas gerada via s\u00e9rie cont\u00ednua (apoia an\u00e1lises hist\u00f3ricas).\nwith calendar as (\n    select\n        day::date as date_day\n    from generate_series('1990-01-01'::date, '2035-12-31'::date, interval '1 day') as gs(day)\n)\nselect\n    row_number() over (order by date_day)         as date_sk,\n    date_day,\n    extract(year from date_day)::int              as year,\n    extract(quarter from date_day)::int           as quarter,\n    extract(month from date_day)::int             as month,\n    to_char(date_day, 'TMMonth')                  as month_name,\n    extract(day from date_day)::int               as day_of_month,\n    to_char(date_day, 'IW')::int                  as iso_week,\n    extract(dow from date_day)::int               as day_of_week,\n    to_char(date_day, 'Dy')                       as day_name,\n    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend\nfrom calendar", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.829372Z", "completed_at": "2025-11-20T21:51:12.843144Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.844094Z", "completed_at": "2025-11-20T21:51:12.844102Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019928455352783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_feedback", "compiled": true, "compiled_code": "\n\n-- Feedbacks recebidos via canais de suporte Metabase.\nselect\n    'METABASE'                               as source_system,\n    f.id                                     as source_feedback_id,\n    'METABASE_FB_' || f.id                   as feedback_nk,\n    -- Associa\u00e7\u00e3o com cliente/conta via chave natural.\n    case\n        when acc.id is not null then 'METABASE_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    f.account_id                             as source_account_id,\n    f.email                                  as contact_email,\n    cast(f.rating as numeric(5,2))           as rating_score,\n    f.rating_mapped                          as rating_label,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when f.date_received ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then f.date_received::timestamp\n        else null\n    end                                      as date_received,\n    f.body                                   as feedback_text,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"feedback\" f\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(f.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.834930Z", "completed_at": "2025-11-20T21:51:12.848760Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.849660Z", "completed_at": "2025-11-20T21:51:12.849668Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017416954040527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_invoices", "compiled": true, "compiled_code": "\n\n-- Faturas SaaS (Metabase) com valores normalizados e v\u00ednculo ao cliente.\nselect\n    'METABASE'                               as source_system,\n    i.id                                     as source_invoice_id,\n    'METABASE_' || i.id                      as invoice_nk,\n    -- Associa\u00e7\u00e3o com cliente/conta via chave natural.\n    case\n        when acc.id is not null then 'METABASE_' || acc.id::varchar\n        else null\n    end                                      as customer_nk,\n    i.account_id                             as source_account_id,\n    i.plan                                   as plan_name,\n    cast(i.payment as numeric(12,4))         as payment_amount,\n    i.expected_invoice                       as expected_invoice_flag,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when i.date_received ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then i.date_received::timestamp\n        else null\n    end                                      as date_received,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"invoices\" i\nleft join \"dw_northwind_metabase\".\"public\".\"accounts\" acc\n       on lower(acc.email) = lower(i.account_id)", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.837806Z", "completed_at": "2025-11-20T21:51:12.853674Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.855153Z", "completed_at": "2025-11-20T21:51:12.855160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02249002456665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_orders", "compiled": true, "compiled_code": "\n-- Pedidos/eventos comerciais da base Metabase Sample.\nwith account_name_map as (\n    select\n        lower(concat_ws(' ', first_name, last_name)) as full_name_key,\n        min(id)                                      as account_id\n    from \"dw_northwind_metabase\".\"public\".\"accounts\"\n    where first_name is not null and last_name is not null\n    group by 1\n),\n-- Mapeamento de nomes completos para IDs na tabela people (quando n\u00e3o h\u00e1 conta vinculada).\npeople_name_map as (\n    select\n        lower(name) as full_name_key,\n        min(id)     as person_id\n    from \"dw_northwind_metabase\".\"public\".\"people\"\n    where name is not null\n    group by 1\n),\n-- Mapeamento de t\u00edtulos de produtos para IDs na tabela products.\nproduct_map as (\n    select\n        lower(title) as title_key,\n        min(id)      as product_id,\n        min('METABASE_' || id) as product_nk,\n        min('METABASE_SUP_' || lower(replace(coalesce(vendor,'UNKNOWN'),' ','_'))) as supplier_nk,\n        min('METABASE_CAT_' || lower(replace(coalesce(category,'UNKNOWN'),' ','_'))) as category_nk\n    from \"dw_northwind_metabase\".\"public\".\"products\"\n    group by 1\n)\n-- Pedidos/eventos comerciais da base Metabase Sample.\nselect\n    'METABASE'                               as source_system,\n    o.id                                     as source_order_id,\n    'METABASE_' || o.id                      as order_nk,\n    case\n        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar\n        when people_map.person_id is not null then 'METABASE_PERSON_' || people_map.person_id::varchar\n        else 'METABASE_ORPHAN_' || upper(trim(o.user_id))\n    end                                       as customer_nk,\n    coalesce(prod_map.product_nk, 'METABASE_' || upper(trim(o.product_id))) as product_nk,\n    coalesce(prod_map.supplier_nk, 'METABASE_SUP_UNKNOWN')                  as supplier_nk,\n    coalesce(prod_map.category_nk, 'METABASE_CAT_UNKNOWN')                  as category_nk,\n    null::varchar                            as order_state,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when o.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then o.created_at::timestamp\n        else null\n    end                                     as order_date,\n    cast(null as timestamp)                  as shipped_date,\n    cast(o.quantity as numeric(12,4))        as quantity,\n    (\n        case\n            when o.quantity is not null and o.quantity <> 0\n                then (o.subtotal / o.quantity)\n            else null\n        end\n    )::numeric(12,4)                         as unit_price,\n    cast(o.discount____ as numeric(12,4))    as discount_pct,\n    cast(o.total as numeric(14,4))           as total_amount,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"orders\" o\nleft join account_name_map acc_map\n       on lower(o.user_id) = acc_map.full_name_key\nleft join people_name_map people_map\n       on acc_map.account_id is null\n      and lower(o.user_id) = people_map.full_name_key\nleft join product_map prod_map\n       on lower(o.product_id) = prod_map.title_key", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.844779Z", "completed_at": "2025-11-20T21:51:12.854153Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.855923Z", "completed_at": "2025-11-20T21:51:12.855930Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021493911743164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_people", "compiled": true, "compiled_code": "\n\n-- Registros da tabela people (usados pelos pedidos B2C que n\u00e3o mapeiam para accounts).\nselect\n    'METABASE'                               as source_system,\n    p.id                                     as source_customer_id,\n    'METABASE_PERSON_' || p.id               as customer_nk,\n    p.name                                   as customer_name,\n    null::varchar                            as contact_name,\n    null::varchar                            as contact_title,\n    split_part(p.name, ' ', 1)               as first_name,\n    nullif(split_part(p.name, ' ', 2), '')   as last_name,\n    p.address                                as address,\n    p.city                                   as city,\n    p.state                                  as region,\n    null::varchar                            as country,\n    p.zip::varchar                           as postal_code,\n    null::varchar                            as plan,\n    p.source                                 as segment,\n    null::int                                as seats,\n    null::boolean                            as trial_converted,\n    null::boolean                            as active_subscription,\n    null::boolean                            as legacy_plan,\n    null::timestamp                          as created_at,\n    null::timestamp                          as trial_ends_at,\n    null::timestamp                          as canceled_at,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"people\" p", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.850409Z", "completed_at": "2025-11-20T21:51:12.857614Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.862528Z", "completed_at": "2025-11-20T21:51:12.862535Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014387369155883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_products", "compiled": true, "compiled_code": "\n\n-- Cat\u00e1logo de produtos Metabase Sample (B2C/SaaS) com atributos de pre\u00e7o e rating.\nselect\n    'METABASE'                               as source_system,\n    p.id                                     as source_product_id,\n    'METABASE_' || p.id                      as product_nk,\n    'METABASE_SUP_' || lower(replace(coalesce(p.vendor,'UNKNOWN'),' ','_')) as supplier_nk,\n    'METABASE_CAT_' || lower(replace(coalesce(p.category,'UNKNOWN'),' ','_')) as category_nk,\n    p.title                                  as product_name,\n    p.category                               as category_name,\n    p.vendor                                 as vendor_name,\n    cast(p.price as numeric(12,4))           as unit_price,\n    cast(p.rating as numeric(5,2))           as rating_score,\n    case\n        when p.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then p.created_at::timestamp\n        else null\n    end                                     as created_at,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"products\" p", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.858557Z", "completed_at": "2025-11-20T21:51:12.870505Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.871419Z", "completed_at": "2025-11-20T21:51:12.871426Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016850709915161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_metabase_reviews", "compiled": true, "compiled_code": "\n\nwith product_map as (\n    select\n        lower(title) as title_key,\n        min(id)      as product_id\n    from \"dw_northwind_metabase\".\"public\".\"products\"\n    group by 1\n)\n-- Reviews p\u00fablicos dos produtos Metabase Sample.\nselect\n    'METABASE'                               as source_system,\n    r._mb_row_id                             as source_review_id,\n    'METABASE_RV_' || r._mb_row_id           as review_nk,\n    -- Associa\u00e7\u00e3o com produto via chave natural.\n    case\n        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar\n        else 'METABASE_' || upper(trim(r.product_id))\n    end                                      as product_nk,\n    r.product_id                             as source_product_id,\n    r.reviewer                               as reviewer_name,\n    cast(r.rating as numeric(5,2))           as rating_score,\n    -- Tratamento de datas inv\u00e1lidas na fonte Metabase (Ex: '0000-00-00'). Se n\u00e3o retornar uma data v\u00e1lida, atribui NULL.\n    case\n        when r.created_at ~ '^\\d{4}-\\d{2}-\\d{2}'\n            then r.created_at::timestamp\n        else null\n    end                                      as created_at,\n    r.body                                   as review_text,\n    current_timestamp                        as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"reviews\" r\nleft join product_map prod_map\n       on lower(r.product_id) = prod_map.title_key", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.864878Z", "completed_at": "2025-11-20T21:51:12.875783Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.877253Z", "completed_at": "2025-11-20T21:51:12.877262Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015230178833007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_categories", "compiled": true, "compiled_code": "\n\n-- Categorias Northwind com NK padronizada.\nselect\n    'NORTHWIND'                               as source_system,\n    c.categoryid                              as source_category_id,\n    'NORTHWIND_CAT_' || c.categoryid          as category_nk,\n    c.categoryname                            as category_name,\n    c.description                             as category_description,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"category\" c", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.867863Z", "completed_at": "2025-11-20T21:51:12.876358Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.877941Z", "completed_at": "2025-11-20T21:51:12.877947Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014882087707519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_customers", "compiled": true, "compiled_code": "\n\n-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).\nselect\n    'NORTHWIND'                               as source_system,\n    custid                                    as source_customer_id,\n    'NORTHWIND_' || custid                    as customer_nk,\n    companyname                               as customer_name,\n    contactname                               as contact_name,\n    contacttitle                              as contact_title,\n    address                                   as address,\n    city                                      as city,\n    coalesce(nullif(region, ''), 'N/A')       as region,\n    country                                   as country,\n    postalcode                                as postal_code,\n    phone                                     as phone,\n    fax                                       as fax,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"customer\"", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.872179Z", "completed_at": "2025-11-20T21:51:12.878931Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.883514Z", "completed_at": "2025-11-20T21:51:12.883521Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016187191009521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_employees", "compiled": true, "compiled_code": "\n\n-- Colaboradores Northwind com atributos de localiza\u00e7\u00e3o e datas chave.\nselect\n    'NORTHWIND'                                   as source_system,\n    e.empid                                       as source_employee_id,\n    'NORTHWIND_' || e.empid                       as employee_nk,\n    e.firstname                                   as first_name,\n    e.lastname                                    as last_name,\n    e.title                                       as job_title,\n    e.titleofcourtesy                             as courtesy_title,\n    cast(e.birthdate as date)                     as birth_date,\n    cast(e.hiredate as date)                      as hire_date,\n    e.city                                        as city,\n    coalesce(nullif(e.region, ''), 'N/A')         as region,\n    e.country                                     as country,\n    e.postalcode                                  as postal_code,\n    e.phone                                       as phone,\n    e.extension                                   as phone_extension,\n    e.mgrid                                       as manager_empid,\n    current_timestamp                             as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"employee\" e", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.880386Z", "completed_at": "2025-11-20T21:51:12.893468Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.896599Z", "completed_at": "2025-11-20T21:51:12.896608Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019917964935302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_order_details", "compiled": true, "compiled_code": "\n\n-- Itens de pedido Northwind com m\u00e9tricas preparadas para a fato de vendas.\nselect\n    'NORTHWIND'                                      as source_system,\n    od.orderid                                       as source_order_id,\n    'NORTHWIND_' || od.orderid                       as order_nk,\n    'NORTHWIND_' || od.productid                     as product_nk,\n    'NORTHWIND_SUP_' || p.supplierid                 as supplier_nk,\n    'NORTHWIND_CAT_' || p.categoryid                 as category_nk,\n    cast(od.qty as numeric(12,4))                    as quantity,\n    cast(od.unitprice as numeric(12,4))              as unit_price,\n    cast(od.discount as numeric(5,4))                as discount_pct,\n    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,\n    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,\n    current_timestamp                                as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"orderdetail\" od\njoin \"dw_northwind_metabase\".\"public\".\"product\" p\n  on od.productid = p.productid", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.886823Z", "completed_at": "2025-11-20T21:51:12.898517Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.899529Z", "completed_at": "2025-11-20T21:51:12.899536Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015466451644897461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_orders", "compiled": true, "compiled_code": "\n\n-- Normaliza os pedidos (cabe\u00e7alho) da Northwind gerando NKs padronizadas.\nselect\n    'NORTHWIND'                                 as source_system,\n    o.orderid                                   as source_order_id,\n    'NORTHWIND_' || o.orderid                   as order_nk,\n    'NORTHWIND_' || o.custid                    as customer_nk,\n    'NORTHWIND_' || o.empid                     as employee_nk,\n    'NORTHWIND_' || o.shipperid                 as shipper_nk,\n    cast(o.orderdate as date)                   as order_date,\n    cast(o.requireddate as date)                as required_date,\n    cast(o.shippeddate as date)                 as shipped_date,\n    cast(o.freight as numeric(12,2))            as freight_amount,\n    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,\n    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,\n    o.shipcity                                  as ship_city,\n    current_timestamp                           as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"salesorder\" o", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.894022Z", "completed_at": "2025-11-20T21:51:12.900179Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.908479Z", "completed_at": "2025-11-20T21:51:12.908491Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022188901901245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_suppliers", "compiled": true, "compiled_code": "\n\n-- Fornecedores Northwind com NK padronizada.\nselect\n    'NORTHWIND'                               as source_system,\n    s.supplierid                              as source_supplier_id,\n    'NORTHWIND_SUP_' || s.supplierid          as supplier_nk,\n    s.companyname                             as supplier_name,\n    s.contactname                             as contact_name,\n    s.contacttitle                            as contact_title,\n    s.city                                    as city,\n    coalesce(nullif(s.region, ''), 'N/A')     as region,\n    s.country                                 as country,\n    s.phone                                   as phone,\n    current_timestamp                         as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"supplier\" s", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.890091Z", "completed_at": "2025-11-20T21:51:12.904381Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.909398Z", "completed_at": "2025-11-20T21:51:12.909405Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024909257888793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.stg_northwind_products", "compiled": true, "compiled_code": "\n\n-- Cat\u00e1logo Northwind com categoria, fornecedor e indicadores de estoque.\nselect\n    'NORTHWIND'                                   as source_system,\n    p.productid                                   as source_product_id,\n    'NORTHWIND_' || p.productid                   as product_nk,\n    'NORTHWIND_SUP_' || p.supplierid              as supplier_nk,\n    'NORTHWIND_CAT_' || p.categoryid              as category_nk,\n    p.productname                                 as product_name,\n    c.categoryname                                as category_name,\n    s.companyname                                 as supplier_name,\n    p.quantityperunit                             as package_details,\n    cast(p.unitprice as numeric(12,4))            as unit_price,\n    p.unitsinstock                                as units_in_stock,\n    p.unitsonorder                                as units_on_order,\n    p.reorderlevel                                as reorder_level,\n    p.discontinued = '1'                          as is_discontinued,\n    null::numeric(5,2)                            as rating_score,\n    null::timestamp                               as product_created_at,\n    current_timestamp                             as dw_load_ts\nfrom \"dw_northwind_metabase\".\"public\".\"product\" p\nleft join \"dw_northwind_metabase\".\"public\".\"category\" c\n       on p.categoryid = c.categoryid\nleft join \"dw_northwind_metabase\".\"public\".\"supplier\" s\n       on p.supplierid = s.supplierid", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.900560Z", "completed_at": "2025-11-20T21:51:12.911940Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.923671Z", "completed_at": "2025-11-20T21:51:12.923680Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02584362030029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_analytic_events", "compiled": true, "compiled_code": "\n\n-- Fato de eventos de produto / analytics.\nselect\n    event_nk,\n    source_system,\n    source_event_id,\n    customer_nk,\n    source_account_id,\n    event_name,\n    event_timestamp,\n    page_url,\n    button_label,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.913238Z", "completed_at": "2025-11-20T21:51:12.935814Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.936642Z", "completed_at": "2025-11-20T21:51:12.936650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02662944793701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\nwhere event_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.931502Z", "completed_at": "2025-11-20T21:51:12.941191Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.942508Z", "completed_at": "2025-11-20T21:51:12.942516Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029764890670776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.925797Z", "completed_at": "2025-11-20T21:51:12.941575Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.943168Z", "completed_at": "2025-11-20T21:51:12.943174Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030939817428588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_analytic_events\"\nwhere event_nk is not null\ngroup by event_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.937330Z", "completed_at": "2025-11-20T21:51:12.944650Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.951559Z", "completed_at": "2025-11-20T21:51:12.951567Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016685962677001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.945414Z", "completed_at": "2025-11-20T21:51:12.961269Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.962307Z", "completed_at": "2025-11-20T21:51:12.962316Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020426034927368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.954021Z", "completed_at": "2025-11-20T21:51:12.967304Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.968907Z", "completed_at": "2025-11-20T21:51:12.968915Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017916440963745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.957785Z", "completed_at": "2025-11-20T21:51:12.968367Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.970110Z", "completed_at": "2025-11-20T21:51:12.970116Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017975807189941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_nk is not null\ngroup by channel_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.963073Z", "completed_at": "2025-11-20T21:51:12.970766Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.975460Z", "completed_at": "2025-11-20T21:51:12.975467Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01822209358215332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\nwhere channel_sk is not null\ngroup by channel_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.971554Z", "completed_at": "2025-11-20T21:51:12.982971Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.987219Z", "completed_at": "2025-11-20T21:51:12.987227Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01953411102294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.978627Z", "completed_at": "2025-11-20T21:51:12.992804Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.995944Z", "completed_at": "2025-11-20T21:51:12.995953Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019971370697021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.983397Z", "completed_at": "2025-11-20T21:51:12.996623Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.997963Z", "completed_at": "2025-11-20T21:51:12.997970Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02145838737487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.987956Z", "completed_at": "2025-11-20T21:51:12.997543Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:12.999122Z", "completed_at": "2025-11-20T21:51:12.999129Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021007299423217773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\"\nwhere date_sk is not null\ngroup by date_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:12.993191Z", "completed_at": "2025-11-20T21:51:13.000300Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.001931Z", "completed_at": "2025-11-20T21:51:13.001938Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010039806365966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_feedback", "compiled": true, "compiled_code": "\n\n-- Fato de feedback (NPS / avalia\u00e7\u00f5es de suporte).\nselect\n    feedback_nk,\n    source_system,\n    source_feedback_id,\n    customer_nk,\n    source_account_id,\n    contact_email,\n    rating_score,\n    rating_label,\n    date_received,\n    feedback_text,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.002588Z", "completed_at": "2025-11-20T21:51:13.015162Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.019193Z", "completed_at": "2025-11-20T21:51:13.019201Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02063131332397461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feedback_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\nwhere feedback_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.012127Z", "completed_at": "2025-11-20T21:51:13.021087Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.022201Z", "completed_at": "2025-11-20T21:51:13.022208Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016481637954711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_invoices", "compiled": true, "compiled_code": "\n\n-- Fato de faturamento SaaS (faturas Metabase).\nselect\n    invoice_nk,\n    source_system,\n    source_invoice_id,\n    customer_nk,\n    source_account_id,\n    plan_name,\n    payment_amount,\n    expected_invoice_flag,\n    date_received,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.007751Z", "completed_at": "2025-11-20T21:51:13.021451Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.022862Z", "completed_at": "2025-11-20T21:51:13.022868Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021488189697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    feedback_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_feedback\"\nwhere feedback_nk is not null\ngroup by feedback_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.015672Z", "completed_at": "2025-11-20T21:51:13.027412Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.028837Z", "completed_at": "2025-11-20T21:51:13.028844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0173799991607666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.024066Z", "completed_at": "2025-11-20T21:51:13.031930Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.039418Z", "completed_at": "2025-11-20T21:51:13.039426Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01891016960144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere invoice_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.032282Z", "completed_at": "2025-11-20T21:51:13.044866Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.045686Z", "completed_at": "2025-11-20T21:51:13.045693Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016303300857543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoice_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_invoices\"\nwhere invoice_nk is not null\ngroup by invoice_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.040325Z", "completed_at": "2025-11-20T21:51:13.050106Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.051407Z", "completed_at": "2025-11-20T21:51:13.051415Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019994735717773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.035524Z", "completed_at": "2025-11-20T21:51:13.050547Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.052091Z", "completed_at": "2025-11-20T21:51:13.052097Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02229785919189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.046371Z", "completed_at": "2025-11-20T21:51:13.059079Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.060544Z", "completed_at": "2025-11-20T21:51:13.060552Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016203880310058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\nwhere order_nk is not null\ngroup by order_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.054183Z", "completed_at": "2025-11-20T21:51:13.068988Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.069962Z", "completed_at": "2025-11-20T21:51:13.069970Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01911306381225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.061197Z", "completed_at": "2025-11-20T21:51:13.071504Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.075927Z", "completed_at": "2025-11-20T21:51:13.075936Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01782536506652832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.064624Z", "completed_at": "2025-11-20T21:51:13.076591Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.077990Z", "completed_at": "2025-11-20T21:51:13.077997Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01942586898803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.072046Z", "completed_at": "2025-11-20T21:51:13.086919Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.088525Z", "completed_at": "2025-11-20T21:51:13.088538Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019217967987060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.078655Z", "completed_at": "2025-11-20T21:51:13.088091Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.092925Z", "completed_at": "2025-11-20T21:51:13.092933Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017565488815307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_reviews", "compiled": true, "compiled_code": "\n\n-- Fato de reviews p\u00fablicos (produtos Metabase).\nselect\n    review_nk,\n    source_system,\n    source_review_id,\n    product_nk,\n    source_product_id,\n    reviewer_name,\n    rating_score,\n    created_at,\n    review_text,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.083111Z", "completed_at": "2025-11-20T21:51:13.095577Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.096806Z", "completed_at": "2025-11-20T21:51:13.096814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0157620906829834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.089351Z", "completed_at": "2025-11-20T21:51:13.097558Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.102702Z", "completed_at": "2025-11-20T21:51:13.102710Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020180225372314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere review_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.103424Z", "completed_at": "2025-11-20T21:51:13.111979Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.116498Z", "completed_at": "2025-11-20T21:51:13.116512Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0206453800201416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_category", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de categorias (SCD1 simples).\nwith unioned as (\n    select distinct\n        category_nk,\n        category_name,\n        category_description\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"\n\n    union\n\n    select distinct\n        category_nk,\n        coalesce(category_name, 'UNKNOWN') as category_name,\n        null::varchar as category_description\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n)\nselect\n    row_number() over (order by category_nk) as category_sk,\n    category_nk,\n    category_name,\n    category_description\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.098305Z", "completed_at": "2025-11-20T21:51:13.117446Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.118303Z", "completed_at": "2025-11-20T21:51:13.118310Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023540735244750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_reviews\"\nwhere review_nk is not null\ngroup by review_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.108117Z", "completed_at": "2025-11-20T21:51:13.120062Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.121681Z", "completed_at": "2025-11-20T21:51:13.121688Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015438556671142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_categories_category_nk.441428ad52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"\nwhere category_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.112544Z", "completed_at": "2025-11-20T21:51:13.120925Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.125515Z", "completed_at": "2025-11-20T21:51:13.125521Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017903566360473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_categories_category_nk.79139c5f53", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_categories\"\nwhere category_nk is not null\ngroup by category_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.122335Z", "completed_at": "2025-11-20T21:51:13.132189Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.138510Z", "completed_at": "2025-11-20T21:51:13.138518Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019467830657958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_customers", "compiled": true, "compiled_code": "\n\n-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.\nwith northwind as (\n    select\n        source_system,\n        customer_nk,\n        source_customer_id,\n        customer_name,\n        contact_name,\n        contact_title,\n        null::varchar                                as first_name,\n        null::varchar                                as last_name,\n        address,\n        city,\n        region,\n        country,\n        postal_code,\n        null::varchar                                as plan,\n        null::varchar                                as segment,\n        null::int                                    as seats,\n        null::boolean                                as trial_converted,\n        null::boolean                                as active_subscription,\n        null::boolean                                as legacy_plan,\n        current_timestamp                            as created_at,\n        null::timestamp                              as trial_ends_at,\n        null::timestamp                              as canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\n),\nmetabase as (\n    select\n        source_system,\n        customer_nk,\n        source_customer_id,\n        customer_name,\n        null::varchar                                as contact_name,\n        null::varchar                                as contact_title,\n        first_name,\n        last_name,\n        null::varchar                                as address,\n        null::varchar                                as city,\n        null::varchar                                as region,\n        country,\n        null::varchar                                as postal_code,\n        plan,\n        segment,\n        seats,\n        trial_converted,\n        active_subscription,\n        legacy_plan,\n        created_at,\n        trial_ends_at,\n        canceled_at,\n    dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\n),\nmetabase_people as (\n    select\n        source_system,\n        customer_nk,\n        source_customer_id,\n        customer_name,\n        contact_name,\n        contact_title,\n        first_name,\n        last_name,\n        address,\n        city,\n        region,\n        country,\n        postal_code,\n        plan,\n        segment,\n        seats,\n        trial_converted,\n        active_subscription,\n        legacy_plan,\n        created_at,\n        trial_ends_at,\n        canceled_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_people\"\n)\nselect * from northwind\nunion all\nselect * from metabase\nunion all\nselect * from metabase_people", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.127549Z", "completed_at": "2025-11-20T21:51:13.143372Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.144331Z", "completed_at": "2025-11-20T21:51:13.144339Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023159265518188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.132990Z", "completed_at": "2025-11-20T21:51:13.145483Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.150299Z", "completed_at": "2025-11-20T21:51:13.150306Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019680023193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.146413Z", "completed_at": "2025-11-20T21:51:13.149510Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.151400Z", "completed_at": "2025-11-20T21:51:13.151406Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007651090621948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.employees_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    employee_nk,\n    source_system,\n    source_employee_id,\n    first_name,\n    last_name,\n    job_title,\n    courtesy_title,\n    birth_date,\n    hire_date,\n    city,\n    region,\n    country,\n    postal_code,\n    phone,\n    phone_extension,\n    manager_empid,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"employees_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.139244Z", "completed_at": "2025-11-20T21:51:13.149944Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.152026Z", "completed_at": "2025-11-20T21:51:13.152032Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02091670036315918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.154756Z", "completed_at": "2025-11-20T21:51:13.170887Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.171585Z", "completed_at": "2025-11-20T21:51:13.171593Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02070450782775879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\nwhere employee_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.159949Z", "completed_at": "2025-11-20T21:51:13.173798Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.177978Z", "completed_at": "2025-11-20T21:51:13.177988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023827552795410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\nwhere employee_nk is not null\ngroup by employee_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.163314Z", "completed_at": "2025-11-20T21:51:13.178897Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.181262Z", "completed_at": "2025-11-20T21:51:13.181270Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023491859436035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.167315Z", "completed_at": "2025-11-20T21:51:13.179605Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.182316Z", "completed_at": "2025-11-20T21:51:13.182324Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02412581443786621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.174152Z", "completed_at": "2025-11-20T21:51:13.183493Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.185266Z", "completed_at": "2025-11-20T21:51:13.185275Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012401342391967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_geography", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de geografia consolidando localidades presentes nas diferentes fontes.\nwith unioned as (\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        upper(coalesce(region, 'N/A'))  as region,\n        upper(coalesce(city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_customers\"\n\n    union\n\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        'N/A'                           as region,\n        'N/A'                           as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_accounts\"\n\n    union\n\n    select distinct\n        upper(coalesce(country, 'N/A')) as country,\n        upper(coalesce(region, 'N/A'))  as region,\n        upper(coalesce(city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_employees\"\n\n    union\n\n    select distinct\n        upper(coalesce(ship_country, 'N/A')) as country,\n        upper(coalesce(ship_region, 'N/A'))  as region,\n        upper(coalesce(ship_city, 'N/A'))    as city\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\n)\nselect\n    row_number() over (order by country, region, city) as geography_sk,\n    country,\n    region,\n    city\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.186716Z", "completed_at": "2025-11-20T21:51:13.199958Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.204824Z", "completed_at": "2025-11-20T21:51:13.204832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02196788787841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.fact_sales", "compiled": true, "compiled_code": "\n\n-- Fato de vendas unificada (B2B + B2C) com m\u00e9tricas financeiras padronizadas.\nwith northwind as (\n    select\n        'NORTHWIND'                          as source_system,\n        od.source_order_id,\n        od.order_nk,\n        o.customer_nk,\n        od.supplier_nk,\n        od.category_nk,\n        od.product_nk,\n        o.employee_nk,\n        o.shipper_nk,\n        'CHANNEL_NORTHWIND'                  as channel_nk,\n        o.order_date,\n        o.shipped_date,\n        od.quantity,\n        od.unit_price,\n        od.discount_pct,\n        od.gross_amount,\n        od.net_amount,\n        od.dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_order_details\" od\n    join \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\" o\n      on od.order_nk = o.order_nk\n),\nmetabase as (\n    select\n        'METABASE'                           as source_system,\n        source_order_id,\n        order_nk,\n        customer_nk,\n        null::varchar                        as supplier_nk,\n        category_nk,\n        product_nk,\n        null::varchar                        as employee_nk,\n        null::varchar                        as shipper_nk,\n        'CHANNEL_METABASE'                   as channel_nk,\n        order_date,\n        shipped_date,\n        quantity,\n        unit_price,\n        discount_pct,\n        (quantity * unit_price)::numeric(14,4)                         as gross_amount,\n        total_amount                                                   as net_amount,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_orders\"\n)\nselect * from northwind\nunion all\nselect * from metabase", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.195496Z", "completed_at": "2025-11-20T21:51:13.206870Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.208634Z", "completed_at": "2025-11-20T21:51:13.208646Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02248692512512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.191853Z", "completed_at": "2025-11-20T21:51:13.209809Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.211455Z", "completed_at": "2025-11-20T21:51:13.211462Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025654077529907227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.200703Z", "completed_at": "2025-11-20T21:51:13.210186Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.212122Z", "completed_at": "2025-11-20T21:51:13.212128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020802974700927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_orders\"\nwhere order_nk is not null\ngroup by order_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.212763Z", "completed_at": "2025-11-20T21:51:13.224742Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.229632Z", "completed_at": "2025-11-20T21:51:13.229642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02213597297668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_products", "compiled": true, "compiled_code": "\n\nwith\nstg_northwind as (\n    select\n        source_system,\n        source_product_id,\n        product_nk,\n        supplier_nk,\n        category_nk,\n        product_name,\n        category_name,\n        supplier_name,\n        package_details,\n        unit_price,\n        units_in_stock,\n        units_on_order,\n        reorder_level,\n        is_discontinued,\n        rating_score,\n        product_created_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\n),\n\nstg_metabase as (\n    select\n        source_system,\n        source_product_id,\n        product_nk,\n        supplier_nk,\n        category_nk,\n        product_name,\n        category_name,\n        vendor_name as supplier_name,\n        null::varchar as package_details,\n        unit_price,\n        null::integer as units_in_stock,\n        null::integer as units_on_order,\n        null::integer as reorder_level,\n        false as is_discontinued,\n        rating_score,\n        created_at as product_created_at,\n        dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n),\n\nunioned as (\n    select * from stg_northwind\n    union all\n    select * from stg_metabase\n)\n\nselect\n    source_system,\n    source_product_id,\n    product_nk,\n    supplier_nk,\n    category_nk,\n    product_name,\n    category_name,\n    supplier_name,\n    package_details,\n    unit_price,\n    units_in_stock,\n    units_on_order,\n    reorder_level,\n    is_discontinued,\n    rating_score,\n    product_created_at,\n    dw_load_ts\nfrom unioned", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.220235Z", "completed_at": "2025-11-20T21:51:13.236593Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.238957Z", "completed_at": "2025-11-20T21:51:13.238967Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022522687911987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.int_suppliers", "compiled": true, "compiled_code": "\n\n-- Unifica fornecedores das fontes Northwind e Metabase (vendor).\nselect\n    supplier_nk,\n    source_system,\n    cast(source_supplier_id as varchar) as source_supplier_id,\n    supplier_name,\n    contact_name,\n    contact_title,\n    city,\n    region,\n    country,\n    phone,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"\n\nunion all\n\nselect\n    supplier_nk,\n    source_system,\n    source_supplier_id,\n    supplier_name,\n    null::varchar as contact_name,\n    null::varchar as contact_title,\n    null::varchar as city,\n    null::varchar as region,\n    null::varchar as country,\n    null::varchar as phone,\n    dw_load_ts\nfrom (\n    select\n        supplier_nk,\n        'METABASE' as source_system,\n        null::varchar as source_supplier_id,\n        coalesce(vendor_name, 'UNKNOWN') as supplier_name,\n        min(dw_load_ts) as dw_load_ts\n    from \"dw_northwind_metabase\".\"dw_stg\".\"stg_metabase_products\"\n    group by 1,2,3,4\n) m", "relation_name": "\"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.225732Z", "completed_at": "2025-11-20T21:51:13.240478Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.242485Z", "completed_at": "2025-11-20T21:51:13.242494Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02404642105102539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.230628Z", "completed_at": "2025-11-20T21:51:13.243511Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.249746Z", "completed_at": "2025-11-20T21:51:13.249754Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03082728385925293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_stg_northwind_suppliers_supplier_nk.fdebdf43ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"\nwhere supplier_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.244778Z", "completed_at": "2025-11-20T21:51:13.257837Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.263896Z", "completed_at": "2025-11-20T21:51:13.263905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024213790893554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.252381Z", "completed_at": "2025-11-20T21:51:13.269538Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.270984Z", "completed_at": "2025-11-20T21:51:13.270993Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026977062225341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_stg_northwind_suppliers_supplier_nk.9dfad0db8c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"stg_northwind_suppliers\"\nwhere supplier_nk is not null\ngroup by supplier_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.258368Z", "completed_at": "2025-11-20T21:51:13.270489Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.272096Z", "completed_at": "2025-11-20T21:51:13.272102Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020878314971923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\nwhere event_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.264956Z", "completed_at": "2025-11-20T21:51:13.277907Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.279261Z", "completed_at": "2025-11-20T21:51:13.279268Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022219181060791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\nwhere event_nk is not null\ngroup by event_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.273275Z", "completed_at": "2025-11-20T21:51:13.283719Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.288700Z", "completed_at": "2025-11-20T21:51:13.288710Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01875591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feedback_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\nwhere feedback_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.280312Z", "completed_at": "2025-11-20T21:51:13.290980Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.295730Z", "completed_at": "2025-11-20T21:51:13.295738Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018461227416992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    feedback_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\nwhere feedback_nk is not null\ngroup by feedback_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.284820Z", "completed_at": "2025-11-20T21:51:13.296459Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.297858Z", "completed_at": "2025-11-20T21:51:13.297865Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019536256790161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.291851Z", "completed_at": "2025-11-20T21:51:13.302675Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.303958Z", "completed_at": "2025-11-20T21:51:13.303965Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014670133590698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere invoice_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.298542Z", "completed_at": "2025-11-20T21:51:13.309305Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.313394Z", "completed_at": "2025-11-20T21:51:13.313402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022113561630249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoice_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\nwhere invoice_nk is not null\ngroup by invoice_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.304619Z", "completed_at": "2025-11-20T21:51:13.314582Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.319174Z", "completed_at": "2025-11-20T21:51:13.319181Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017432689666748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.309757Z", "completed_at": "2025-11-20T21:51:13.320254Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.321653Z", "completed_at": "2025-11-20T21:51:13.321659Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01819777488708496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere review_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.315769Z", "completed_at": "2025-11-20T21:51:13.326699Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.328042Z", "completed_at": "2025-11-20T21:51:13.328050Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015198469161987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\nwhere review_nk is not null\ngroup by review_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.322808Z", "completed_at": "2025-11-20T21:51:13.334077Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.339901Z", "completed_at": "2025-11-20T21:51:13.339909Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02014946937561035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_category_category_nk.9a0ca90757", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.329102Z", "completed_at": "2025-11-20T21:51:13.340714Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.345005Z", "completed_at": "2025-11-20T21:51:13.345012Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02271890640258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_category_category_sk.3ef7ab8615", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.334427Z", "completed_at": "2025-11-20T21:51:13.345747Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.347126Z", "completed_at": "2025-11-20T21:51:13.347133Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01851797103881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_category_category_nk.a563adfca4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_nk is not null\ngroup by category_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.341076Z", "completed_at": "2025-11-20T21:51:13.349057Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.353115Z", "completed_at": "2025-11-20T21:51:13.353122Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019556760787963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_category_category_sk.76b1e39575", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\nwhere category_sk is not null\ngroup by category_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.349406Z", "completed_at": "2025-11-20T21:51:13.351918Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.353753Z", "completed_at": "2025-11-20T21:51:13.353761Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007653236389160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.customers_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    customer_nk,\n    source_system,\n    source_customer_id,\n    customer_name,\n    contact_name,\n    contact_title,\n    first_name,\n    last_name,\n    address,\n    city,\n    region,\n    country,\n    postal_code,\n    plan,\n    segment,\n    seats,\n    trial_converted,\n    active_subscription,\n    legacy_plan,\n    created_at,\n    trial_ends_at,\n    canceled_at,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"customers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.354365Z", "completed_at": "2025-11-20T21:51:13.363809Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.367838Z", "completed_at": "2025-11-20T21:51:13.367845Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019732952117919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.359292Z", "completed_at": "2025-11-20T21:51:13.372543Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.373686Z", "completed_at": "2025-11-20T21:51:13.373696Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02107524871826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.364567Z", "completed_at": "2025-11-20T21:51:13.374721Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.379348Z", "completed_at": "2025-11-20T21:51:13.379358Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01707768440246582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_system\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere source_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.368519Z", "completed_at": "2025-11-20T21:51:13.378876Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.380604Z", "completed_at": "2025-11-20T21:51:13.380612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01785135269165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_customers\"\nwhere customer_nk is not null\ngroup by customer_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.375564Z", "completed_at": "2025-11-20T21:51:13.383102Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.387919Z", "completed_at": "2025-11-20T21:51:13.387926Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014837026596069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_employee", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de colaboradores (Northwind) SCD2.\nwith latest as (\n    select *\n    from \"dw_northwind_metabase\".\"snapshots\".\"employees_snapshot\"\n    where dbt_valid_to is null\n)\nselect\n    row_number() over (order by employee_nk)   as employee_sk,\n    employee_nk,\n    source_system,\n    source_employee_id,\n    first_name,\n    last_name,\n    job_title,\n    courtesy_title,\n    birth_date,\n    hire_date,\n    city,\n    region,\n    country,\n    postal_code,\n    phone,\n    phone_extension,\n    manager_empid,\n    dbt_valid_from,\n    dbt_valid_to,\n    case when dbt_valid_to is null then true else false end as current_flag\nfrom latest", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.383470Z", "completed_at": "2025-11-20T21:51:13.396548Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.397445Z", "completed_at": "2025-11-20T21:51:13.397453Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017489194869995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geography_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"\nwhere geography_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.389068Z", "completed_at": "2025-11-20T21:51:13.403272Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.404406Z", "completed_at": "2025-11-20T21:51:13.404413Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021810531616210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    geography_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_geography\"\nwhere geography_sk is not null\ngroup by geography_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.392630Z", "completed_at": "2025-11-20T21:51:13.404004Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.408585Z", "completed_at": "2025-11-20T21:51:13.408595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021564722061157227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere channel_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.398175Z", "completed_at": "2025-11-20T21:51:13.409391Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.410934Z", "completed_at": "2025-11-20T21:51:13.410945Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014980316162109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere customer_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.405045Z", "completed_at": "2025-11-20T21:51:13.413457Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.415042Z", "completed_at": "2025-11-20T21:51:13.415050Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012321233749389648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere order_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.433799Z", "completed_at": "2025-11-20T21:51:13.436662Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.437078Z", "completed_at": "2025-11-20T21:51:13.437085Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00436854362487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.products_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    product_nk,\n    source_system,\n    source_product_id,\n    supplier_nk,\n    category_nk,\n    product_name,\n    category_name,\n    supplier_name,\n    package_details,\n    unit_price,\n    units_in_stock,\n    units_on_order,\n    reorder_level,\n    rating_score,\n    product_created_at,\n    is_discontinued,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_products\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"products_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.415772Z", "completed_at": "2025-11-20T21:51:13.437783Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.438698Z", "completed_at": "2025-11-20T21:51:13.438705Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026912689208984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.419717Z", "completed_at": "2025-11-20T21:51:13.439364Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.441038Z", "completed_at": "2025-11-20T21:51:13.441050Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028720378875732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_category_nk__category_nk__ref_dim_category_.f77453a776", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where category_nk is not null\n),\n\nparent as (\n    select category_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.428045Z", "completed_at": "2025-11-20T21:51:13.439748Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.441695Z", "completed_at": "2025-11-20T21:51:13.441701Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027176618576049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where channel_nk is not null\n),\n\nparent as (\n    select channel_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.453584Z", "completed_at": "2025-11-20T21:51:13.456081Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.460281Z", "completed_at": "2025-11-20T21:51:13.460290Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012205839157104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dw_northwind_metabase.suppliers_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    supplier_nk,\n    source_system,\n    source_supplier_id,\n    supplier_name,\n    contact_name,\n    contact_title,\n    city,\n    region,\n    country,\n    phone,\n    dw_load_ts\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"\n", "relation_name": "\"dw_northwind_metabase\".\"snapshots\".\"suppliers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.444284Z", "completed_at": "2025-11-20T21:51:13.459738Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.461652Z", "completed_at": "2025-11-20T21:51:13.461660Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021614551544189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_products_product_nk.bdcda5f3c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_products\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.449117Z", "completed_at": "2025-11-20T21:51:13.461258Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.462811Z", "completed_at": "2025-11-20T21:51:13.462819Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020192384719848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_products_product_nk.f50228595e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_products\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.456547Z", "completed_at": "2025-11-20T21:51:13.464265Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.465926Z", "completed_at": "2025-11-20T21:51:13.465932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017396211624145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_int_suppliers_supplier_nk.6c165af711", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_nk\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"\nwhere supplier_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.472143Z", "completed_at": "2025-11-20T21:51:13.483298Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.484172Z", "completed_at": "2025-11-20T21:51:13.484179Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018765926361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_customer", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.\nwith latest as (\n    select\n        *\n    from \"dw_northwind_metabase\".\"snapshots\".\"customers_snapshot\"\n    where dbt_valid_to is null\n)\nselect\n    row_number() over (order by customer_nk)       as customer_sk,\n    customer_nk,\n    source_system,\n    source_customer_id,\n    customer_name,\n    contact_name,\n    contact_title,\n    first_name,\n    last_name,\n    address,\n    city,\n    region,\n    country,\n    postal_code,\n    plan,\n    segment,\n    seats,\n    trial_converted,\n    active_subscription,\n    legacy_plan,\n    created_at,\n    trial_ends_at,\n    canceled_at,\n    dbt_valid_from,\n    dbt_valid_to,\n    case when dbt_valid_to is null then true else false end as current_flag\nfrom latest", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.468021Z", "completed_at": "2025-11-20T21:51:13.483753Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.485050Z", "completed_at": "2025-11-20T21:51:13.485058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020464658737182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_int_suppliers_supplier_nk.1fff00cf7f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_stg\".\"int_suppliers\"\nwhere supplier_nk is not null\ngroup by supplier_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.475065Z", "completed_at": "2025-11-20T21:51:13.485744Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.487724Z", "completed_at": "2025-11-20T21:51:13.487731Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020947933197021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.479050Z", "completed_at": "2025-11-20T21:51:13.486711Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.488867Z", "completed_at": "2025-11-20T21:51:13.488873Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01440286636352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.491768Z", "completed_at": "2025-11-20T21:51:13.509240Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.510153Z", "completed_at": "2025-11-20T21:51:13.510160Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021804094314575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_employee_nk__employee_nk__ref_dim_employee_.d99c1a5c6d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select employee_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where employee_nk is not null\n),\n\nparent as (\n    select employee_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.498349Z", "completed_at": "2025-11-20T21:51:13.509751Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.510976Z", "completed_at": "2025-11-20T21:51:13.510986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02160930633544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_nk is not null\ngroup by employee_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.503155Z", "completed_at": "2025-11-20T21:51:13.511632Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.513455Z", "completed_at": "2025-11-20T21:51:13.513461Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022185802459716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    employee_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\"\nwhere employee_sk is not null\ngroup by employee_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.506457Z", "completed_at": "2025-11-20T21:51:13.512512Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.514572Z", "completed_at": "2025-11-20T21:51:13.514578Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016794443130493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_product", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de produtos SCD2 (a partir do snapshot).\nwith latest as (\n    select *\n    from \"dw_northwind_metabase\".\"snapshots\".\"products_snapshot\"\n    where dbt_valid_to is null\n)\nselect\n    row_number() over (order by product_nk) as product_sk,\n    product_nk,\n    source_system,\n    source_product_id,\n    supplier_nk,\n    category_nk,\n    product_name,\n    category_name,\n    supplier_name,\n    package_details,\n    unit_price,\n    units_in_stock,\n    units_on_order,\n    reorder_level,\n    rating_score,\n    product_created_at,\n    is_discontinued,\n    dbt_valid_from,\n    dbt_valid_to,\n    case when dbt_valid_to is null then true else false end as current_flag\nfrom latest", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.517731Z", "completed_at": "2025-11-20T21:51:13.536331Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.537605Z", "completed_at": "2025-11-20T21:51:13.537614Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02356243133544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dim_supplier", "compiled": true, "compiled_code": "\n\n-- Dimens\u00e3o de fornecedores SCD2 (Northwind + Metabase vendors).\nwith latest as (\n    select *\n    from \"dw_northwind_metabase\".\"snapshots\".\"suppliers_snapshot\"\n    where dbt_valid_to is null\n)\nselect\n    row_number() over (order by supplier_nk) as supplier_sk,\n    supplier_nk,\n    source_system,\n    source_supplier_id,\n    supplier_name,\n    contact_name,\n    contact_title,\n    city,\n    region,\n    country,\n    phone,\n    dbt_valid_from,\n    dbt_valid_to,\n    case when dbt_valid_to is null then true else false end as current_flag\nfrom latest", "relation_name": "\"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.521052Z", "completed_at": "2025-11-20T21:51:13.536917Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.538473Z", "completed_at": "2025-11-20T21:51:13.538482Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023392200469970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_saas", "compiled": true, "compiled_code": "\n\n-- Data mart para faturamento SaaS (Metabase invoices) com enriquecimento de cliente e calend\u00e1rio.\nwith invoices as (\n    select\n        fi.invoice_nk,\n        fi.customer_nk,\n        fi.plan_name,\n        fi.payment_amount,\n        fi.expected_invoice_flag,\n        fi.date_received::date as invoice_date,\n        dc.customer_name,\n        dc.segment,\n        dc.plan,\n        dd.year,\n        dd.month,\n        dd.month_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\" fi\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fi.customer_nk = dc.customer_nk\n          and dc.current_flag\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\" dd\n           on fi.date_received::date = dd.date_day\n)\nselect *\nfrom invoices", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_saas\".\"dm_saas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.524689Z", "completed_at": "2025-11-20T21:51:13.539962Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.541866Z", "completed_at": "2025-11-20T21:51:13.541873Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02462625503540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.532024Z", "completed_at": "2025-11-20T21:51:13.541428Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.543281Z", "completed_at": "2025-11-20T21:51:13.543287Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022719860076904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.544677Z", "completed_at": "2025-11-20T21:51:13.560094Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.565764Z", "completed_at": "2025-11-20T21:51:13.565782Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02496814727783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.550099Z", "completed_at": "2025-11-20T21:51:13.565116Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.566647Z", "completed_at": "2025-11-20T21:51:13.566654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02425384521484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where customer_nk is not null\n),\n\nparent as (\n    select customer_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.556232Z", "completed_at": "2025-11-20T21:51:13.569237Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.570749Z", "completed_at": "2025-11-20T21:51:13.570763Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021147727966308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_product_analytics", "compiled": true, "compiled_code": "\n\n-- Mart que combina eventos de uso, reviews e feedbacks para an\u00e1lises 360\u00ba do produto.\nwith events as (\n    select\n        'ANALYTIC_EVENT'                              as record_type,\n        fa.event_nk                                   as record_nk,\n        fa.customer_nk,\n        null::varchar                                 as product_nk,\n        fa.event_name                                 as metric_name,\n        1::numeric                                    as metric_value,\n        fa.event_timestamp                            as metric_timestamp,\n        fa.page_url                                   as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar                                 as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\" fa\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fa.customer_nk = dc.customer_nk\n          and dc.current_flag\n),\nreviews as (\n    select\n        'REVIEW'                                      as record_type,\n        fr.review_nk                                  as record_nk,\n        null::varchar                                 as customer_nk,\n        fr.product_nk,\n        'rating_score'                                as metric_name,\n        fr.rating_score                               as metric_value,\n        fr.created_at                                 as metric_timestamp,\n        fr.review_text                                as context_info,\n        null::varchar                                 as customer_name,\n        null::varchar                                 as segment,\n        dp.product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\" fr\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n           on fr.product_nk = dp.product_nk\n),\nfeedback as (\n    select\n        'FEEDBACK'                                    as record_type,\n        ff.feedback_nk                                as record_nk,\n        ff.customer_nk,\n        null::varchar                                 as product_nk,\n        'rating_score'                                as metric_name,\n        ff.rating_score                               as metric_value,\n        ff.date_received                              as metric_timestamp,\n        ff.feedback_text                              as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar                                 as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\" ff\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on ff.customer_nk = dc.customer_nk\n          and dc.current_flag\n)\nselect * from events\nunion all\nselect * from reviews\nunion all\nselect * from feedback", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_product_analytics\".\"dm_product_analytics\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.560810Z", "completed_at": "2025-11-20T21:51:13.569604Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.571384Z", "completed_at": "2025-11-20T21:51:13.571390Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016663551330566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.572419Z", "completed_at": "2025-11-20T21:51:13.584605Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.594134Z", "completed_at": "2025-11-20T21:51:13.594145Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02564096450805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.577033Z", "completed_at": "2025-11-20T21:51:13.594996Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.596371Z", "completed_at": "2025-11-20T21:51:13.596380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026567935943603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\"\n    where product_nk is not null\n),\n\nparent as (\n    select product_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.585016Z", "completed_at": "2025-11-20T21:51:13.598653Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.600378Z", "completed_at": "2025-11-20T21:51:13.600387Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0180819034576416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where product_nk is not null\n),\n\nparent as (\n    select product_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.590319Z", "completed_at": "2025-11-20T21:51:13.599456Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.605221Z", "completed_at": "2025-11-20T21:51:13.605229Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02243328094482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_nk is not null\ngroup by product_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.601128Z", "completed_at": "2025-11-20T21:51:13.613087Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.614561Z", "completed_at": "2025-11-20T21:51:13.614569Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01741623878479004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\"\nwhere product_sk is not null\ngroup by product_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.608053Z", "completed_at": "2025-11-20T21:51:13.623639Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.625017Z", "completed_at": "2025-11-20T21:51:13.625049Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02535533905029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_sales", "compiled": true, "compiled_code": "\n\n-- Data mart consolidado de vendas usando a fato unificada.\nselect\n    fs.*,\n    dc.customer_name,\n    dp.product_name,\n    dp.category_name,\n    coalesce(dp.supplier_name, ds.supplier_name) as supplier_name\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\" fs\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n       on fs.customer_nk = dc.customer_nk\n      and dc.current_flag\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n       on fs.product_nk = dp.product_nk\n      and dp.current_flag\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\" ds\n       on fs.supplier_nk = ds.supplier_nk\n      and ds.current_flag", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.615318Z", "completed_at": "2025-11-20T21:51:13.627509Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.635397Z", "completed_at": "2025-11-20T21:51:13.635407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023564577102661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_supplier_supplier_nk.d28dc32fe6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_nk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_nk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.619002Z", "completed_at": "2025-11-20T21:51:13.634128Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.636437Z", "completed_at": "2025-11-20T21:51:13.636446Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024003267288208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.not_null_dim_supplier_supplier_sk.2431bdc298", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_sk\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.628016Z", "completed_at": "2025-11-20T21:51:13.643161Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.644615Z", "completed_at": "2025-11-20T21:51:13.644624Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020257949829101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.relationships_fact_sales_supplier_nk__supplier_nk__ref_dim_supplier_.a82039abd4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select supplier_nk as from_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\"\n    where supplier_nk is not null\n),\n\nparent as (\n    select supplier_nk as to_field\n    from \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.639348Z", "completed_at": "2025-11-20T21:51:13.653659Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.654802Z", "completed_at": "2025-11-20T21:51:13.654810Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020129919052124023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_supplier_supplier_nk.a66ac359fa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_nk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_nk is not null\ngroup by supplier_nk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.656006Z", "completed_at": "2025-11-20T21:51:13.660672Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.661110Z", "completed_at": "2025-11-20T21:51:13.661118Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007098674774169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2c", "compiled": true, "compiled_code": "\n\n-- Data mart focado nas vendas Metabase (B2C/SaaS).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'METABASE'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2c\".\"dm_b2c\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.646730Z", "completed_at": "2025-11-20T21:51:13.661856Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.662440Z", "completed_at": "2025-11-20T21:51:13.662450Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01896214485168457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_northwind_metabase.unique_dim_supplier_supplier_sk.cced48ade4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supplier_sk as unique_field,\n    count(*) as n_records\n\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\"\nwhere supplier_sk is not null\ngroup by supplier_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T21:51:13.650805Z", "completed_at": "2025-11-20T21:51:13.663155Z"}, {"name": "execute", "started_at": "2025-11-20T21:51:13.663611Z", "completed_at": "2025-11-20T21:51:13.663623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01962590217590332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2b", "compiled": true, "compiled_code": "\n\n-- Data mart focado no fluxo Northwind (B2B).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'NORTHWIND'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2b\".\"dm_b2b\"", "batch_results": null}], "elapsed_time": 1.4020330905914307, "args": {"print": true, "empty_catalog": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "upload_to_artifacts_ingest_api": false, "version_check": true, "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "log_format_file": "debug", "defer": false, "favor_state": false, "require_all_warnings_handled_by_warn_error": false, "show_all_deprecations": false, "require_nested_cumulative_type_params": false, "select": [], "use_colors": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "static": false, "log_file_max_bytes": 10485760, "require_batched_execution_for_custom_microbatch_strategy": false, "profiles_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "require_yaml_configuration_for_mf_time_spines": false, "which": "generate", "require_explicit_package_overrides_for_builtin_materializations": true, "quiet": false, "exclude": [], "indirect_selection": "eager", "strict_mode": false, "require_generic_test_arguments_property": true, "partial_parse_file_diff": true, "log_level": "info", "use_fast_test_edges": false, "require_resource_names_without_spaces": true, "introspect": true, "static_parser": true, "cache_selected_only": false, "partial_parse": true, "show_resource_report": false, "state_modified_compare_vars": false, "invocation_command": "dbt docs generate", "macro_debugging": false, "log_level_file": "debug", "project_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "source_freshness_run_project_hooks": true, "write_json": true, "log_path": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs", "vars": {}, "validate_macro_args": false, "printer_width": 80, "compile": true, "state_modified_compare_more_unrendered_values": false, "populate_cache": true}}