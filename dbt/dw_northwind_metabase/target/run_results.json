{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-22T23:22:36.823273Z", "invocation_id": "6b19500f-ee22-48c6-be7d-7903c776ab85", "invocation_started_at": "2025-11-22T23:22:34.254473Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T23:22:36.421003Z", "completed_at": "2025-11-22T23:22:36.430171Z"}, {"name": "execute", "started_at": "2025-11-22T23:22:36.450137Z", "completed_at": "2025-11-22T23:22:36.633099Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22451114654541016, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dw_northwind_metabase.dm_saas", "compiled": true, "compiled_code": "\n\n-- Data mart para faturamento SaaS (Metabase invoices) com joins SCD2 usando o intervalo completo.\nwith invoices as (\n    select\n        fi.invoice_nk,\n        fi.customer_nk,\n        fi.plan_name,\n        fi.payment_amount,\n        fi.expected_invoice_flag,\n        fi.date_received::date as invoice_date,\n        dc.customer_name,\n        dc.segment,\n        dc.plan,\n        dd.year,\n        dd.month,\n        dd.month_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_invoices\" fi\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fi.customer_nk = dc.customer_nk\n          and fi.date_received::date >= coalesce(dc.dbt_valid_from, date '1900-01-01')\n          and fi.date_received::date <  coalesce(dc.dbt_valid_to,   date '9999-12-31')\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_date\" dd\n           on fi.date_received::date = dd.date_day\n)\nselect *\nfrom invoices", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_saas\".\"dm_saas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T23:22:36.425279Z", "completed_at": "2025-11-22T23:22:36.480269Z"}, {"name": "execute", "started_at": "2025-11-22T23:22:36.483897Z", "completed_at": "2025-11-22T23:22:36.637119Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21993541717529297, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dw_northwind_metabase.dm_sales", "compiled": true, "compiled_code": "\n\n-- Data mart consolidado de vendas.\n-- As jun\u00e7\u00f5es s\u00e3o simples e diretas, pois o fact_sales j\u00e1 resolveu as chaves substitutas (SKs) corretas para cada venda.\nselect\n    -- Chaves e m\u00e9tricas da fato\n    fs.order_nk,\n    fs.source_system,\n    fs.order_date,\n    fs.quantity,\n    fs.gross_amount,\n    fs.net_amount,\n    -- SKs para rastreabilidade\n    fs.dim_customer_sk,\n    fs.dim_product_sk,\n    fs.dim_supplier_sk,\n    fs.dim_category_sk,\n    fs.dim_employee_sk,\n    fs.dim_channel_sk,\n    -- Atributos de cliente/produto etc. resolvidos via SK (j\u00e1 \u201cas of\u201d)\n    dc.customer_nk,\n    dc.customer_name,\n    dc.city as customer_city,\n    dc.segment,\n    dc.country as customer_country,\n    dp.product_nk,\n    dp.product_name,\n    dcat.category_name,\n    ds.supplier_name,\n    de.employee_name,\n    de.job_title,\n    dch.channel_name\nfrom \"dw_northwind_metabase\".\"dw_dw\".\"fact_sales\" fs\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc on fs.dim_customer_sk = dc.customer_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp on fs.dim_product_sk = dp.product_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_supplier\" ds on fs.dim_supplier_sk = ds.supplier_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_category\" dcat on fs.dim_category_sk = dcat.category_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_employee\" de on fs.dim_employee_sk = de.employee_sk\nleft join \"dw_northwind_metabase\".\"dw_dw\".\"dim_channel\" dch on fs.dim_channel_sk = dch.channel_sk", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T23:22:36.410556Z", "completed_at": "2025-11-22T23:22:36.429696Z"}, {"name": "execute", "started_at": "2025-11-22T23:22:36.430794Z", "completed_at": "2025-11-22T23:22:36.639304Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23214197158813477, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dw_northwind_metabase.dm_product_analytics", "compiled": true, "compiled_code": "\n\n-- Mart 360 de produto com joins SCD2 usando o intervalo completo.\nwith events as (\n    select\n        'ANALYTIC_EVENT'   as record_type,\n        fa.event_nk        as record_nk,\n        fa.customer_nk,\n        null::varchar      as product_nk,\n        fa.event_name      as metric_name,\n        1::numeric         as metric_value,\n        fa.event_timestamp as metric_timestamp,\n        fa.page_url        as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar      as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_analytic_events\" fa\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on fa.customer_nk = dc.customer_nk\n          and fa.event_timestamp >= coalesce(dc.dbt_valid_from, timestamp '1900-01-01')\n          and fa.event_timestamp <  coalesce(dc.dbt_valid_to,   timestamp '9999-12-31')\n),\nreviews as (\n    select\n        'REVIEW'           as record_type,\n        fr.review_nk       as record_nk,\n        null::varchar      as customer_nk,\n        fr.product_nk,\n        'rating_score'     as metric_name,\n        fr.rating_score    as metric_value,\n        fr.created_at      as metric_timestamp,\n        fr.review_text     as context_info,\n        null::varchar      as customer_name,\n        null::varchar      as segment,\n        dp.product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_reviews\" fr\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_product\" dp\n           on fr.product_nk = dp.product_nk\n          and fr.created_at >= coalesce(dp.dbt_valid_from, timestamp '1900-01-01')\n          and fr.created_at <  coalesce(dp.dbt_valid_to,   timestamp '9999-12-31')\n),\nfeedback as (\n    select\n        'FEEDBACK'         as record_type,\n        ff.feedback_nk     as record_nk,\n        ff.customer_nk,\n        null::varchar      as product_nk,\n        'rating_score'     as metric_name,\n        ff.rating_score    as metric_value,\n        ff.date_received   as metric_timestamp,\n        ff.feedback_text   as context_info,\n        dc.customer_name,\n        dc.segment,\n        null::varchar      as product_name\n    from \"dw_northwind_metabase\".\"dw_dw\".\"fact_feedback\" ff\n    left join \"dw_northwind_metabase\".\"dw_dw\".\"dim_customer\" dc\n           on ff.customer_nk = dc.customer_nk\n          and ff.date_received >= coalesce(dc.dbt_valid_from, timestamp '1900-01-01')\n          and ff.date_received <  coalesce(dc.dbt_valid_to,   timestamp '9999-12-31')\n)\nselect * from events\nunion all\nselect * from reviews\nunion all\nselect * from feedback", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_product_analytics\".\"dm_product_analytics\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T23:22:36.652379Z", "completed_at": "2025-11-22T23:22:36.660342Z"}, {"name": "execute", "started_at": "2025-11-22T23:22:36.661360Z", "completed_at": "2025-11-22T23:22:36.750867Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1012413501739502, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2c", "compiled": true, "compiled_code": "\n\n-- Data mart focado nas vendas Metabase (B2C/SaaS).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'METABASE'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2c\".\"dm_b2c\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T23:22:36.656252Z", "completed_at": "2025-11-22T23:22:36.660805Z"}, {"name": "execute", "started_at": "2025-11-22T23:22:36.664849Z", "completed_at": "2025-11-22T23:22:36.759370Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10809707641601562, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dw_northwind_metabase.dm_b2b", "compiled": true, "compiled_code": "\n\n-- Data mart focado no fluxo Northwind (B2B).\nselect *\nfrom \"dw_northwind_metabase\".\"dw_dm_sales\".\"dm_sales\"\nwhere source_system = 'NORTHWIND'", "relation_name": "\"dw_northwind_metabase\".\"dw_dm_b2b\".\"dm_b2b\"", "batch_results": null}], "elapsed_time": 1.0214354991912842, "args": {"static_parser": true, "log_level_file": "debug", "log_file_max_bytes": 10485760, "partial_parse": true, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "write_json": true, "project_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "partial_parse_file_diff": true, "quiet": false, "validate_macro_args": false, "favor_state": false, "show_all_deprecations": false, "upload_to_artifacts_ingest_api": false, "state_modified_compare_vars": false, "vars": {}, "print": true, "require_resource_names_without_spaces": true, "use_colors_file": true, "log_path": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs", "use_colors": true, "printer_width": 80, "cache_selected_only": false, "profiles_dir": "D:\\OneDrive\\Documentos\\Profissional\\P\u00f3s IA IFG\\Mat\u00e9rias\\T\u00f3picos - Intelig\u00eancia de Neg\u00f3cios - Sirlon Diniz\\Exerc\u00edcios e Trabalhos\\DW\\dbt\\dw_northwind_metabase", "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "select": ["dm_sales", "dm_b2b", "dm_b2c", "dm_saas", "dm_product_analytics"], "require_nested_cumulative_type_params": false, "defer": false, "exclude": [], "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "version_check": true, "strict_mode": false, "use_fast_test_edges": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "macro_debugging": false, "empty": false, "introspect": true, "log_level": "info", "invocation_command": "dbt run --select dm_sales dm_b2b dm_b2c dm_saas dm_product_analytics", "populate_cache": true, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_more_unrendered_values": false, "which": "run", "source_freshness_run_project_hooks": true, "require_generic_test_arguments_property": true}}