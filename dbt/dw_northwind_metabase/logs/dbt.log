[0m21:20:01.200355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB37B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB5054B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB5698E10>]}


============================== 21:20:01.223682 | f2ead345-30e1-43ee-94a4-fef94f2a5412 ==============================
[0m21:20:01.223682 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:20:01.225081 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:20:01.707685 [info ] [MainThread]: dbt version: 1.10.13
[0m21:20:01.708285 [info ] [MainThread]: python version: 3.13.9
[0m21:20:01.708730 [info ] [MainThread]: python path: D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\.venv\Scripts\python.exe
[0m21:20:01.709225 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:20:01.902123 [info ] [MainThread]: Using profiles dir at D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase
[0m21:20:01.903268 [info ] [MainThread]: Using profiles.yml file at D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\profiles.yml
[0m21:20:01.904200 [info ] [MainThread]: Using dbt_project.yml file at D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\dbt_project.yml
[0m21:20:01.906094 [info ] [MainThread]: adapter type: postgres
[0m21:20:01.907209 [info ] [MainThread]: adapter version: 1.9.1
[0m21:20:02.323701 [info ] [MainThread]: Configuration:
[0m21:20:02.324467 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:20:02.325840 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:20:02.327415 [info ] [MainThread]: Required dependencies:
[0m21:20:02.328965 [debug] [MainThread]: Executing "git --help"
[0m21:20:02.546255 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:20:02.547436 [debug] [MainThread]: STDERR: "b''"
[0m21:20:02.549132 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:20:02.550561 [info ] [MainThread]: Connection:
[0m21:20:02.551691 [info ] [MainThread]:   host: localhost
[0m21:20:02.552672 [info ] [MainThread]:   port: 5433
[0m21:20:02.553559 [info ] [MainThread]:   user: postgres
[0m21:20:02.554502 [info ] [MainThread]:   database: dw_northwind_metabase
[0m21:20:02.555498 [info ] [MainThread]:   schema: dw
[0m21:20:02.556412 [info ] [MainThread]:   connect_timeout: 10
[0m21:20:02.557395 [info ] [MainThread]:   role: None
[0m21:20:02.558351 [info ] [MainThread]:   search_path: None
[0m21:20:02.559163 [info ] [MainThread]:   keepalives_idle: 0
[0m21:20:02.559987 [info ] [MainThread]:   sslmode: None
[0m21:20:02.560847 [info ] [MainThread]:   sslcert: None
[0m21:20:02.561652 [info ] [MainThread]:   sslkey: None
[0m21:20:02.562512 [info ] [MainThread]:   sslrootcert: None
[0m21:20:02.563382 [info ] [MainThread]:   application_name: dbt
[0m21:20:02.564227 [info ] [MainThread]:   retries: 1
[0m21:20:02.566354 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:20:03.674058 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:20:09.612876 [debug] [MainThread]: Using postgres connection "debug"
[0m21:20:09.613425 [debug] [MainThread]: On debug: select 1 as id
[0m21:20:09.613865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:09.717244 [debug] [MainThread]: SQL status: SELECT 1 in 0.103 seconds
[0m21:20:09.719229 [debug] [MainThread]: On debug: Close
[0m21:20:09.719909 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:20:09.720529 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:20:09.722275 [debug] [MainThread]: Command `dbt debug` succeeded at 21:20:09.721943 after 8.70 seconds
[0m21:20:09.722858 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:20:09.723310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB58DF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB5A80830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB59E7F00>]}
[0m21:20:09.723857 [debug] [MainThread]: Flushing usage events
[0m21:20:10.962801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:59.975371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213EEB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213FD9BED0>]}


============================== 21:32:59.983736 | 7590e651-1e29-4139-ac4b-ba73148c476f ==============================
[0m21:32:59.983736 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:32:59.984771 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:33:00.364878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F0E9F30>]}
[0m21:33:00.469795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213FE23DF0>]}
[0m21:33:00.471248 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:33:00.994944 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:33:00.997209 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:33:00.998605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141122E50>]}
[0m21:33:05.316951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.intermediate
- snapshots.dw_northwind_metabase
[0m21:33:05.335292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221412DAD50>]}
[0m21:33:05.481140 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:33:05.520639 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:33:05.663040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221415F3070>]}
[0m21:33:05.664075 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:33:05.665070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141325230>]}
[0m21:33:05.668391 [info ] [MainThread]: 
[0m21:33:05.669273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:05.670163 [info ] [MainThread]: 
[0m21:33:05.671599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:05.680419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:33:05.800168 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:33:05.800699 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:33:05.801146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:05.886728 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.086 seconds
[0m21:33:05.894644 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:33:05.896695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_stg)
[0m21:33:05.898277 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_stg"
"
[0m21:33:05.906932 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_stg"
[0m21:33:05.907598 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: BEGIN
[0m21:33:05.908059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:06.000206 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m21:33:06.001267 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_stg"
[0m21:33:06.001966 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_stg"} */
create schema if not exists "dw_stg"
[0m21:33:06.004486 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m21:33:06.006052 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: COMMIT
[0m21:33:06.006559 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_stg"
[0m21:33:06.006980 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: COMMIT
[0m21:33:06.008977 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:33:06.009740 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: Close
[0m21:33:06.016147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:33:06.026332 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:33:06.026853 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:33:06.027297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:06.108599 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m21:33:06.109152 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:33:06.109657 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:33:06.184809 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.075 seconds
[0m21:33:06.186530 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:33:06.187133 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:33:06.193929 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.194444 [debug] [MainThread]: On master: BEGIN
[0m21:33:06.194923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:06.268552 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m21:33:06.269148 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.269685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:33:06.310526 [debug] [MainThread]: SQL status: SELECT 0 in 0.040 seconds
[0m21:33:06.312143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141626990>]}
[0m21:33:06.312876 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:06.313688 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.314133 [debug] [MainThread]: On master: BEGIN
[0m21:33:06.314990 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:33:06.315402 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.315787 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.316147 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.316728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:33:06.317197 [debug] [MainThread]: On master: Close
[0m21:33:06.331576 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.332445 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.333015 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.333569 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.334330 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:33:06.334951 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:33:06.337138 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:33:06.337886 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:33:06.335680 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:33:06.338560 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.339122 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.336344 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:33:06.339912 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:33:06.350162 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.359042 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.359902 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:33:06.360510 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.361547 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.367358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.373191 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.377449 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.385501 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.416065 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.430166 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.440106 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.441858 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.443461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.448864 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.455012 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.455692 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:33:06.456547 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:06.457476 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.458319 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.459175 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:33:06.460019 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:33:06.460853 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.461486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:33:06.462164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:06.462888 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:33:06.464103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:33:06.550503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m21:33:06.551451 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.552528 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
;
  );
[0m21:33:06.558410 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m21:33:06.559306 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.560313 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
;
  );
[0m21:33:06.561686 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: ;
         ^

[0m21:33:06.562902 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:33:06.564102 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: ;
         ^

[0m21:33:06.565076 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:33:06.566016 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:33:06.566775 [debug] [Thread-4 (]: SQL status: BEGIN in 0.105 seconds
[0m21:33:06.567884 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:33:06.568656 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.570818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.107 seconds
[0m21:33:06.571984 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
;
  );
[0m21:33:06.572842 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.575502 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
;
  );
[0m21:33:06.576678 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: ;
         ^

[0m21:33:06.578217 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:33:06.579632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: ;
         ^

[0m21:33:06.580759 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:33:06.581803 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:33:06.585288 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:33:06.626553 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  syntax error at or near ";"
  LINE 25: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:33:06.627761 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  syntax error at or near ";"
  LINE 22: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:33:06.629144 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:33:06.631167 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:33:06.649393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141942360>]}
[0m21:33:06.650065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141B394F0>]}
[0m21:33:06.651535 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141B2BD10>]}
[0m21:33:06.651040 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.29s]
[0m21:33:06.652399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F06F750>]}
[0m21:33:06.653285 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.29s]
[0m21:33:06.655921 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.654542 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.27s]
[0m21:33:06.658925 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.660044 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.661333 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  syntax error at or near ";"
  LINE 25: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:33:06.657231 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.30s]
[0m21:33:06.663760 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.667930 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:33:06.664804 [info ] [Thread-2 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:33:06.669956 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.671252 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  syntax error at or near ";"
  LINE 22: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:33:06.672455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:33:06.674174 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:33:06.675312 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.684089 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.686744 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.695969 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.700537 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.701664 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:33:06.702657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:06.797558 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m21:33:06.798240 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.798854 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
;
  );
[0m21:33:06.800093 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: ;
         ^

[0m21:33:06.800639 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:33:06.801518 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:33:06.808400 [debug] [Thread-2 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:33:06.809133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141A64FB0>]}
[0m21:33:06.810170 [error] [Thread-2 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.14s]
[0m21:33:06.811314 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.812342 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:33:06.814514 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.815019 [debug] [MainThread]: On master: BEGIN
[0m21:33:06.815445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:06.885965 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m21:33:06.886524 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.886953 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.887354 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.888026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:33:06.888523 [debug] [MainThread]: On master: Close
[0m21:33:06.889190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:06.889599 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:33:06.890017 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:33:06.890391 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:33:06.890762 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:33:06.891163 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:33:06.891555 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:33:06.892070 [info ] [MainThread]: 
[0m21:33:06.892746 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m21:33:06.894723 [debug] [MainThread]: Command end result
[0m21:33:06.932566 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:33:06.936556 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:33:06.945903 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:33:06.946841 [info ] [MainThread]: 
[0m21:33:06.948044 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:33:06.949314 [info ] [MainThread]: 
[0m21:33:06.950392 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:33:06.951521 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  syntax error at or near ";"
  LINE 25: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:33:06.952243 [info ] [MainThread]: 
[0m21:33:06.953159 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:33:06.953942 [info ] [MainThread]: 
[0m21:33:06.954758 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:33:06.955943 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:33:06.956825 [info ] [MainThread]: 
[0m21:33:06.957867 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:33:06.958833 [info ] [MainThread]: 
[0m21:33:06.960197 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:33:06.961266 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  syntax error at or near ";"
  LINE 22: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:33:06.964597 [info ] [MainThread]: 
[0m21:33:06.966299 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:33:06.967241 [info ] [MainThread]: 
[0m21:33:06.968391 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:33:06.969425 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:33:06.970419 [info ] [MainThread]: 
[0m21:33:06.971584 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:33:06.972488 [info ] [MainThread]: 
[0m21:33:06.973689 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:33:06.974853 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:33:06.976830 [info ] [MainThread]: 
[0m21:33:06.978285 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:33:06.980276 [info ] [MainThread]: 
[0m21:33:06.982914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:33:06.986405 [debug] [MainThread]: Command `dbt run` failed at 21:33:06.986110 after 7.23 seconds
[0m21:33:06.988595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F75EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141BCF8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141BCFB30>]}
[0m21:33:06.989704 [debug] [MainThread]: Flushing usage events
[0m21:33:08.357711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:20.213548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE200830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAEAA8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0198E10>]}


============================== 21:34:20.219550 | 7c20ef5e-0200-4b77-a868-4263adb4463f ==============================
[0m21:34:20.219550 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:34:20.220349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:34:20.616646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE439F30>]}
[0m21:34:20.725871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0227DF0>]}
[0m21:34:20.727942 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:34:21.181455 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:34:21.459017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m21:34:21.459976 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_customers.sql
[0m21:34:21.460612 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:21.461203 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_orders.sql
[0m21:34:21.462218 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m21:34:21.462895 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:22.155904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.dw
- snapshots.dw_northwind_metabase
[0m21:34:22.178194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0768B50>]}
[0m21:34:22.313407 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:34:22.316829 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:34:22.347841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB07C4320>]}
[0m21:34:22.348519 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:34:22.349114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB03D8670>]}
[0m21:34:22.352099 [info ] [MainThread]: 
[0m21:34:22.352836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:22.353578 [info ] [MainThread]: 
[0m21:34:22.354847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:22.364262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:34:22.471081 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:34:22.471601 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:34:22.472037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:22.557385 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.085 seconds
[0m21:34:22.559566 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:34:22.562595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:34:22.569291 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:34:22.569909 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:34:22.570318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:22.638648 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m21:34:22.639400 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:34:22.640124 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:34:22.652083 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m21:34:22.653794 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:34:22.654502 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:34:22.662311 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.662993 [debug] [MainThread]: On master: BEGIN
[0m21:34:22.663487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:22.737999 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m21:34:22.738537 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.739056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:34:22.750430 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m21:34:22.752147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB08D2F70>]}
[0m21:34:22.752736 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:22.753381 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.753779 [debug] [MainThread]: On master: BEGIN
[0m21:34:22.754512 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:34:22.755085 [debug] [MainThread]: On master: COMMIT
[0m21:34:22.755832 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.756479 [debug] [MainThread]: On master: COMMIT
[0m21:34:22.757343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:34:22.758106 [debug] [MainThread]: On master: Close
[0m21:34:22.767449 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:22.768397 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:22.769008 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:22.769567 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:22.770494 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:34:22.771555 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:34:22.772460 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:34:22.775214 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:34:22.773537 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:34:22.776941 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:34:22.778077 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:34:22.778823 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:22.779971 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:34:22.780939 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:22.781822 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:22.787743 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:22.801485 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:22.806077 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:22.813590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:22.818047 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:22.820228 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:22.827228 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:22.873733 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:22.915565 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:22.917282 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:22.919313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:22.920654 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:22.931551 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:22.933179 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:22.934112 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:34:22.934992 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:22.935798 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:22.936599 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:34:22.937275 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:34:22.937958 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:34:22.938778 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:22.940344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:34:22.939528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:34:22.941251 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:34:22.943137 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:23.035358 [debug] [Thread-4 (]: SQL status: BEGIN in 0.099 seconds
[0m21:34:23.036149 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:23.036933 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
  );
[0m21:34:23.038458 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m21:34:23.039049 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:23.045382 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
  );
[0m21:34:23.046464 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.orderdetail"
LINE 21: from "northwind"."public"."orderdetail" od
              ^

[0m21:34:23.047689 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:34:23.048700 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.customer"
LINE 25: from "northwind"."public"."customer"
              ^

[0m21:34:23.049475 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:34:23.050255 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:34:23.051242 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:34:23.055576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m21:34:23.056542 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:23.057294 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
  );
[0m21:34:23.058393 [debug] [Thread-2 (]: SQL status: BEGIN in 0.115 seconds
[0m21:34:23.059281 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:23.059975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.accounts"
LINE 28: from "sample_metabase_pg"."public"."accounts" a
              ^

[0m21:34:23.060672 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
  );
[0m21:34:23.061584 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:34:23.063344 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:34:23.064164 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.orders"
LINE 24: from "sample_metabase_pg"."public"."orders" o
              ^

[0m21:34:23.066196 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:34:23.067165 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:34:23.094053 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:34:23.095618 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:23.098887 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:34:23.100118 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:23.101661 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0B8E210>]}
[0m21:34:23.102155 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0DA41B0>]}
[0m21:34:23.103457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB02F4E10>]}
[0m21:34:23.104010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE3C2170>]}
[0m21:34:23.103013 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.32s]
[0m21:34:23.105257 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.32s]
[0m21:34:23.106909 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.32s]
[0m21:34:23.110562 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:23.108650 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.32s]
[0m21:34:23.112324 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:23.113476 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:23.114443 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.115588 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:34:23.116569 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:23.117559 [info ] [Thread-3 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:34:23.119655 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:34:23.121057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:34:23.122322 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:34:23.123354 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.124751 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:34:23.129706 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.132202 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.139633 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.141798 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.142806 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:34:23.143444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:34:23.292993 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m21:34:23.294121 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.295330 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
  );
[0m21:34:23.297351 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.salesorder"
LINE 25: from "northwind"."public"."salesorder" o
              ^

[0m21:34:23.298144 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:34:23.299151 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:34:23.306607 [debug] [Thread-3 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:34:23.307688 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0373540>]}
[0m21:34:23.309450 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.19s]
[0m21:34:23.311439 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.313008 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:34:23.316047 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:23.316978 [debug] [MainThread]: On master: BEGIN
[0m21:34:23.317852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:23.421730 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m21:34:23.423406 [debug] [MainThread]: On master: COMMIT
[0m21:34:23.425991 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:23.428798 [debug] [MainThread]: On master: COMMIT
[0m21:34:23.430609 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:34:23.432347 [debug] [MainThread]: On master: Close
[0m21:34:23.433940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:23.435105 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:34:23.435963 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:34:23.437319 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:34:23.438357 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:34:23.439622 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:34:23.440570 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:34:23.441847 [info ] [MainThread]: 
[0m21:34:23.443409 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m21:34:23.448593 [debug] [MainThread]: Command end result
[0m21:34:23.552215 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:34:23.559980 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:34:23.579630 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:34:23.580653 [info ] [MainThread]: 
[0m21:34:23.582018 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:34:23.583368 [info ] [MainThread]: 
[0m21:34:23.586077 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:34:23.589798 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:34:23.591084 [info ] [MainThread]: 
[0m21:34:23.596494 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:34:23.598421 [info ] [MainThread]: 
[0m21:34:23.601344 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:34:23.603997 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:34:23.605393 [info ] [MainThread]: 
[0m21:34:23.608089 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:34:23.609516 [info ] [MainThread]: 
[0m21:34:23.611182 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:34:23.612602 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:23.614644 [info ] [MainThread]: 
[0m21:34:23.616738 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:23.618166 [info ] [MainThread]: 
[0m21:34:23.620672 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:34:23.623511 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:23.625443 [info ] [MainThread]: 
[0m21:34:23.627859 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:23.630954 [info ] [MainThread]: 
[0m21:34:23.633860 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:34:23.635744 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:34:23.637831 [info ] [MainThread]: 
[0m21:34:23.640032 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:34:23.642392 [info ] [MainThread]: 
[0m21:34:23.643508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:34:23.646581 [debug] [MainThread]: Command `dbt run` failed at 21:34:23.646230 after 3.61 seconds
[0m21:34:23.647639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE291DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0DEB8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0DEBB90>]}
[0m21:34:23.648625 [debug] [MainThread]: Flushing usage events
[0m21:34:25.028756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:48.507957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91D8C0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91F258910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91F89BED0>]}


============================== 21:36:48.523930 | 02d516c5-d4d3-48a3-8990-0bde6a2f6601 ==============================
[0m21:36:48.523930 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:36:48.525453 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m21:36:48.927083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91DAF9F30>]}
[0m21:36:49.037209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91F923DF0>]}
[0m21:36:49.038803 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:36:49.547891 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:36:49.839826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:49.840329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:49.847710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_sales
- snapshots.dw_northwind_metabase
[0m21:36:49.934018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FE68D50>]}
[0m21:36:50.060065 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:36:50.063577 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:36:50.185881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FEBC5F0>]}
[0m21:36:50.186568 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:36:50.187364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FA6D8D0>]}
[0m21:36:50.194414 [info ] [MainThread]: 
[0m21:36:50.195262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:50.195981 [info ] [MainThread]: 
[0m21:36:50.196899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:50.204002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:36:50.463982 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:36:50.464520 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:36:50.464908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:50.574368 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.109 seconds
[0m21:36:50.576063 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:36:50.578522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:36:50.586814 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:36:50.587308 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:36:50.587667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:50.728687 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m21:36:50.736963 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:36:50.738013 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:36:50.771427 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m21:36:50.775200 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:36:50.776485 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:36:50.790483 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.791409 [debug] [MainThread]: On master: BEGIN
[0m21:36:50.795622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:50.919612 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m21:36:50.920744 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.922024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:36:50.954180 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m21:36:50.957046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9200F2C30>]}
[0m21:36:50.958440 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:50.959901 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.960860 [debug] [MainThread]: On master: BEGIN
[0m21:36:50.962279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:36:50.963149 [debug] [MainThread]: On master: COMMIT
[0m21:36:50.963961 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.964911 [debug] [MainThread]: On master: COMMIT
[0m21:36:50.966058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:50.966934 [debug] [MainThread]: On master: Close
[0m21:36:50.988231 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:50.989469 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:50.990594 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:50.991707 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:50.993111 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:36:50.994483 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:36:50.999316 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:36:50.997680 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:36:51.001083 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:36:50.996374 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:36:51.002478 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:51.004858 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:36:51.007161 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:51.008742 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:36:51.036305 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:51.055561 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.056948 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.058279 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:51.069637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.079055 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.081457 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:51.093709 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:51.094889 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:51.195785 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.196892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.205417 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.206384 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:51.215678 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.217123 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.218444 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.219558 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:36:51.220873 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:36:51.222695 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.223729 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:36:51.225042 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.226163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:51.227286 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:36:51.228563 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:36:51.229926 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:36:51.230985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:36:51.335904 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m21:36:51.337018 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.338136 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
  );
[0m21:36:51.345479 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.customer"
LINE 25: from "northwind"."public"."customer"
              ^

[0m21:36:51.346673 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:36:51.348204 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:36:51.354814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.129 seconds
[0m21:36:51.355962 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.357222 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
  );
[0m21:36:51.359524 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.accounts"
LINE 28: from "sample_metabase_pg"."public"."accounts" a
              ^

[0m21:36:51.360618 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:36:51.361797 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:36:51.366000 [debug] [Thread-4 (]: SQL status: BEGIN in 0.135 seconds
[0m21:36:51.367342 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.368382 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
  );
[0m21:36:51.370327 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.orderdetail"
LINE 21: from "northwind"."public"."orderdetail" od
              ^

[0m21:36:51.371350 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:36:51.372357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.142 seconds
[0m21:36:51.373481 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:36:51.374264 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.375503 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
  );
[0m21:36:51.380034 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.orders"
LINE 24: from "sample_metabase_pg"."public"."orders" o
              ^

[0m21:36:51.381166 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:36:51.382715 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:36:51.397445 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:36:51.405153 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:36:51.406808 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:36:51.411516 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:36:51.412559 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FF0F350>]}
[0m21:36:51.413119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920142360>]}
[0m21:36:51.414717 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920348730>]}
[0m21:36:51.414141 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.40s]
[0m21:36:51.415476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91DA82210>]}
[0m21:36:51.416475 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.40s]
[0m21:36:51.418725 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:51.417481 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.41s]
[0m21:36:51.420818 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:51.421544 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.422562 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:36:51.419737 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.40s]
[0m21:36:51.423841 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:51.426977 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:36:51.424916 [info ] [Thread-3 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:36:51.428864 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:51.430753 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:36:51.431894 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:36:51.433583 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:36:51.434511 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.439321 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.440944 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.445616 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.447236 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.449165 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:36:51.450182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:36:51.528037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.078 seconds
[0m21:36:51.528894 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.529623 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
  );
[0m21:36:51.531119 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.salesorder"
LINE 25: from "northwind"."public"."salesorder" o
              ^

[0m21:36:51.531711 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:36:51.532607 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:36:51.540482 [debug] [Thread-3 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:36:51.541269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FF7BCB0>]}
[0m21:36:51.542210 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.11s]
[0m21:36:51.543468 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.544368 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:36:51.546501 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:51.547074 [debug] [MainThread]: On master: BEGIN
[0m21:36:51.547551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:51.618580 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m21:36:51.619267 [debug] [MainThread]: On master: COMMIT
[0m21:36:51.619762 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:51.620244 [debug] [MainThread]: On master: COMMIT
[0m21:36:51.621034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:51.621571 [debug] [MainThread]: On master: Close
[0m21:36:51.622275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:51.622727 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:36:51.623252 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:36:51.623640 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:36:51.624085 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:36:51.624592 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:36:51.625036 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:36:51.625605 [info ] [MainThread]: 
[0m21:36:51.626380 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m21:36:51.628768 [debug] [MainThread]: Command end result
[0m21:36:51.746736 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:36:51.751639 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:36:51.762995 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:36:51.763762 [info ] [MainThread]: 
[0m21:36:51.764738 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:36:51.765581 [info ] [MainThread]: 
[0m21:36:51.766520 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:36:51.767331 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:36:51.768029 [info ] [MainThread]: 
[0m21:36:51.768948 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:36:51.769711 [info ] [MainThread]: 
[0m21:36:51.771305 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:36:51.772492 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:36:51.773629 [info ] [MainThread]: 
[0m21:36:51.775309 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:36:51.776463 [info ] [MainThread]: 
[0m21:36:51.778022 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:36:51.780509 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:36:51.782297 [info ] [MainThread]: 
[0m21:36:51.783913 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:36:51.785146 [info ] [MainThread]: 
[0m21:36:51.786591 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:36:51.788008 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:36:51.790216 [info ] [MainThread]: 
[0m21:36:51.791729 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:36:51.792748 [info ] [MainThread]: 
[0m21:36:51.793845 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:36:51.794738 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:36:51.795692 [info ] [MainThread]: 
[0m21:36:51.796572 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:36:51.797616 [info ] [MainThread]: 
[0m21:36:51.799343 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:36:51.802005 [debug] [MainThread]: Command `dbt run` failed at 21:36:51.801687 after 3.61 seconds
[0m21:36:51.803185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FB34A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920388D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920388CB0>]}
[0m21:36:51.804062 [debug] [MainThread]: Flushing usage events
[0m21:36:53.069525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:41.464858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA5FD0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6878910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6EBBED0>]}


============================== 21:37:41.470087 | c5225a24-6408-4d9e-bf73-be32a1f69ea0 ==============================
[0m21:37:41.470087 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:37:41.471077 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:37:41.712426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6209F30>]}
[0m21:37:41.897992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8023DF0>]}
[0m21:37:41.900224 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:37:42.385832 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:37:42.573856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:42.574355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:42.587588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- snapshots.dw_northwind_metabase
[0m21:37:42.676803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8564D50>]}
[0m21:37:42.812905 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:37:42.817455 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:37:42.850920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA85C85F0>]}
[0m21:37:42.851989 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:37:42.852920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA816D8D0>]}
[0m21:37:42.855770 [info ] [MainThread]: 
[0m21:37:42.856432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:42.856930 [info ] [MainThread]: 
[0m21:37:42.857826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:42.863539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:37:42.983602 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:37:42.984368 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:37:42.985177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:43.066130 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.081 seconds
[0m21:37:43.068064 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:37:43.071600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:37:43.078995 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:37:43.079530 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:37:43.079945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:43.151802 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:37:43.152344 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:37:43.152781 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:37:43.162736 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m21:37:43.164785 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:37:43.165695 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:37:43.171800 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.172326 [debug] [MainThread]: On master: BEGIN
[0m21:37:43.172713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:43.237538 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m21:37:43.238058 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.238543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:37:43.250329 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m21:37:43.251866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA87EEC30>]}
[0m21:37:43.252435 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:43.253106 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.253521 [debug] [MainThread]: On master: BEGIN
[0m21:37:43.254255 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:37:43.254649 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.255046 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.255415 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.255948 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:43.256398 [debug] [MainThread]: On master: Close
[0m21:37:43.263800 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.264449 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.265036 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.265570 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.266258 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:37:43.267010 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:37:43.269371 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:37:43.267593 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:37:43.270263 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:37:43.270921 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.268435 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:37:43.271752 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:37:43.272248 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.282257 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.283537 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:37:43.284425 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.288701 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.289502 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.294162 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.298980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.299778 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.322098 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.361136 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.364683 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.365424 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.366524 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.371505 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.378820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.379882 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.380978 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.381555 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:37:43.382137 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:37:43.382816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:37:43.383722 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:37:43.384838 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.385509 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.386373 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:37:43.387219 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:37:43.387992 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:37:43.388729 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:43.487457 [debug] [Thread-3 (]: SQL status: BEGIN in 0.105 seconds
[0m21:37:43.488542 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.489610 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
  );
[0m21:37:43.491675 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.customer"
LINE 25: from "northwind"."public"."customer"
              ^

[0m21:37:43.492644 [debug] [Thread-2 (]: SQL status: BEGIN in 0.109 seconds
[0m21:37:43.493495 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:37:43.494515 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.495769 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
  );
[0m21:37:43.497062 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:37:43.500312 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.orders"
LINE 24: from "sample_metabase_pg"."public"."orders" o
              ^

[0m21:37:43.501391 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:37:43.502874 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:37:43.509182 [debug] [Thread-4 (]: SQL status: BEGIN in 0.121 seconds
[0m21:37:43.510262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m21:37:43.511263 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.512608 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.514190 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
  );
[0m21:37:43.515632 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
  );
[0m21:37:43.517962 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.orderdetail"
LINE 21: from "northwind"."public"."orderdetail" od
              ^

[0m21:37:43.518768 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.accounts"
LINE 28: from "sample_metabase_pg"."public"."accounts" a
              ^

[0m21:37:43.519355 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:37:43.520020 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:37:43.521502 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:37:43.522961 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:37:43.545560 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:37:43.548291 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:37:43.552510 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:37:43.556960 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:37:43.558760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA86031D0>]}
[0m21:37:43.559325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA883E200>]}
[0m21:37:43.560690 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA88F6710>]}
[0m21:37:43.560198 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.28s]
[0m21:37:43.561427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6192210>]}
[0m21:37:43.562372 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.29s]
[0m21:37:43.564445 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.563410 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.29s]
[0m21:37:43.566359 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.567294 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.565383 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.27s]
[0m21:37:43.568625 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:37:43.569592 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.571673 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.570665 [info ] [Thread-4 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:37:43.573679 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:37:43.574946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:37:43.576191 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:37:43.576838 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.577691 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:37:43.584394 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.588301 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.694172 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.696916 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.697987 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:37:43.698729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:37:43.802051 [debug] [Thread-4 (]: SQL status: BEGIN in 0.103 seconds
[0m21:37:43.803719 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.804941 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
  );
[0m21:37:43.807102 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.salesorder"
LINE 25: from "northwind"."public"."salesorder" o
              ^

[0m21:37:43.807911 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:37:43.809072 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:37:43.820929 [debug] [Thread-4 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:37:43.822012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8A83380>]}
[0m21:37:43.823178 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.25s]
[0m21:37:43.824812 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.825913 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:37:43.829164 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.830172 [debug] [MainThread]: On master: BEGIN
[0m21:37:43.831080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:43.936931 [debug] [MainThread]: SQL status: BEGIN in 0.106 seconds
[0m21:37:43.937533 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.938008 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.938429 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.939170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:43.940005 [debug] [MainThread]: On master: Close
[0m21:37:43.941321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:43.942007 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:37:43.942658 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:37:43.943167 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:37:43.943692 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:37:43.944326 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:37:43.944912 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:37:43.945646 [info ] [MainThread]: 
[0m21:37:43.946612 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m21:37:43.948778 [debug] [MainThread]: Command end result
[0m21:37:43.994888 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:37:43.999687 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:37:44.014029 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:37:44.014940 [info ] [MainThread]: 
[0m21:37:44.015934 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:37:44.016732 [info ] [MainThread]: 
[0m21:37:44.018314 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:37:44.019553 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:37:44.020518 [info ] [MainThread]: 
[0m21:37:44.021924 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:37:44.023059 [info ] [MainThread]: 
[0m21:37:44.023853 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:37:44.024541 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:37:44.025149 [info ] [MainThread]: 
[0m21:37:44.025780 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:37:44.026509 [info ] [MainThread]: 
[0m21:37:44.027569 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:37:44.028844 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:37:44.029934 [info ] [MainThread]: 
[0m21:37:44.030805 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:37:44.031426 [info ] [MainThread]: 
[0m21:37:44.032090 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:37:44.033416 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:37:44.034710 [info ] [MainThread]: 
[0m21:37:44.035711 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:37:44.036508 [info ] [MainThread]: 
[0m21:37:44.037364 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:37:44.038600 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:37:44.039408 [info ] [MainThread]: 
[0m21:37:44.040438 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:37:44.041290 [info ] [MainThread]: 
[0m21:37:44.042634 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:37:44.045652 [debug] [MainThread]: Command `dbt run` failed at 21:37:44.045369 after 2.74 seconds
[0m21:37:44.046336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8A5C3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8AAFA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8AAFA10>]}
[0m21:37:44.046981 [debug] [MainThread]: Flushing usage events
[0m21:37:45.166961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:58.544759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8825B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C882E58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88449BED0>]}


============================== 21:39:58.550411 | 0e92d187-5895-46c1-aed0-6e22a314815d ==============================
[0m21:39:58.550411 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:39:58.551279 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:39:58.817223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8827E9F30>]}
[0m21:39:58.901550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884523DF0>]}
[0m21:39:58.902869 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:39:59.295496 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:39:59.497544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:39:59.499038 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\staging.yml
[0m21:40:00.319207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.dw
- snapshots.dw_northwind_metabase
[0m21:40:00.335475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884A65650>]}
[0m21:40:00.446447 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:40:00.449778 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:40:00.479002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884AC8410>]}
[0m21:40:00.479639 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:40:00.480329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8846DD8D0>]}
[0m21:40:00.482845 [info ] [MainThread]: 
[0m21:40:00.483809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:40:00.484402 [info ] [MainThread]: 
[0m21:40:00.485309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:00.492916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:40:00.592158 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:40:00.592842 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:40:00.593572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:00.663695 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.070 seconds
[0m21:40:00.665407 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:40:00.668053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:40:00.675481 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:40:00.675975 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:40:00.676355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:00.750126 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m21:40:00.750630 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:40:00.751061 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:40:00.761061 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m21:40:00.762770 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:40:00.763397 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:40:00.769532 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.770041 [debug] [MainThread]: On master: BEGIN
[0m21:40:00.770413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:00.838639 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m21:40:00.839168 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.839678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:40:00.850955 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m21:40:00.852539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884FE9A50>]}
[0m21:40:00.853091 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:00.853860 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.854259 [debug] [MainThread]: On master: BEGIN
[0m21:40:00.854999 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:40:00.855380 [debug] [MainThread]: On master: COMMIT
[0m21:40:00.855749 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.856117 [debug] [MainThread]: On master: COMMIT
[0m21:40:00.856711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:00.857177 [debug] [MainThread]: On master: Close
[0m21:40:00.866180 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:00.866780 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:00.867363 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:00.867901 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:00.868592 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:40:00.869335 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:40:00.871588 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:40:00.872350 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:40:00.872864 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:00.870134 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:40:00.873530 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:00.870750 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:40:00.885020 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:00.886066 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:40:00.891188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:00.892026 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:40:00.892801 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:00.893763 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:00.894436 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:00.903320 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:00.908863 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:00.909880 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:00.954659 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:00.959172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:00.960311 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:00.964872 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:00.966136 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:00.966898 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:00.967458 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:00.971709 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:00.972399 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:40:00.973092 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:40:00.973864 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:00.974605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:40:00.975227 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:40:00.975845 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:40:00.976791 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:00.977860 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:40:00.978855 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:40:00.980023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:40:01.056922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m21:40:01.057867 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.058930 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m21:40:01.068204 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m21:40:01.068983 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:01.069617 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m21:40:01.072369 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column o.state does not exist
LINE 16:     o.state                                  as order_state,
             ^

[0m21:40:01.073169 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:40:01.074224 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:40:01.077770 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m21:40:01.078686 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.079564 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m21:40:01.080498 [debug] [Thread-3 (]: SQL status: BEGIN in 0.100 seconds
[0m21:40:01.081182 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.081865 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m21:40:01.083661 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m21:40:01.092036 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.092659 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:40:01.093247 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m21:40:01.093758 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m21:40:01.097346 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.101107 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.101979 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m21:40:01.102782 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m21:40:01.103422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:40:01.122687 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:40:01.123374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m21:40:01.124063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m21:40:01.124621 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.126668 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:40:01.128506 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:40:01.129130 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:40:01.129681 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.130251 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.130991 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:40:01.131622 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:40:01.132661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:40:01.140427 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m21:40:01.141494 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m21:40:01.142048 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m21:40:01.148719 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.151646 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m21:40:01.154397 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m21:40:01.155015 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m21:40:01.156098 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.157039 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.157746 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m21:40:01.158349 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m21:40:01.162501 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:40:01.165835 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:40:01.166417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m21:40:01.167170 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m21:40:01.168255 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.state does not exist
  LINE 16:     o.state                                  as order_state,
               ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:40:01.171907 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:40:01.173727 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:40:01.174958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884E42E10>]}
[0m21:40:01.175896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8861BC520>]}
[0m21:40:01.176620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8861BC680>]}
[0m21:40:01.177330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88619BBB0>]}
[0m21:40:01.178317 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.28s]
[0m21:40:01.182504 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:01.183055 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.179410 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.29s]
[0m21:40:01.184747 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:01.180811 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.30s]
[0m21:40:01.186279 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:01.181714 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.31s]
[0m21:40:01.187535 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.state does not exist
  LINE 16:     o.state                                  as order_state,
               ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:40:01.188512 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:01.183973 [info ] [Thread-3 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:40:01.190665 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:40:01.191572 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.197621 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.198965 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.202867 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.204525 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.205458 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:40:01.206731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:40:01.278913 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m21:40:01.279501 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.280065 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m21:40:01.282048 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column o.shipvia does not exist
LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                             ^
HINT:  Perhaps you meant to reference the column "o.shipcity".

[0m21:40:01.282609 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:40:01.283338 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:40:01.289473 [debug] [Thread-3 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  column o.shipvia does not exist
  LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                               ^
  HINT:  Perhaps you meant to reference the column "o.shipcity".
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:40:01.290215 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884ADFAF0>]}
[0m21:40:01.291036 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.10s]
[0m21:40:01.292333 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.293256 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  column o.shipvia does not exist
  LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                               ^
  HINT:  Perhaps you meant to reference the column "o.shipcity".
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:40:01.295241 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.295688 [debug] [MainThread]: On master: BEGIN
[0m21:40:01.296065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:01.362368 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m21:40:01.362883 [debug] [MainThread]: On master: COMMIT
[0m21:40:01.363316 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.363694 [debug] [MainThread]: On master: COMMIT
[0m21:40:01.364291 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:01.364733 [debug] [MainThread]: On master: Close
[0m21:40:01.365373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:01.365772 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:40:01.366134 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:40:01.366478 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:40:01.366861 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:40:01.367204 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:40:01.367548 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:40:01.368026 [info ] [MainThread]: 
[0m21:40:01.368815 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m21:40:01.370848 [debug] [MainThread]: Command end result
[0m21:40:01.403473 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:40:01.409046 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:40:01.417483 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:40:01.418120 [info ] [MainThread]: 
[0m21:40:01.418852 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:40:01.419601 [info ] [MainThread]: 
[0m21:40:01.420851 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:40:01.421800 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.state does not exist
  LINE 16:     o.state                                  as order_state,
               ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:40:01.422868 [info ] [MainThread]: 
[0m21:40:01.423914 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:40:01.424951 [info ] [MainThread]: 
[0m21:40:01.426024 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:40:01.426898 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  column o.shipvia does not exist
  LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                               ^
  HINT:  Perhaps you meant to reference the column "o.shipcity".
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:40:01.427541 [info ] [MainThread]: 
[0m21:40:01.428201 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:40:01.428868 [info ] [MainThread]: 
[0m21:40:01.429766 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m21:40:01.431652 [debug] [MainThread]: Command `dbt run` failed at 21:40:01.431401 after 3.06 seconds
[0m21:40:01.432236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8862C2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C882E11970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8861FF410>]}
[0m21:40:01.432763 [debug] [MainThread]: Flushing usage events
[0m21:40:02.799721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:19.549357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355CCD0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355D578B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DBB8E10>]}


============================== 21:41:19.556505 | 411553cd-3353-47e8-b672-28cf53b7437c ==============================
[0m21:41:19.556505 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:41:19.557310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'invocation_command': 'dbt run --select staging', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:41:19.829943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355CF09F30>]}
[0m21:41:19.925225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DC3FDF0>]}
[0m21:41:19.926534 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:41:20.393926 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:41:20.629284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:41:20.630151 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m21:41:20.630731 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_orders.sql
[0m21:41:21.294865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
- snapshots.dw_northwind_metabase
[0m21:41:21.314782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F268B50>]}
[0m21:41:21.470220 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:21.473730 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:21.506917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F2C4410>]}
[0m21:41:21.507809 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:41:21.508549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DE1D1D0>]}
[0m21:41:21.512079 [info ] [MainThread]: 
[0m21:41:21.512734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:21.513360 [info ] [MainThread]: 
[0m21:41:21.514423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:41:21.522245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:41:21.631135 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:41:21.631731 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:41:21.632187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:21.719411 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.087 seconds
[0m21:41:21.721458 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:41:21.724566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:41:21.732179 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:21.732711 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:41:21.733161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:21.805853 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m21:41:21.806421 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:21.806880 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:41:21.820078 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.013 seconds
[0m21:41:21.822764 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:41:21.823593 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:41:21.830336 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.830874 [debug] [MainThread]: On master: BEGIN
[0m21:41:21.831262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:21.908290 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m21:41:21.908864 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.909405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:41:21.923541 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m21:41:21.926326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F8401F0>]}
[0m21:41:21.927463 [debug] [MainThread]: On master: ROLLBACK
[0m21:41:21.928496 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.929174 [debug] [MainThread]: On master: BEGIN
[0m21:41:21.930339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:41:21.931095 [debug] [MainThread]: On master: COMMIT
[0m21:41:21.931824 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.932510 [debug] [MainThread]: On master: COMMIT
[0m21:41:21.933665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:21.934683 [debug] [MainThread]: On master: Close
[0m21:41:22.111555 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.113123 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.114191 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.115124 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.115941 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:41:22.117068 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:41:22.118724 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:41:22.122217 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:41:22.120612 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:41:22.123767 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:41:22.124908 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:41:22.125828 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.126690 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:41:22.127427 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.128525 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.143925 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.148998 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.157849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.165025 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.172867 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.175830 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.189122 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.290570 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.291383 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.293750 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.301626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.303182 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.312326 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.313664 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.315251 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:41:22.316422 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.317626 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:41:22.318898 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:41:22.320206 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.321635 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.322869 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:41:22.323963 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:41:22.325044 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:41:22.326492 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:22.327621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:22.435996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.118 seconds
[0m21:41:22.437242 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.438552 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m21:41:22.451893 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:41:22.466358 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.467502 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m21:41:22.468769 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m21:41:22.470325 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.471568 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m21:41:22.472809 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:41:22.474379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m21:41:22.475103 [debug] [Thread-2 (]: SQL status: BEGIN in 0.149 seconds
[0m21:41:22.481181 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.482352 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.483390 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.484719 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m21:41:22.486525 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m21:41:22.488021 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m21:41:22.490349 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m21:41:22.495369 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.496196 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column o.price does not exist
LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                  ^

[0m21:41:22.497025 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m21:41:22.497727 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:41:22.498459 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:41:22.515367 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m21:41:22.527559 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:22.528371 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m21:41:22.533352 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.534570 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:41:22.535690 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.541449 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.542169 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m21:41:22.543029 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:22.545373 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m21:41:22.547483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:22.550522 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:22.551546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:41:22.552384 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.553226 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m21:41:22.557386 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.558202 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:22.567642 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m21:41:22.568781 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m21:41:22.577311 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.578241 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m21:41:22.580312 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m21:41:22.581040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:41:22.584680 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m21:41:22.588281 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:22.589765 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.590539 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.591187 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m21:41:22.591824 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:22.594451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:41:22.595132 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m21:41:22.598721 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m21:41:22.599322 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m21:41:22.603485 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:41:22.604961 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.607050 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:41:22.607868 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m21:41:22.613168 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F496510>]}
[0m21:41:22.614039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F49B8B0>]}
[0m21:41:22.615108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:41:22.616608 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.49s]
[0m21:41:22.622205 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:41:22.618800 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.49s]
[0m21:41:22.623680 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.630860 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.632265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F9BC870>]}
[0m21:41:22.633731 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.635681 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.price does not exist
  LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                    ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:41:22.637481 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.51s]
[0m21:41:22.638888 [info ] [Thread-4 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:41:22.640089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F84CC50>]}
[0m21:41:22.641284 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.642305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:41:22.644425 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.643361 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.51s]
[0m21:41:22.650025 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.651652 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.653161 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.price does not exist
  LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                    ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:41:22.656228 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.661905 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.663764 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.664736 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:41:22.665567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:41:22.756443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m21:41:22.757265 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.757986 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m21:41:22.772404 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m21:41:22.777664 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.778332 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m21:41:22.779613 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:22.781547 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:22.782213 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.782728 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:22.785157 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:41:22.788214 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m21:41:22.789265 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.789800 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m21:41:22.791052 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:41:22.793475 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:41:22.794517 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F92F930>]}
[0m21:41:22.795526 [info ] [Thread-4 (]: 5 of 5 OK created sql view model dw_stg.stg_northwind_orders ................... [[32mCREATE VIEW[0m in 0.15s]
[0m21:41:22.796728 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.799849 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:22.800738 [debug] [MainThread]: On master: BEGIN
[0m21:41:22.801513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:22.880303 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m21:41:22.880883 [debug] [MainThread]: On master: COMMIT
[0m21:41:22.881317 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:22.881726 [debug] [MainThread]: On master: COMMIT
[0m21:41:22.882333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:22.882787 [debug] [MainThread]: On master: Close
[0m21:41:22.883470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:22.884223 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:41:22.884742 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:41:22.885127 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:41:22.885585 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:41:22.886014 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:41:22.886385 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:41:22.886912 [info ] [MainThread]: 
[0m21:41:22.887425 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m21:41:22.889838 [debug] [MainThread]: Command end result
[0m21:41:22.927322 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:22.931632 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:22.942125 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:41:22.942828 [info ] [MainThread]: 
[0m21:41:22.943383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:41:22.944132 [info ] [MainThread]: 
[0m21:41:22.945301 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:41:22.946671 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.price does not exist
  LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                    ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:41:22.947954 [info ] [MainThread]: 
[0m21:41:22.949450 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:41:22.951271 [info ] [MainThread]: 
[0m21:41:22.952492 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m21:41:22.956087 [debug] [MainThread]: Command `dbt run` failed at 21:41:22.955524 after 3.60 seconds
[0m21:41:22.958363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F9C0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DAC77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F326270>]}
[0m21:41:22.959578 [debug] [MainThread]: Flushing usage events
[0m21:41:24.273091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:40.248132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E808E0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82254B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82898E10>]}


============================== 21:41:40.253982 | a3817bc2-42fa-428c-a625-83168ad5ebe6 ==============================
[0m21:41:40.253982 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:41:40.254779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:41:40.531901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E80B19F30>]}
[0m21:41:40.627069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8291FDF0>]}
[0m21:41:40.628560 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:41:41.089890 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:41:41.318849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:41:41.319830 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m21:41:42.057707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- snapshots.dw_northwind_metabase
[0m21:41:42.081166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82E68950>]}
[0m21:41:42.206746 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:42.212150 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:42.243608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82EC7110>]}
[0m21:41:42.244405 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:41:42.244978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82ADC670>]}
[0m21:41:42.248422 [info ] [MainThread]: 
[0m21:41:42.249154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:42.249985 [info ] [MainThread]: 
[0m21:41:42.251068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:41:42.258376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:41:42.365497 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:41:42.366027 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:41:42.366428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:42.455186 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.089 seconds
[0m21:41:42.457291 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:41:42.461407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:41:42.470754 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:42.471691 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:41:42.472444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:42.549040 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m21:41:42.549698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:42.550221 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:41:42.561880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m21:41:42.563734 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:41:42.564503 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:41:42.571281 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.571787 [debug] [MainThread]: On master: BEGIN
[0m21:41:42.572223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:42.645550 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m21:41:42.646090 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.646610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:41:42.660044 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m21:41:42.661843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E834282C0>]}
[0m21:41:42.662442 [debug] [MainThread]: On master: ROLLBACK
[0m21:41:42.663174 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.663614 [debug] [MainThread]: On master: BEGIN
[0m21:41:42.664441 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:41:42.664849 [debug] [MainThread]: On master: COMMIT
[0m21:41:42.665251 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.665647 [debug] [MainThread]: On master: COMMIT
[0m21:41:42.666198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:42.666650 [debug] [MainThread]: On master: Close
[0m21:41:42.674468 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:42.675811 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:42.676858 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:42.677697 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:42.678634 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:41:42.679538 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:41:42.680686 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:41:42.681774 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:41:42.682930 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:41:42.683970 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:41:42.684729 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:41:42.685471 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:41:42.686321 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:42.686942 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:42.687581 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:42.688334 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:42.699364 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.704235 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.709380 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.715738 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.718172 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:42.719056 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:42.719896 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:42.739543 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:42.804234 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.808612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.814988 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.822686 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.824636 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.826274 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.827242 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:41:42.828273 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:41:42.829328 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:41:42.830384 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.831257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:42.831868 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.832715 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:41:42.833560 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:41:42.834200 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:41:42.834847 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:42.922604 [debug] [Thread-4 (]: SQL status: BEGIN in 0.093 seconds
[0m21:41:42.923659 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.924458 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m21:41:42.934056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m21:41:42.935035 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.935831 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:41:42.936545 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m21:41:42.946614 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.947432 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m21:41:42.948078 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m21:41:42.948677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m21:41:42.949201 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.949962 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.950568 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:42.951161 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m21:41:42.951917 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m21:41:42.956964 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.957973 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m21:41:42.959269 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:41:42.960333 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:42.964590 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.985372 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m21:41:42.986371 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m21:41:42.995677 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:42.996341 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m21:41:43.001044 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:43.004777 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.005430 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:43.006143 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m21:41:43.006744 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m21:41:43.007294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:43.007940 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:43.013393 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:43.014031 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m21:41:43.014567 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:41:43.015252 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m21:41:43.020358 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.021027 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m21:41:43.022889 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m21:41:43.023563 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m21:41:43.033038 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m21:41:43.033680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m21:41:43.034239 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:43.042487 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:43.043440 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m21:41:43.045646 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:43.046308 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m21:41:43.047081 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m21:41:43.049197 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:43.049786 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:43.050590 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.051264 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:43.051848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:41:43.052381 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:43.052894 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:43.056396 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m21:41:43.057009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:41:43.061923 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:41:43.062800 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:41:43.063941 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:43.066775 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m21:41:43.070581 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m21:41:43.073039 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m21:41:43.074284 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:43.075726 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.076914 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m21:41:43.077765 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m21:41:43.078522 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:43.079488 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8306A5D0>]}
[0m21:41:43.082256 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:41:43.082865 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:41:43.084244 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m21:41:43.083709 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.39s]
[0m21:41:43.087246 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:41:43.088384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8309FA10>]}
[0m21:41:43.091387 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:41:43.093193 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:43.095141 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.40s]
[0m21:41:43.096720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E831A13B0>]}
[0m21:41:43.098069 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.099488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E834E28D0>]}
[0m21:41:43.100948 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:43.102361 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.41s]
[0m21:41:43.103630 [info ] [Thread-4 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:41:43.107001 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:43.105147 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.42s]
[0m21:41:43.108126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:41:43.109712 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:43.110403 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.115124 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.116665 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.122384 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.124192 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.125093 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:41:43.126021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:41:43.206791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.081 seconds
[0m21:41:43.207711 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.208638 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m21:41:43.220225 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:41:43.224691 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.225526 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m21:41:43.227298 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:43.231149 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.231726 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m21:41:43.232968 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:43.235071 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:43.235616 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.236096 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:43.238287 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:41:43.242185 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m21:41:43.243689 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.244375 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m21:41:43.247399 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:43.249751 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:41:43.250683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E834A88A0>]}
[0m21:41:43.251624 [info ] [Thread-4 (]: 5 of 5 OK created sql view model dw_stg.stg_northwind_orders ................... [[32mCREATE VIEW[0m in 0.14s]
[0m21:41:43.252605 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.255701 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:43.256456 [debug] [MainThread]: On master: BEGIN
[0m21:41:43.257054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:43.336724 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m21:41:43.337322 [debug] [MainThread]: On master: COMMIT
[0m21:41:43.337742 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:43.338181 [debug] [MainThread]: On master: COMMIT
[0m21:41:43.338926 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:43.339429 [debug] [MainThread]: On master: Close
[0m21:41:43.340129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:43.340558 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:41:43.340996 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:41:43.341367 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:41:43.341961 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:41:43.342678 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:41:43.343530 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:41:43.344376 [info ] [MainThread]: 
[0m21:41:43.344993 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m21:41:43.347889 [debug] [MainThread]: Command end result
[0m21:41:43.385581 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:43.391561 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:43.402097 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:41:43.402803 [info ] [MainThread]: 
[0m21:41:43.403553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:43.404245 [info ] [MainThread]: 
[0m21:41:43.405421 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:41:43.407884 [debug] [MainThread]: Command `dbt run` succeeded at 21:41:43.407598 after 3.34 seconds
[0m21:41:43.408923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E80A027B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82F2BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E83507B30>]}
[0m21:41:43.410155 [debug] [MainThread]: Flushing usage events
[0m21:41:44.838395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:33.130760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249AE9B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0258B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0898E10>]}


============================== 22:36:33.150061 | 6c4702f6-4380-48e9-bf1a-79208a4a5cbd ==============================
[0m22:36:33.150061 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:36:33.151910 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'printer_width': '80', 'target_path': 'None'}
[0m22:36:33.760171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249AEBE9F30>]}
[0m22:36:33.827454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B090FDF0>]}
[0m22:36:33.830483 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:36:34.442258 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:36:35.629329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m22:36:35.630025 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\fact_sales.sql
[0m22:36:35.630466 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\intermediate\int_customers.sql
[0m22:36:35.630877 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://snapshots\customers_snapshot.sql
[0m22:36:35.631468 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dw.yml
[0m22:36:35.632010 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\intermediate\intermediate.yml
[0m22:36:35.632598 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_customer.sql
[0m22:36:36.463397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
[0m22:36:36.481334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0E6B150>]}
[0m22:36:36.613154 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:36:36.618772 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:36:36.911934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B109A030>]}
[0m22:36:36.913259 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:36:36.914345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0B46B30>]}
[0m22:36:36.921499 [info ] [MainThread]: 
[0m22:36:36.922250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:36:36.922972 [info ] [MainThread]: 
[0m22:36:36.924069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:36.925894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:36:41.657787 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:36:41.658727 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:36:41.659413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.842454 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.183 seconds
[0m22:36:41.845257 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:36:41.856739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:36:41.869430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:36:41.868066 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:36:41.874884 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:36:41.875773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:36:41.876483 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:36:41.877995 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:36:41.881388 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:36:41.881864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.882225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.882584 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:36:41.883271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.973451 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m22:36:41.974065 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m22:36:41.974472 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:36:41.974925 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:36:41.975529 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:36:41.976041 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:36:41.976420 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m22:36:41.977021 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:36:41.977434 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:36:41.991453 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m22:36:41.992108 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m22:36:41.992559 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m22:36:41.994242 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:36:41.996018 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:36:41.998221 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:36:41.999239 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:36:41.999896 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:36:42.000524 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:36:42.011508 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.011995 [debug] [MainThread]: On master: BEGIN
[0m22:36:42.012495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:42.076442 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m22:36:42.076858 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.077234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:36:42.094111 [debug] [MainThread]: SQL status: SELECT 5 in 0.016 seconds
[0m22:36:42.095478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B141AB60>]}
[0m22:36:42.095985 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:42.096541 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.096923 [debug] [MainThread]: On master: BEGIN
[0m22:36:42.097606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:36:42.097995 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.098560 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.099071 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.099722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:36:42.100169 [debug] [MainThread]: On master: Close
[0m22:36:42.111615 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.112263 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m22:36:42.113087 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m22:36:42.114051 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.126084 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.215396 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:36:42.215984 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m22:36:42.216508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:42.289070 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_stg.int_customers" does not exist
LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
              ^

[0m22:36:42.289747 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m22:36:42.486917 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  relation "dw_stg.int_customers" does not exist
  LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
                ^
[0m22:36:42.491559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B1216E10>]}
[0m22:36:42.492987 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.customers_snapshot ......................... [[31mERROR[0m in 0.37s]
[0m22:36:42.493909 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.494753 [debug] [Thread-7 (]: Marking all children of 'snapshot.dw_northwind_metabase.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  relation "dw_stg.int_customers" does not exist
  LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
                ^.
[0m22:36:42.497137 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.497583 [debug] [MainThread]: On master: BEGIN
[0m22:36:42.497942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:42.558380 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m22:36:42.558806 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.559144 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.559432 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.559889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:36:42.560206 [debug] [MainThread]: On master: Close
[0m22:36:42.560716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:42.561043 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:36:42.561328 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:36:42.561628 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:36:42.561922 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:36:42.562228 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m22:36:42.562608 [info ] [MainThread]: 
[0m22:36:42.563046 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m22:36:42.564031 [debug] [MainThread]: Command end result
[0m22:36:42.597699 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:36:42.601394 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:36:42.609072 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:36:42.609520 [info ] [MainThread]: 
[0m22:36:42.610010 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:36:42.610592 [info ] [MainThread]: 
[0m22:36:42.611536 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m22:36:42.612207 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  relation "dw_stg.int_customers" does not exist
  LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
                ^
[0m22:36:42.612823 [info ] [MainThread]: 
[0m22:36:42.613429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:36:42.615348 [debug] [MainThread]: Command `dbt snapshot` failed at 22:36:42.615081 after 9.67 seconds
[0m22:36:42.615957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B15A1FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B1627ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B16276B0>]}
[0m22:36:42.616491 [debug] [MainThread]: Flushing usage events
[0m22:36:43.996475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:01.297044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A70B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A7958B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A7F98E10>]}


============================== 22:37:01.303677 | a2cece7c-b3d0-45f7-8659-0c7cf869ba86 ==============================
[0m22:37:01.303677 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:37:01.305098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --select intermediate', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:37:01.621705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A72E9F30>]}
[0m22:37:01.707018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A901FDF0>]}
[0m22:37:01.708951 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:37:02.203358 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:37:02.486167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:02.489289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:02.508249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m22:37:02.637939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A931F350>]}
[0m22:37:02.826655 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:02.832929 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:02.876043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A95C4C80>]}
[0m22:37:02.877115 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:37:02.877929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A91690F0>]}
[0m22:37:02.881718 [info ] [MainThread]: 
[0m22:37:02.882417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:02.883067 [info ] [MainThread]: 
[0m22:37:02.884048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:02.885885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:37:03.039125 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:37:03.039561 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:37:03.039883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.098347 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.058 seconds
[0m22:37:03.099927 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:37:03.106473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:37:03.113452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:37:03.118054 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:03.120522 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:03.121123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:37:03.121593 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:37:03.122404 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:37:03.124087 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:03.124469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.124818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.125172 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:37:03.125881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.187265 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m22:37:03.187689 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:03.188026 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:37:03.190580 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m22:37:03.191201 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:03.191734 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:37:03.198223 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m22:37:03.200328 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:37:03.201034 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:37:03.203713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:37:03.205261 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:37:03.205866 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:37:03.295305 [debug] [ThreadPool]: SQL status: BEGIN in 0.170 seconds
[0m22:37:03.295983 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:03.296502 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:37:03.305919 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m22:37:03.307254 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:37:03.307786 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:37:03.314829 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.315268 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.315621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:03.370666 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m22:37:03.371046 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.371396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:37:03.382094 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:37:03.384201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9A28A10>]}
[0m22:37:03.384928 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:03.385610 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.386064 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.386872 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:03.387358 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.387824 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.388266 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.388860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:03.389330 [debug] [MainThread]: On master: Close
[0m22:37:03.395348 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m22:37:03.396787 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m22:37:03.398129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m22:37:03.398872 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m22:37:03.414509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m22:37:03.421777 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m22:37:03.474260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m22:37:03.477669 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:03.478734 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m22:37:03.479511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:03.537567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m22:37:03.538283 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:03.539089 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
)
select * from northwind
union all
select * from metabase
;
  );
[0m22:37:03.542472 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 67: ;
         ^

[0m22:37:03.542954 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: ROLLBACK
[0m22:37:03.543733 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m22:37:03.557731 [debug] [Thread-1 (]: Database Error in model int_customers (models\intermediate\int_customers.sql)
  syntax error at or near ";"
  LINE 67: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\intermediate\int_customers.sql
[0m22:37:03.561122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A96CB950>]}
[0m22:37:03.562457 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dw_stg.int_customers ...................... [[31mERROR[0m in 0.16s]
[0m22:37:03.563944 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m22:37:03.565102 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.int_customers' to be skipped because of status 'error'.  Reason: Database Error in model int_customers (models\intermediate\int_customers.sql)
  syntax error at or near ";"
  LINE 67: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\intermediate\int_customers.sql.
[0m22:37:03.568012 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.568668 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.569157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:03.631550 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m22:37:03.632141 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.632614 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.633080 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.633783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:03.634303 [debug] [MainThread]: On master: Close
[0m22:37:03.635131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:03.635693 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:37:03.636112 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:37:03.636521 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:37:03.637057 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:37:03.637560 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m22:37:03.638107 [info ] [MainThread]: 
[0m22:37:03.638738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m22:37:03.640016 [debug] [MainThread]: Command end result
[0m22:37:03.774539 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:03.779182 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:03.790735 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:37:03.791589 [info ] [MainThread]: 
[0m22:37:03.792444 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:37:03.793402 [info ] [MainThread]: 
[0m22:37:03.794352 [error] [MainThread]: [31mFailure in model int_customers (models\intermediate\int_customers.sql)[0m
[0m22:37:03.795247 [error] [MainThread]:   Database Error in model int_customers (models\intermediate\int_customers.sql)
  syntax error at or near ";"
  LINE 67: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\intermediate\int_customers.sql
[0m22:37:03.796156 [info ] [MainThread]: 
[0m22:37:03.796989 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\intermediate\int_customers.sql
[0m22:37:03.797720 [info ] [MainThread]: 
[0m22:37:03.798402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:03.800489 [debug] [MainThread]: Command `dbt run` failed at 22:37:03.800199 after 2.65 seconds
[0m22:37:03.801257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A96B7B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9AAE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9AAE850>]}
[0m22:37:03.801929 [debug] [MainThread]: Flushing usage events
[0m22:37:05.313436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:18.367560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3674B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F367D58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369398E10>]}


============================== 22:37:18.373517 | 3a30c182-0104-4599-82de-cd0a457ce764 ==============================
[0m22:37:18.373517 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:37:18.374184 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select intermediate', 'printer_width': '80', 'target_path': 'None'}
[0m22:37:18.610546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3676E9F30>]}
[0m22:37:18.688399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F36941FDF0>]}
[0m22:37:18.689648 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:37:19.296016 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:37:19.589175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:37:19.590374 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\intermediate\int_customers.sql
[0m22:37:20.274950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2c
[0m22:37:20.295776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F36998DE50>]}
[0m22:37:20.461982 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:20.465297 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:20.542291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3699C7980>]}
[0m22:37:20.543399 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:37:20.544095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3695D9C50>]}
[0m22:37:20.547669 [info ] [MainThread]: 
[0m22:37:20.548620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:20.549402 [info ] [MainThread]: 
[0m22:37:20.550467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:20.552609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:37:20.721594 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:37:20.722254 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:37:20.722712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.804432 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.082 seconds
[0m22:37:20.807157 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:37:20.815449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:37:20.824274 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:20.825436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:37:20.826607 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:37:20.831368 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:20.832459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:37:20.833133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.833950 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:37:20.837811 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:20.838960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.839769 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:37:20.840833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.944314 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m22:37:20.944868 [debug] [ThreadPool]: SQL status: BEGIN in 0.104 seconds
[0m22:37:20.945345 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:20.945788 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m22:37:20.946276 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:20.946792 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:37:20.947338 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:20.948020 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:37:20.948867 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:37:20.961783 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m22:37:20.962400 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m22:37:20.964098 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:37:20.964606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m22:37:20.966751 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:37:20.969345 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:37:20.970314 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:37:20.971319 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:37:20.972333 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:37:20.983348 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:20.983841 [debug] [MainThread]: On master: BEGIN
[0m22:37:20.984248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:21.175506 [debug] [MainThread]: SQL status: BEGIN in 0.191 seconds
[0m22:37:21.176227 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.177031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:37:21.194145 [debug] [MainThread]: SQL status: SELECT 5 in 0.016 seconds
[0m22:37:21.196759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369E746D0>]}
[0m22:37:21.197678 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:21.198760 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.199452 [debug] [MainThread]: On master: BEGIN
[0m22:37:21.200581 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:21.201682 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.203396 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.204703 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.205896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:21.206900 [debug] [MainThread]: On master: Close
[0m22:37:21.215239 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m22:37:21.216328 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m22:37:21.217420 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m22:37:21.219840 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m22:37:21.253715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m22:37:21.257150 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m22:37:21.346026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m22:37:21.347834 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.348867 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m22:37:21.349439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:21.417955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m22:37:21.418987 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.419689 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
)
select * from northwind
union all
select * from metabase
  );
[0m22:37:21.475829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m22:37:21.485065 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.485967 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m22:37:21.489144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:37:21.510367 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:37:21.511033 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.511545 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:37:21.566399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.054 seconds
[0m22:37:21.578946 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m22:37:21.588051 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.588860 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m22:37:21.590705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:37:21.593720 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m22:37:21.597171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369A36C90>]}
[0m22:37:21.598414 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.38s]
[0m22:37:21.599740 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m22:37:21.602756 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.603556 [debug] [MainThread]: On master: BEGIN
[0m22:37:21.604204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:21.683648 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m22:37:21.684154 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.684608 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.684989 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.685862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:21.686400 [debug] [MainThread]: On master: Close
[0m22:37:21.687193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:21.687616 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:37:21.688126 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:37:21.688567 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:37:21.689008 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:37:21.689970 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m22:37:21.690633 [info ] [MainThread]: 
[0m22:37:21.691233 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m22:37:21.692642 [debug] [MainThread]: Command end result
[0m22:37:21.731789 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:21.736343 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:21.746420 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:37:21.746946 [info ] [MainThread]: 
[0m22:37:21.747664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:21.748320 [info ] [MainThread]: 
[0m22:37:21.749378 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:21.751968 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:21.751453 after 3.54 seconds
[0m22:37:21.752875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369F75D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369A47BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369A444B0>]}
[0m22:37:21.753538 [debug] [MainThread]: Flushing usage events
[0m22:37:22.925091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:30.674783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3D4B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3DD58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F398E10>]}


============================== 22:37:30.680449 | 91bd579d-076a-4302-a882-ba8f2e9efc4b ==============================
[0m22:37:30.680449 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:37:30.681477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:37:31.010305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3D6E9F30>]}
[0m22:37:31.164192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F40FDF0>]}
[0m22:37:31.166423 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:37:31.797362 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:37:32.065198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:32.066245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:32.076205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
[0m22:37:32.154371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F72B350>]}
[0m22:37:32.305043 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:32.311949 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:32.360674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F9D4AA0>]}
[0m22:37:32.362817 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:37:32.364370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F9D0AD0>]}
[0m22:37:32.369211 [info ] [MainThread]: 
[0m22:37:32.369976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:32.370769 [info ] [MainThread]: 
[0m22:37:32.372258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:32.374898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:37:32.533176 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:37:32.533707 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:37:32.534105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.618010 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.084 seconds
[0m22:37:32.619744 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:37:32.628070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:37:32.636148 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:32.636860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:37:32.637364 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:37:32.641077 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:32.642245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:37:32.642948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.644419 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:37:32.647251 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:32.648055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.648563 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:37:32.649353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.736293 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m22:37:32.737158 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:32.738004 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:37:32.740036 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m22:37:32.741305 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:32.742277 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:37:32.746329 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m22:37:32.747277 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:32.748063 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:37:32.752082 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m22:37:32.754171 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:37:32.755014 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:37:32.756357 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m22:37:32.760395 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:37:32.761682 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:37:32.763289 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m22:37:32.766848 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:37:32.767576 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:37:32.776399 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.776958 [debug] [MainThread]: On master: BEGIN
[0m22:37:32.777446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:32.857718 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m22:37:32.858470 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.859047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:37:32.872405 [debug] [MainThread]: SQL status: SELECT 7 in 0.013 seconds
[0m22:37:32.876347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FDB8E20>]}
[0m22:37:32.877011 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:32.877869 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.878359 [debug] [MainThread]: On master: BEGIN
[0m22:37:32.879290 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:32.880040 [debug] [MainThread]: On master: COMMIT
[0m22:37:32.880662 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.881333 [debug] [MainThread]: On master: COMMIT
[0m22:37:32.882377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:32.882990 [debug] [MainThread]: On master: Close
[0m22:37:32.894712 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:32.896272 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m22:37:32.898134 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m22:37:32.899198 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:32.916944 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:33.054620 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.055467 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m22:37:33.057121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:33.136506 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.080 seconds
[0m22:37:33.141815 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.142547 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m22:37:33.143962 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:37:33.145139 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.147872 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.149123 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m22:37:33.150752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:37:33.151909 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.152853 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      
  
    

  create  table "dw_northwind_metabase"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



  );
  
  
[0m22:37:33.485137 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"

[0m22:37:33.485795 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: ROLLBACK
[0m22:37:33.486804 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m22:37:33.505894 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"
  compiled code at target\run\dw_northwind_metabase\snapshots\customers_snapshot.sql
[0m22:37:33.512298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FAD3E90>]}
[0m22:37:33.514288 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.customers_snapshot ......................... [[31mERROR[0m in 0.61s]
[0m22:37:33.515712 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:33.516776 [debug] [Thread-7 (]: Marking all children of 'snapshot.dw_northwind_metabase.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"
  compiled code at target\run\dw_northwind_metabase\snapshots\customers_snapshot.sql.
[0m22:37:33.519857 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:33.520426 [debug] [MainThread]: On master: BEGIN
[0m22:37:33.520907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:33.604276 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m22:37:33.604812 [debug] [MainThread]: On master: COMMIT
[0m22:37:33.605229 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:33.605732 [debug] [MainThread]: On master: COMMIT
[0m22:37:33.607336 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:37:33.608768 [debug] [MainThread]: On master: Close
[0m22:37:33.609907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:33.610497 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:37:33.611104 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:37:33.611637 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:37:33.612150 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:37:33.612632 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m22:37:33.613063 [info ] [MainThread]: 
[0m22:37:33.613555 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m22:37:33.614997 [debug] [MainThread]: Command end result
[0m22:37:33.734353 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:33.738401 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:33.749272 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:37:33.749776 [info ] [MainThread]: 
[0m22:37:33.750479 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:37:33.751251 [info ] [MainThread]: 
[0m22:37:33.752677 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m22:37:33.753777 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"
  compiled code at target\run\dw_northwind_metabase\snapshots\customers_snapshot.sql
[0m22:37:33.754618 [info ] [MainThread]: 
[0m22:37:33.755391 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:33.759219 [debug] [MainThread]: Command `dbt snapshot` failed at 22:37:33.758957 after 3.24 seconds
[0m22:37:33.759815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FAC7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FB42D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FB428F0>]}
[0m22:37:33.760325 [debug] [MainThread]: Flushing usage events
[0m22:37:34.924127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:47.636299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23D9D0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23F358B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23F998E10>]}


============================== 22:46:47.645213 | da51f5ed-e024-42b9-a848-3a83d0dfc364 ==============================
[0m22:46:47.645213 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:46:47.646262 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m22:46:48.024097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23DC09F30>]}
[0m22:46:48.123488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FA1FDF0>]}
[0m22:46:48.132159 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:46:48.650422 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:46:48.929845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:46:48.930674 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m22:46:48.931194 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_accounts.sql
[0m22:46:49.590298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
[0m22:46:49.618026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FF98B50>]}
[0m22:46:49.830169 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:46:49.841125 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:46:49.979670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FFC4AA0>]}
[0m22:46:49.980729 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:46:49.981451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FBDEC10>]}
[0m22:46:49.987547 [info ] [MainThread]: 
[0m22:46:49.988807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:49.990149 [info ] [MainThread]: 
[0m22:46:49.991659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:50.051239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:46:50.371783 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:46:50.373386 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:46:50.374474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.616864 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.242 seconds
[0m22:46:50.618284 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:46:50.620837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:46:50.628799 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:46:50.629408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:46:50.629806 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:46:50.631671 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:46:50.632528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.633004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:46:50.633456 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:46:50.635438 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:46:50.635940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.636353 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:46:50.636885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.720019 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m22:46:50.721117 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:46:50.722317 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:46:50.728242 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m22:46:50.729350 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:46:50.730342 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:46:50.739266 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m22:46:50.740378 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:46:50.741325 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:46:50.742225 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m22:46:50.745209 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:46:50.746774 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:46:50.747829 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m22:46:50.751050 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:46:50.752451 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:46:50.759953 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m22:46:50.762986 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:46:50.764363 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:46:50.781234 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.782228 [debug] [MainThread]: On master: BEGIN
[0m22:46:50.782984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:50.905389 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m22:46:50.906547 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.907524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:46:50.931130 [debug] [MainThread]: SQL status: SELECT 7 in 0.022 seconds
[0m22:46:50.934041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24047CD50>]}
[0m22:46:50.934786 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:50.935597 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.936170 [debug] [MainThread]: On master: BEGIN
[0m22:46:50.937147 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:46:50.937914 [debug] [MainThread]: On master: COMMIT
[0m22:46:50.939766 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.941205 [debug] [MainThread]: On master: COMMIT
[0m22:46:50.942414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:46:50.943259 [debug] [MainThread]: On master: Close
[0m22:46:50.955026 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:50.957137 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:50.958548 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:50.959394 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:50.960488 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m22:46:50.962546 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m22:46:50.964128 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m22:46:50.966038 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m22:46:50.969648 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m22:46:50.971046 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m22:46:50.973653 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m22:46:50.975526 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m22:46:50.977161 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:50.978838 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:50.980345 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:50.981978 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:50.994521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.000567 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.011974 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.015943 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.023282 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:51.074004 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:51.077064 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.077605 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:51.081650 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.086605 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.087319 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:51.093275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.094510 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.095313 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m22:46:51.096226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:51.097691 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.098648 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.099325 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.099828 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m22:46:51.100445 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m22:46:51.101054 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m22:46:51.101616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:51.102282 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:46:51.102958 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:46:51.168499 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m22:46:51.169179 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.169897 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m22:46:51.178085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m22:46:51.178948 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.179761 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    case
        when a.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.created_at::timestamp
        else null
    end                                   as created_at,
    case
        when a.trial_ends_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.trial_ends_at::timestamp
        else null
    end                                   as trial_ends_at,
    case
        when a.canceled_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.canceled_at::timestamp
        else null
    end                                   as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m22:46:51.183872 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m22:46:51.184624 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.185175 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m22:46:51.187543 [debug] [Thread-4 (]: SQL status: BEGIN in 0.084 seconds
[0m22:46:51.188583 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m22:46:51.189468 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.200927 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.201538 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m22:46:51.202030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m22:46:51.202564 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m22:46:51.203141 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m22:46:51.207990 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.212101 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.212961 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m22:46:51.213506 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m22:46:51.214195 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.217766 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.218285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:46:51.218739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:46:51.219174 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m22:46:51.223579 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.224680 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:46:51.230821 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.232127 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m22:46:51.233094 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.238183 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.241152 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m22:46:51.253987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:46:51.275067 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m22:46:51.281957 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m22:46:51.284217 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m22:46:51.284784 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:46:51.285516 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.286301 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.290367 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:46:51.291610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:46:51.292207 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m22:46:51.292991 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m22:46:51.293836 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.297340 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.298128 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:46:51.298685 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m22:46:51.299721 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:46:51.300377 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.310577 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m22:46:51.311210 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m22:46:51.311729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m22:46:51.313677 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m22:46:51.320605 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.325597 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m22:46:51.328498 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m22:46:51.329082 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.329582 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m22:46:51.330506 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.331409 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.331904 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m22:46:51.332606 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m22:46:51.333281 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m22:46:51.335315 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:46:51.339424 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m22:46:51.341404 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.342217 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:46:51.342967 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m22:46:51.343735 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:46:51.346555 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m22:46:51.347052 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m22:46:51.349135 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m22:46:51.349913 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:46:51.351728 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m22:46:51.357544 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m22:46:51.362983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2402F6F90>]}
[0m22:46:51.363537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2404D97B0>]}
[0m22:46:51.364397 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.38s]
[0m22:46:51.365040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2401F5D10>]}
[0m22:46:51.365594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23DB92170>]}
[0m22:46:51.366841 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.39s]
[0m22:46:51.368348 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:51.369584 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.39s]
[0m22:46:51.372747 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:51.373959 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.371128 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.38s]
[0m22:46:51.375871 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:51.377152 [info ] [Thread-2 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m22:46:51.378978 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:51.380238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_orders)
[0m22:46:51.381415 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.387623 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.390322 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.397654 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.399950 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.400925 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m22:46:51.402139 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:51.476705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m22:46:51.477605 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.478570 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m22:46:51.498184 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m22:46:51.506108 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.507730 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m22:46:51.510210 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.515502 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.516460 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m22:46:51.517900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.520368 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m22:46:51.521556 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.524099 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m22:46:51.526909 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:46:51.531828 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m22:46:51.533057 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.533711 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m22:46:51.539543 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:46:51.543610 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m22:46:51.545558 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24057AF20>]}
[0m22:46:51.547584 [info ] [Thread-2 (]: 5 of 5 OK created sql view model dw_stg.stg_northwind_orders ................... [[32mCREATE VIEW[0m in 0.17s]
[0m22:46:51.549418 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.554899 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:51.556668 [debug] [MainThread]: On master: BEGIN
[0m22:46:51.558123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:51.761289 [debug] [MainThread]: SQL status: BEGIN in 0.203 seconds
[0m22:46:51.762319 [debug] [MainThread]: On master: COMMIT
[0m22:46:51.763562 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:51.764675 [debug] [MainThread]: On master: COMMIT
[0m22:46:51.765769 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:46:51.766544 [debug] [MainThread]: On master: Close
[0m22:46:51.767784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:51.768535 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:46:51.769428 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:46:51.771073 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:46:51.771813 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:46:51.774906 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m22:46:51.775765 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m22:46:51.776372 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m22:46:51.777004 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m22:46:51.777925 [info ] [MainThread]: 
[0m22:46:51.778786 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m22:46:51.781762 [debug] [MainThread]: Command end result
[0m22:46:51.837048 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:46:51.843565 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:46:51.852311 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:46:51.853028 [info ] [MainThread]: 
[0m22:46:51.853703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:51.854769 [info ] [MainThread]: 
[0m22:46:51.856883 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m22:46:51.860075 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:51.859788 after 4.40 seconds
[0m22:46:51.860890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23D7CB0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23DAF9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C240203C50>]}
[0m22:46:51.861727 [debug] [MainThread]: Flushing usage events
[0m22:46:53.364334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:02.600563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D23B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D2C58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4298E10>]}


============================== 22:47:02.605832 | bd73121a-52a3-49a8-8684-1f14313e7dcf ==============================
[0m22:47:02.605832 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:47:02.606496 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select intermediate', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m22:47:02.860200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D25E9F30>]}
[0m22:47:02.936128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D431FDF0>]}
[0m22:47:02.937478 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:47:03.415909 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:47:03.674597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:03.675075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:03.683844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m22:47:03.753478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D461F350>]}
[0m22:47:03.875126 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:03.880387 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:03.916770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4884C80>]}
[0m22:47:03.917428 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:47:03.917948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4469C50>]}
[0m22:47:03.920602 [info ] [MainThread]: 
[0m22:47:03.921345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:03.922002 [info ] [MainThread]: 
[0m22:47:03.922975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:03.962576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:47:04.129860 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:47:04.130526 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:47:04.131040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.191217 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.060 seconds
[0m22:47:04.193638 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:47:04.201302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:47:04.207339 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:04.207968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:47:04.208434 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:47:04.211795 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:04.212739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:47:04.213222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.214364 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:04.216415 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:04.217096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.217514 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:47:04.218124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.280302 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m22:47:04.280790 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:04.281193 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:47:04.282703 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m22:47:04.283158 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:04.283518 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:47:04.286921 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m22:47:04.287425 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:04.287799 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:47:04.290486 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:47:04.291945 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:47:04.292375 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:47:04.294192 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:47:04.294884 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:47:04.297321 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:47:04.297857 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m22:47:04.299356 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:47:04.300250 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:47:04.305238 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.305661 [debug] [MainThread]: On master: BEGIN
[0m22:47:04.305968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:04.356610 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m22:47:04.357060 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.357438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:47:04.368045 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:47:04.369491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4D287A0>]}
[0m22:47:04.369987 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:04.370544 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.370924 [debug] [MainThread]: On master: BEGIN
[0m22:47:04.371631 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:04.371978 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.372295 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.372597 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.373052 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:04.373401 [debug] [MainThread]: On master: Close
[0m22:47:04.379462 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m22:47:04.380109 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m22:47:04.380701 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m22:47:04.381213 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m22:47:04.389849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m22:47:04.397104 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m22:47:04.443061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m22:47:04.447029 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.447969 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m22:47:04.448623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:04.544507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m22:47:04.545579 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.546559 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
)
select * from northwind
union all
select * from metabase
  );
[0m22:47:04.560224 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:47:04.569683 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.570235 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m22:47:04.571878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:47:04.590887 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:47:04.591448 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.591882 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:47:04.596227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:47:04.676005 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m22:47:04.688230 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.688934 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m22:47:04.690286 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:47:04.694681 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m22:47:04.699786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D49C3050>]}
[0m22:47:04.701227 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m22:47:04.702887 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m22:47:04.706084 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.706846 [debug] [MainThread]: On master: BEGIN
[0m22:47:04.707497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:04.782965 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:47:04.783460 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.783838 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.784185 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.784674 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:04.785062 [debug] [MainThread]: On master: Close
[0m22:47:04.785621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:04.786002 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:47:04.786342 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:47:04.786640 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:04.786939 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:47:04.787249 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m22:47:04.787716 [info ] [MainThread]: 
[0m22:47:04.788145 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m22:47:04.789283 [debug] [MainThread]: Command end result
[0m22:47:04.824894 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:04.830555 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:04.837783 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:47:04.838408 [info ] [MainThread]: 
[0m22:47:04.838978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:47:04.839623 [info ] [MainThread]: 
[0m22:47:04.840374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:04.842448 [debug] [MainThread]: Command `dbt run` succeeded at 22:47:04.842254 after 2.40 seconds
[0m22:47:04.842980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D49B7960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D43F77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D43F4F50>]}
[0m22:47:04.843791 [debug] [MainThread]: Flushing usage events
[0m22:47:05.967198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:14.685926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A2F0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744AB98B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C298E10>]}


============================== 22:47:14.692239 | c646fa1b-b33b-4be8-932c-b758a13f922e ==============================
[0m22:47:14.692239 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:47:14.693800 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m22:47:14.954229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A529F30>]}
[0m22:47:15.037198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C30FDF0>]}
[0m22:47:15.038614 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:47:15.489565 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:47:15.703560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:15.703979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:15.710186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
[0m22:47:15.788854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C61B350>]}
[0m22:47:15.919649 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:15.924400 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:15.982581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C8886E0>]}
[0m22:47:15.983789 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:47:15.984492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C884AD0>]}
[0m22:47:15.987367 [info ] [MainThread]: 
[0m22:47:15.988002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:15.988922 [info ] [MainThread]: 
[0m22:47:15.990135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:15.991792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:47:16.228614 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:47:16.229121 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:47:16.229488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.294210 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.065 seconds
[0m22:47:16.295705 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:47:16.302796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:47:16.309698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:16.310312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:47:16.310727 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:16.312613 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:16.313152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:47:16.313495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.315280 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:47:16.317772 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:16.318603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.319165 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:47:16.319750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.385218 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m22:47:16.385699 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:16.386088 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:47:16.387869 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m22:47:16.388322 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:16.388764 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:47:16.393219 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m22:47:16.393699 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:16.394113 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:47:16.394583 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:47:16.395881 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:47:16.396482 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:47:16.396987 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:47:16.399640 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:47:16.401085 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:47:16.405869 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m22:47:16.407338 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:47:16.407883 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:47:16.413874 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.414353 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.415063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:16.466899 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m22:47:16.467482 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.468050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:47:16.478550 [debug] [MainThread]: SQL status: SELECT 7 in 0.010 seconds
[0m22:47:16.480817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CCF0C80>]}
[0m22:47:16.481757 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:16.482694 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.483441 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.484451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:16.484889 [debug] [MainThread]: On master: COMMIT
[0m22:47:16.485289 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.485629 [debug] [MainThread]: On master: COMMIT
[0m22:47:16.486139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:16.486521 [debug] [MainThread]: On master: Close
[0m22:47:16.492075 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.492777 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m22:47:16.493406 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m22:47:16.493831 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.503527 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.592564 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.593133 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m22:47:16.593598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:16.645235 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.052 seconds
[0m22:47:16.650402 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.650945 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m22:47:16.651793 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:47:16.652443 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.659541 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.660168 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m22:47:16.661545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:47:16.662503 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.663249 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      
  
    

  create  table "dw_northwind_metabase"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



  );
  
  
[0m22:47:16.890444 [debug] [Thread-1 (]: SQL status: SELECT 2586 in 0.226 seconds
[0m22:47:16.917015 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m22:47:16.917685 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.918112 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m22:47:16.921702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:47:16.923733 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m22:47:16.926543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C9CBC50>]}
[0m22:47:16.928580 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mSELECT 2586[0m in 0.43s]
[0m22:47:16.930055 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.933641 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.934410 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.935135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:17.002834 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m22:47:17.003357 [debug] [MainThread]: On master: COMMIT
[0m22:47:17.003735 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:17.004246 [debug] [MainThread]: On master: COMMIT
[0m22:47:17.004925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:17.005340 [debug] [MainThread]: On master: Close
[0m22:47:17.006174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:17.006676 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:47:17.007114 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:17.007435 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:47:17.007770 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:47:17.008138 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m22:47:17.008711 [info ] [MainThread]: 
[0m22:47:17.009170 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m22:47:17.010312 [debug] [MainThread]: Command end result
[0m22:47:17.125878 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:17.130366 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:17.141025 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:47:17.141640 [info ] [MainThread]: 
[0m22:47:17.142305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:47:17.142937 [info ] [MainThread]: 
[0m22:47:17.143785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:17.145927 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:47:17.145716 after 2.62 seconds
[0m22:47:17.146438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C9B6A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CA2A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CA2A7B0>]}
[0m22:47:17.146875 [debug] [MainThread]: Flushing usage events
[0m22:47:18.247542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:28.430866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C41B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C4A58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6098E10>]}


============================== 22:47:28.438090 | 55a8576e-6e2d-47f9-ae54-8c8261956f13 ==============================
[0m22:47:28.438090 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:47:28.439616 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select dw', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:47:28.689728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C43E9F30>]}
[0m22:47:28.773701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C611FDF0>]}
[0m22:47:28.775960 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:47:29.271515 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:47:29.498901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:29.499416 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:29.510451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_saas
[0m22:47:29.633001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C641F350>]}
[0m22:47:29.840197 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:29.845981 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:29.893569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C667CC80>]}
[0m22:47:29.894687 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:47:29.895315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6269C50>]}
[0m22:47:29.898422 [info ] [MainThread]: 
[0m22:47:29.899006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:29.899455 [info ] [MainThread]: 
[0m22:47:29.900392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:29.908583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:47:30.077193 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:47:30.077732 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:47:30.078131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.161053 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.083 seconds
[0m22:47:30.162537 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:47:30.163426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dw)
[0m22:47:30.164119 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dw"
"
[0m22:47:30.169200 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dw"
[0m22:47:30.170052 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:30.170550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:47:30.220477 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m22:47:30.221107 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dw"
[0m22:47:30.221759 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dw"} */
create schema if not exists "dw_dw"
[0m22:47:30.226429 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m22:47:30.227689 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: COMMIT
[0m22:47:30.228125 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dw"
[0m22:47:30.228514 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: COMMIT
[0m22:47:30.229982 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:47:30.230410 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: Close
[0m22:47:30.233196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:47:30.239934 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:30.240622 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:47:30.241290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:47:30.241788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.244414 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:30.245052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:47:30.245748 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:47:30.247860 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:30.248448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.248938 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:30.249546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.307601 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m22:47:30.308067 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:30.308537 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:47:30.311644 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m22:47:30.312084 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:30.312445 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:47:30.314872 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m22:47:30.315304 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:30.315654 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:47:30.316682 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m22:47:30.318110 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:47:30.318737 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:47:30.321096 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m22:47:30.323911 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:47:30.324886 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:47:30.327035 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:47:30.328716 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:47:30.329479 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:47:30.334858 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.335259 [debug] [MainThread]: On master: BEGIN
[0m22:47:30.335543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:30.390808 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m22:47:30.391257 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.391671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:47:30.400835 [debug] [MainThread]: SQL status: SELECT 7 in 0.009 seconds
[0m22:47:30.404146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6B40600>]}
[0m22:47:30.404820 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:30.405578 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.405980 [debug] [MainThread]: On master: BEGIN
[0m22:47:30.406790 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:30.407152 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.407498 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.407829 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.408388 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:30.408782 [debug] [MainThread]: On master: Close
[0m22:47:30.414707 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m22:47:30.415212 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m22:47:30.415770 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m22:47:30.416369 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m22:47:30.417086 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m22:47:30.417645 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m22:47:30.418082 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m22:47:30.418483 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m22:47:30.427285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.435439 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.443509 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m22:47:30.477914 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m22:47:30.559742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.563660 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.567969 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.568559 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m22:47:30.569020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:30.571526 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.572770 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m22:47:30.573934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:47:30.632645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m22:47:30.633216 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.633715 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
;
  );
  
[0m22:47:30.639639 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m22:47:30.640187 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.640656 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        null::varchar                        as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        null::varchar                        as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
;
  );
  
[0m22:47:30.642032 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 49: ;
         ^

[0m22:47:30.642513 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: ROLLBACK
[0m22:47:30.642962 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 60: ;
         ^

[0m22:47:30.643474 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: ROLLBACK
[0m22:47:30.644008 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m22:47:30.644494 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m22:47:30.670474 [debug] [Thread-2 (]: Database Error in model fact_sales (models\dw\fact_sales.sql)
  syntax error at or near ";"
  LINE 60: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:47:30.671996 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dw\dim_customer.sql)
  syntax error at or near ";"
  LINE 49: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_customer.sql
[0m22:47:30.675044 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C67CBB90>]}
[0m22:47:30.675571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C67B71D0>]}
[0m22:47:30.676392 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dw_dw.fact_sales ......................... [[31mERROR[0m in 0.26s]
[0m22:47:30.678564 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m22:47:30.679718 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\dw\fact_sales.sql)
  syntax error at or near ";"
  LINE 60: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql.
[0m22:47:30.677245 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dw_dw.dim_customer ....................... [[31mERROR[0m in 0.26s]
[0m22:47:30.682826 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m22:47:30.683981 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models\dw\dim_customer.sql)
  syntax error at or near ";"
  LINE 49: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_customer.sql.
[0m22:47:30.687093 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.687890 [debug] [MainThread]: On master: BEGIN
[0m22:47:30.688734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:30.818587 [debug] [MainThread]: SQL status: BEGIN in 0.130 seconds
[0m22:47:30.819108 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.819602 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.820318 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.821337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:30.821931 [debug] [MainThread]: On master: Close
[0m22:47:30.822817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:30.823578 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:30.824285 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:47:30.824950 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:47:30.825407 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:30.825864 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m22:47:30.826235 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m22:47:30.826675 [info ] [MainThread]: 
[0m22:47:30.827122 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m22:47:30.828559 [debug] [MainThread]: Command end result
[0m22:47:30.872776 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:30.876429 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:30.884591 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:47:30.885286 [info ] [MainThread]: 
[0m22:47:30.885982 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:47:30.887683 [info ] [MainThread]: 
[0m22:47:30.888873 [error] [MainThread]: [31mFailure in model fact_sales (models\dw\fact_sales.sql)[0m
[0m22:47:30.889918 [error] [MainThread]:   Database Error in model fact_sales (models\dw\fact_sales.sql)
  syntax error at or near ";"
  LINE 60: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:47:30.890793 [info ] [MainThread]: 
[0m22:47:30.891672 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:47:30.892411 [info ] [MainThread]: 
[0m22:47:30.893196 [error] [MainThread]: [31mFailure in model dim_customer (models\dw\dim_customer.sql)[0m
[0m22:47:30.894161 [error] [MainThread]:   Database Error in model dim_customer (models\dw\dim_customer.sql)
  syntax error at or near ";"
  LINE 49: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_customer.sql
[0m22:47:30.894881 [info ] [MainThread]: 
[0m22:47:30.895847 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dim_customer.sql
[0m22:47:30.896593 [info ] [MainThread]: 
[0m22:47:30.897307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m22:47:30.899137 [debug] [MainThread]: Command `dbt run` failed at 22:47:30.898922 after 2.62 seconds
[0m22:47:30.899731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C60D4AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6B29E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C33CB750>]}
[0m22:47:30.900381 [debug] [MainThread]: Flushing usage events
[0m22:47:32.089549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:40.368417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FE5B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FEE58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980498E10>]}


============================== 22:48:40.373930 | b17abbbc-8f0b-4d31-b56c-314b47cccca0 ==============================
[0m22:48:40.373930 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:48:40.374747 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select dw', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m22:48:40.664130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FE7E9F30>]}
[0m22:48:40.916524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998051FDF0>]}
[0m22:48:40.920398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:48:41.622059 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:48:42.099061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:48:42.101232 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\fact_sales.sql
[0m22:48:42.102257 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dim_customer.sql
[0m22:48:43.172185 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m22:48:43.202007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980A8CB50>]}
[0m22:48:43.395421 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:48:43.401801 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:48:43.461241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980AA06E0>]}
[0m22:48:43.462286 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:48:43.463123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980745010>]}
[0m22:48:43.468608 [info ] [MainThread]: 
[0m22:48:43.473662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:48:43.474538 [info ] [MainThread]: 
[0m22:48:43.475888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:48:43.484691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:48:43.777381 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:48:43.777890 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:48:43.778534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.863744 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.085 seconds
[0m22:48:43.866622 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:48:43.870606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:48:43.879683 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:48:43.880513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:48:43.881175 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:48:43.884622 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:48:43.885377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:48:43.886530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.887130 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:48:43.889913 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:48:43.890741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.891143 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:48:43.891688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.967374 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m22:48:43.968215 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:48:43.968972 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:48:43.972669 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m22:48:43.973338 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:48:43.973996 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:48:43.979184 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m22:48:43.980049 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:48:43.981043 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m22:48:43.982278 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:48:43.984956 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:48:43.986013 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:48:43.988082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m22:48:43.990717 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:48:43.991748 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:48:43.996806 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:48:43.999348 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:48:44.000410 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:48:44.009285 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.009985 [debug] [MainThread]: On master: BEGIN
[0m22:48:44.010503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:44.083528 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m22:48:44.084155 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.084841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:48:44.097244 [debug] [MainThread]: SQL status: SELECT 7 in 0.012 seconds
[0m22:48:44.100483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299821B4A10>]}
[0m22:48:44.101256 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:44.102630 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.103377 [debug] [MainThread]: On master: BEGIN
[0m22:48:44.104429 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:48:44.104941 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.105508 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.106017 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.106838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:48:44.107398 [debug] [MainThread]: On master: Close
[0m22:48:44.115522 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m22:48:44.116673 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m22:48:44.117813 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m22:48:44.119431 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m22:48:44.121183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m22:48:44.122255 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m22:48:44.123294 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m22:48:44.124241 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m22:48:44.150609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.157902 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.161093 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m22:48:44.162107 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m22:48:44.258491 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.267331 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.269672 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.270783 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m22:48:44.272031 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:48:44.273068 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.274219 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m22:48:44.275197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:44.381672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.109 seconds
[0m22:48:44.383403 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.385078 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        null::varchar                        as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        null::varchar                        as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m22:48:44.406169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m22:48:44.407226 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.408207 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m22:48:44.466621 [debug] [Thread-1 (]: SQL status: SELECT 2586 in 0.057 seconds
[0m22:48:44.487474 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.488558 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m22:48:44.490498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:48:44.525485 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:48:44.526369 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.527208 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:48:44.529744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:48:44.545698 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m22:48:44.557380 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.558275 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m22:48:44.559552 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:48:44.564140 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m22:48:44.569745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980C7E390>]}
[0m22:48:44.571308 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 2586[0m in 0.44s]
[0m22:48:44.572838 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m22:48:44.860727 [debug] [Thread-2 (]: Postgres adapter: Postgres error: numeric field overflow
DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.

[0m22:48:44.861354 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: ROLLBACK
[0m22:48:44.862121 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m22:48:44.877222 [debug] [Thread-2 (]: Database Error in model fact_sales (models\dw\fact_sales.sql)
  numeric field overflow
  DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:48:44.878243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029982194F70>]}
[0m22:48:44.879436 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dw_dw.fact_sales ......................... [[31mERROR[0m in 0.76s]
[0m22:48:44.881133 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m22:48:44.883231 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\dw\fact_sales.sql)
  numeric field overflow
  DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql.
[0m22:48:44.886930 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.887484 [debug] [MainThread]: On master: BEGIN
[0m22:48:44.887929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:44.959876 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m22:48:44.960539 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.960948 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.961407 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.962132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:48:44.962633 [debug] [MainThread]: On master: Close
[0m22:48:44.963380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:44.963883 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:48:44.964409 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:48:44.965310 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:48:44.966257 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:48:44.966896 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m22:48:44.967594 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m22:48:44.968392 [info ] [MainThread]: 
[0m22:48:44.969176 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m22:48:44.971113 [debug] [MainThread]: Command end result
[0m22:48:45.029623 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:48:45.036114 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:48:45.048951 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:48:45.050473 [info ] [MainThread]: 
[0m22:48:45.051571 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:48:45.052575 [info ] [MainThread]: 
[0m22:48:45.053570 [error] [MainThread]: [31mFailure in model fact_sales (models\dw\fact_sales.sql)[0m
[0m22:48:45.054580 [error] [MainThread]:   Database Error in model fact_sales (models\dw\fact_sales.sql)
  numeric field overflow
  DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:48:45.055489 [info ] [MainThread]: 
[0m22:48:45.056366 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:48:45.057071 [info ] [MainThread]: 
[0m22:48:45.057796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:48:45.060272 [debug] [MainThread]: Command `dbt run` failed at 22:48:45.060022 after 4.88 seconds
[0m22:48:45.060993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998069AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998211A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980728BD0>]}
[0m22:48:45.061798 [debug] [MainThread]: Flushing usage events
[0m22:48:46.456675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:22.467316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BD9B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BF258B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BF898E10>]}


============================== 22:49:22.473776 | 2b307df1-03b6-4410-9c7c-a24d9581d98e ==============================
[0m22:49:22.473776 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:22.474598 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_metabase_orders', 'printer_width': '80', 'target_path': 'None'}
[0m22:49:22.798380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BDBE9F30>]}
[0m22:49:22.905759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BF91FDF0>]}
[0m22:49:22.907311 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:49:23.539667 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:23.815829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:49:23.816764 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m22:49:24.550378 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
[0m22:49:24.574327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFE81E50>]}
[0m22:49:24.720679 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:24.724476 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:24.770676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFE6EC60>]}
[0m22:49:24.771697 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:49:24.772382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFADDC50>]}
[0m22:49:24.774979 [info ] [MainThread]: 
[0m22:49:24.775579 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:24.776100 [info ] [MainThread]: 
[0m22:49:24.777245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:24.778939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:49:25.033852 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:49:25.034521 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:49:25.035159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.132375 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.097 seconds
[0m22:49:25.134367 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:49:25.141275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:49:25.150056 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:25.150972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:49:25.151694 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:49:25.154551 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:25.155240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:49:25.155674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.156225 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:49:25.158270 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:25.159062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.159528 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:49:25.160107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.259873 [debug] [ThreadPool]: SQL status: BEGIN in 0.104 seconds
[0m22:49:25.260661 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:25.261406 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:49:25.262061 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m22:49:25.262956 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:25.264066 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:49:25.267359 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m22:49:25.267970 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:25.268466 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:49:25.302538 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m22:49:25.303266 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m22:49:25.305334 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:49:25.305877 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m22:49:25.307620 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:49:25.310202 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:49:25.310902 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:49:25.311575 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:49:25.312439 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:49:25.325316 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.325845 [debug] [MainThread]: On master: BEGIN
[0m22:49:25.326247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:25.411008 [debug] [MainThread]: SQL status: BEGIN in 0.085 seconds
[0m22:49:25.411679 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.412317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:49:25.430953 [debug] [MainThread]: SQL status: SELECT 7 in 0.018 seconds
[0m22:49:25.434791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C037D090>]}
[0m22:49:25.435904 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:25.437081 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.437994 [debug] [MainThread]: On master: BEGIN
[0m22:49:25.439044 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:49:25.439546 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.439991 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.440436 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.441132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:25.441645 [debug] [MainThread]: On master: Close
[0m22:49:25.452271 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.453241 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m22:49:25.454442 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m22:49:25.455618 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.475238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.477616 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.555305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.557360 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.558177 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m22:49:25.559182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:25.648730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m22:49:25.649780 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.650394 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m22:49:25.682260 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m22:49:25.694899 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.695823 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m22:49:25.698089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:49:25.703851 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.704498 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m22:49:25.705646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:49:25.731706 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:49:25.733153 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.734054 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:49:25.742134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m22:49:25.755395 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m22:49:25.763067 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.764381 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m22:49:25.768535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:49:25.772225 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m22:49:25.775792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C01F6B10>]}
[0m22:49:25.777063 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.32s]
[0m22:49:25.778352 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.782217 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.783160 [debug] [MainThread]: On master: BEGIN
[0m22:49:25.783899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:25.862790 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m22:49:25.863689 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.864596 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.865337 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.866307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:25.867162 [debug] [MainThread]: On master: Close
[0m22:49:25.868303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:25.869155 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:49:25.869822 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:49:25.870443 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:49:25.871156 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:49:25.871766 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m22:49:25.872468 [info ] [MainThread]: 
[0m22:49:25.873203 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m22:49:25.874905 [debug] [MainThread]: Command end result
[0m22:49:25.974565 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:25.984524 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:26.013182 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:49:26.015145 [info ] [MainThread]: 
[0m22:49:26.016587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:26.018073 [info ] [MainThread]: 
[0m22:49:26.019066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:49:26.022683 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:26.022350 after 3.74 seconds
[0m22:49:26.023730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFE0BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFB09B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFB0A030>]}
[0m22:49:26.024983 [debug] [MainThread]: Flushing usage events
[0m22:49:27.106985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:38.808098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA017B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03058B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03698E10>]}


============================== 22:49:38.817097 | 8e5e5b47-fc6d-428a-9bfc-7b361e068f9c ==============================
[0m22:49:38.817097 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:38.818522 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_sales', 'printer_width': '80', 'write_json': 'True'}
[0m22:49:39.325189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA019E9F30>]}
[0m22:49:39.509338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA0370FDF0>]}
[0m22:49:39.512754 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:49:40.572662 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:40.925952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:40.926934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:40.936997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
[0m22:49:41.077716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03A1B350>]}
[0m22:49:41.273591 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:41.278502 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:41.328763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03C60C80>]}
[0m22:49:41.329819 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:49:41.330606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA038684B0>]}
[0m22:49:41.333334 [info ] [MainThread]: 
[0m22:49:41.333924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:41.334738 [info ] [MainThread]: 
[0m22:49:41.335935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:41.338568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:49:41.616645 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:49:41.617302 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:49:41.617836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.733518 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.116 seconds
[0m22:49:41.736660 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:49:41.751817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:49:41.768432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:49:41.770100 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:41.775682 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:41.776929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:49:41.777805 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:49:41.779378 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:49:41.783263 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:41.784178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.785019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.785760 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:49:41.789075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.917289 [debug] [ThreadPool]: SQL status: BEGIN in 0.132 seconds
[0m22:49:41.918228 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:41.919265 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:49:41.940115 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m22:49:41.943434 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:49:41.944995 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:49:41.958503 [debug] [ThreadPool]: SQL status: BEGIN in 0.174 seconds
[0m22:49:41.959698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:41.960641 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:49:41.964777 [debug] [ThreadPool]: SQL status: BEGIN in 0.176 seconds
[0m22:49:41.965797 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:41.966648 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:49:41.977819 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m22:49:41.980913 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:49:41.982017 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:49:41.985619 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m22:49:41.991124 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:49:41.992391 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:49:42.008986 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.010054 [debug] [MainThread]: On master: BEGIN
[0m22:49:42.011138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:42.110166 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m22:49:42.110962 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.111775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:49:42.126755 [debug] [MainThread]: SQL status: SELECT 7 in 0.014 seconds
[0m22:49:42.130659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA04128460>]}
[0m22:49:42.131582 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:42.132524 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.132961 [debug] [MainThread]: On master: BEGIN
[0m22:49:42.133756 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:49:42.134377 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.134994 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.135564 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.136552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:42.137550 [debug] [MainThread]: On master: Close
[0m22:49:42.145478 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m22:49:42.146241 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m22:49:42.147053 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m22:49:42.147743 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m22:49:42.164533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.166695 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m22:49:42.242785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.245920 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.250830 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m22:49:42.251454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:42.318625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m22:49:42.319317 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.320445 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        null::varchar                        as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        null::varchar                        as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m22:49:42.897576 [debug] [Thread-1 (]: SQL status: SELECT 20915 in 0.576 seconds
[0m22:49:42.916970 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.917990 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m22:49:42.919983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:49:42.960253 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m22:49:42.961146 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.961828 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m22:49:42.974062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m22:49:43.076267 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m22:49:43.085666 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:43.086676 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m22:49:43.088381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:49:43.092060 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m22:49:43.097006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03DCBAD0>]}
[0m22:49:43.098610 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 0.95s]
[0m22:49:43.100118 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m22:49:43.103031 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:43.104248 [debug] [MainThread]: On master: BEGIN
[0m22:49:43.105596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:43.180885 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:49:43.181492 [debug] [MainThread]: On master: COMMIT
[0m22:49:43.182153 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:43.182760 [debug] [MainThread]: On master: COMMIT
[0m22:49:43.183576 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:43.184028 [debug] [MainThread]: On master: Close
[0m22:49:43.184789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:43.185410 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:49:43.185974 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:49:43.186555 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:49:43.187578 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:49:43.188521 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m22:49:43.189387 [info ] [MainThread]: 
[0m22:49:43.190122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m22:49:43.191590 [debug] [MainThread]: Command end result
[0m22:49:43.248422 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:43.254020 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:43.301625 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:49:43.302624 [info ] [MainThread]: 
[0m22:49:43.303852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:43.305532 [info ] [MainThread]: 
[0m22:49:43.306612 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:49:43.309305 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:43.308987 after 4.76 seconds
[0m22:49:43.310147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03DB7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA01971950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA01972170>]}
[0m22:49:43.311170 [debug] [MainThread]: Flushing usage events
[0m22:49:44.474870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:57.279060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A81E0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A8A88B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA198E10>]}


============================== 22:49:57.285686 | 50ca32dd-eea3-44ca-a545-9275defb4a3c ==============================
[0m22:49:57.285686 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:57.286608 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customer', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:49:57.666475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A8419F30>]}
[0m22:49:57.784374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA21FDF0>]}
[0m22:49:57.786605 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:49:58.441366 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:58.750701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:58.751193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:58.758510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
[0m22:49:58.865145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA51F350>]}
[0m22:49:59.066920 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:59.072805 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:59.142669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA768C80>]}
[0m22:49:59.144713 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:49:59.145580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA3684B0>]}
[0m22:49:59.149887 [info ] [MainThread]: 
[0m22:49:59.150881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:59.151927 [info ] [MainThread]: 
[0m22:49:59.153347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:59.155430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:49:59.441656 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:49:59.442462 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:49:59.443851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.528019 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.084 seconds
[0m22:49:59.530804 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:49:59.540091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:49:59.550169 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:59.550999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:49:59.551478 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:49:59.555165 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:59.556321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:49:59.556979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.558588 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:49:59.563481 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:59.564568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.565095 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:49:59.565715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.683136 [debug] [ThreadPool]: SQL status: BEGIN in 0.126 seconds
[0m22:49:59.684115 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:59.685234 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:49:59.702497 [debug] [ThreadPool]: SQL status: BEGIN in 0.138 seconds
[0m22:49:59.703620 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:59.704873 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m22:49:59.706465 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:49:59.712097 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:49:59.714806 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:49:59.729983 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m22:49:59.731097 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:59.732236 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:49:59.740720 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m22:49:59.745612 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:49:59.747304 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:49:59.754926 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.022 seconds
[0m22:49:59.757590 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:49:59.758784 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:49:59.770828 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.771518 [debug] [MainThread]: On master: BEGIN
[0m22:49:59.772376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:59.887238 [debug] [MainThread]: SQL status: BEGIN in 0.115 seconds
[0m22:49:59.888044 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.888597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:49:59.914207 [debug] [MainThread]: SQL status: SELECT 7 in 0.024 seconds
[0m22:49:59.919329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AAC28BB0>]}
[0m22:49:59.920331 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:59.921599 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.922488 [debug] [MainThread]: On master: BEGIN
[0m22:49:59.923942 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:49:59.924979 [debug] [MainThread]: On master: COMMIT
[0m22:49:59.926014 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.929636 [debug] [MainThread]: On master: COMMIT
[0m22:49:59.932960 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:59.934168 [debug] [MainThread]: On master: Close
[0m22:49:59.949958 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m22:49:59.953948 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m22:49:59.958439 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m22:49:59.961898 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m22:49:59.986785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m22:49:59.989991 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m22:50:00.128635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.131195 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.132291 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m22:50:00.133466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:00.215885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m22:50:00.216892 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.217802 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m22:50:00.262743 [debug] [Thread-1 (]: SQL status: SELECT 2586 in 0.044 seconds
[0m22:50:00.283401 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.284361 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m22:50:00.285573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:50:00.290488 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.291461 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m22:50:00.293140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:50:00.413991 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:50:00.414826 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.415527 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:50:00.419087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:50:00.429933 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m22:50:00.439567 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.440514 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m22:50:00.449460 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m22:50:00.453169 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m22:50:00.456884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA8CBAD0>]}
[0m22:50:00.458118 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 2586[0m in 0.50s]
[0m22:50:00.459312 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m22:50:00.462387 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:00.463186 [debug] [MainThread]: On master: BEGIN
[0m22:50:00.463580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:50:00.538976 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:50:00.539471 [debug] [MainThread]: On master: COMMIT
[0m22:50:00.539844 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:00.540189 [debug] [MainThread]: On master: COMMIT
[0m22:50:00.540718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:50:00.541086 [debug] [MainThread]: On master: Close
[0m22:50:00.541748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:00.542295 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:50:00.542692 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:50:00.543205 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:50:00.543933 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:50:00.544748 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m22:50:00.545432 [info ] [MainThread]: 
[0m22:50:00.546123 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m22:50:00.547568 [debug] [MainThread]: Command end result
[0m22:50:00.593654 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:50:00.598423 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:50:00.607769 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:50:00.608574 [info ] [MainThread]: 
[0m22:50:00.609267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:50:00.610084 [info ] [MainThread]: 
[0m22:50:00.610853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:50:00.613783 [debug] [MainThread]: Command `dbt run` succeeded at 22:50:00.613445 after 3.57 seconds
[0m22:50:00.614617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA8B7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AAC5F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AAC5F6B0>]}
[0m22:50:00.615325 [debug] [MainThread]: Flushing usage events
[0m22:50:01.882379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:07.420512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022248CB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224A558B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224AB98E10>]}


============================== 23:04:07.431435 | 80909edd-fd35-4fb5-92e1-b7889b90b7a7 ==============================
[0m23:04:07.431435 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:04:07.434045 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt run --select staging', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m23:04:07.781954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022248EE9F30>]}
[0m23:04:07.871995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224AC0FDF0>]}
[0m23:04:07.874540 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:04:08.506040 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:04:08.893227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 17 files added, 2 files changed.
[0m23:04:08.894386 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\marts\dm_b2b\dm_b2b.sql
[0m23:04:08.895105 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\fact_invoices.sql
[0m23:04:08.896090 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\fact_feedback.sql
[0m23:04:08.896527 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_product.sql
[0m23:04:08.896940 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\metabase\stg_metabase_invoices.sql
[0m23:04:08.897364 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\marts\dm_b2c\dm_b2c.sql
[0m23:04:08.897946 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\northwind\stg_northwind_products.sql
[0m23:04:08.898792 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_employee.sql
[0m23:04:08.899471 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\northwind\stg_northwind_employees.sql
[0m23:04:08.900007 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\fact_reviews.sql
[0m23:04:08.900462 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\marts\dm_sales\dm_sales.sql
[0m23:04:08.900900 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\metabase\stg_metabase_analytic_events.sql
[0m23:04:08.901337 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\metabase\stg_metabase_reviews.sql
[0m23:04:08.901761 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\fact_analytic_events.sql
[0m23:04:08.902163 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\metabase\stg_metabase_feedback.sql
[0m23:04:08.902616 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\marts\marts.yml
[0m23:04:08.903013 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\metabase\stg_metabase_products.sql
[0m23:04:08.904605 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\staging.yml
[0m23:04:08.905222 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dw.yml
[0m23:04:10.316893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_saas
[0m23:04:10.350279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224AF1FE50>]}
[0m23:04:10.698118 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:04:10.704765 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:04:10.786464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B16DD60>]}
[0m23:04:10.787575 [info ] [MainThread]: Found 24 models, 1 snapshot, 51 data tests, 14 sources, 449 macros
[0m23:04:10.788625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B4C3150>]}
[0m23:04:10.857944 [info ] [MainThread]: 
[0m23:04:10.858649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:10.859355 [info ] [MainThread]: 
[0m23:04:10.860436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:10.868639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:04:11.213390 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:04:11.213976 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:04:11.214463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:11.340569 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.126 seconds
[0m23:04:11.342332 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:04:11.346604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:04:11.354496 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:04:11.355226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:04:11.355699 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:04:11.357932 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:04:11.358550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:04:11.358960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:11.359528 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:04:11.360589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:04:11.362558 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:04:11.363314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:11.365571 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:04:11.366357 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:04:11.367551 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:04:11.368514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:11.369161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:11.452141 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m23:04:11.452846 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m23:04:11.453367 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:04:11.454027 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:04:11.454650 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:04:11.455588 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:04:11.460458 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m23:04:11.461062 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m23:04:11.461600 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:04:11.462135 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:04:11.462831 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:04:11.463384 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:04:11.474778 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:04:11.475523 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m23:04:11.475985 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:04:11.476422 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.020 seconds
[0m23:04:11.478070 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:04:11.480179 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:04:11.481987 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:04:11.484325 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:04:11.485409 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:04:11.485893 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:04:11.486308 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:04:11.486762 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:04:11.487561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_snapshots)
[0m23:04:11.488532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:04:11.495620 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:04:11.498153 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:04:11.498691 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:04:11.499313 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:04:11.499874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:11.500510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:11.571795 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m23:04:11.572377 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:04:11.572834 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:04:11.573301 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m23:04:11.573813 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:04:11.574247 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:04:11.584199 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:04:11.585172 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m23:04:11.587433 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:04:11.589469 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:04:11.590242 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:04:11.590708 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:04:11.599446 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:11.600181 [debug] [MainThread]: On master: BEGIN
[0m23:04:11.600772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:11.658620 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m23:04:11.659136 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:11.659612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:04:11.679313 [debug] [MainThread]: SQL status: SELECT 7 in 0.019 seconds
[0m23:04:11.681743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B603D40>]}
[0m23:04:11.682330 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:11.683384 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:11.684144 [debug] [MainThread]: On master: BEGIN
[0m23:04:11.685161 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:04:11.685654 [debug] [MainThread]: On master: COMMIT
[0m23:04:11.686083 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:11.686498 [debug] [MainThread]: On master: COMMIT
[0m23:04:11.687118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:11.687550 [debug] [MainThread]: On master: Close
[0m23:04:11.697064 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:04:11.697658 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:04:11.698159 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:04:11.698640 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:04:11.699327 [info ] [Thread-4 (]: 4 of 12 START sql view model dw_stg.stg_metabase_invoices ...................... [RUN]
[0m23:04:11.700572 [info ] [Thread-3 (]: 3 of 12 START sql view model dw_stg.stg_metabase_feedback ...................... [RUN]
[0m23:04:11.701723 [info ] [Thread-1 (]: 1 of 12 START sql view model dw_stg.stg_metabase_accounts ...................... [RUN]
[0m23:04:11.703547 [info ] [Thread-2 (]: 2 of 12 START sql view model dw_stg.stg_metabase_analytic_events ............... [RUN]
[0m23:04:11.704609 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_invoices'
[0m23:04:11.705379 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_feedback'
[0m23:04:11.706087 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m23:04:11.706707 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_analytic_events'
[0m23:04:11.707240 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:04:11.707978 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:04:11.708678 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:04:11.709215 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:04:11.720603 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:04:11.725007 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:04:11.729516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:11.734191 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:04:11.742798 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:04:11.743971 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:04:11.826428 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:04:11.912500 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:04:11.913176 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:04:11.916418 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:04:11.919983 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:04:11.927933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:11.930197 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:04:11.931501 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: BEGIN
[0m23:04:11.932703 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:04:11.935323 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:04:11.936951 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:11.938070 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:04:11.939125 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: BEGIN
[0m23:04:11.940797 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m23:04:11.941974 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: BEGIN
[0m23:04:11.942978 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:04:11.944121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:11.945185 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:04:12.072330 [debug] [Thread-4 (]: SQL status: BEGIN in 0.129 seconds
[0m23:04:12.073382 [debug] [Thread-3 (]: SQL status: BEGIN in 0.128 seconds
[0m23:04:12.074369 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:04:12.075482 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:04:12.076771 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp"
    
    
  as (
    

-- Faturas SaaS (Metabase) com valores normalizados e v√≠nculo ao cliente.
select
    'METABASE'                               as source_system,
    i.id                                     as source_invoice_id,
    'METABASE_' || i.id                      as invoice_nk,
    case
        when nullif(i.account_id, '') is not null then 'METABASE_' || i.account_id
        else null
    end                                      as customer_nk,
    i.account_id                             as source_account_id,
    i.plan                                   as plan_name,
    cast(i.payment as numeric(12,4))         as payment_amount,
    i.expected_invoice                       as expected_invoice_flag,
    case
        when i.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then i.date_received::timestamp
        else null
    end                                      as date_received,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."invoices" i
  );
[0m23:04:12.078221 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp"
    
    
  as (
    

-- Feedbacks recebidos via canais de suporte Metabase.
select
    'METABASE'                               as source_system,
    f.id                                     as source_feedback_id,
    'METABASE_FB_' || f.id                   as feedback_nk,
    case
        when nullif(f.account_id, '') is not null then 'METABASE_' || f.account_id
        else null
    end                                      as customer_nk,
    f.account_id                             as source_account_id,
    f.email                                  as contact_email,
    cast(f.rating as numeric(5,2))           as rating_score,
    f.rating_mapped                          as rating_label,
    case
        when f.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then f.date_received::timestamp
        else null
    end                                      as date_received,
    f.body                                   as feedback_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."feedback" f
  );
[0m23:04:12.086447 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.feedback" does not exist
LINE 29: from "dw_northwind_metabase"."public"."feedback" f
              ^

[0m23:04:12.087560 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.invoices" does not exist
LINE 28: from "dw_northwind_metabase"."public"."invoices" i
              ^

[0m23:04:12.088576 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: ROLLBACK
[0m23:04:12.089728 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: ROLLBACK
[0m23:04:12.091387 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: Close
[0m23:04:12.092657 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: Close
[0m23:04:12.098933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m23:04:12.100753 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:12.102281 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    case
        when a.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.created_at::timestamp
        else null
    end                                   as created_at,
    case
        when a.trial_ends_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.trial_ends_at::timestamp
        else null
    end                                   as trial_ends_at,
    case
        when a.canceled_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.canceled_at::timestamp
        else null
    end                                   as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m23:04:12.133105 [debug] [Thread-3 (]: Database Error in model stg_metabase_feedback (models\staging\metabase\stg_metabase_feedback.sql)
  relation "public.feedback" does not exist
  LINE 29: from "dw_northwind_metabase"."public"."feedback" f
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_feedback.sql
[0m23:04:12.135557 [debug] [Thread-4 (]: Database Error in model stg_metabase_invoices (models\staging\metabase\stg_metabase_invoices.sql)
  relation "public.invoices" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."invoices" i
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_invoices.sql
[0m23:04:12.137053 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m23:04:12.158254 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:12.159465 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m23:04:12.162145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B6CE990>]}
[0m23:04:12.163334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:04:12.165492 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B6D76A0>]}
[0m23:04:12.173742 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:12.164749 [error] [Thread-3 (]: 3 of 12 ERROR creating sql view model dw_stg.stg_metabase_feedback ............. [[31mERROR[0m in 0.43s]
[0m23:04:12.175955 [error] [Thread-4 (]: 4 of 12 ERROR creating sql view model dw_stg.stg_metabase_invoices ............. [[31mERROR[0m in 0.44s]
[0m23:04:12.177258 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m23:04:12.178946 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:04:12.180852 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:04:12.182346 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:04:12.184230 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_products
[0m23:04:12.185929 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_feedback' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_feedback (models\staging\metabase\stg_metabase_feedback.sql)
  relation "public.feedback" does not exist
  LINE 29: from "dw_northwind_metabase"."public"."feedback" f
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_feedback.sql.
[0m23:04:12.187339 [info ] [Thread-3 (]: 5 of 12 START sql view model dw_stg.stg_metabase_orders ........................ [RUN]
[0m23:04:12.189023 [info ] [Thread-4 (]: 6 of 12 START sql view model dw_stg.stg_metabase_products ...................... [RUN]
[0m23:04:12.193555 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_invoices' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_invoices (models\staging\metabase\stg_metabase_invoices.sql)
  relation "public.invoices" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."invoices" i
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_invoices.sql.
[0m23:04:12.195076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.262 seconds
[0m23:04:12.196192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_feedback, now model.dw_northwind_metabase.stg_metabase_orders)
[0m23:04:12.197341 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_invoices, now model.dw_northwind_metabase.stg_metabase_products)
[0m23:04:12.198793 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:04:12.200024 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m23:04:12.201076 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_products
[0m23:04:12.202099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m23:04:12.203273 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp"
    
    
  as (
    

-- Eventos de analytics (produto/app) para an√°lises de comportamento.
select
    'METABASE'                               as source_system,
    ae.id                                    as source_event_id,
    'METABASE_EVT_' || ae.id                 as event_nk,
    case
        when nullif(ae.account_id, '') is not null then 'METABASE_' || ae.account_id
        else null
    end                                      as customer_nk,
    ae.account_id                            as source_account_id,
    ae.event                                 as event_name,
    case
        when ae."timestamp" ~ '^\d{4}-\d{2}-\d{2}'
            then ae."timestamp"::timestamp
        else null
    end                                      as event_timestamp,
    ae.page_url                              as page_url,
    ae.button_label                          as button_label,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."analyticevents" ae
  );
[0m23:04:12.215242 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.222349 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_products"
[0m23:04:12.262683 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m23:04:12.263892 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.analyticevents" does not exist
LINE 28: from "dw_northwind_metabase"."public"."analyticevents" ae
              ^

[0m23:04:12.265454 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:12.268289 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: ROLLBACK
[0m23:04:12.269690 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m23:04:12.270849 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m23:04:12.272213 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_products
[0m23:04:12.281181 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.282184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m23:04:12.283579 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: Close
[0m23:04:12.291710 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_products"
[0m23:04:12.308748 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m23:04:12.326246 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:04:12.327733 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m23:04:12.329335 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.330414 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m23:04:12.331392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:12.333188 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:04:12.334353 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_products: BEGIN
[0m23:04:12.335497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:04:12.343324 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.014 seconds
[0m23:04:12.350007 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m23:04:12.352294 [debug] [Thread-2 (]: Database Error in model stg_metabase_analytic_events (models\staging\metabase\stg_metabase_analytic_events.sql)
  relation "public.analyticevents" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."analyticevents" ae
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_analytic_events.sql
[0m23:04:12.353757 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224BA4BA70>]}
[0m23:04:12.356917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B65A250>]}
[0m23:04:12.355520 [error] [Thread-2 (]: 2 of 12 ERROR creating sql view model dw_stg.stg_metabase_analytic_events ...... [[31mERROR[0m in 0.65s]
[0m23:04:12.360762 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:04:12.362017 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:04:12.363597 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_analytic_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_analytic_events (models\staging\metabase\stg_metabase_analytic_events.sql)
  relation "public.analyticevents" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."analyticevents" ae
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_analytic_events.sql.
[0m23:04:12.358699 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dw_stg.stg_metabase_accounts ................. [[32mCREATE VIEW[0m in 0.65s]
[0m23:04:12.365081 [info ] [Thread-2 (]: 7 of 12 START sql view model dw_stg.stg_metabase_reviews ....................... [RUN]
[0m23:04:12.367862 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:04:12.369169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_analytic_events, now model.dw_northwind_metabase.stg_metabase_reviews)
[0m23:04:12.370335 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m23:04:12.372789 [info ] [Thread-1 (]: 8 of 12 START sql view model dw_stg.stg_northwind_customers .................... [RUN]
[0m23:04:12.374090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_accounts, now model.dw_northwind_metabase.stg_northwind_customers)
[0m23:04:12.371574 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:04:12.375098 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m23:04:12.383864 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:04:12.391147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.393762 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:04:12.404426 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:04:12.406003 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m23:04:12.415468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.417992 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:04:12.419102 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: BEGIN
[0m23:04:12.420740 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:12.422579 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.424147 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m23:04:12.425399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:12.514783 [debug] [Thread-3 (]: SQL status: BEGIN in 0.183 seconds
[0m23:04:12.515848 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.517410 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m23:04:12.535638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.200 seconds
[0m23:04:12.536781 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:04:12.537962 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_tmp"
    
    
  as (
    

-- Cat√°logo de produtos Metabase Sample (B2C/SaaS) com atributos de pre√ßo e rating.
select
    'METABASE'                               as source_system,
    p.id                                     as source_product_id,
    'METABASE_' || p.id                      as product_nk,
    p.title                                  as product_name,
    p.category                               as category_name,
    p.vendor                                 as vendor_name,
    cast(p.price as numeric(12,4))           as unit_price,
    cast(p.rating as numeric(5,2))           as rating_score,
    case
        when p.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then p.created_at::timestamp
        else null
    end                                     as created_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."products" p
  );
[0m23:04:12.539630 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m23:04:12.540814 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.products" does not exist
LINE 25: from "dw_northwind_metabase"."public"."products" p
              ^

[0m23:04:12.549264 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.550463 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_products: ROLLBACK
[0m23:04:12.551640 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m23:04:12.553613 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_products: Close
[0m23:04:12.555553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:04:12.564974 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.566195 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m23:04:12.568463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:12.572545 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:04:12.585650 [debug] [Thread-4 (]: Database Error in model stg_metabase_products (models\staging\metabase\stg_metabase_products.sql)
  relation "public.products" does not exist
  LINE 25: from "dw_northwind_metabase"."public"."products" p
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_products.sql
[0m23:04:12.596126 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224BAFD1D0>]}
[0m23:04:12.597598 [error] [Thread-4 (]: 6 of 12 ERROR creating sql view model dw_stg.stg_metabase_products ............. [[31mERROR[0m in 0.40s]
[0m23:04:12.594802 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.599178 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_products
[0m23:04:12.600498 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:04:12.601637 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_employees
[0m23:04:12.603071 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_products (models\staging\metabase\stg_metabase_products.sql)
  relation "public.products" does not exist
  LINE 25: from "dw_northwind_metabase"."public"."products" p
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_products.sql.
[0m23:04:12.604740 [info ] [Thread-4 (]: 9 of 12 START sql view model dw_stg.stg_northwind_employees .................... [RUN]
[0m23:04:12.606377 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_products, now model.dw_northwind_metabase.stg_northwind_employees)
[0m23:04:12.607385 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_employees
[0m23:04:12.615746 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:04:12.619774 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_employees
[0m23:04:12.629350 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:04:12.632027 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:04:12.633101 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_employees: BEGIN
[0m23:04:12.634084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:04:12.659053 [debug] [Thread-3 (]: SQL status: COMMIT in 0.055 seconds
[0m23:04:12.664651 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m23:04:12.666704 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:04:12.667784 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m23:04:12.672893 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:04:12.676498 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m23:04:12.678153 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B0964B0>]}
[0m23:04:12.679810 [info ] [Thread-3 (]: 5 of 12 OK created sql view model dw_stg.stg_metabase_orders ................... [[32mCREATE VIEW[0m in 0.48s]
[0m23:04:12.681621 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:04:12.682929 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:04:12.685277 [info ] [Thread-3 (]: 10 of 12 START sql view model dw_stg.stg_northwind_order_details ............... [RUN]
[0m23:04:12.687013 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_order_details)
[0m23:04:12.688365 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:04:12.699961 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:12.702752 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:04:12.710291 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:12.712708 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:12.713732 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m23:04:12.714727 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:12.845661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.420 seconds
[0m23:04:12.846845 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.848167 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m23:04:12.872854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m23:04:12.881419 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.882504 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m23:04:12.884718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:12.892483 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.893930 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m23:04:12.895123 [debug] [Thread-2 (]: SQL status: BEGIN in 0.474 seconds
[0m23:04:12.897126 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:04:12.898599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:04:12.900343 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp"
    
    
  as (
    

-- Reviews p√∫blicos dos produtos Metabase Sample.
select
    'METABASE'                               as source_system,
    r.id                                     as source_review_id,
    'METABASE_RV_' || r.id                   as review_nk,
    case
        when nullif(r.product_id, '') is not null then 'METABASE_' || r.product_id
        else null
    end                                      as product_nk,
    r.product_id                             as source_product_id,
    r.reviewer                               as reviewer_name,
    cast(r.rating as numeric(5,2))           as rating_score,
    case
        when r.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then r.created_at::timestamp
        else null
    end                                      as created_at,
    r.body                                   as review_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."reviews" r
  );
[0m23:04:12.906255 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m23:04:12.908006 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.909387 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.reviews" does not exist
LINE 28: from "dw_northwind_metabase"."public"."reviews" r
              ^

[0m23:04:12.910431 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m23:04:12.911706 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: ROLLBACK
[0m23:04:12.913691 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: Close
[0m23:04:12.932639 [debug] [Thread-2 (]: Database Error in model stg_metabase_reviews (models\staging\metabase\stg_metabase_reviews.sql)
  relation "public.reviews" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."reviews" r
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_reviews.sql
[0m23:04:12.934103 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224BAD35F0>]}
[0m23:04:12.935944 [error] [Thread-2 (]: 7 of 12 ERROR creating sql view model dw_stg.stg_metabase_reviews .............. [[31mERROR[0m in 0.56s]
[0m23:04:12.938349 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:04:12.941736 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m23:04:12.943023 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m23:04:12.944967 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_reviews (models\staging\metabase\stg_metabase_reviews.sql)
  relation "public.reviews" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."reviews" r
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_reviews.sql.
[0m23:04:12.953901 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m23:04:12.955452 [info ] [Thread-2 (]: 11 of 12 START sql view model dw_stg.stg_northwind_orders ...................... [RUN]
[0m23:04:12.958153 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:04:12.959397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_reviews, now model.dw_northwind_metabase.stg_northwind_orders)
[0m23:04:12.960685 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m23:04:12.962103 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m23:04:12.975888 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:12.977083 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m23:04:12.983420 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m23:04:12.986258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224BA57E90>]}
[0m23:04:12.987942 [info ] [Thread-1 (]: 8 of 12 OK created sql view model dw_stg.stg_northwind_customers ............... [[32mCREATE VIEW[0m in 0.61s]
[0m23:04:12.990093 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m23:04:12.991402 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_northwind_products
[0m23:04:12.994126 [info ] [Thread-1 (]: 12 of 12 START sql view model dw_stg.stg_northwind_products .................... [RUN]
[0m23:04:12.996391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_products)
[0m23:04:12.997612 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_products
[0m23:04:13.011069 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m23:04:13.009122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_products"
[0m23:04:13.022687 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.025940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.311 seconds
[0m23:04:13.027109 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:13.028568 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m23:04:13.030435 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.031654 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m23:04:13.035540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:13.038085 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_northwind_products
[0m23:04:13.048439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_products"
[0m23:04:13.049722 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m23:04:13.058085 [debug] [Thread-4 (]: SQL status: BEGIN in 0.424 seconds
[0m23:04:13.059204 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:13.060278 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:04:13.061576 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m23:04:13.063179 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_tmp"
    
    
  as (
    

-- Colaboradores Northwind com atributos de localiza√ß√£o e datas chave.
select
    'NORTHWIND'                                   as source_system,
    e.empid                                       as source_employee_id,
    'NORTHWIND_' || e.empid                       as employee_nk,
    e.firstname                                   as first_name,
    e.lastname                                    as last_name,
    e.title                                       as job_title,
    e.titleofcourtesy                             as courtesy_title,
    cast(e.birthdate as date)                     as birth_date,
    cast(e.hiredate as date)                      as hire_date,
    e.city                                        as city,
    coalesce(nullif(e.region, ''), 'N/A')         as region,
    e.country                                     as country,
    e.postalcode                                  as postal_code,
    e.phone                                       as phone,
    e.extension                                   as phone_extension,
    e.mgrid                                       as manager_empid,
    current_timestamp                             as dw_load_ts
from "dw_northwind_metabase"."public"."employee" e
  );
[0m23:04:13.065729 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:13.067756 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.employee" does not exist
LINE 28: from "dw_northwind_metabase"."public"."employee" e
              ^

[0m23:04:13.069429 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:04:13.077903 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:13.079155 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_employees: ROLLBACK
[0m23:04:13.080401 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_products: BEGIN
[0m23:04:13.081818 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m23:04:13.083912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:13.085420 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_employees: Close
[0m23:04:13.087366 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:13.095113 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m23:04:13.096870 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:13.098488 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m23:04:13.109515 [debug] [Thread-4 (]: Database Error in model stg_northwind_employees (models\staging\northwind\stg_northwind_employees.sql)
  relation "public.employee" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."employee" e
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_employees.sql
[0m23:04:13.110851 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B095A30>]}
[0m23:04:13.112531 [error] [Thread-4 (]: 9 of 12 ERROR creating sql view model dw_stg.stg_northwind_employees ........... [[31mERROR[0m in 0.50s]
[0m23:04:13.114390 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_employees
[0m23:04:13.115969 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_employees' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_employees (models\staging\northwind\stg_northwind_employees.sql)
  relation "public.employee" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."employee" e
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_employees.sql.
[0m23:04:13.125172 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m23:04:13.131568 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m23:04:13.134339 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:04:13.135632 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m23:04:13.139253 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:04:13.142936 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m23:04:13.144789 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B094950>]}
[0m23:04:13.146756 [info ] [Thread-3 (]: 10 of 12 OK created sql view model dw_stg.stg_northwind_order_details .......... [[32mCREATE VIEW[0m in 0.46s]
[0m23:04:13.148735 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:04:13.200980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.168 seconds
[0m23:04:13.202130 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.203334 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m23:04:13.221991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m23:04:13.232023 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.233239 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m23:04:13.235544 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:13.242479 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.243577 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m23:04:13.245461 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:04:13.249531 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m23:04:13.250821 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.268241 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m23:04:13.312129 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m23:04:13.318549 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m23:04:13.320893 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:04:13.321998 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m23:04:13.326292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.243 seconds
[0m23:04:13.327415 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:04:13.328494 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:04:13.329713 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_tmp"
    
    
  as (
    

-- Cat√°logo Northwind com categoria, fornecedor e indicadores de estoque.
select
    'NORTHWIND'                                   as source_system,
    p.productid                                   as source_product_id,
    'NORTHWIND_' || p.productid                   as product_nk,
    p.productname                                 as product_name,
    c.categoryname                                as category_name,
    s.companyname                                 as supplier_name,
    p.quantityperunit                             as package_details,
    cast(p.unitprice as numeric(12,4))            as unit_price,
    p.unitsinstock                                as units_in_stock,
    p.unitsonorder                                as units_on_order,
    p.reorderlevel                                as reorder_level,
    p.discontinued = '1'                          as is_discontinued,
    current_timestamp                             as dw_load_ts
from "dw_northwind_metabase"."public"."product" p
left join "dw_northwind_metabase"."public"."category" c
       on p.categoryid = c.categoryid
left join "dw_northwind_metabase"."public"."supplier" s
       on p.supplierid = s.supplierid
  );
[0m23:04:13.333677 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m23:04:13.335630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224BA7A4B0>]}
[0m23:04:13.338319 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.product" does not exist
LINE 24: from "dw_northwind_metabase"."public"."product" p
              ^

[0m23:04:13.339357 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_products: ROLLBACK
[0m23:04:13.337348 [info ] [Thread-2 (]: 11 of 12 OK created sql view model dw_stg.stg_northwind_orders ................. [[32mCREATE VIEW[0m in 0.38s]
[0m23:04:13.341132 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m23:04:13.342289 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_products: Close
[0m23:04:13.356318 [debug] [Thread-1 (]: Database Error in model stg_northwind_products (models\staging\northwind\stg_northwind_products.sql)
  relation "public.product" does not exist
  LINE 24: from "dw_northwind_metabase"."public"."product" p
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_products.sql
[0m23:04:13.357614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80909edd-fd35-4fb5-92e1-b7889b90b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B097470>]}
[0m23:04:13.359201 [error] [Thread-1 (]: 12 of 12 ERROR creating sql view model dw_stg.stg_northwind_products ........... [[31mERROR[0m in 0.36s]
[0m23:04:13.360969 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_northwind_products
[0m23:04:13.362906 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_products (models\staging\northwind\stg_northwind_products.sql)
  relation "public.product" does not exist
  LINE 24: from "dw_northwind_metabase"."public"."product" p
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_products.sql.
[0m23:04:13.366894 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:13.367940 [debug] [MainThread]: On master: BEGIN
[0m23:04:13.369366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:13.513403 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m23:04:13.514394 [debug] [MainThread]: On master: COMMIT
[0m23:04:13.515136 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:13.515889 [debug] [MainThread]: On master: COMMIT
[0m23:04:13.517387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:13.518128 [debug] [MainThread]: On master: Close
[0m23:04:13.519076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:13.519780 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:04:13.520654 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:04:13.521799 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:04:13.522946 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:04:13.523941 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:04:13.524869 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_employees' was properly closed.
[0m23:04:13.525675 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m23:04:13.526475 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_products' was properly closed.
[0m23:04:13.527229 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m23:04:13.528278 [info ] [MainThread]: 
[0m23:04:13.529348 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m23:04:13.536073 [debug] [MainThread]: Command end result
[0m23:04:13.626940 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:04:13.635590 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:04:13.656237 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:04:13.657239 [info ] [MainThread]: 
[0m23:04:13.658478 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m23:04:13.660016 [info ] [MainThread]: 
[0m23:04:13.661780 [error] [MainThread]: [31mFailure in model stg_metabase_feedback (models\staging\metabase\stg_metabase_feedback.sql)[0m
[0m23:04:13.663597 [error] [MainThread]:   Database Error in model stg_metabase_feedback (models\staging\metabase\stg_metabase_feedback.sql)
  relation "public.feedback" does not exist
  LINE 29: from "dw_northwind_metabase"."public"."feedback" f
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_feedback.sql
[0m23:04:13.666251 [info ] [MainThread]: 
[0m23:04:13.669976 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_feedback.sql
[0m23:04:13.671366 [info ] [MainThread]: 
[0m23:04:13.672886 [error] [MainThread]: [31mFailure in model stg_metabase_invoices (models\staging\metabase\stg_metabase_invoices.sql)[0m
[0m23:04:13.674750 [error] [MainThread]:   Database Error in model stg_metabase_invoices (models\staging\metabase\stg_metabase_invoices.sql)
  relation "public.invoices" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."invoices" i
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_invoices.sql
[0m23:04:13.676002 [info ] [MainThread]: 
[0m23:04:13.678375 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_invoices.sql
[0m23:04:13.680946 [info ] [MainThread]: 
[0m23:04:13.684382 [error] [MainThread]: [31mFailure in model stg_metabase_analytic_events (models\staging\metabase\stg_metabase_analytic_events.sql)[0m
[0m23:04:13.686957 [error] [MainThread]:   Database Error in model stg_metabase_analytic_events (models\staging\metabase\stg_metabase_analytic_events.sql)
  relation "public.analyticevents" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."analyticevents" ae
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_analytic_events.sql
[0m23:04:13.688388 [info ] [MainThread]: 
[0m23:04:13.689652 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_analytic_events.sql
[0m23:04:13.691512 [info ] [MainThread]: 
[0m23:04:13.693104 [error] [MainThread]: [31mFailure in model stg_metabase_products (models\staging\metabase\stg_metabase_products.sql)[0m
[0m23:04:13.694782 [error] [MainThread]:   Database Error in model stg_metabase_products (models\staging\metabase\stg_metabase_products.sql)
  relation "public.products" does not exist
  LINE 25: from "dw_northwind_metabase"."public"."products" p
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_products.sql
[0m23:04:13.695943 [info ] [MainThread]: 
[0m23:04:13.697346 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_products.sql
[0m23:04:13.698237 [info ] [MainThread]: 
[0m23:04:13.699324 [error] [MainThread]: [31mFailure in model stg_metabase_reviews (models\staging\metabase\stg_metabase_reviews.sql)[0m
[0m23:04:13.700906 [error] [MainThread]:   Database Error in model stg_metabase_reviews (models\staging\metabase\stg_metabase_reviews.sql)
  relation "public.reviews" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."reviews" r
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_reviews.sql
[0m23:04:13.701959 [info ] [MainThread]: 
[0m23:04:13.703266 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_reviews.sql
[0m23:04:13.704467 [info ] [MainThread]: 
[0m23:04:13.706590 [error] [MainThread]: [31mFailure in model stg_northwind_employees (models\staging\northwind\stg_northwind_employees.sql)[0m
[0m23:04:13.708290 [error] [MainThread]:   Database Error in model stg_northwind_employees (models\staging\northwind\stg_northwind_employees.sql)
  relation "public.employee" does not exist
  LINE 28: from "dw_northwind_metabase"."public"."employee" e
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_employees.sql
[0m23:04:13.710333 [info ] [MainThread]: 
[0m23:04:13.713143 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_employees.sql
[0m23:04:13.714092 [info ] [MainThread]: 
[0m23:04:13.716165 [error] [MainThread]: [31mFailure in model stg_northwind_products (models\staging\northwind\stg_northwind_products.sql)[0m
[0m23:04:13.717947 [error] [MainThread]:   Database Error in model stg_northwind_products (models\staging\northwind\stg_northwind_products.sql)
  relation "public.product" does not exist
  LINE 24: from "dw_northwind_metabase"."public"."product" p
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_products.sql
[0m23:04:13.719031 [info ] [MainThread]: 
[0m23:04:13.720084 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_products.sql
[0m23:04:13.720885 [info ] [MainThread]: 
[0m23:04:13.764743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=12
[0m23:04:13.769216 [debug] [MainThread]: Command `dbt run` failed at 23:04:13.768778 after 6.60 seconds
[0m23:04:13.770681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222487286B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B3532F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224B604830>]}
[0m23:04:13.773077 [debug] [MainThread]: Flushing usage events
[0m23:04:15.516579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:23.597780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B8EB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B9758B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B9D98E10>]}


============================== 23:05:23.604925 | 54c30022-a58d-4c9b-8a43-b200967863c1 ==============================
[0m23:05:23.604925 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:05:23.606678 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m23:05:24.092522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B90E9F30>]}
[0m23:05:24.266729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B9E1FDF0>]}
[0m23:05:24.270165 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:05:24.910092 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:05:25.183113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:25.184043 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:25.191831 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m23:05:25.272778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB3D5250>]}
[0m23:05:25.409385 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:05:25.415795 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:05:25.462249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB415400>]}
[0m23:05:25.463244 [info ] [MainThread]: Found 24 models, 1 snapshot, 51 data tests, 14 sources, 449 macros
[0m23:05:25.464277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB5D0750>]}
[0m23:05:25.467995 [info ] [MainThread]: 
[0m23:05:25.468719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:25.469342 [info ] [MainThread]: 
[0m23:05:25.470252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:25.480150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:05:25.736135 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:05:25.736676 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:05:25.737066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:25.820551 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.083 seconds
[0m23:05:25.822248 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:05:25.826367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:05:25.838134 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:05:25.838820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:05:25.839321 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:05:25.841929 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:05:25.842586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:05:25.843001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:25.843700 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:05:25.845060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:05:25.847778 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:05:25.848782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:25.851269 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:05:25.851996 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:05:25.852686 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:05:25.853150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:25.853666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:25.937182 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m23:05:25.938132 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:05:25.939018 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:05:25.956149 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m23:05:25.956767 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:05:25.957469 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:05:25.958302 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m23:05:25.961126 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:05:25.962788 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:05:25.963895 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m23:05:25.965422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_snapshots)
[0m23:05:25.966270 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m23:05:25.969406 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:05:25.973106 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:05:25.973813 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:05:25.974463 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m23:05:25.974958 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:05:25.975842 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:05:25.976461 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:05:25.978902 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:05:25.979850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:25.981333 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:05:25.982620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:05:25.987127 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:05:25.988054 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:05:25.988855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:25.993662 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:05:25.995035 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m23:05:25.998559 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:05:26.001497 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:05:26.002683 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:05:26.003457 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:05:26.097225 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m23:05:26.098293 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:05:26.098951 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:05:26.099638 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m23:05:26.100295 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:05:26.101155 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:05:26.112207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m23:05:26.114436 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:05:26.115015 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:05:26.116781 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:05:26.117313 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:05:26.118097 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:05:26.126891 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:26.127582 [debug] [MainThread]: On master: BEGIN
[0m23:05:26.128550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:26.197187 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m23:05:26.197770 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:26.198309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:05:26.212828 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m23:05:26.214833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB79CFC0>]}
[0m23:05:26.215554 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:26.216359 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:26.216837 [debug] [MainThread]: On master: BEGIN
[0m23:05:26.218519 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:05:26.219409 [debug] [MainThread]: On master: COMMIT
[0m23:05:26.220251 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:26.220896 [debug] [MainThread]: On master: COMMIT
[0m23:05:26.221557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:26.222004 [debug] [MainThread]: On master: Close
[0m23:05:26.230601 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:05:26.231300 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:05:26.231841 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:05:26.232361 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:05:26.233112 [info ] [Thread-4 (]: 4 of 12 START sql view model dw_stg.stg_metabase_invoices ...................... [RUN]
[0m23:05:26.234356 [info ] [Thread-3 (]: 3 of 12 START sql view model dw_stg.stg_metabase_feedback ...................... [RUN]
[0m23:05:26.235549 [info ] [Thread-1 (]: 1 of 12 START sql view model dw_stg.stg_metabase_accounts ...................... [RUN]
[0m23:05:26.236608 [info ] [Thread-2 (]: 2 of 12 START sql view model dw_stg.stg_metabase_analytic_events ............... [RUN]
[0m23:05:26.237578 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_invoices'
[0m23:05:26.238366 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_feedback'
[0m23:05:26.239069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m23:05:26.239763 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_analytic_events'
[0m23:05:26.240314 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:05:26.240877 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:05:26.241384 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:05:26.290158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.292562 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:05:26.241927 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:05:26.262358 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.283616 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.362388 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:05:26.321639 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.431325 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.434171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.435583 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:05:26.444792 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.446500 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.447655 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: BEGIN
[0m23:05:26.448722 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:05:26.449787 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.451378 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m23:05:26.452565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:26.454634 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:05:26.465719 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.467821 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.468968 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: BEGIN
[0m23:05:26.470199 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:26.471907 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.473167 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: BEGIN
[0m23:05:26.474279 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:26.579382 [debug] [Thread-4 (]: SQL status: BEGIN in 0.130 seconds
[0m23:05:26.580616 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.581718 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp"
    
    
  as (
    

-- Faturas SaaS (Metabase) com valores normalizados e v√≠nculo ao cliente.
select
    'METABASE'                               as source_system,
    i.id                                     as source_invoice_id,
    'METABASE_' || i.id                      as invoice_nk,
    case
        when nullif(i.account_id, '') is not null then 'METABASE_' || i.account_id
        else null
    end                                      as customer_nk,
    i.account_id                             as source_account_id,
    i.plan                                   as plan_name,
    cast(i.payment as numeric(12,4))         as payment_amount,
    i.expected_invoice                       as expected_invoice_flag,
    case
        when i.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then i.date_received::timestamp
        else null
    end                                      as date_received,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."invoices" i
  );
[0m23:05:26.584387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m23:05:26.585409 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m23:05:26.586443 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.587342 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.588324 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    case
        when a.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.created_at::timestamp
        else null
    end                                   as created_at,
    case
        when a.trial_ends_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.trial_ends_at::timestamp
        else null
    end                                   as trial_ends_at,
    case
        when a.canceled_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.canceled_at::timestamp
        else null
    end                                   as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m23:05:26.589515 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp"
    
    
  as (
    

-- Feedbacks recebidos via canais de suporte Metabase.
select
    'METABASE'                               as source_system,
    f.id                                     as source_feedback_id,
    'METABASE_FB_' || f.id                   as feedback_nk,
    case
        when nullif(f.account_id, '') is not null then 'METABASE_' || f.account_id
        else null
    end                                      as customer_nk,
    f.account_id                             as source_account_id,
    f.email                                  as contact_email,
    cast(f.rating as numeric(5,2))           as rating_score,
    f.rating_mapped                          as rating_label,
    case
        when f.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then f.date_received::timestamp
        else null
    end                                      as date_received,
    f.body                                   as feedback_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."feedback" f
  );
[0m23:05:26.600145 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m23:05:26.612713 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.613969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m23:05:26.614755 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m23:05:26.615370 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp" rename to "stg_metabase_invoices"
[0m23:05:26.620397 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.625754 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.626942 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m23:05:26.628251 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:26.629413 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp" rename to "stg_metabase_feedback"
[0m23:05:26.658159 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: COMMIT
[0m23:05:26.658879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m23:05:26.659666 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.660308 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:26.665929 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.666810 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: COMMIT
[0m23:05:26.669694 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: COMMIT
[0m23:05:26.670536 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m23:05:26.671506 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.672506 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: COMMIT
[0m23:05:26.673494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:26.682996 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m23:05:26.683932 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m23:05:26.685086 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m23:05:26.686253 [debug] [Thread-2 (]: SQL status: BEGIN in 0.212 seconds
[0m23:05:26.686948 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.699059 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_backup"
[0m23:05:26.704477 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_backup"
[0m23:05:26.705604 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.706531 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m23:05:26.717959 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:05:26.719612 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:05:26.720653 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp"
    
    
  as (
    

-- Eventos de analytics (produto/app) para an√°lises de comportamento.
select
    'METABASE'                               as source_system,
    ae.id                                    as source_event_id,
    'METABASE_EVT_' || ae.id                 as event_nk,
    case
        when nullif(ae.account_id, '') is not null then 'METABASE_' || ae.account_id
        else null
    end                                      as customer_nk,
    ae.account_id                            as source_account_id,
    ae.event                                 as event_name,
    case
        when ae."timestamp" ~ '^\d{4}-\d{2}-\d{2}'
            then ae."timestamp"::timestamp
        else null
    end                                      as event_timestamp,
    ae.page_url                              as page_url,
    ae.button_label                          as button_label,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."analyticevents" ae
  );
[0m23:05:26.721500 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_backup" cascade
[0m23:05:26.722296 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_backup" cascade
[0m23:05:26.723020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:05:26.727552 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m23:05:26.729409 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:05:26.730643 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:05:26.732760 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:05:26.737339 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: Close
[0m23:05:26.738033 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:05:26.739998 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: Close
[0m23:05:26.740632 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m23:05:26.750253 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.752781 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp" rename to "stg_metabase_analytic_events"
[0m23:05:26.754751 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB9E8F50>]}
[0m23:05:26.755481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB9B8100>]}
[0m23:05:26.756204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:05:26.758232 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:05:26.757510 [info ] [Thread-4 (]: 4 of 12 OK created sql view model dw_stg.stg_metabase_invoices ................. [[32mCREATE VIEW[0m in 0.51s]
[0m23:05:26.764696 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m23:05:26.759827 [info ] [Thread-3 (]: 3 of 12 OK created sql view model dw_stg.stg_metabase_feedback ................. [[32mCREATE VIEW[0m in 0.51s]
[0m23:05:26.769290 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: COMMIT
[0m23:05:26.771178 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:05:26.772913 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:05:26.774398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BBA9EC10>]}
[0m23:05:26.775467 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.777393 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:05:26.779201 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_products
[0m23:05:26.782338 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: COMMIT
[0m23:05:26.781234 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dw_stg.stg_metabase_accounts ................. [[32mCREATE VIEW[0m in 0.54s]
[0m23:05:26.784567 [info ] [Thread-4 (]: 5 of 12 START sql view model dw_stg.stg_metabase_orders ........................ [RUN]
[0m23:05:26.786227 [info ] [Thread-3 (]: 6 of 12 START sql view model dw_stg.stg_metabase_products ...................... [RUN]
[0m23:05:26.788215 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:05:26.789474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_invoices, now model.dw_northwind_metabase.stg_metabase_orders)
[0m23:05:26.790564 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:05:26.791536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_feedback, now model.dw_northwind_metabase.stg_metabase_products)
[0m23:05:26.792943 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:05:26.794122 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m23:05:26.805138 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_backup"
[0m23:05:26.806088 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_products
[0m23:05:26.807151 [info ] [Thread-1 (]: 7 of 12 START sql view model dw_stg.stg_metabase_reviews ....................... [RUN]
[0m23:05:26.816054 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:26.818262 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:05:26.825597 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:26.826690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_accounts, now model.dw_northwind_metabase.stg_metabase_reviews)
[0m23:05:26.828940 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_backup" cascade
[0m23:05:26.830564 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:05:26.840780 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m23:05:26.841888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:26.842784 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m23:05:26.848554 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:26.852073 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: Close
[0m23:05:26.853281 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_products
[0m23:05:26.855137 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB59E7D0>]}
[0m23:05:26.865028 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:26.868127 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:05:26.866988 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dw_stg.stg_metabase_analytic_events .......... [[32mCREATE VIEW[0m in 0.62s]
[0m23:05:26.870136 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:26.876806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:26.879912 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:05:26.881172 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m23:05:26.882990 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:26.884291 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m23:05:26.885692 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:05:26.887269 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: BEGIN
[0m23:05:26.889151 [info ] [Thread-2 (]: 8 of 12 START sql view model dw_stg.stg_northwind_customers .................... [RUN]
[0m23:05:26.891076 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:05:26.892421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_analytic_events, now model.dw_northwind_metabase.stg_northwind_customers)
[0m23:05:26.893929 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:26.896208 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m23:05:26.897555 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: BEGIN
[0m23:05:26.907518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:26.906465 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:26.910177 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m23:05:26.922505 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:26.935455 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:26.937504 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m23:05:26.943222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:05:27.110687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.203 seconds
[0m23:05:27.112629 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:27.114083 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp"
    
    
  as (
    

-- Reviews p√∫blicos dos produtos Metabase Sample.
select
    'METABASE'                               as source_system,
    r.id                                     as source_review_id,
    'METABASE_RV_' || r.id                   as review_nk,
    case
        when nullif(r.product_id, '') is not null then 'METABASE_' || r.product_id
        else null
    end                                      as product_nk,
    r.product_id                             as source_product_id,
    r.reviewer                               as reviewer_name,
    cast(r.rating as numeric(5,2))           as rating_score,
    case
        when r.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then r.created_at::timestamp
        else null
    end                                      as created_at,
    r.body                                   as review_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."reviews" r
  );
[0m23:05:27.130046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:05:27.137852 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:27.139045 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp" rename to "stg_metabase_reviews"
[0m23:05:27.141100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.145021 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:05:27.147413 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:27.148701 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:05:27.155322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:05:27.166329 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup"
[0m23:05:27.169440 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:05:27.170776 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup" cascade
[0m23:05:27.172581 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:05:27.176115 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: Close
[0m23:05:27.180191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB9E7B60>]}
[0m23:05:27.182626 [info ] [Thread-1 (]: 7 of 12 OK created sql view model dw_stg.stg_metabase_reviews .................. [[32mCREATE VIEW[0m in 0.35s]
[0m23:05:27.184767 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:05:27.186071 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_northwind_employees
[0m23:05:27.187651 [info ] [Thread-1 (]: 9 of 12 START sql view model dw_stg.stg_northwind_employees .................... [RUN]
[0m23:05:27.189075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_reviews, now model.dw_northwind_metabase.stg_northwind_employees)
[0m23:05:27.190250 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_employees
[0m23:05:27.199392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.203521 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_northwind_employees
[0m23:05:27.221148 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.223954 [debug] [Thread-4 (]: SQL status: BEGIN in 0.338 seconds
[0m23:05:27.225255 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:27.226592 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m23:05:27.229869 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.231643 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: BEGIN
[0m23:05:27.232923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:27.242649 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:05:27.250434 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:27.251592 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m23:05:27.254016 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.261639 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:27.263268 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m23:05:27.266088 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.270579 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:05:27.271795 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:27.272960 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:05:27.282831 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m23:05:27.289899 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m23:05:27.292009 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:05:27.293234 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m23:05:27.297801 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:05:27.301587 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m23:05:27.303384 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB5508F0>]}
[0m23:05:27.305198 [info ] [Thread-4 (]: 5 of 12 OK created sql view model dw_stg.stg_metabase_orders ................... [[32mCREATE VIEW[0m in 0.51s]
[0m23:05:27.307135 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:05:27.308321 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:05:27.309872 [info ] [Thread-4 (]: 10 of 12 START sql view model dw_stg.stg_northwind_order_details ............... [RUN]
[0m23:05:27.311331 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_order_details)
[0m23:05:27.312705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.422 seconds
[0m23:05:27.313808 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:05:27.314999 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:27.322985 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.324341 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_tmp"
    
    
  as (
    

-- Cat√°logo de produtos Metabase Sample (B2C/SaaS) com atributos de pre√ßo e rating.
select
    'METABASE'                               as source_system,
    p.id                                     as source_product_id,
    'METABASE_' || p.id                      as product_nk,
    p.title                                  as product_name,
    p.category                               as category_name,
    p.vendor                                 as vendor_name,
    cast(p.price as numeric(12,4))           as unit_price,
    cast(p.rating as numeric(5,2))           as rating_score,
    case
        when p.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then p.created_at::timestamp
        else null
    end                                     as created_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."products" p
  );
[0m23:05:27.327442 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:05:27.338165 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.339899 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:05:27.347647 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:27.348801 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_tmp" rename to "stg_metabase_products"
[0m23:05:27.350706 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.351924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:05:27.352973 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m23:05:27.356992 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: COMMIT
[0m23:05:27.358455 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:05:27.359855 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:27.361346 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: COMMIT
[0m23:05:27.373255 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m23:05:27.379096 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_backup"
[0m23:05:27.381253 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:05:27.382648 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_backup" cascade
[0m23:05:27.384518 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:05:27.388105 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: Close
[0m23:05:27.389774 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB495310>]}
[0m23:05:27.391553 [info ] [Thread-3 (]: 6 of 12 OK created sql view model dw_stg.stg_metabase_products ................. [[32mCREATE VIEW[0m in 0.60s]
[0m23:05:27.393453 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_products
[0m23:05:27.394670 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m23:05:27.396356 [info ] [Thread-3 (]: 11 of 12 START sql view model dw_stg.stg_northwind_orders ...................... [RUN]
[0m23:05:27.397757 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_products, now model.dw_northwind_metabase.stg_northwind_orders)
[0m23:05:27.398906 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m23:05:27.407920 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.410407 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m23:05:27.419607 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.422239 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.423349 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m23:05:27.424443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:05:27.433099 [debug] [Thread-2 (]: SQL status: BEGIN in 0.490 seconds
[0m23:05:27.434364 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:27.435825 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m23:05:27.453847 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m23:05:27.462824 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:27.464199 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m23:05:27.466310 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.473407 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:27.474504 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m23:05:27.476576 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.481093 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m23:05:27.482378 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:27.483513 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m23:05:27.493390 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m23:05:27.500103 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m23:05:27.502185 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:05:27.503328 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m23:05:27.514960 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:05:27.519081 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m23:05:27.520815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B9F67890>]}
[0m23:05:27.522608 [info ] [Thread-2 (]: 8 of 12 OK created sql view model dw_stg.stg_northwind_customers ............... [[32mCREATE VIEW[0m in 0.63s]
[0m23:05:27.524706 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m23:05:27.526645 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_products
[0m23:05:27.528334 [info ] [Thread-2 (]: 12 of 12 START sql view model dw_stg.stg_northwind_products .................... [RUN]
[0m23:05:27.529977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_products)
[0m23:05:27.531235 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_products
[0m23:05:27.541666 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.544562 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_products
[0m23:05:27.554859 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.557748 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.559010 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: BEGIN
[0m23:05:27.560495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:05:27.566801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.334 seconds
[0m23:05:27.567979 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.569291 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_tmp"
    
    
  as (
    

-- Colaboradores Northwind com atributos de localiza√ß√£o e datas chave.
select
    'NORTHWIND'                                   as source_system,
    e.empid                                       as source_employee_id,
    'NORTHWIND_' || e.empid                       as employee_nk,
    e.firstname                                   as first_name,
    e.lastname                                    as last_name,
    e.title                                       as job_title,
    e.titleofcourtesy                             as courtesy_title,
    cast(e.birthdate as date)                     as birth_date,
    cast(e.hiredate as date)                      as hire_date,
    e.city                                        as city,
    coalesce(nullif(e.region, ''), 'N/A')         as region,
    e.country                                     as country,
    e.postalcode                                  as postal_code,
    e.phone                                       as phone,
    e.extension                                   as phone_extension,
    e.mgrid                                       as manager_empid,
    current_timestamp                             as dw_load_ts
from "dw_northwind_metabase"."public"."employee" e
  );
[0m23:05:27.570616 [debug] [Thread-4 (]: SQL status: BEGIN in 0.212 seconds
[0m23:05:27.572100 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.573497 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m23:05:27.587792 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m23:05:27.597467 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.598681 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m23:05:27.599843 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_tmp" rename to "stg_northwind_employees"
[0m23:05:27.607711 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.609144 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m23:05:27.610386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.614483 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: COMMIT
[0m23:05:27.615622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:05:27.616645 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.624371 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.625648 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: COMMIT
[0m23:05:27.626868 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m23:05:27.629367 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.633648 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m23:05:27.634860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:05:27.635992 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.653144 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_backup"
[0m23:05:27.654258 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m23:05:27.656828 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:05:27.658558 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_backup" cascade
[0m23:05:27.659870 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:05:27.666189 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m23:05:27.667557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:05:27.669498 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:05:27.670636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.246 seconds
[0m23:05:27.674270 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_employees: Close
[0m23:05:27.675531 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m23:05:27.676614 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.678166 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m23:05:27.681302 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:05:27.686489 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m23:05:27.688263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB373530>]}
[0m23:05:27.690097 [info ] [Thread-4 (]: 10 of 12 OK created sql view model dw_stg.stg_northwind_order_details .......... [[32mCREATE VIEW[0m in 0.38s]
[0m23:05:27.691988 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:05:27.693288 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m23:05:27.700420 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.701558 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m23:05:27.705136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:05:27.712748 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.713876 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m23:05:27.682770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B9F67110>]}
[0m23:05:27.721011 [info ] [Thread-1 (]: 9 of 12 OK created sql view model dw_stg.stg_northwind_employees ............... [[32mCREATE VIEW[0m in 0.49s]
[0m23:05:27.722759 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_northwind_employees
[0m23:05:27.723851 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m23:05:27.734986 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m23:05:27.736190 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.737173 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m23:05:27.771813 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m23:05:27.779242 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m23:05:27.781488 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:05:27.782780 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m23:05:27.808667 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.025 seconds
[0m23:05:27.812566 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m23:05:27.814734 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB373650>]}
[0m23:05:27.816640 [info ] [Thread-3 (]: 11 of 12 OK created sql view model dw_stg.stg_northwind_orders ................. [[32mCREATE VIEW[0m in 0.42s]
[0m23:05:27.818593 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m23:05:27.862685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.302 seconds
[0m23:05:27.863986 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.865404 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_tmp"
    
    
  as (
    

-- Cat√°logo Northwind com categoria, fornecedor e indicadores de estoque.
select
    'NORTHWIND'                                   as source_system,
    p.productid                                   as source_product_id,
    'NORTHWIND_' || p.productid                   as product_nk,
    p.productname                                 as product_name,
    c.categoryname                                as category_name,
    s.companyname                                 as supplier_name,
    p.quantityperunit                             as package_details,
    cast(p.unitprice as numeric(12,4))            as unit_price,
    p.unitsinstock                                as units_in_stock,
    p.unitsonorder                                as units_on_order,
    p.reorderlevel                                as reorder_level,
    p.discontinued = '1'                          as is_discontinued,
    current_timestamp                             as dw_load_ts
from "dw_northwind_metabase"."public"."product" p
left join "dw_northwind_metabase"."public"."category" c
       on p.categoryid = c.categoryid
left join "dw_northwind_metabase"."public"."supplier" s
       on p.supplierid = s.supplierid
  );
[0m23:05:27.881013 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:05:27.887170 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.887954 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_tmp" rename to "stg_northwind_products"
[0m23:05:27.889356 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:27.891874 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: COMMIT
[0m23:05:27.892568 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.893148 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: COMMIT
[0m23:05:27.897677 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:05:27.902830 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_backup"
[0m23:05:27.904640 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:05:27.905423 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_backup" cascade
[0m23:05:27.906686 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:05:27.910181 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_products: Close
[0m23:05:27.912442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c30022-a58d-4c9b-8a43-b200967863c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB371130>]}
[0m23:05:27.915235 [info ] [Thread-2 (]: 12 of 12 OK created sql view model dw_stg.stg_northwind_products ............... [[32mCREATE VIEW[0m in 0.38s]
[0m23:05:27.917864 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_products
[0m23:05:27.921842 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:27.922866 [debug] [MainThread]: On master: BEGIN
[0m23:05:27.923791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:28.033049 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m23:05:28.034093 [debug] [MainThread]: On master: COMMIT
[0m23:05:28.034923 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:28.035520 [debug] [MainThread]: On master: COMMIT
[0m23:05:28.036658 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:05:28.037359 [debug] [MainThread]: On master: Close
[0m23:05:28.038234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:28.038865 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:05:28.039448 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:05:28.039970 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:05:28.040683 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:05:28.041439 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:05:28.042081 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m23:05:28.042633 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m23:05:28.043116 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_employees' was properly closed.
[0m23:05:28.043580 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_products' was properly closed.
[0m23:05:28.044253 [info ] [MainThread]: 
[0m23:05:28.044992 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m23:05:28.051647 [debug] [MainThread]: Command end result
[0m23:05:28.161870 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:05:28.171352 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:05:28.189239 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:05:28.190262 [info ] [MainThread]: 
[0m23:05:28.191392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:28.192743 [info ] [MainThread]: 
[0m23:05:28.193869 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m23:05:28.197558 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:28.197202 after 4.84 seconds
[0m23:05:28.198531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B9F66690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B90906B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BB9DBB90>]}
[0m23:05:28.199502 [debug] [MainThread]: Flushing usage events
[0m23:05:29.756695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:42.239339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D508B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D52158B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D52798E10>]}


============================== 23:05:42.246397 | 6be52fb8-ea81-43bb-b084-ea12441885cb ==============================
[0m23:05:42.246397 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:05:42.247487 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_product dim_employee fact_invoices fact_feedback fact_reviews fact_analytic_events', 'printer_width': '80', 'target_path': 'None'}
[0m23:05:42.672508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D50AE9F30>]}
[0m23:05:42.793736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5281FDF0>]}
[0m23:05:42.795473 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:05:43.348186 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:05:43.621768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:43.622280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:43.630214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m23:05:43.723566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D52DD1250>]}
[0m23:05:43.897151 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:05:43.903293 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:05:43.955215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D52E19400>]}
[0m23:05:43.956065 [info ] [MainThread]: Found 24 models, 1 snapshot, 51 data tests, 14 sources, 449 macros
[0m23:05:43.956697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D52FE0750>]}
[0m23:05:43.962534 [info ] [MainThread]: 
[0m23:05:43.963194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:43.963875 [info ] [MainThread]: 
[0m23:05:43.964929 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:44.032181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:05:44.315062 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:05:44.315632 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:05:44.316158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:44.411728 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.095 seconds
[0m23:05:44.413514 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:05:44.418191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:05:44.428129 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:05:44.428882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:05:44.429373 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:05:44.432354 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:05:44.433097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:05:44.433587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:44.434385 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:05:44.435311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:05:44.439770 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:05:44.441316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:44.444908 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:05:44.445885 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:05:44.446876 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:05:44.447684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:44.448691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:44.543932 [debug] [ThreadPool]: SQL status: BEGIN in 0.110 seconds
[0m23:05:44.544880 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:05:44.545625 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:05:44.561223 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:05:44.564698 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:05:44.566211 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:05:44.567047 [debug] [ThreadPool]: SQL status: BEGIN in 0.126 seconds
[0m23:05:44.567644 [debug] [ThreadPool]: SQL status: BEGIN in 0.120 seconds
[0m23:05:44.569033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_snapshots)
[0m23:05:44.569766 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:05:44.570536 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:05:44.573855 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:05:44.574449 [debug] [ThreadPool]: SQL status: BEGIN in 0.126 seconds
[0m23:05:44.574966 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:05:44.575703 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:05:44.576551 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:05:44.577200 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:05:44.578036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:44.579057 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:05:44.592833 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:05:44.593797 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.016 seconds
[0m23:05:44.596519 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:05:44.597488 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.017 seconds
[0m23:05:44.600189 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:05:44.603284 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:05:44.604310 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:05:44.605426 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:05:44.606644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:05:44.607471 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:05:44.611322 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:05:44.614939 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:05:44.619833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:44.690518 [debug] [ThreadPool]: SQL status: BEGIN in 0.112 seconds
[0m23:05:44.691344 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:05:44.691852 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:05:44.707592 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m23:05:44.709647 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:05:44.710523 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:05:44.725172 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:05:44.726058 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:05:44.726782 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:05:44.741820 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:05:44.745047 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:05:44.746280 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:05:44.761710 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:44.762609 [debug] [MainThread]: On master: BEGIN
[0m23:05:44.763133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:44.856205 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m23:05:44.856798 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:44.857362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:05:44.870857 [debug] [MainThread]: SQL status: SELECT 14 in 0.013 seconds
[0m23:05:44.873139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D531A8EF0>]}
[0m23:05:44.873899 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:44.874800 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:44.875323 [debug] [MainThread]: On master: BEGIN
[0m23:05:44.876229 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:05:44.876712 [debug] [MainThread]: On master: COMMIT
[0m23:05:44.877162 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:44.877581 [debug] [MainThread]: On master: COMMIT
[0m23:05:44.878152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:44.878589 [debug] [MainThread]: On master: Close
[0m23:05:44.887865 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.fact_analytic_events
[0m23:05:44.888798 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.fact_feedback
[0m23:05:44.889395 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_employee
[0m23:05:44.889982 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dim_product
[0m23:05:44.891097 [info ] [Thread-3 (]: 3 of 6 START sql table model dw_dw.fact_analytic_events ........................ [RUN]
[0m23:05:44.892942 [info ] [Thread-4 (]: 4 of 6 START sql table model dw_dw.fact_feedback ............................... [RUN]
[0m23:05:44.894868 [info ] [Thread-1 (]: 1 of 6 START sql table model dw_dw.dim_employee ................................ [RUN]
[0m23:05:44.896032 [info ] [Thread-2 (]: 2 of 6 START sql table model dw_dw.dim_product ................................. [RUN]
[0m23:05:44.897336 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_analytic_events'
[0m23:05:44.898251 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_feedback'
[0m23:05:44.899039 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_employee'
[0m23:05:44.899764 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_product'
[0m23:05:44.900358 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.fact_analytic_events
[0m23:05:44.900961 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.fact_feedback
[0m23:05:44.902521 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_employee
[0m23:05:44.903540 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dim_product
[0m23:05:44.917369 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:44.923594 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_feedback"
[0m23:05:44.928124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_employee"
[0m23:05:44.933186 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_product"
[0m23:05:44.937784 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.fact_analytic_events
[0m23:05:44.968784 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.fact_feedback
[0m23:05:44.983967 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dim_product
[0m23:05:44.984810 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_employee
[0m23:05:45.029527 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:45.034538 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_product"
[0m23:05:45.035534 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_feedback"
[0m23:05:45.040679 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_employee"
[0m23:05:45.043302 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m23:05:45.044437 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: BEGIN
[0m23:05:45.045541 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:45.046876 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:45.047832 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m23:05:45.048509 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:05:45.049090 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: BEGIN
[0m23:05:45.049730 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: BEGIN
[0m23:05:45.050293 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: BEGIN
[0m23:05:45.050960 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:45.052019 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:45.052943 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:05:45.143461 [debug] [Thread-2 (]: SQL status: BEGIN in 0.098 seconds
[0m23:05:45.144289 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m23:05:45.145208 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_product__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de produtos combinando cat√°logo Northwind (B2B) e Metabase (B2C/SaaS).
with unioned as (
    select
        product_nk,
        source_system,
        source_product_id,
        product_name,
        category_name,
        supplier_name,
        null::varchar                        as vendor_name,
        package_details,
        unit_price,
        units_in_stock,
        units_on_order,
        reorder_level,
        null::numeric(5,2)                   as rating_score,
        null::timestamp                      as product_created_at,
        is_discontinued,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_products"

    union all

    select
        product_nk,
        source_system,
        source_product_id,
        product_name,
        category_name,
        null::varchar                        as supplier_name,
        vendor_name,
        null::varchar                        as package_details,
        unit_price,
        null::integer                        as units_in_stock,
        null::integer                        as units_on_order,
        null::integer                        as reorder_level,
        rating_score,
        created_at                           as product_created_at,
        false                                 as is_discontinued,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_products"
)
select
    row_number() over (order by product_nk)    as product_sk,
    *
from unioned
  );
  
[0m23:05:45.158066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.106 seconds
[0m23:05:45.158910 [debug] [Thread-3 (]: SQL status: BEGIN in 0.108 seconds
[0m23:05:45.159824 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m23:05:45.160669 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:45.161620 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de colaboradores (Northwind) para an√°lises B2B.
select
    row_number() over (order by employee_nk)   as employee_sk,
    employee_nk,
    source_system,
    source_employee_id,
    first_name,
    last_name,
    job_title,
    courtesy_title,
    birth_date,
    hire_date,
    city,
    region,
    country,
    postal_code,
    phone,
    phone_extension,
    manager_empid,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"
  );
  
[0m23:05:45.162568 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de eventos de produto / analytics.
select
    event_nk,
    source_system,
    source_event_id,
    customer_nk,
    source_account_id,
    event_name,
    event_timestamp,
    page_url,
    button_label,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events"
  );
  
[0m23:05:45.167987 [debug] [Thread-4 (]: SQL status: BEGIN in 0.115 seconds
[0m23:05:45.169316 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:05:45.170688 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de feedback (NPS / avalia√ß√µes de suporte).
select
    feedback_nk,
    source_system,
    source_feedback_id,
    customer_nk,
    source_account_id,
    contact_email,
    rating_score,
    rating_label,
    date_received,
    feedback_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback"
  );
  
[0m23:05:45.335139 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.171 seconds
[0m23:05:45.359545 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m23:05:45.360566 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.189 seconds
[0m23:05:45.361521 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m23:05:45.366578 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:05:45.367386 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_tmp" rename to "fact_feedback"
[0m23:05:45.368357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:45.395687 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: COMMIT
[0m23:05:45.396418 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m23:05:45.397056 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m23:05:45.399568 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: COMMIT
[0m23:05:45.400462 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: COMMIT
[0m23:05:45.401254 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:05:45.402545 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: COMMIT
[0m23:05:45.447487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m23:05:45.462392 [debug] [Thread-4 (]: SQL status: COMMIT in 0.059 seconds
[0m23:05:45.463400 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_backup"
[0m23:05:45.466982 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_backup"
[0m23:05:45.478160 [debug] [Thread-2 (]: SQL status: SELECT 277 in 0.332 seconds
[0m23:05:45.479062 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m23:05:45.480515 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:05:45.485537 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m23:05:45.486948 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_backup" cascade
[0m23:05:45.488160 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_backup" cascade
[0m23:05:45.489405 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_product__dbt_tmp" rename to "dim_product"
[0m23:05:45.491005 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:05:45.492059 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:45.498281 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_employee: Close
[0m23:05:45.498949 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m23:05:45.501092 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: COMMIT
[0m23:05:45.506021 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_feedback: Close
[0m23:05:45.511712 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m23:05:45.513139 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: COMMIT
[0m23:05:45.515480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D533F4D10>]}
[0m23:05:45.516650 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D53358730>]}
[0m23:05:45.518356 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dw_dw.dim_employee ........................... [[32mSELECT 9[0m in 0.61s]
[0m23:05:45.523065 [info ] [Thread-4 (]: 4 of 6 OK created sql table model dw_dw.fact_feedback .......................... [[32mSELECT 642[0m in 0.62s]
[0m23:05:45.524737 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:05:45.526825 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_employee
[0m23:05:45.528432 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.fact_feedback
[0m23:05:45.532264 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_product__dbt_backup"
[0m23:05:45.533251 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_invoices
[0m23:05:45.534228 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.fact_reviews
[0m23:05:45.537485 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m23:05:45.538704 [info ] [Thread-1 (]: 5 of 6 START sql table model dw_dw.fact_invoices ............................... [RUN]
[0m23:05:45.540089 [info ] [Thread-4 (]: 6 of 6 START sql table model dw_dw.fact_reviews ................................ [RUN]
[0m23:05:45.541467 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_product__dbt_backup" cascade
[0m23:05:45.542469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_employee, now model.dw_northwind_metabase.fact_invoices)
[0m23:05:45.543200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_feedback, now model.dw_northwind_metabase.fact_reviews)
[0m23:05:45.544260 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_invoices
[0m23:05:45.544936 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:05:45.545668 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.fact_reviews
[0m23:05:45.553420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_invoices"
[0m23:05:45.557145 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: Close
[0m23:05:45.562070 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_reviews"
[0m23:05:45.563697 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5337A030>]}
[0m23:05:45.565517 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dw_dw.dim_product ............................ [[32mSELECT 277[0m in 0.66s]
[0m23:05:45.567786 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dim_product
[0m23:05:45.570266 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.fact_reviews
[0m23:05:45.586435 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_reviews"
[0m23:05:45.587677 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_invoices
[0m23:05:45.594509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_invoices"
[0m23:05:45.595879 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:05:45.596968 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: BEGIN
[0m23:05:45.598065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:05:45.599467 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:05:45.600507 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: BEGIN
[0m23:05:45.602413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:45.746314 [debug] [Thread-4 (]: SQL status: BEGIN in 0.148 seconds
[0m23:05:45.747500 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:05:45.748659 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de reviews p√∫blicos (produtos Metabase).
select
    review_nk,
    source_system,
    source_review_id,
    product_nk,
    source_product_id,
    reviewer_name,
    rating_score,
    created_at,
    review_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
  );
  
[0m23:05:45.866273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.264 seconds
[0m23:05:45.867478 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:05:45.869086 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de faturamento SaaS (faturas Metabase).
select
    invoice_nk,
    source_system,
    source_invoice_id,
    customer_nk,
    source_account_id,
    plan_name,
    payment_amount,
    expected_invoice_flag,
    date_received,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices"
  );
  
[0m23:05:46.090262 [debug] [Thread-3 (]: SQL status: SELECT 37169 in 0.926 seconds
[0m23:05:46.097020 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:46.098068 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_tmp" rename to "fact_analytic_events"
[0m23:05:46.099890 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:46.103854 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: COMMIT
[0m23:05:46.105245 [debug] [Thread-4 (]: SQL status: SELECT 1112 in 0.355 seconds
[0m23:05:46.106369 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:46.112028 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:05:46.112853 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: COMMIT
[0m23:05:46.113846 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp" rename to "fact_reviews"
[0m23:05:46.116438 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:46.120818 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:05:46.122248 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:05:46.123424 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:05:46.124425 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:05:46.129301 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_backup"
[0m23:05:46.130406 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m23:05:46.132413 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:05:46.139324 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup"
[0m23:05:46.140372 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_backup" cascade
[0m23:05:46.141894 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:05:46.142710 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup" cascade
[0m23:05:46.143393 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:05:46.145829 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_analytic_events: Close
[0m23:05:46.146563 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:05:46.149479 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_reviews: Close
[0m23:05:46.150407 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D531F2750>]}
[0m23:05:46.153762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5349FF50>]}
[0m23:05:46.151976 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dw_dw.fact_analytic_events ................... [[32mSELECT 37169[0m in 1.25s]
[0m23:05:46.155831 [info ] [Thread-4 (]: 6 of 6 OK created sql table model dw_dw.fact_reviews ........................... [[32mSELECT 1112[0m in 0.61s]
[0m23:05:46.159108 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.fact_analytic_events
[0m23:05:46.161143 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.fact_reviews
[0m23:05:46.273012 [debug] [Thread-1 (]: SQL status: SELECT 13856 in 0.403 seconds
[0m23:05:46.278082 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:05:46.278841 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_tmp" rename to "fact_invoices"
[0m23:05:46.280380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:46.283143 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: COMMIT
[0m23:05:46.283890 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:05:46.284487 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: COMMIT
[0m23:05:46.290987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:05:46.295614 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_backup"
[0m23:05:46.296936 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:05:46.297583 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_backup" cascade
[0m23:05:46.299177 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:05:46.302886 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_invoices: Close
[0m23:05:46.304679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be52fb8-ea81-43bb-b084-ea12441885cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5296B710>]}
[0m23:05:46.306250 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dw_dw.fact_invoices .......................... [[32mSELECT 13856[0m in 0.76s]
[0m23:05:46.307907 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_invoices
[0m23:05:46.310979 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:46.312033 [debug] [MainThread]: On master: BEGIN
[0m23:05:46.312671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:46.408247 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m23:05:46.409108 [debug] [MainThread]: On master: COMMIT
[0m23:05:46.409721 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:46.410301 [debug] [MainThread]: On master: COMMIT
[0m23:05:46.411744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:46.412427 [debug] [MainThread]: On master: Close
[0m23:05:46.413226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:46.413720 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:05:46.414343 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:05:46.414879 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:05:46.415320 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:05:46.415809 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:05:46.416306 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_analytic_events' was properly closed.
[0m23:05:46.416809 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_reviews' was properly closed.
[0m23:05:46.417335 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_invoices' was properly closed.
[0m23:05:46.417774 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_product' was properly closed.
[0m23:05:46.418565 [info ] [MainThread]: 
[0m23:05:46.419583 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m23:05:46.422879 [debug] [MainThread]: Command end result
[0m23:05:46.590494 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:05:46.603511 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:05:46.637912 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:05:46.638984 [info ] [MainThread]: 
[0m23:05:46.640427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:46.641633 [info ] [MainThread]: 
[0m23:05:46.643131 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m23:05:46.648448 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:46.647967 after 4.59 seconds
[0m23:05:46.649205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D52A11670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D520CF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D509DF590>]}
[0m23:05:46.649823 [debug] [MainThread]: Flushing usage events
[0m23:05:48.022412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:06:01.991625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919FEB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A0758B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A0D98E10>]}


============================== 23:06:02.001563 | a3226690-9cd5-4492-b827-8a3cb9539465 ==============================
[0m23:06:02.001563 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:06:02.003193 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dm_sales dm_b2b dm_b2c', 'printer_width': '80', 'write_json': 'True'}
[0m23:06:02.365135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A00E9F30>]}
[0m23:06:02.552617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A0E1FDF0>]}
[0m23:06:02.555337 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:06:03.259828 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:06:03.521804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:06:03.522276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:06:03.533445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m23:06:03.612911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A24C1250>]}
[0m23:06:03.767656 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:06:03.771658 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:06:03.820382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A252D400>]}
[0m23:06:03.821154 [info ] [MainThread]: Found 24 models, 1 snapshot, 51 data tests, 14 sources, 449 macros
[0m23:06:03.821720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A26D4750>]}
[0m23:06:03.827584 [info ] [MainThread]: 
[0m23:06:03.828700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:06:03.829343 [info ] [MainThread]: 
[0m23:06:03.830376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:03.837530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:06:03.854585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:06:03.943841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:06:04.103943 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:06:04.104541 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:06:04.105087 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:06:04.105618 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:06:04.106103 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:06:04.106620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.107139 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:06:04.107596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.108613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.215446 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.108 seconds
[0m23:06:04.216099 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.109 seconds
[0m23:06:04.218200 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:06:04.220309 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:06:04.223098 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.114 seconds
[0m23:06:04.225571 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:06:04.227760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dm_b2c)
[0m23:06:04.229165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dm_b2b)
[0m23:06:04.229952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dm_sales)
[0m23:06:04.236083 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dm_b2c"
"
[0m23:06:04.237065 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dm_b2b"
"
[0m23:06:04.237790 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dm_sales"
"
[0m23:06:04.246585 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_b2c"
[0m23:06:04.249954 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_b2b"
[0m23:06:04.252319 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_sales"
[0m23:06:04.252897 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:06:04.253398 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:06:04.253879 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:06:04.254345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:04.254800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:04.255243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:04.358987 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m23:06:04.360358 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_sales"
[0m23:06:04.361683 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dm_sales"} */
create schema if not exists "dw_dm_sales"
[0m23:06:04.366857 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m23:06:04.369451 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_sales: COMMIT
[0m23:06:04.370767 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_sales"
[0m23:06:04.371738 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m23:06:04.372508 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_sales: COMMIT
[0m23:06:04.373108 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m23:06:04.373766 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_b2b"
[0m23:06:04.374656 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_b2c"
[0m23:06:04.375741 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dm_b2b"} */
create schema if not exists "dw_dm_b2b"
[0m23:06:04.376910 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m23:06:04.377875 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dm_b2c"} */
create schema if not exists "dw_dm_b2c"
[0m23:06:04.379268 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_sales: Close
[0m23:06:04.382594 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m23:06:04.383662 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m23:06:04.385996 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2c: COMMIT
[0m23:06:04.388047 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2b: COMMIT
[0m23:06:04.388813 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_b2c"
[0m23:06:04.389595 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_b2b"
[0m23:06:04.390144 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2c: COMMIT
[0m23:06:04.390741 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2b: COMMIT
[0m23:06:04.393432 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m23:06:04.394214 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:06:04.394839 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m23:06:04.395794 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:06:04.403325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:06:04.413034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:06:04.412340 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:06:04.417397 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:06:04.418146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:06:04.418622 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:06:04.419435 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:06:04.420343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:06:04.422627 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:06:04.423298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.423865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.426699 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:06:04.427453 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:06:04.430710 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:06:04.431519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.432208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:04.533695 [debug] [ThreadPool]: SQL status: BEGIN in 0.110 seconds
[0m23:06:04.534625 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:06:04.535460 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:06:04.541577 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m23:06:04.542588 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:06:04.543785 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:06:04.551114 [debug] [ThreadPool]: SQL status: BEGIN in 0.120 seconds
[0m23:06:04.552105 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m23:06:04.552843 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:06:04.555121 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:06:04.555841 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:06:04.556749 [debug] [ThreadPool]: SQL status: BEGIN in 0.125 seconds
[0m23:06:04.557561 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:06:04.558395 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:06:04.559301 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m23:06:04.560500 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:06:04.562305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:06:04.565795 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:06:04.570700 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:06:04.571603 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:06:04.572239 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:06:04.572862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:04.573401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.017 seconds
[0m23:06:04.574774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:06:04.578365 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:06:04.588077 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:06:04.588927 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m23:06:04.590011 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:06:04.590967 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:06:04.594579 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:06:04.595765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:04.597523 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:06:04.670099 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m23:06:04.670716 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:06:04.671221 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:06:04.687009 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:06:04.689102 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:06:04.690065 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:06:04.690688 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m23:06:04.691257 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:06:04.692159 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:06:04.705980 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:06:04.707847 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:06:04.708915 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:06:04.722490 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:04.723172 [debug] [MainThread]: On master: BEGIN
[0m23:06:04.723897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:04.820671 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m23:06:04.821257 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:04.821821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:06:04.839986 [debug] [MainThread]: SQL status: SELECT 14 in 0.017 seconds
[0m23:06:04.842386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A2885F30>]}
[0m23:06:04.843677 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:04.845112 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:04.846168 [debug] [MainThread]: On master: BEGIN
[0m23:06:04.847499 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:06:04.848116 [debug] [MainThread]: On master: COMMIT
[0m23:06:04.848727 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:04.849386 [debug] [MainThread]: On master: COMMIT
[0m23:06:04.850412 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:04.851097 [debug] [MainThread]: On master: Close
[0m23:06:04.857722 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dm_sales
[0m23:06:04.858580 [info ] [Thread-1 (]: 1 of 3 START sql view model dw_dm_sales.dm_sales ............................... [RUN]
[0m23:06:04.860636 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_sales'
[0m23:06:04.861804 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dm_sales
[0m23:06:04.874915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_sales"
[0m23:06:04.880401 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dm_sales
[0m23:06:05.014217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_sales"
[0m23:06:05.017465 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m23:06:05.018515 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: BEGIN
[0m23:06:05.019334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:06:05.093081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m23:06:05.094097 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m23:06:05.094749 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_sales"} */

  create view "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_tmp"
    
    
  as (
    

-- Data mart consolidado de vendas usando a fato unificada.
select
    fs.*,
    dc.customer_name,
    dp.product_name,
    dp.category_name,
    dp.vendor_name
from "dw_northwind_metabase"."dw_dw"."fact_sales" fs
left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
       on fs.customer_nk = dc.customer_nk
      and dc.current_flag
left join "dw_northwind_metabase"."dw_dw"."dim_product" dp
       on fs.product_nk = dp.product_nk
  );
[0m23:06:05.107889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:06:05.119617 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m23:06:05.120267 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_sales"} */
alter table "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_tmp" rename to "dm_sales"
[0m23:06:05.121822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:06:05.144685 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: COMMIT
[0m23:06:05.145624 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m23:06:05.146216 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: COMMIT
[0m23:06:05.150491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:06:05.158914 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_backup"
[0m23:06:05.167825 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m23:06:05.168487 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_sales"} */
drop view if exists "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_backup" cascade
[0m23:06:05.169480 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:06:05.172675 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_sales: Close
[0m23:06:05.175865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A2AAC410>]}
[0m23:06:05.178181 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dw_dm_sales.dm_sales .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:06:05.180521 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dm_sales
[0m23:06:05.181814 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.dm_b2c
[0m23:06:05.182524 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dm_b2b
[0m23:06:05.183285 [info ] [Thread-3 (]: 3 of 3 START sql view model dw_dm_b2c.dm_b2c ................................... [RUN]
[0m23:06:05.184344 [info ] [Thread-2 (]: 2 of 3 START sql view model dw_dm_b2b.dm_b2b ................................... [RUN]
[0m23:06:05.185780 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_b2c'
[0m23:06:05.186643 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_b2b'
[0m23:06:05.187398 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.dm_b2c
[0m23:06:05.188137 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dm_b2b
[0m23:06:05.192336 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.200090 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.203132 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dm_b2b
[0m23:06:05.211228 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.212571 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.dm_b2c
[0m23:06:05.218915 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.220296 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.221442 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: BEGIN
[0m23:06:05.222499 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:06:05.224067 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.225112 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: BEGIN
[0m23:06:05.226516 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:06:05.314578 [debug] [Thread-2 (]: SQL status: BEGIN in 0.092 seconds
[0m23:06:05.315360 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.316333 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2b"} */

  create view "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_tmp"
    
    
  as (
    

-- Data mart focado no fluxo Northwind (B2B).
select *
from "dw_northwind_metabase"."dw_dm_sales"."dm_sales"
where source_system = 'NORTHWIND'
  );
[0m23:06:05.318158 [debug] [Thread-3 (]: SQL status: BEGIN in 0.092 seconds
[0m23:06:05.319245 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.320412 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2c"} */

  create view "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_tmp"
    
    
  as (
    

-- Data mart focado nas vendas Metabase (B2C/SaaS).
select *
from "dw_northwind_metabase"."dw_dm_sales"."dm_sales"
where source_system = 'METABASE'
  );
[0m23:06:05.327517 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:06:05.334530 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.335452 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:06:05.336366 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2b"} */
alter table "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_tmp" rename to "dm_b2b"
[0m23:06:05.341565 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.342425 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2c"} */
alter table "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_tmp" rename to "dm_b2c"
[0m23:06:05.343189 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:06:05.345450 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: COMMIT
[0m23:06:05.346131 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:06:05.346865 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.348960 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: COMMIT
[0m23:06:05.349599 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: COMMIT
[0m23:06:05.350340 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.351203 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: COMMIT
[0m23:06:05.354439 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:06:05.358515 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_backup"
[0m23:06:05.360526 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m23:06:05.362487 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m23:06:05.366651 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_backup"
[0m23:06:05.367736 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2b"} */
drop view if exists "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_backup" cascade
[0m23:06:05.374290 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m23:06:05.375164 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2c"} */
drop view if exists "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_backup" cascade
[0m23:06:05.376158 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:06:05.379880 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_b2b: Close
[0m23:06:05.380676 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:06:05.382962 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_b2c: Close
[0m23:06:05.383804 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A2A494F0>]}
[0m23:06:05.386272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3226690-9cd5-4492-b827-8a3cb9539465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A2AF23F0>]}
[0m23:06:05.385189 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dw_dm_b2b.dm_b2b .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m23:06:05.390016 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dm_b2b
[0m23:06:05.387911 [info ] [Thread-3 (]: 3 of 3 OK created sql view model dw_dm_b2c.dm_b2c .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m23:06:05.392120 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.dm_b2c
[0m23:06:05.395543 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:05.396336 [debug] [MainThread]: On master: BEGIN
[0m23:06:05.396836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:05.546153 [debug] [MainThread]: SQL status: BEGIN in 0.149 seconds
[0m23:06:05.547086 [debug] [MainThread]: On master: COMMIT
[0m23:06:05.547834 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:05.548517 [debug] [MainThread]: On master: COMMIT
[0m23:06:05.549541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:05.550403 [debug] [MainThread]: On master: Close
[0m23:06:05.551596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:05.552428 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:06:05.553128 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:06:05.553813 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:06:05.554524 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:06:05.555189 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:06:05.555872 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:06:05.556556 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:06:05.557253 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_sales' was properly closed.
[0m23:06:05.557922 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_b2c' was properly closed.
[0m23:06:05.558609 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_b2b' was properly closed.
[0m23:06:05.559624 [info ] [MainThread]: 
[0m23:06:05.560570 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m23:06:05.563181 [debug] [MainThread]: Command end result
[0m23:06:05.645630 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:06:05.650571 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:06:05.665021 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:06:05.665887 [info ] [MainThread]: 
[0m23:06:05.666822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:06:05.668259 [info ] [MainThread]: 
[0m23:06:05.670336 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:06:05.673574 [debug] [MainThread]: Command `dbt run` succeeded at 23:06:05.673131 after 3.87 seconds
[0m23:06:05.674672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A234ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A006F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919BF8ED60>]}
[0m23:06:05.681138 [debug] [MainThread]: Flushing usage events
[0m23:06:06.847609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:21.960169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996A2E0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996AB88B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C298E10>]}


============================== 23:11:21.970678 | ca01b13a-a64d-4961-936f-8569c140520d ==============================
[0m23:11:21.970678 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:11:21.971941 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'invocation_command': 'dbt run --select dim_date dim_geography dim_channel', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m23:11:22.300227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996A519F30>]}
[0m23:11:22.395943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C31FDF0>]}
[0m23:11:22.399583 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:11:23.195071 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:11:23.587008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 2 files changed.
[0m23:11:23.587915 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_date.sql
[0m23:11:23.588373 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\marts\dm_saas\dm_saas.sql
[0m23:11:23.588817 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_geography.sql
[0m23:11:23.589256 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\marts\dm_product_analytics\dm_product_analytics.sql
[0m23:11:23.589694 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_channel.sql
[0m23:11:23.590399 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dw.yml
[0m23:11:23.590943 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\marts\marts.yml
[0m23:11:24.305740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C8D7250>]}
[0m23:11:24.454112 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:11:24.459164 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:11:24.532173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C939310>]}
[0m23:11:24.533376 [info ] [MainThread]: Found 29 models, 1 snapshot, 61 data tests, 14 sources, 449 macros
[0m23:11:24.534108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C4DC050>]}
[0m23:11:24.539024 [info ] [MainThread]: 
[0m23:11:24.539632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:24.540171 [info ] [MainThread]: 
[0m23:11:24.540980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:24.547973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:11:24.862369 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:11:24.862922 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:11:24.863332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:24.997952 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.134 seconds
[0m23:11:25.001064 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:11:25.009580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:11:25.021301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:11:25.022480 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:11:25.025362 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:11:25.026863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:11:25.027730 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:11:25.028494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:11:25.029085 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:11:25.033205 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:11:25.034283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:25.039524 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:11:25.040429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:25.041095 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:11:25.041923 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:11:25.042811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:25.043435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:25.141656 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m23:11:25.142624 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:11:25.143547 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:11:25.151551 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m23:11:25.152588 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:11:25.153465 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:11:25.163887 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.019 seconds
[0m23:11:25.167470 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:11:25.168282 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m23:11:25.171132 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:11:25.171920 [debug] [ThreadPool]: SQL status: BEGIN in 0.129 seconds
[0m23:11:25.172677 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:11:25.173198 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:11:25.173643 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:11:25.174519 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:11:25.176019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:11:25.177059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_snapshots)
[0m23:11:25.190004 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:11:25.194687 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:11:25.195540 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:11:25.196304 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:11:25.197217 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:11:25.200398 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:11:25.201439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:25.202512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:25.203530 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:11:25.205273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:11:25.210657 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:11:25.211536 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:11:25.212229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:25.286895 [debug] [ThreadPool]: SQL status: BEGIN in 0.243 seconds
[0m23:11:25.287818 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:11:25.288691 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:11:25.307723 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m23:11:25.310820 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:11:25.312186 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:11:25.314021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_stg)
[0m23:11:25.318949 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:11:25.320558 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:11:25.321405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:25.356133 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m23:11:25.357128 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:11:25.358196 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:11:25.359118 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m23:11:25.361144 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:11:25.362246 [debug] [ThreadPool]: SQL status: BEGIN in 0.150 seconds
[0m23:11:25.363123 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:11:25.364250 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:11:25.366039 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:11:25.379608 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m23:11:25.380960 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m23:11:25.384782 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:11:25.385418 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:11:25.387113 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:11:25.388841 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:11:25.389454 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:11:25.390427 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:11:25.391727 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:11:25.435132 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m23:11:25.436137 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:11:25.437100 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:11:25.450610 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.013 seconds
[0m23:11:25.453388 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:11:25.454556 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:11:25.469869 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:25.470467 [debug] [MainThread]: On master: BEGIN
[0m23:11:25.470906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:25.563928 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m23:11:25.564947 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:25.565969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:11:25.587998 [debug] [MainThread]: SQL status: SELECT 19 in 0.021 seconds
[0m23:11:25.593388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CE6A0D0>]}
[0m23:11:25.594423 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:25.595388 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:25.595940 [debug] [MainThread]: On master: BEGIN
[0m23:11:25.596851 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:11:25.597352 [debug] [MainThread]: On master: COMMIT
[0m23:11:25.598183 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:25.599002 [debug] [MainThread]: On master: COMMIT
[0m23:11:25.600250 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:25.600910 [debug] [MainThread]: On master: Close
[0m23:11:25.611240 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_channel
[0m23:11:25.611968 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.dim_geography
[0m23:11:25.612558 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dim_date
[0m23:11:25.613295 [info ] [Thread-1 (]: 1 of 3 START sql table model dw_dw.dim_channel ................................. [RUN]
[0m23:11:25.614897 [info ] [Thread-3 (]: 3 of 3 START sql table model dw_dw.dim_geography ............................... [RUN]
[0m23:11:25.618300 [info ] [Thread-2 (]: 2 of 3 START sql table model dw_dw.dim_date .................................... [RUN]
[0m23:11:25.619706 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_channel'
[0m23:11:25.620917 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_geography'
[0m23:11:25.622002 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_date'
[0m23:11:25.623641 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_channel
[0m23:11:25.624761 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.dim_geography
[0m23:11:25.625929 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dim_date
[0m23:11:25.645974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_channel"
[0m23:11:25.653356 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_geography"
[0m23:11:25.658304 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_date"
[0m23:11:25.661464 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_channel
[0m23:11:25.662745 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.dim_geography
[0m23:11:25.793774 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dim_date
[0m23:11:25.804458 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_geography"
[0m23:11:25.808522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_channel"
[0m23:11:25.818550 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_date"
[0m23:11:25.822287 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:25.823707 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_geography: BEGIN
[0m23:11:25.824783 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:11:25.826200 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m23:11:25.827429 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: BEGIN
[0m23:11:25.829052 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:25.832436 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m23:11:25.833848 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: BEGIN
[0m23:11:25.834990 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:11:25.965915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.137 seconds
[0m23:11:25.967217 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m23:11:25.968901 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de canais/fonte (B2B x B2C/SaaS).
select
    row_number() over (order by channel_nk) as channel_sk,
    channel_nk,
    channel_name,
    business_model
from (
    values
        ('CHANNEL_NORTHWIND', 'Northwind ERP', 'B2B'),
        ('CHANNEL_METABASE', 'Metabase Sample', 'B2C/SaaS')
) as channels(channel_nk, channel_name, business_model)
  );
  
[0m23:11:25.970159 [debug] [Thread-2 (]: SQL status: BEGIN in 0.135 seconds
[0m23:11:25.971241 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m23:11:25.972189 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de datas gerada via s√©rie cont√≠nua (apoia an√°lises hist√≥ricas).
with calendar as (
    select
        day::date as date_day
    from generate_series('1990-01-01'::date, '2035-12-31'::date, interval '1 day') as gs(day)
)
select
    row_number() over (order by date_day)         as date_sk,
    date_day,
    extract(year from date_day)::int              as year,
    extract(quarter from date_day)::int           as quarter,
    extract(month from date_day)::int             as month,
    to_char(date_day, 'TMMonth')                  as month_name,
    extract(day from date_day)::int               as day_of_month,
    to_char(date_day, 'IW')::int                  as iso_week,
    extract(dow from date_day)::int               as day_of_week,
    to_char(date_day, 'Dy')                       as day_name,
    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
from calendar
  );
  
[0m23:11:25.980958 [debug] [Thread-3 (]: SQL status: BEGIN in 0.156 seconds
[0m23:11:25.983310 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:25.984892 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de geografia consolidando localidades presentes nas diferentes fontes.
with unioned as (
    select distinct
        upper(coalesce(country, 'N/A')) as country,
        upper(coalesce(region, 'N/A'))  as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"

    union

    select distinct
        upper(coalesce(country, 'N/A')) as country,
        'N/A'                           as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"

    union

    select distinct
        upper(coalesce(country, 'N/A')) as country,
        upper(coalesce(region, 'N/A'))  as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"

    union

    select distinct
        upper(coalesce(ship_country, 'N/A')) as country,
        upper(coalesce(ship_region, 'N/A'))  as region,
        upper(coalesce(ship_city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_orders"
)
select
    row_number() over (order by country, region, city) as geography_sk,
    country,
    region,
    city
from unioned
  );
  
[0m23:11:25.993959 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "city" does not exist
LINE 27:         upper(coalesce(city, 'N/A'))    as city
                                ^
HINT:  There is a column named "city" in table "*SELECT* 1", but it cannot be referenced from this part of the query.

[0m23:11:25.994983 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_geography: ROLLBACK
[0m23:11:25.996406 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_geography: Close
[0m23:11:26.021678 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.051 seconds
[0m23:11:26.038488 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m23:11:26.039941 [debug] [Thread-3 (]: Database Error in model dim_geography (models\dw\dim_geography.sql)
  column "city" does not exist
  LINE 27:         upper(coalesce(city, 'N/A'))    as city
                                  ^
  HINT:  There is a column named "city" in table "*SELECT* 1", but it cannot be referenced from this part of the query.
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_geography.sql
[0m23:11:26.040613 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m23:11:26.044312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:11:26.071344 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: COMMIT
[0m23:11:26.072148 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m23:11:26.072770 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: COMMIT
[0m23:11:26.073440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C99AE10>]}
[0m23:11:26.075181 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model dw_dw.dim_geography ...................... [[31mERROR[0m in 0.42s]
[0m23:11:26.076949 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.dim_geography
[0m23:11:26.078229 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.dim_geography' to be skipped because of status 'error'.  Reason: Database Error in model dim_geography (models\dw\dim_geography.sql)
  column "city" does not exist
  LINE 27:         upper(coalesce(city, 'N/A'))    as city
                                  ^
  HINT:  There is a column named "city" in table "*SELECT* 1", but it cannot be referenced from this part of the query.
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_geography.sql.
[0m23:11:26.079207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:11:26.111832 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_backup"
[0m23:11:26.124972 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m23:11:26.126081 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_backup" cascade
[0m23:11:26.127683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:11:26.133659 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: Close
[0m23:11:26.135537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C99FCD0>]}
[0m23:11:26.137296 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dw_dw.dim_channel ............................ [[32mSELECT 2[0m in 0.52s]
[0m23:11:26.139136 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_channel
[0m23:11:26.221883 [debug] [Thread-2 (]: SQL status: SELECT 16800 in 0.249 seconds
[0m23:11:26.226655 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m23:11:26.227338 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:11:26.228829 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:11:26.231765 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: COMMIT
[0m23:11:26.232872 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m23:11:26.233935 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: COMMIT
[0m23:11:26.237214 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:11:26.241252 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_date__dbt_backup"
[0m23:11:26.251868 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m23:11:26.252780 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_date__dbt_backup" cascade
[0m23:11:26.254055 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:11:26.257556 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_date: Close
[0m23:11:26.259059 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca01b13a-a64d-4961-936f-8569c140520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996E0F7E30>]}
[0m23:11:26.261458 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dw_dw.dim_date ............................... [[32mSELECT 16800[0m in 0.64s]
[0m23:11:26.263899 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dim_date
[0m23:11:26.267302 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:26.267935 [debug] [MainThread]: On master: BEGIN
[0m23:11:26.268412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:26.362296 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m23:11:26.363371 [debug] [MainThread]: On master: COMMIT
[0m23:11:26.364182 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:26.365043 [debug] [MainThread]: On master: COMMIT
[0m23:11:26.366187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:26.367018 [debug] [MainThread]: On master: Close
[0m23:11:26.368225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:26.368867 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:11:26.369341 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:11:26.369750 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:11:26.370421 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:11:26.371006 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:11:26.371631 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_channel' was properly closed.
[0m23:11:26.372244 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_geography' was properly closed.
[0m23:11:26.372879 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_date' was properly closed.
[0m23:11:26.373730 [info ] [MainThread]: 
[0m23:11:26.374470 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m23:11:26.376379 [debug] [MainThread]: Command end result
[0m23:11:26.453126 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:11:26.459221 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:11:26.473914 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:11:26.475025 [info ] [MainThread]: 
[0m23:11:26.476029 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:11:26.477395 [info ] [MainThread]: 
[0m23:11:26.480426 [error] [MainThread]: [31mFailure in model dim_geography (models\dw\dim_geography.sql)[0m
[0m23:11:26.483288 [error] [MainThread]:   Database Error in model dim_geography (models\dw\dim_geography.sql)
  column "city" does not exist
  LINE 27:         upper(coalesce(city, 'N/A'))    as city
                                  ^
  HINT:  There is a column named "city" in table "*SELECT* 1", but it cannot be referenced from this part of the query.
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_geography.sql
[0m23:11:26.486159 [info ] [MainThread]: 
[0m23:11:26.487326 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dim_geography.sql
[0m23:11:26.488306 [info ] [MainThread]: 
[0m23:11:26.489279 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m23:11:26.492127 [debug] [MainThread]: Command `dbt run` failed at 23:11:26.491795 after 4.74 seconds
[0m23:11:26.493121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CA43DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996A4AF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C2CF310>]}
[0m23:11:26.494227 [debug] [MainThread]: Flushing usage events
[0m23:11:27.973225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:54.100986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1FBB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B21458B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B21A98E10>]}


============================== 23:11:54.107485 | 1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0 ==============================
[0m23:11:54.107485 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:11:54.109529 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select dim_geography', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m23:11:54.426652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1FDE9F30>]}
[0m23:11:54.545514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B21B0FDF0>]}
[0m23:11:54.548340 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:11:55.082746 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:11:55.359324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:55.361600 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dim_geography.sql
[0m23:11:56.035607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B220F2450>]}
[0m23:11:56.181551 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:11:56.185802 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:11:56.231715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B22121130>]}
[0m23:11:56.233234 [info ] [MainThread]: Found 29 models, 1 snapshot, 61 data tests, 14 sources, 449 macros
[0m23:11:56.235032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B21CDF5B0>]}
[0m23:11:56.238461 [info ] [MainThread]: 
[0m23:11:56.239085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:56.239809 [info ] [MainThread]: 
[0m23:11:56.240717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:56.242410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:11:56.404815 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:11:56.405390 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:11:56.405774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:56.479147 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.073 seconds
[0m23:11:56.481074 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:11:56.489350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:11:56.497494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:11:56.498410 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:11:56.501287 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:11:56.501875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:11:56.502447 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:11:56.503104 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:11:56.503714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:11:56.505768 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:11:56.506324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:56.506720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:56.508670 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:11:56.509209 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:11:56.510433 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:11:56.511416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:56.512087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:56.589768 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m23:11:56.590438 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:11:56.590903 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:11:56.602175 [debug] [ThreadPool]: SQL status: BEGIN in 0.090 seconds
[0m23:11:56.603007 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:11:56.603740 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:11:56.605437 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m23:11:56.606101 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:11:56.606529 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:11:56.608450 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:11:56.609350 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:11:56.610684 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:11:56.612551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_stg)
[0m23:11:56.617228 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:11:56.617935 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:11:56.618440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:56.619017 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m23:11:56.621159 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:11:56.622274 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:11:56.623022 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m23:11:56.624027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:11:56.626820 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:11:56.631494 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:11:56.632529 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:11:56.633277 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:11:56.633945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:56.635148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:11:56.640373 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:11:56.641220 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:11:56.641894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:56.719199 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m23:11:56.719913 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:11:56.720395 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:11:56.735950 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.015 seconds
[0m23:11:56.739255 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:11:56.740338 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:11:56.741075 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m23:11:56.741779 [debug] [ThreadPool]: SQL status: BEGIN in 0.235 seconds
[0m23:11:56.742931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:11:56.743992 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:11:56.750570 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:11:56.754462 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:11:56.755329 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m23:11:56.755959 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:11:56.756584 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:11:56.757132 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:11:56.757608 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:11:56.758355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:56.759206 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:11:56.774697 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m23:11:56.775540 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.017 seconds
[0m23:11:56.778764 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:11:56.779762 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:11:56.782300 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:11:56.785553 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:11:56.786545 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:11:56.787673 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:11:56.788843 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:11:56.856879 [debug] [ThreadPool]: SQL status: BEGIN in 0.098 seconds
[0m23:11:56.857533 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:11:56.858071 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:11:56.870490 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m23:11:56.872420 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:11:56.873379 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:11:56.884556 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:56.885129 [debug] [MainThread]: On master: BEGIN
[0m23:11:56.885625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:56.985217 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m23:11:56.987314 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:56.989251 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:11:57.034281 [debug] [MainThread]: SQL status: SELECT 19 in 0.043 seconds
[0m23:11:57.044515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B225FDBF0>]}
[0m23:11:57.045948 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:57.047381 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:57.048343 [debug] [MainThread]: On master: BEGIN
[0m23:11:57.049958 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:11:57.050907 [debug] [MainThread]: On master: COMMIT
[0m23:11:57.051714 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:57.052591 [debug] [MainThread]: On master: COMMIT
[0m23:11:57.053834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:57.054890 [debug] [MainThread]: On master: Close
[0m23:11:57.066685 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_geography
[0m23:11:57.068220 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.dim_geography ............................... [RUN]
[0m23:11:57.074527 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_geography'
[0m23:11:57.080909 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_geography
[0m23:11:57.118323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_geography"
[0m23:11:57.125018 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_geography
[0m23:11:57.375668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_geography"
[0m23:11:57.380842 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:57.382810 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: BEGIN
[0m23:11:57.384038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:57.572403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.188 seconds
[0m23:11:57.573521 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:57.574669 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de geografia consolidando localidades presentes nas diferentes fontes.
with unioned as (
    select distinct
        upper(coalesce(country, 'N/A')) as country,
        upper(coalesce(region, 'N/A'))  as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"

    union

    select distinct
        upper(coalesce(country, 'N/A')) as country,
        'N/A'                           as region,
        'N/A'                           as city
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"

    union

    select distinct
        upper(coalesce(country, 'N/A')) as country,
        upper(coalesce(region, 'N/A'))  as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"

    union

    select distinct
        upper(coalesce(ship_country, 'N/A')) as country,
        upper(coalesce(ship_region, 'N/A'))  as region,
        upper(coalesce(ship_city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_orders"
)
select
    row_number() over (order by country, region, city) as geography_sk,
    country,
    region,
    city
from unioned
  );
  
[0m23:11:58.146324 [debug] [Thread-1 (]: SQL status: SELECT 206 in 0.570 seconds
[0m23:11:58.162415 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:58.163578 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m23:11:58.165877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:11:58.193711 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: COMMIT
[0m23:11:58.196198 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:58.197428 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: COMMIT
[0m23:11:58.217590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m23:11:58.231864 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_backup"
[0m23:11:58.241120 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m23:11:58.241761 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_backup" cascade
[0m23:11:58.242892 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:11:58.249401 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: Close
[0m23:11:58.253908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac779f3-e00d-4e9c-aeb8-a1b6cddb79b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B22347890>]}
[0m23:11:58.255762 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.dim_geography .......................... [[32mSELECT 206[0m in 1.18s]
[0m23:11:58.257656 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_geography
[0m23:11:58.263947 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.265206 [debug] [MainThread]: On master: BEGIN
[0m23:11:58.266073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:58.358750 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m23:11:58.359312 [debug] [MainThread]: On master: COMMIT
[0m23:11:58.359886 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.360700 [debug] [MainThread]: On master: COMMIT
[0m23:11:58.361860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:58.362717 [debug] [MainThread]: On master: Close
[0m23:11:58.363553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:58.364111 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:11:58.364694 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:11:58.365361 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:11:58.365869 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:11:58.366631 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:11:58.367178 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_geography' was properly closed.
[0m23:11:58.367705 [info ] [MainThread]: 
[0m23:11:58.368353 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m23:11:58.369877 [debug] [MainThread]: Command end result
[0m23:11:58.452806 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:11:58.457587 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:11:58.469165 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:11:58.469741 [info ] [MainThread]: 
[0m23:11:58.470541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:58.471670 [info ] [MainThread]: 
[0m23:11:58.472628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:11:58.474842 [debug] [MainThread]: Command `dbt run` succeeded at 23:11:58.474583 after 4.56 seconds
[0m23:11:58.475438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B22316D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B21BF7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B21BF72F0>]}
[0m23:11:58.475997 [debug] [MainThread]: Flushing usage events
[0m23:11:59.602673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:08.971051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF3EB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF4758B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF4D98E10>]}


============================== 23:12:08.978348 | c656c09f-3cd1-4752-966a-916e229164e7 ==============================
[0m23:12:08.978348 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:12:08.979598 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dm_saas dm_product_analytics', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m23:12:09.262977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF40E9F30>]}
[0m23:12:09.351454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF4E1FDF0>]}
[0m23:12:09.353021 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:12:09.838653 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:12:10.160818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:10.161317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:10.255725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF64D1250>]}
[0m23:12:10.411484 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:12:10.416510 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:12:10.463708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF65254F0>]}
[0m23:12:10.464687 [info ] [MainThread]: Found 29 models, 1 snapshot, 61 data tests, 14 sources, 449 macros
[0m23:12:10.466047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF6555710>]}
[0m23:12:10.470431 [info ] [MainThread]: 
[0m23:12:10.471058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:10.471543 [info ] [MainThread]: 
[0m23:12:10.472491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:10.477532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:12:10.493942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:12:10.959542 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:12:10.960273 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:12:10.961035 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:12:10.961868 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:12:10.962682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:10.963293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.095856 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.132 seconds
[0m23:12:11.096443 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.134 seconds
[0m23:12:11.098374 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:12:11.100617 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:12:11.102402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:12:11.103286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dm_saas)
[0m23:12:11.109491 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dm_product_analytics"
"
[0m23:12:11.110409 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dm_saas"
"
[0m23:12:11.117827 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:12:11.121361 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_saas"
[0m23:12:11.122010 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:12:11.122749 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:12:11.123460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:11.123933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:11.210932 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m23:12:11.211681 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:12:11.212260 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dm_product_analytics"} */
create schema if not exists "dw_dm_product_analytics"
[0m23:12:11.212826 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m23:12:11.213492 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_saas"
[0m23:12:11.213960 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dm_saas"} */
create schema if not exists "dw_dm_saas"
[0m23:12:11.237496 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.023 seconds
[0m23:12:11.238224 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.025 seconds
[0m23:12:11.239684 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_saas: COMMIT
[0m23:12:11.241008 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_product_analytics: COMMIT
[0m23:12:11.241569 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_saas"
[0m23:12:11.242108 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:12:11.242599 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_saas: COMMIT
[0m23:12:11.243081 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_product_analytics: COMMIT
[0m23:12:11.245317 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:12:11.246200 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_saas: Close
[0m23:12:11.246981 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m23:12:11.247660 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:12:11.257114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:12:11.270865 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:12:11.271926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:12:11.272684 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:12:11.275682 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:12:11.276420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:12:11.276892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.277845 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:12:11.278797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:12:11.283803 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:12:11.285307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.289291 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:12:11.290107 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:12:11.291071 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:12:11.291917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.292998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.382498 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:12:11.383557 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:12:11.384622 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:12:11.390116 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:12:11.390934 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:12:11.391641 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:12:11.397198 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:12:11.398005 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:12:11.399154 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:12:11.400551 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.015 seconds
[0m23:12:11.404456 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:12:11.405430 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:12:11.406105 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m23:12:11.406691 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m23:12:11.407751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:12:11.408352 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:12:11.414257 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:12:11.415081 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.015 seconds
[0m23:12:11.419226 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:12:11.419908 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:12:11.422076 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:12:11.422577 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:12:11.423033 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:12:11.423836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:11.424638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_snapshots)
[0m23:12:11.425363 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:12:11.430040 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:12:11.430929 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:12:11.432324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:12:11.433368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:11.443231 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:12:11.444183 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m23:12:11.445012 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:12:11.447165 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:12:11.447968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:11.449656 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:12:11.451363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:12:11.456531 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:12:11.457374 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:12:11.458122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:11.532621 [debug] [ThreadPool]: SQL status: BEGIN in 0.108 seconds
[0m23:12:11.533784 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:12:11.535121 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:12:11.550046 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:12:11.553484 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:12:11.554655 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:12:11.561708 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m23:12:11.562746 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:12:11.563552 [debug] [ThreadPool]: SQL status: BEGIN in 0.130 seconds
[0m23:12:11.564317 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:12:11.565085 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m23:12:11.566118 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:12:11.567423 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:12:11.568239 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:12:11.569160 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:12:11.579824 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:12:11.581679 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:12:11.582808 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m23:12:11.583794 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m23:12:11.584507 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:12:11.586735 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:12:11.588537 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:12:11.589735 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:12:11.590462 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:12:11.603969 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.604552 [debug] [MainThread]: On master: BEGIN
[0m23:12:11.605127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:11.692151 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m23:12:11.692762 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.693328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:12:11.712343 [debug] [MainThread]: SQL status: SELECT 19 in 0.018 seconds
[0m23:12:11.717506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF689D8B0>]}
[0m23:12:11.718527 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:11.719311 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.719797 [debug] [MainThread]: On master: BEGIN
[0m23:12:11.720633 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:12:11.721090 [debug] [MainThread]: On master: COMMIT
[0m23:12:11.721568 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.721992 [debug] [MainThread]: On master: COMMIT
[0m23:12:11.722715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:11.723237 [debug] [MainThread]: On master: Close
[0m23:12:11.729508 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dm_product_analytics
[0m23:12:11.730415 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dm_saas
[0m23:12:11.731660 [info ] [Thread-1 (]: 1 of 2 START sql view model dw_dm_product_analytics.dm_product_analytics ....... [RUN]
[0m23:12:11.733687 [info ] [Thread-2 (]: 2 of 2 START sql view model dw_dm_saas.dm_saas ................................. [RUN]
[0m23:12:11.735485 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_product_analytics'
[0m23:12:11.736380 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_saas'
[0m23:12:11.737149 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dm_product_analytics
[0m23:12:11.737925 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dm_saas
[0m23:12:11.756793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:11.762434 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_saas"
[0m23:12:11.771329 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dm_product_analytics
[0m23:12:11.807538 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dm_saas
[0m23:12:11.874356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:11.876463 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_saas"
[0m23:12:11.879894 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:11.881192 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m23:12:11.882818 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: BEGIN
[0m23:12:11.884153 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: BEGIN
[0m23:12:11.885350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:11.886505 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:12:11.980596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m23:12:11.981489 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m23:12:11.982920 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:11.984247 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m23:12:11.985767 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_product_analytics"} */

  create view "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_tmp"
    
    
  as (
    

-- Mart que combina eventos de uso, reviews e feedbacks para an√°lises 360¬∫ do produto.
with events as (
    select
        'ANALYTIC_EVENT'                              as record_type,
        fa.event_nk                                   as record_nk,
        fa.customer_nk,
        null::varchar                                 as product_nk,
        fa.event_name                                 as metric_name,
        1::numeric                                    as metric_value,
        fa.event_timestamp                            as metric_timestamp,
        fa.page_url                                   as context_info,
        dc.customer_name,
        dc.segment,
        null::varchar                                 as product_name
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events" fa
    left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
           on fa.customer_nk = dc.customer_nk
          and dc.current_flag
),
reviews as (
    select
        'REVIEW'                                      as record_type,
        fr.review_nk                                  as record_nk,
        null::varchar                                 as customer_nk,
        fr.product_nk,
        'rating_score'                                as metric_name,
        fr.rating_score                               as metric_value,
        fr.created_at                                 as metric_timestamp,
        fr.review_text                                as context_info,
        null::varchar                                 as customer_name,
        null::varchar                                 as segment,
        dp.product_name
    from "dw_northwind_metabase"."dw_dw"."fact_reviews" fr
    left join "dw_northwind_metabase"."dw_dw"."dim_product" dp
           on fr.product_nk = dp.product_nk
),
feedback as (
    select
        'FEEDBACK'                                    as record_type,
        ff.feedback_nk                                as record_nk,
        ff.customer_nk,
        null::varchar                                 as product_nk,
        'rating_score'                                as metric_name,
        ff.rating_score                               as metric_value,
        ff.date_received                              as metric_timestamp,
        ff.feedback_text                              as context_info,
        dc.customer_name,
        dc.segment,
        null::varchar                                 as product_name
    from "dw_northwind_metabase"."dw_dw"."fact_feedback" ff
    left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
           on ff.customer_nk = dc.customer_nk
          and dc.current_flag
)
select * from events
union all
select * from reviews
union all
select * from feedback
  );
[0m23:12:11.987200 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_saas"} */

  create view "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_tmp"
    
    
  as (
    

-- Data mart para faturamento SaaS (Metabase invoices) com enriquecimento de cliente e calend√°rio.
with invoices as (
    select
        fi.invoice_nk,
        fi.customer_nk,
        fi.plan_name,
        fi.payment_amount,
        fi.expected_invoice_flag,
        fi.date_received::date as invoice_date,
        dc.customer_name,
        dc.segment,
        dc.plan,
        dd.year,
        dd.month,
        dd.month_name
    from "dw_northwind_metabase"."dw_dw"."fact_invoices" fi
    left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
           on fi.customer_nk = dc.customer_nk
          and dc.current_flag
    left join "dw_northwind_metabase"."dw_dw"."dim_date" dd
           on fi.date_received::date = dd.date_day
)
select *
from invoices
  );
[0m23:12:12.006628 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m23:12:12.007563 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m23:12:12.018481 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m23:12:12.023158 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:12.023865 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_saas"} */
alter table "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_tmp" rename to "dm_saas"
[0m23:12:12.024503 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_product_analytics"} */
alter table "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_tmp" rename to "dm_product_analytics"
[0m23:12:12.052460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m23:12:12.053221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m23:12:12.077190 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: COMMIT
[0m23:12:12.080273 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: COMMIT
[0m23:12:12.081271 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:12.083783 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m23:12:12.085147 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: COMMIT
[0m23:12:12.086384 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: COMMIT
[0m23:12:12.094385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:12:12.095157 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m23:12:12.107322 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_backup"
[0m23:12:12.112102 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_backup"
[0m23:12:12.124709 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m23:12:12.125910 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m23:12:12.126529 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_product_analytics"} */
drop view if exists "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_backup" cascade
[0m23:12:12.127108 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_saas"} */
drop view if exists "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_backup" cascade
[0m23:12:12.128135 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:12:12.128679 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:12:12.133595 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: Close
[0m23:12:12.136775 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: Close
[0m23:12:12.142048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF6AC50D0>]}
[0m23:12:12.143051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c656c09f-3cd1-4752-966a-916e229164e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF6A55440>]}
[0m23:12:12.144348 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dw_dm_product_analytics.dm_product_analytics .. [[32mCREATE VIEW[0m in 0.40s]
[0m23:12:12.147214 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dm_product_analytics
[0m23:12:12.145465 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dw_dm_saas.dm_saas ............................ [[32mCREATE VIEW[0m in 0.40s]
[0m23:12:12.150145 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dm_saas
[0m23:12:12.152963 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:12.153585 [debug] [MainThread]: On master: BEGIN
[0m23:12:12.154021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:12.240293 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m23:12:12.240966 [debug] [MainThread]: On master: COMMIT
[0m23:12:12.242040 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:12.242821 [debug] [MainThread]: On master: COMMIT
[0m23:12:12.243855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:12.244737 [debug] [MainThread]: On master: Close
[0m23:12:12.245939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:12.246783 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:12:12.247466 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:12:12.248145 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:12:12.248907 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:12:12.249616 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:12:12.250261 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:12:12.251011 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_product_analytics' was properly closed.
[0m23:12:12.251741 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_saas' was properly closed.
[0m23:12:12.252790 [info ] [MainThread]: 
[0m23:12:12.253893 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m23:12:12.256376 [debug] [MainThread]: Command end result
[0m23:12:12.327694 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:12:12.333518 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:12:12.344146 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:12:12.344963 [info ] [MainThread]: 
[0m23:12:12.345744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:12.346640 [info ] [MainThread]: 
[0m23:12:12.347967 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:12:12.350789 [debug] [MainThread]: Command `dbt run` succeeded at 23:12:12.350559 after 3.56 seconds
[0m23:12:12.351822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF6AE0A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF68FBAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF6500C50>]}
[0m23:12:12.352595 [debug] [MainThread]: Flushing usage events
[0m23:12:13.747139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:20.107921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79CFB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79D858B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79DE98E10>]}


============================== 23:20:20.117143 | ac448f17-0db6-4e7e-b53e-311cce0947b8 ==============================
[0m23:20:20.117143 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:20:20.118943 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select fact_sales', 'printer_width': '80', 'write_json': 'True'}
[0m23:20:20.463803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79D1E9F30>]}
[0m23:20:20.546796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79DF1FDF0>]}
[0m23:20:20.549716 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:20:21.196620 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:20:21.607712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:20:21.609761 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dw.yml
[0m23:20:21.610647 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\fact_sales.sql
[0m23:20:22.244999 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m23:20:22.246446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F4FC550>]}
[0m23:20:22.546456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F52BD40>]}
[0m23:20:22.764271 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:20:22.775759 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:20:22.883046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F64BD90>]}
[0m23:20:22.884118 [info ] [MainThread]: Found 29 models, 1 snapshot, 72 data tests, 14 sources, 449 macros
[0m23:20:22.887720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F805710>]}
[0m23:20:22.894413 [info ] [MainThread]: 
[0m23:20:22.895332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:20:22.896378 [info ] [MainThread]: 
[0m23:20:22.897503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:22.899170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:20:23.380810 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:20:23.381659 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:20:23.382429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:23.578571 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.196 seconds
[0m23:20:23.581039 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:20:23.596587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:20:23.605463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:20:23.616328 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:20:23.622564 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:20:23.623853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:20:23.624906 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:20:23.626188 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:20:23.627129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:20:23.629837 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:20:23.630588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:23.631118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:23.633466 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:20:23.634107 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:20:23.635637 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:20:23.638619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:23.639508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:23.743713 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m23:20:23.744739 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:20:23.745691 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:20:23.747422 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m23:20:23.748125 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:20:23.748839 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:20:23.749598 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m23:20:23.750132 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:20:23.750664 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:20:23.753676 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m23:20:23.754550 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:20:23.755128 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:20:23.768805 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.022 seconds
[0m23:20:23.770028 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m23:20:23.770907 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m23:20:23.771528 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m23:20:23.774843 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:20:23.777427 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:20:23.779153 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:20:23.780839 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:20:23.781673 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:20:23.782174 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:20:23.782796 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:20:23.783688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:20:23.784178 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:20:23.790119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_stg)
[0m23:20:23.791664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_snapshots)
[0m23:20:23.794433 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:20:23.797504 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:20:23.798427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:20:23.801345 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:20:23.802811 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:20:23.803644 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:20:23.807157 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:20:23.807938 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:20:23.808536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:23.809024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:23.809508 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:20:23.810001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:23.810898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:23.925463 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m23:20:23.926488 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:20:23.927473 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:20:23.929640 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m23:20:23.930594 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:20:23.931572 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:20:23.935677 [debug] [ThreadPool]: SQL status: BEGIN in 0.125 seconds
[0m23:20:23.936766 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:20:23.937945 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:20:23.940459 [debug] [ThreadPool]: SQL status: BEGIN in 0.130 seconds
[0m23:20:23.941407 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:20:23.942290 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:20:23.945606 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.017 seconds
[0m23:20:23.949102 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:20:23.950083 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m23:20:23.953424 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:20:23.954471 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:20:23.956293 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:20:23.957693 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m23:20:23.964187 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m23:20:23.967233 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:20:23.971476 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:20:23.972741 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:20:23.973425 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:20:23.989534 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:23.990456 [debug] [MainThread]: On master: BEGIN
[0m23:20:23.991315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:24.090931 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m23:20:24.091828 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:24.092569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:20:24.120691 [debug] [MainThread]: SQL status: SELECT 27 in 0.027 seconds
[0m23:20:24.130202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F663050>]}
[0m23:20:24.131134 [debug] [MainThread]: On master: ROLLBACK
[0m23:20:24.132341 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:24.133191 [debug] [MainThread]: On master: BEGIN
[0m23:20:24.134517 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:20:24.135654 [debug] [MainThread]: On master: COMMIT
[0m23:20:24.136843 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:24.137827 [debug] [MainThread]: On master: COMMIT
[0m23:20:24.139032 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:20:24.139964 [debug] [MainThread]: On master: Close
[0m23:20:24.164868 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m23:20:24.166265 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m23:20:24.167947 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m23:20:24.169754 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m23:20:24.189391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m23:20:24.197479 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m23:20:24.309027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m23:20:24.328776 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:20:24.330008 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m23:20:24.331026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:20:24.446244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m23:20:24.447040 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:20:24.447755 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m23:20:25.093570 [debug] [Thread-1 (]: SQL status: SELECT 20915 in 0.645 seconds
[0m23:20:25.109940 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:20:25.110631 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m23:20:25.112389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:25.117809 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:20:25.118737 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:20:25.120863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:20:25.151314 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:20:25.152402 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:20:25.153533 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:20:25.162463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:20:25.174765 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m23:20:25.184478 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:20:25.185465 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m23:20:25.209487 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m23:20:25.213165 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m23:20:25.223597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac448f17-0db6-4e7e-b53e-311cce0947b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F83A780>]}
[0m23:20:25.225325 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 1.05s]
[0m23:20:25.227002 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m23:20:25.230042 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:25.231037 [debug] [MainThread]: On master: BEGIN
[0m23:20:25.231848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:25.311277 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m23:20:25.311916 [debug] [MainThread]: On master: COMMIT
[0m23:20:25.312393 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:25.312969 [debug] [MainThread]: On master: COMMIT
[0m23:20:25.314083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:20:25.314949 [debug] [MainThread]: On master: Close
[0m23:20:25.316143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:25.316902 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:20:25.317613 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:20:25.318386 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:20:25.319338 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:20:25.320163 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:20:25.321192 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m23:20:25.321919 [info ] [MainThread]: 
[0m23:20:25.322555 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m23:20:25.324180 [debug] [MainThread]: Command end result
[0m23:20:25.396679 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:20:25.401238 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:20:25.412516 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:20:25.413182 [info ] [MainThread]: 
[0m23:20:25.414052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:20:25.415345 [info ] [MainThread]: 
[0m23:20:25.416628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:20:25.418128 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:20:25.421943 [debug] [MainThread]: Command `dbt run` succeeded at 23:20:25.421579 after 5.50 seconds
[0m23:20:25.422946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79FC480F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79FA7FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79F4A3CD0>]}
[0m23:20:25.423921 [debug] [MainThread]: Flushing usage events
[0m23:20:26.842763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:53.123115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020573AB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020575358B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020575998E10>]}


============================== 23:20:53.131648 | b828ae39-16a9-4698-bf1f-944484e2b564 ==============================
[0m23:20:53.131648 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:20:53.134003 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt test --select fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m23:20:53.674632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b828ae39-16a9-4698-bf1f-944484e2b564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020573CE9F30>]}
[0m23:20:53.810378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b828ae39-16a9-4698-bf1f-944484e2b564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020575A1FDF0>]}
[0m23:20:53.812605 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:20:54.360520 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:20:54.685235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:54.687175 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dw.yml
[0m23:20:55.440933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b828ae39-16a9-4698-bf1f-944484e2b564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020575FDA550>]}
[0m23:20:55.588430 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:20:55.592109 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:20:55.695392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b828ae39-16a9-4698-bf1f-944484e2b564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205763B72F0>]}
[0m23:20:55.696170 [info ] [MainThread]: Found 29 models, 1 snapshot, 72 data tests, 14 sources, 449 macros
[0m23:20:55.696975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b828ae39-16a9-4698-bf1f-944484e2b564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020575B6EA50>]}
[0m23:20:55.704406 [info ] [MainThread]: 
[0m23:20:55.705046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:20:55.705586 [info ] [MainThread]: 
[0m23:20:55.706345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:55.714467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:20:55.729875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:20:55.734075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:20:55.741965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:20:55.879034 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:20:55.879549 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:20:55.880093 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:20:55.880515 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:20:55.881225 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:20:55.882004 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:20:55.882632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:55.883111 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:20:55.883553 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:20:55.883942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:55.884655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:55.885086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:55.989858 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:20:55.990540 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:20:55.991302 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:20:55.991987 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m23:20:55.992934 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m23:20:55.993418 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:20:55.994024 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:20:55.994465 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m23:20:55.995078 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:20:55.995677 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:20:55.996244 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:20:55.997264 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:20:56.004527 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m23:20:56.007066 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:20:56.007881 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.011 seconds
[0m23:20:56.008378 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:20:56.008790 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.011 seconds
[0m23:20:56.009189 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m23:20:56.010782 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:20:56.012533 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:20:56.013306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_snapshots)
[0m23:20:56.015320 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:20:56.018388 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:20:56.018888 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:20:56.019278 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:20:56.019750 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:20:56.020163 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:20:56.020656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:56.021291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:20:56.021964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:20:56.027616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:20:56.030647 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:20:56.038892 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:20:56.041511 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:20:56.042040 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:20:56.042498 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:20:56.042934 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:20:56.043359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:56.043769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:56.044167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:56.103652 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m23:20:56.104489 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:20:56.105260 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:20:56.129782 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.024 seconds
[0m23:20:56.133004 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:20:56.134538 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:20:56.177669 [debug] [ThreadPool]: SQL status: BEGIN in 0.133 seconds
[0m23:20:56.178462 [debug] [ThreadPool]: SQL status: BEGIN in 0.135 seconds
[0m23:20:56.178961 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:20:56.179545 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:20:56.180059 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:20:56.180657 [debug] [ThreadPool]: SQL status: BEGIN in 0.137 seconds
[0m23:20:56.181210 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:20:56.182449 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:20:56.183451 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:20:56.194853 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:20:56.195458 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:20:56.197032 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:20:56.197625 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:20:56.199915 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:20:56.201744 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:20:56.202311 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:20:56.203302 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:20:56.204313 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:20:56.214220 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:56.215166 [debug] [MainThread]: On master: BEGIN
[0m23:20:56.215797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:56.294063 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m23:20:56.294602 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:56.295104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:20:56.311924 [debug] [MainThread]: SQL status: SELECT 22 in 0.016 seconds
[0m23:20:56.317092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b828ae39-16a9-4698-bf1f-944484e2b564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020576632750>]}
[0m23:20:56.317816 [debug] [MainThread]: On master: ROLLBACK
[0m23:20:56.318615 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:56.319089 [debug] [MainThread]: On master: BEGIN
[0m23:20:56.320150 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:20:56.320683 [debug] [MainThread]: On master: COMMIT
[0m23:20:56.321109 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:56.321513 [debug] [MainThread]: On master: COMMIT
[0m23:20:56.322088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:20:56.322507 [debug] [MainThread]: On master: Close
[0m23:20:56.329161 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:20:56.329805 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:20:56.330400 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:20:56.331340 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:20:56.332451 [info ] [Thread-4 (]: 4 of 21 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m23:20:56.333586 [info ] [Thread-3 (]: 3 of 21 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m23:20:56.334713 [info ] [Thread-1 (]: 1 of 21 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m23:20:56.335914 [info ] [Thread-2 (]: 2 of 21 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m23:20:56.337332 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m23:20:56.338565 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m23:20:56.339583 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m23:20:56.340396 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m23:20:56.341020 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:20:56.341613 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:20:56.342301 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:20:56.343088 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:20:56.362875 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:20:56.369914 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:20:56.375589 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:20:56.382559 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:20:56.391284 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:20:56.392415 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:20:56.426121 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:20:56.427653 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:20:56.428613 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:20:56.429246 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:20:56.434510 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:20:56.439436 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:20:56.441303 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:20:56.442339 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m23:20:56.443191 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:20:56.444323 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:20:56.445187 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:20:56.445931 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m23:20:56.446623 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m23:20:56.447719 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:20:56.450031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:20:56.451164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:20:56.451983 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m23:20:56.453439 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:20:56.544843 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m23:20:56.545627 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:20:56.546346 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.551768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m23:20:56.552842 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:20:56.553928 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.559468 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m23:20:56.560479 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:20:56.561423 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.564325 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:20:56.573936 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m23:20:56.575025 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:20:56.578421 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m23:20:56.579387 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m23:20:56.580559 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m23:20:56.584821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.131 seconds
[0m23:20:56.582294 [info ] [Thread-4 (]: 4 of 21 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.24s]
[0m23:20:56.586265 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:20:56.588081 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:20:56.588895 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m23:20:56.583784 [info ] [Thread-3 (]: 3 of 21 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.25s]
[0m23:20:56.590006 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.591236 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:20:56.593644 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m23:20:56.594607 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:20:56.595357 [info ] [Thread-4 (]: 5 of 21 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m23:20:56.596363 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:20:56.597382 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m23:20:56.598163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m23:20:56.599428 [info ] [Thread-3 (]: 6 of 21 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m23:20:56.601079 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:20:56.603213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m23:20:56.604279 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:20:56.615606 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:20:56.602411 [info ] [Thread-1 (]: 1 of 21 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.26s]
[0m23:20:56.616946 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:20:56.620289 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m23:20:56.622034 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:20:56.630996 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:20:56.632340 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:20:56.633251 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m23:20:56.634582 [info ] [Thread-1 (]: 7 of 21 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m23:20:56.636060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m23:20:56.638242 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:20:56.639116 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:20:56.647745 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:20:56.637401 [info ] [Thread-2 (]: 2 of 21 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.30s]
[0m23:20:56.675678 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:20:56.676646 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:20:56.677749 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:20:56.680097 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:20:56.685735 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:20:56.687184 [info ] [Thread-2 (]: 8 of 21 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m23:20:56.688751 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:20:56.690182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m23:20:56.695545 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:20:56.696713 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:20:56.708749 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:20:56.710002 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:20:56.711518 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m23:20:56.712649 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:20:56.714155 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:20:56.719722 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m23:20:56.717947 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:20:56.720694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:56.726862 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:20:56.728063 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m23:20:56.734748 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:20:56.736250 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:20:56.739091 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:20:56.740251 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m23:20:56.741311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:20:56.864436 [debug] [Thread-4 (]: SQL status: BEGIN in 0.152 seconds
[0m23:20:56.865698 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:20:56.866876 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.894584 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m23:20:56.898576 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m23:20:56.900436 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m23:20:56.901637 [debug] [Thread-2 (]: SQL status: BEGIN in 0.160 seconds
[0m23:20:56.902664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.182 seconds
[0m23:20:56.903766 [debug] [Thread-3 (]: SQL status: BEGIN in 0.167 seconds
[0m23:20:56.906517 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:20:56.905336 [info ] [Thread-4 (]: 5 of 21 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.31s]
[0m23:20:56.908379 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:20:56.909673 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:20:56.911035 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.912837 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:20:56.913701 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.914783 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:56.916319 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:20:56.918280 [info ] [Thread-4 (]: 9 of 21 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m23:20:56.919862 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m23:20:56.921063 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:20:56.922130 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:20:56.932802 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:20:56.934060 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:20:56.937968 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m23:20:56.939206 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:20:56.943838 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m23:20:56.948219 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m23:20:56.949671 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m23:20:56.951167 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m23:20:56.952540 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m23:20:56.953767 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:20:56.955545 [info ] [Thread-3 (]: 6 of 21 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.35s]
[0m23:20:56.965239 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:20:56.957146 [info ] [Thread-1 (]: 7 of 21 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.32s]
[0m23:20:56.967511 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:20:56.959161 [info ] [Thread-2 (]: 8 of 21 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.27s]
[0m23:20:56.969810 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:20:56.971117 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:20:56.972868 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:20:56.974493 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:20:56.975949 [info ] [Thread-3 (]: 10 of 21 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m23:20:56.977514 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:20:56.978887 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:20:56.980285 [info ] [Thread-1 (]: 11 of 21 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:20:56.981681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m23:20:56.982846 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m23:20:56.984060 [info ] [Thread-2 (]: 12 of 21 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:20:56.985645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m23:20:56.986963 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:20:56.988112 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:20:56.989099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m23:20:56.989889 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:20:56.999424 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:20:57.001063 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:20:57.015521 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:20:57.028001 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:20:57.030205 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:20:57.038522 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:20:57.040486 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:20:57.049804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:20:57.051798 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:20:57.065304 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:20:57.068260 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m23:20:57.073413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:20:57.077303 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:20:57.078822 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m23:20:57.081643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:57.071923 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:20:57.093771 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:20:57.094890 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m23:20:57.096160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:20:57.181915 [debug] [Thread-4 (]: SQL status: BEGIN in 0.194 seconds
[0m23:20:57.183040 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:20:57.184047 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.197727 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:20:57.201498 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m23:20:57.203111 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m23:20:57.206021 [info ] [Thread-4 (]: 9 of 21 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.29s]
[0m23:20:57.208670 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:20:57.209943 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:20:57.211267 [info ] [Thread-4 (]: 13 of 21 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:20:57.212554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m23:20:57.213685 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:20:57.230579 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:20:57.233255 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:20:57.239687 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:20:57.242628 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:20:57.243797 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m23:20:57.245381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:20:57.290829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.195 seconds
[0m23:20:57.292091 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:20:57.293529 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.318490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.245 seconds
[0m23:20:57.320199 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:20:57.321578 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.326082 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.031 seconds
[0m23:20:57.330047 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m23:20:57.333449 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m23:20:57.334823 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:20:57.338579 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m23:20:57.341360 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m23:20:57.342777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.262 seconds
[0m23:20:57.346019 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:20:57.340341 [error] [Thread-2 (]: 12 of 21 FAIL 642 relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[31mFAIL 642[0m in 0.35s]
[0m23:20:57.347629 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.345057 [info ] [Thread-3 (]: 10 of 21 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.36s]
[0m23:20:57.350007 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:20:57.352076 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:20:57.353507 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:20:57.355016 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:20:57.356408 [info ] [Thread-2 (]: 14 of 21 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:20:57.357749 [info ] [Thread-3 (]: 15 of 21 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m23:20:57.359101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m23:20:57.360431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m23:20:57.361657 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:20:57.362890 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:20:57.390893 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:20:57.406730 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:20:57.408708 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.057 seconds
[0m23:20:57.414081 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m23:20:57.415736 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m23:20:57.416981 [debug] [Thread-4 (]: SQL status: BEGIN in 0.172 seconds
[0m23:20:57.420257 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:20:57.422396 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.419002 [error] [Thread-1 (]: 11 of 21 FAIL 37169 relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[31mFAIL 37169[0m in 0.43s]
[0m23:20:57.425108 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:20:57.426240 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:20:57.430023 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:20:57.439079 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:20:57.445438 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:20:57.447172 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:20:57.448912 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:20:57.450973 [info ] [Thread-1 (]: 16 of 21 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:20:57.456027 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m23:20:57.457377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m23:20:57.458925 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:20:57.460220 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m23:20:57.474104 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:20:57.477750 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:20:57.479517 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m23:20:57.480828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:20:57.483135 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:20:57.476320 [error] [Thread-4 (]: 13 of 21 FAIL 13856 relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[31mFAIL 13856[0m in 0.26s]
[0m23:20:57.485041 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m23:20:57.487357 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:20:57.488709 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:20:57.489918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:20:57.491273 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:20:57.499370 [info ] [Thread-4 (]: 17 of 21 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:20:57.500785 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m23:20:57.501983 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:20:57.515671 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:20:57.516749 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:20:57.520086 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:20:57.522349 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m23:20:57.523346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:57.521294 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:20:57.529985 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:20:57.532965 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:20:57.534183 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m23:20:57.535275 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:20:57.622537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.142 seconds
[0m23:20:57.623683 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:20:57.624783 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.629834 [debug] [Thread-3 (]: SQL status: BEGIN in 0.140 seconds
[0m23:20:57.630924 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:20:57.631998 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.646792 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:20:57.650893 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m23:20:57.652042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.129 seconds
[0m23:20:57.653192 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:20:57.654096 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m23:20:57.655128 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.656883 [error] [Thread-2 (]: 14 of 21 FAIL 1112 relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[31mFAIL 1112[0m in 0.30s]
[0m23:20:57.658990 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:20:57.660179 [debug] [Thread-4 (]: SQL status: BEGIN in 0.125 seconds
[0m23:20:57.661361 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:20:57.662613 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:20:57.663880 [info ] [Thread-2 (]: 18 of 21 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m23:20:57.665197 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.032 seconds
[0m23:20:57.666376 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:20:57.667748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m23:20:57.671799 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m23:20:57.673128 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:20:57.682191 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m23:20:57.685883 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:20:57.686608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m23:20:57.691790 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m23:20:57.688068 [info ] [Thread-3 (]: 15 of 21 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.33s]
[0m23:20:57.693781 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:20:57.694888 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m23:20:57.695854 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:20:57.696578 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:20:57.699889 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m23:20:57.702334 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:20:57.701435 [error] [Thread-1 (]: 16 of 21 FAIL 18760 relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[31mFAIL 18760[0m in 0.24s]
[0m23:20:57.703271 [info ] [Thread-3 (]: 19 of 21 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m23:20:57.704863 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m23:20:57.708395 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:20:57.709535 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:20:57.710314 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m23:20:57.713145 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:20:57.714443 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:20:57.711921 [error] [Thread-4 (]: 17 of 21 FAIL 18760 relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[31mFAIL 18760[0m in 0.21s]
[0m23:20:57.716187 [info ] [Thread-1 (]: 20 of 21 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m23:20:57.725499 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:20:57.727296 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:20:57.729697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m23:20:57.730753 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:20:57.732012 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:20:57.732761 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:20:57.733626 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m23:20:57.734480 [info ] [Thread-4 (]: 21 of 21 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m23:20:57.742171 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:20:57.743125 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:20:57.743881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:20:57.744809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m23:20:57.749209 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:20:57.750706 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:20:57.760358 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:20:57.761928 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:20:57.767829 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:20:57.770007 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:20:57.775981 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:20:57.777509 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:20:57.778915 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m23:20:57.780098 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:20:57.782143 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:20:57.783343 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m23:20:57.784560 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:20:57.785466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:57.786524 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m23:20:57.787505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:20:57.868430 [debug] [Thread-2 (]: SQL status: BEGIN in 0.124 seconds
[0m23:20:57.869444 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:20:57.870503 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:20:57.896862 [debug] [Thread-3 (]: SQL status: BEGIN in 0.117 seconds
[0m23:20:57.897937 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:20:57.899122 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:20:57.904813 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:20:57.908176 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m23:20:57.909107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m23:20:57.910043 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:20:57.910675 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m23:20:57.911293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m23:20:57.911957 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:20:57.912787 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:20:57.913884 [info ] [Thread-3 (]: 19 of 21 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.20s]
[0m23:20:57.915252 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:20:57.917418 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:20:57.923808 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:20:57.924854 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.053 seconds
[0m23:20:57.927385 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m23:20:57.930538 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m23:20:57.932829 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m23:20:57.934254 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m23:20:57.938613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m23:20:57.936245 [info ] [Thread-4 (]: 21 of 21 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.19s]
[0m23:20:57.942808 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m23:20:57.944625 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:20:57.937656 [info ] [Thread-2 (]: 18 of 21 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.27s]
[0m23:20:57.946804 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:20:57.947824 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m23:20:57.949973 [info ] [Thread-1 (]: 20 of 21 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.22s]
[0m23:20:57.951807 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:20:57.955267 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:57.956183 [debug] [MainThread]: On master: BEGIN
[0m23:20:57.956947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:58.049787 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m23:20:58.050729 [debug] [MainThread]: On master: COMMIT
[0m23:20:58.051366 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:58.051849 [debug] [MainThread]: On master: COMMIT
[0m23:20:58.052646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:20:58.053310 [debug] [MainThread]: On master: Close
[0m23:20:58.054218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:58.054747 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:20:58.055433 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:20:58.056070 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:20:58.056738 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:20:58.057449 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m23:20:58.058139 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e' was properly closed.
[0m23:20:58.058779 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m23:20:58.059434 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd' was properly closed.
[0m23:20:58.060231 [info ] [MainThread]: 
[0m23:20:58.061094 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m23:20:58.070223 [debug] [MainThread]: Command end result
[0m23:20:58.143359 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:20:58.148380 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:20:58.162176 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:20:58.163047 [info ] [MainThread]: 
[0m23:20:58.163707 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m23:20:58.164740 [info ] [MainThread]: 
[0m23:20:58.166696 [error] [MainThread]: [31mFailure in test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_ (models\dw\dw.yml)[0m
[0m23:20:58.168239 [error] [MainThread]:   Got 642 results, configured to fail if != 0
[0m23:20:58.169350 [info ] [MainThread]: 
[0m23:20:58.170497 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_feedback_554121ba4085396fe127145d5488dad1.sql
[0m23:20:58.171177 [info ] [MainThread]: 
[0m23:20:58.172117 [error] [MainThread]: [31mFailure in test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_ (models\dw\dw.yml)[0m
[0m23:20:58.173171 [error] [MainThread]:   Got 37169 results, configured to fail if != 0
[0m23:20:58.173966 [info ] [MainThread]: 
[0m23:20:58.174960 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_analytic_ev_71ca9490db4c2c94b091aeda658bdb86.sql
[0m23:20:58.175772 [info ] [MainThread]: 
[0m23:20:58.176562 [error] [MainThread]: [31mFailure in test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_ (models\dw\dw.yml)[0m
[0m23:20:58.177535 [error] [MainThread]:   Got 13856 results, configured to fail if != 0
[0m23:20:58.178204 [info ] [MainThread]: 
[0m23:20:58.179002 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_invoices_b475ee016c9b70b1b8e97d26f39ba407.sql
[0m23:20:58.179735 [info ] [MainThread]: 
[0m23:20:58.181062 [error] [MainThread]: [31mFailure in test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_ (models\dw\dw.yml)[0m
[0m23:20:58.182584 [error] [MainThread]:   Got 1112 results, configured to fail if != 0
[0m23:20:58.183437 [info ] [MainThread]: 
[0m23:20:58.184590 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_reviews_ad613a1d0d4e9a21698cf227f766fd77.sql
[0m23:20:58.185466 [info ] [MainThread]: 
[0m23:20:58.186613 [error] [MainThread]: [31mFailure in test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_ (models\dw\dw.yml)[0m
[0m23:20:58.187885 [error] [MainThread]:   Got 18760 results, configured to fail if != 0
[0m23:20:58.188704 [info ] [MainThread]: 
[0m23:20:58.189908 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_sales_d4911c7fbe94a687baf4d24871f270a7.sql
[0m23:20:58.190826 [info ] [MainThread]: 
[0m23:20:58.191920 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_nk__product_nk__ref_dim_product_ (models\dw\dw.yml)[0m
[0m23:20:58.193057 [error] [MainThread]:   Got 18760 results, configured to fail if != 0
[0m23:20:58.193893 [info ] [MainThread]: 
[0m23:20:58.194862 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_sales_8cdccf20451339f43c0b6fe22e9adc5b.sql
[0m23:20:58.195699 [info ] [MainThread]: 
[0m23:20:58.196511 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=21
[0m23:20:58.199102 [debug] [MainThread]: Command `dbt test` failed at 23:20:58.198824 after 5.25 seconds
[0m23:20:58.199754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205757E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057642E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057642CF70>]}
[0m23:20:58.200373 [debug] [MainThread]: Flushing usage events
[0m23:20:59.272332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:22.459765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208365B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020836E58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838498E10>]}


============================== 23:26:22.475414 | 355fb569-5a5e-4d5a-a356-a6be50ed5457 ==============================
[0m23:26:22.475414 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:26:22.476823 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_metabase_orders stg_metabase_invoices stg_metabase_feedback stg_metabase_analytic_events', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m23:26:22.813929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208367E9F30>]}
[0m23:26:22.947489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083850FDF0>]}
[0m23:26:22.950037 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:26:23.566066 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:26:23.959054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:26:23.960703 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_feedback.sql
[0m23:26:23.961673 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_analytic_events.sql
[0m23:26:23.962505 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_invoices.sql
[0m23:26:23.963270 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m23:26:25.022336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838AFEB50>]}
[0m23:26:25.267299 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:26:25.277793 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:26:25.391256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838B88F50>]}
[0m23:26:25.393279 [info ] [MainThread]: Found 29 models, 1 snapshot, 72 data tests, 14 sources, 449 macros
[0m23:26:25.394183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838764210>]}
[0m23:26:25.402266 [info ] [MainThread]: 
[0m23:26:25.402969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:25.403492 [info ] [MainThread]: 
[0m23:26:25.404340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:25.415001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:26:25.742993 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:26:25.743575 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:26:25.744157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:25.876617 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.132 seconds
[0m23:26:25.878706 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:26:25.883606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:26:25.892318 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:26:25.893112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:26:25.893880 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:26:25.896767 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:26:25.898050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:26:25.898514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:25.899158 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:26:25.899735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:26:25.901828 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:26:25.902606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:25.904829 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:26:25.905414 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:26:25.907010 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:26:25.908012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:25.909164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:25.994455 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m23:26:25.995352 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:26:25.996127 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:26:25.997872 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m23:26:25.998596 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:26:25.999421 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:26:26.003942 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m23:26:26.004539 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:26:26.005062 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:26:26.009564 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m23:26:26.010203 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:26:26.010745 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:26:26.017220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m23:26:26.017857 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:26:26.019690 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:26:26.020177 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m23:26:26.021722 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:26:26.022298 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m23:26:26.024628 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:26:26.025234 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:26:26.026951 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:26:26.027441 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:26:26.028131 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:26:26.030472 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:26:26.031340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:26:26.031889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:26:26.036387 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:26:26.037328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dw)
[0m23:26:26.038365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_stg)
[0m23:26:26.042082 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:26:26.042780 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:26:26.045143 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:26:26.047890 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:26:26.048498 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:26:26.048975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:26.049429 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:26:26.049863 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:26:26.050287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:26.050906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:26.051342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:26.145371 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m23:26:26.146236 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:26:26.146975 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:26:26.149128 [debug] [ThreadPool]: SQL status: BEGIN in 0.098 seconds
[0m23:26:26.150136 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:26:26.150965 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:26:26.152790 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m23:26:26.153571 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:26:26.154226 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:26:26.161319 [debug] [ThreadPool]: SQL status: BEGIN in 0.110 seconds
[0m23:26:26.162150 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:26:26.162854 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:26:26.166241 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:26:26.169055 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:26:26.169867 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.018 seconds
[0m23:26:26.170548 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m23:26:26.173226 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:26:26.174331 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:26:26.177493 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:26:26.178861 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:26:26.179728 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:26:26.181026 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.017 seconds
[0m23:26:26.188601 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:26:26.191468 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:26:26.206799 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:26.207536 [debug] [MainThread]: On master: BEGIN
[0m23:26:26.208191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:26.304963 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m23:26:26.306038 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:26.309856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:26:26.343600 [debug] [MainThread]: SQL status: SELECT 22 in 0.032 seconds
[0m23:26:26.352463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083A1857E0>]}
[0m23:26:26.353580 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:26.354699 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:26.355493 [debug] [MainThread]: On master: BEGIN
[0m23:26:26.358904 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:26:26.361037 [debug] [MainThread]: On master: COMMIT
[0m23:26:26.362415 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:26.363886 [debug] [MainThread]: On master: COMMIT
[0m23:26:26.368488 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:26:26.369584 [debug] [MainThread]: On master: Close
[0m23:26:26.494854 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:26:26.496412 [info ] [Thread-3 (]: 3 of 4 START sql view model dw_stg.stg_metabase_invoices ....................... [RUN]
[0m23:26:26.498599 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:26:26.499767 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:26:26.500815 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:26:26.502155 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_invoices'
[0m23:26:26.503525 [info ] [Thread-1 (]: 1 of 4 START sql view model dw_stg.stg_metabase_analytic_events ................ [RUN]
[0m23:26:26.507950 [info ] [Thread-4 (]: 4 of 4 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m23:26:26.513234 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:26:26.509988 [info ] [Thread-2 (]: 2 of 4 START sql view model dw_stg.stg_metabase_feedback ....................... [RUN]
[0m23:26:26.516245 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_analytic_events'
[0m23:26:26.517810 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m23:26:26.546512 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:26.549555 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_feedback'
[0m23:26:26.550932 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:26:26.552259 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m23:26:26.554165 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:26:26.566031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:26.583071 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:26.592982 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:26.595280 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:26:26.644143 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m23:26:26.705869 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:26:26.764243 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:26:26.819301 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:26.824436 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:26.829276 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:26.839012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:26.848132 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:26.849461 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m23:26:26.850666 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:26:26.853154 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:26.854403 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: BEGIN
[0m23:26:26.856128 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:26:26.863985 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:26.865481 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: BEGIN
[0m23:26:26.866718 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:26:26.918065 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:26.919231 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: BEGIN
[0m23:26:26.920218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:26:27.097344 [debug] [Thread-3 (]: SQL status: BEGIN in 0.241 seconds
[0m23:26:27.098482 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:27.099670 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp"
    
    
  as (
    

-- Faturas SaaS (Metabase) com valores normalizados e v√≠nculo ao cliente.
select
    'METABASE'                               as source_system,
    i.id                                     as source_invoice_id,
    'METABASE_' || i.id                      as invoice_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else null
    end                                      as customer_nk,
    i.account_id                             as source_account_id,
    i.plan                                   as plan_name,
    cast(i.payment as numeric(12,4))         as payment_amount,
    i.expected_invoice                       as expected_invoice_flag,
    case
        when i.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then i.date_received::timestamp
        else null
    end                                      as date_received,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."invoices" i
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(acc.email) = lower(i.account_id)
  );
[0m23:26:27.113670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.193 seconds
[0m23:26:27.114994 [debug] [Thread-2 (]: SQL status: BEGIN in 0.248 seconds
[0m23:26:27.116215 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:27.117429 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:27.119254 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp"
    
    
  as (
    

-- Eventos de analytics (produto/app) para an√°lises de comportamento.
select
    'METABASE'                               as source_system,
    ae.id                                    as source_event_id,
    'METABASE_EVT_' || ae.id                 as event_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else null
    end                                      as customer_nk,
    ae.account_id                            as source_account_id,
    ae.event                                 as event_name,
    case
        when ae."timestamp" ~ '^\d{4}-\d{2}-\d{2}'
            then ae."timestamp"::timestamp
        else null
    end                                      as event_timestamp,
    ae.page_url                              as page_url,
    ae.button_label                          as button_label,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."analyticevents" ae
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(acc.email) = lower(ae.account_id)
  );
[0m23:26:27.120789 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp"
    
    
  as (
    

-- Feedbacks recebidos via canais de suporte Metabase.
select
    'METABASE'                               as source_system,
    f.id                                     as source_feedback_id,
    'METABASE_FB_' || f.id                   as feedback_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else null
    end                                      as customer_nk,
    f.account_id                             as source_account_id,
    f.email                                  as contact_email,
    cast(f.rating as numeric(5,2))           as rating_score,
    f.rating_mapped                          as rating_label,
    case
        when f.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then f.date_received::timestamp
        else null
    end                                      as date_received,
    f.body                                   as feedback_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."feedback" f
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(acc.email) = lower(f.account_id)
  );
[0m23:26:27.123069 [debug] [Thread-4 (]: SQL status: BEGIN in 0.272 seconds
[0m23:26:27.124577 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:27.126246 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else 'METABASE_' || upper(o.user_id)
    end                                       as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(concat_ws(' ', acc.first_name, acc.last_name)) = lower(o.user_id)
  );
[0m23:26:27.137090 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m23:26:27.138370 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m23:26:27.151852 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:27.152569 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m23:26:27.153232 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m23:26:27.161627 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:27.162833 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices" rename to "stg_metabase_invoices__dbt_backup"
[0m23:26:27.168446 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:27.173257 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:27.175291 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events" rename to "stg_metabase_analytic_events__dbt_backup"
[0m23:26:27.176840 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback" rename to "stg_metabase_feedback__dbt_backup"
[0m23:26:27.178162 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m23:26:27.179305 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:26:27.185541 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:27.186288 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:26:27.186922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:26:27.187523 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp" rename to "stg_metabase_invoices"
[0m23:26:27.188172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:26:27.197032 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:27.202897 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:27.210841 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:27.211965 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:26:27.212876 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp" rename to "stg_metabase_feedback"
[0m23:26:27.213704 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp" rename to "stg_metabase_analytic_events"
[0m23:26:27.214498 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m23:26:27.250643 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: COMMIT
[0m23:26:27.251819 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:27.252625 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:27.253246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:27.253796 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: COMMIT
[0m23:26:27.254344 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:26:27.257663 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: COMMIT
[0m23:26:27.261191 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: COMMIT
[0m23:26:27.264147 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:26:27.264885 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:27.265599 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:27.266349 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:26:27.267146 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:27.267758 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: COMMIT
[0m23:26:27.268350 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: COMMIT
[0m23:26:27.279829 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_backup"
[0m23:26:27.280678 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:26:27.289217 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:26:27.290468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:26:27.291930 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:26:27.293742 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:27.296277 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_backup" cascade
[0m23:26:27.300643 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_backup"
[0m23:26:27.304073 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_backup"
[0m23:26:27.309791 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m23:26:27.311541 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:26:27.313248 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:26:27.314743 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:26:27.315544 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:26:27.316159 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_backup" cascade
[0m23:26:27.316814 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_backup" cascade
[0m23:26:27.317458 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m23:26:27.321140 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_invoices: Close
[0m23:26:27.327516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:26:27.328706 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:26:27.329718 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:26:27.333139 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: Close
[0m23:26:27.336578 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m23:26:27.338865 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_feedback: Close
[0m23:26:27.339998 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208389E3A10>]}
[0m23:26:27.341733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838E6FCD0>]}
[0m23:26:27.344402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838E6F330>]}
[0m23:26:27.347827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '355fb569-5a5e-4d5a-a356-a6be50ed5457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083A36C550>]}
[0m23:26:27.346182 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dw_stg.stg_metabase_invoices .................. [[32mCREATE VIEW[0m in 0.82s]
[0m23:26:27.349779 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.82s]
[0m23:26:27.355808 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:26:27.351923 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dw_stg.stg_metabase_feedback .................. [[32mCREATE VIEW[0m in 0.80s]
[0m23:26:27.353989 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw_stg.stg_metabase_analytic_events ........... [[32mCREATE VIEW[0m in 0.83s]
[0m23:26:27.358701 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:26:27.360864 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:26:27.362548 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:26:27.365989 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:27.366684 [debug] [MainThread]: On master: BEGIN
[0m23:26:27.367406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:27.480570 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m23:26:27.481454 [debug] [MainThread]: On master: COMMIT
[0m23:26:27.482235 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:27.482929 [debug] [MainThread]: On master: COMMIT
[0m23:26:27.483868 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:27.484406 [debug] [MainThread]: On master: Close
[0m23:26:27.485291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:27.486012 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:26:27.486522 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:26:27.487232 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:26:27.488088 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:26:27.489362 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:26:27.490824 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_invoices' was properly closed.
[0m23:26:27.491732 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_analytic_events' was properly closed.
[0m23:26:27.492727 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m23:26:27.493656 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_feedback' was properly closed.
[0m23:26:27.494789 [info ] [MainThread]: 
[0m23:26:27.495845 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m23:26:27.499168 [debug] [MainThread]: Command end result
[0m23:26:27.608020 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:26:27.613845 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:26:27.633342 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:26:27.634370 [info ] [MainThread]: 
[0m23:26:27.635386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:27.636511 [info ] [MainThread]: 
[0m23:26:27.637992 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:26:27.641571 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:27.641181 after 5.39 seconds
[0m23:26:27.642447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208384CF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083268ED60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020836428BF0>]}
[0m23:26:27.643162 [debug] [MainThread]: Flushing usage events
[0m23:26:29.244755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:41.434102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275CAB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275E358B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275E998E10>]}


============================== 23:26:41.447248 | cf0b7ea3-d844-4c71-9707-fbce76e85848 ==============================
[0m23:26:41.447248 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:26:41.449069 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select fact_sales fact_invoices fact_feedback fact_analytic_events', 'printer_width': '80', 'target_path': 'None'}
[0m23:26:41.731201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275CCE9F30>]}
[0m23:26:41.836006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275EA1FDF0>]}
[0m23:26:41.838018 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:26:42.388491 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:26:42.649071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:42.650048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:42.734273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275EFDD250>]}
[0m23:26:42.905426 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:26:42.910230 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:26:43.039376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127594D8F50>]}
[0m23:26:43.040088 [info ] [MainThread]: Found 29 models, 1 snapshot, 72 data tests, 14 sources, 449 macros
[0m23:26:43.040753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275EBD99B0>]}
[0m23:26:43.102857 [info ] [MainThread]: 
[0m23:26:43.104091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:43.105269 [info ] [MainThread]: 
[0m23:26:43.106362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:43.124683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:26:43.305867 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:26:43.306380 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:26:43.306792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:43.395699 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.089 seconds
[0m23:26:43.398592 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:26:43.403546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:26:43.411250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:26:43.412246 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:26:43.416155 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:26:43.416820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m23:26:43.417547 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:26:43.418242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:26:43.418740 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:26:43.421150 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:26:43.421789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:43.424081 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:26:43.424633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:43.425135 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:26:43.425905 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:26:43.426776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:43.427273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:43.516752 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m23:26:43.517761 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:26:43.518678 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:26:43.522214 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m23:26:43.522947 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:26:43.523779 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:26:43.532245 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:26:43.533184 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:26:43.534051 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:26:43.535233 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m23:26:43.536168 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m23:26:43.539100 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:26:43.540112 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:26:43.540884 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.016 seconds
[0m23:26:43.541708 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:26:43.542314 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:26:43.544540 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:26:43.547213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:26:43.552268 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:26:43.553144 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:26:43.553917 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.019 seconds
[0m23:26:43.555240 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:26:43.557915 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:26:43.559011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_snapshots)
[0m23:26:43.559823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:43.563669 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:26:43.567026 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:26:43.567617 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:26:43.569994 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:26:43.570970 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:26:43.572127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:43.573006 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:26:43.574091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:26:43.587047 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:26:43.588350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:26:43.589464 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:26:43.593691 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:26:43.594608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:43.595580 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:26:43.597069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:43.674349 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m23:26:43.675229 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:26:43.676024 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:26:43.679164 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m23:26:43.680356 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:26:43.681608 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:26:43.693136 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:26:43.695140 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:26:43.695843 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m23:26:43.698827 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:26:43.699468 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:26:43.700047 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:26:43.700583 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:26:43.701160 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:26:43.701859 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m23:26:43.702688 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:26:43.703833 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:26:43.705019 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:26:43.717467 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m23:26:43.718059 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:26:43.719808 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:26:43.721439 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:26:43.722207 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:26:43.722663 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:26:43.733486 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:43.734069 [debug] [MainThread]: On master: BEGIN
[0m23:26:43.734503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:43.799667 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m23:26:43.800491 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:43.801318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:26:43.818453 [debug] [MainThread]: SQL status: SELECT 26 in 0.016 seconds
[0m23:26:43.822986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275F3AD300>]}
[0m23:26:43.823680 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:43.824547 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:43.825132 [debug] [MainThread]: On master: BEGIN
[0m23:26:43.825975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:26:43.826453 [debug] [MainThread]: On master: COMMIT
[0m23:26:43.826900 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:43.827313 [debug] [MainThread]: On master: COMMIT
[0m23:26:43.827927 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:43.828379 [debug] [MainThread]: On master: Close
[0m23:26:43.837990 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_analytic_events
[0m23:26:43.839004 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.fact_invoices
[0m23:26:43.839655 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m23:26:43.840255 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_feedback
[0m23:26:43.841937 [info ] [Thread-1 (]: 1 of 4 START sql table model dw_dw.fact_analytic_events ........................ [RUN]
[0m23:26:43.842941 [info ] [Thread-3 (]: 3 of 4 START sql table model dw_dw.fact_invoices ............................... [RUN]
[0m23:26:43.844089 [info ] [Thread-4 (]: 4 of 4 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m23:26:43.845276 [info ] [Thread-2 (]: 2 of 4 START sql table model dw_dw.fact_feedback ............................... [RUN]
[0m23:26:43.847287 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_analytic_events'
[0m23:26:43.848578 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_invoices'
[0m23:26:43.849602 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m23:26:43.850867 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_feedback'
[0m23:26:43.851939 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_analytic_events
[0m23:26:43.852904 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.fact_invoices
[0m23:26:43.853837 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m23:26:43.854463 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_feedback
[0m23:26:43.870466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:43.875332 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_invoices"
[0m23:26:43.882154 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m23:26:43.886675 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_feedback"
[0m23:26:43.895997 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_analytic_events
[0m23:26:43.929471 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_feedback
[0m23:26:43.930716 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.fact_invoices
[0m23:26:43.971759 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_feedback"
[0m23:26:43.977795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:43.983209 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_invoices"
[0m23:26:43.984386 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m23:26:43.990432 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m23:26:43.992238 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:26:43.992963 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: BEGIN
[0m23:26:43.993947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:26:43.994936 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:26:43.995881 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:43.997444 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: BEGIN
[0m23:26:43.998583 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: BEGIN
[0m23:26:43.999971 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:26:44.000608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:26:44.001441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:26:44.002470 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m23:26:44.004284 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:26:44.093916 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m23:26:44.094745 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:26:44.095481 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de feedback (NPS / avalia√ß√µes de suporte).
select
    feedback_nk,
    source_system,
    source_feedback_id,
    customer_nk,
    source_account_id,
    contact_email,
    rating_score,
    rating_label,
    date_received,
    feedback_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback"
  );
  
[0m23:26:44.100474 [debug] [Thread-3 (]: SQL status: BEGIN in 0.100 seconds
[0m23:26:44.101378 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:26:44.102003 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de faturamento SaaS (faturas Metabase).
select
    invoice_nk,
    source_system,
    source_invoice_id,
    customer_nk,
    source_account_id,
    plan_name,
    payment_amount,
    expected_invoice_flag,
    date_received,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices"
  );
  
[0m23:26:44.103850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m23:26:44.104641 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:44.105508 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de eventos de produto / analytics.
select
    event_nk,
    source_system,
    source_event_id,
    customer_nk,
    source_account_id,
    event_name,
    event_timestamp,
    page_url,
    button_label,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events"
  );
  
[0m23:26:44.107683 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m23:26:44.108530 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:26:44.109528 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m23:26:44.291432 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.195 seconds
[0m23:26:44.311954 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:26:44.312901 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_feedback" rename to "fact_feedback__dbt_backup"
[0m23:26:44.314981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.321930 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:26:44.322685 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_tmp" rename to "fact_feedback"
[0m23:26:44.324223 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.374205 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: COMMIT
[0m23:26:44.374962 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:26:44.375735 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: COMMIT
[0m23:26:44.388055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m23:26:44.403643 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_backup"
[0m23:26:44.416906 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m23:26:44.418150 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_backup" cascade
[0m23:26:44.434921 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.016 seconds
[0m23:26:44.440169 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_feedback: Close
[0m23:26:44.445359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275F5F8650>]}
[0m23:26:44.447304 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dw_dw.fact_feedback .......................... [[32mSELECT 642[0m in 0.59s]
[0m23:26:44.449472 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_feedback
[0m23:26:44.552477 [debug] [Thread-3 (]: SQL status: SELECT 13856 in 0.450 seconds
[0m23:26:44.558602 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:26:44.559314 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_invoices" rename to "fact_invoices__dbt_backup"
[0m23:26:44.560457 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.566186 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:26:44.567060 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_tmp" rename to "fact_invoices"
[0m23:26:44.568619 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.572237 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: COMMIT
[0m23:26:44.572899 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:26:44.573658 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: COMMIT
[0m23:26:44.584211 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m23:26:44.589564 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_backup"
[0m23:26:44.590833 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m23:26:44.591408 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_backup" cascade
[0m23:26:44.602225 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m23:26:44.604443 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_invoices: Close
[0m23:26:44.605453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275F144680>]}
[0m23:26:44.606836 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dw_dw.fact_invoices .......................... [[32mSELECT 13856[0m in 0.76s]
[0m23:26:44.608796 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.fact_invoices
[0m23:26:44.886274 [debug] [Thread-1 (]: SQL status: SELECT 37169 in 0.780 seconds
[0m23:26:44.891251 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:44.891843 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_analytic_events" rename to "fact_analytic_events__dbt_backup"
[0m23:26:44.892918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.897912 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:44.898639 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_tmp" rename to "fact_analytic_events"
[0m23:26:44.899941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.902749 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: COMMIT
[0m23:26:44.903335 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:44.903825 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: COMMIT
[0m23:26:44.909087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:26:44.911901 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_backup"
[0m23:26:44.912872 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m23:26:44.914053 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_backup" cascade
[0m23:26:44.923088 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m23:26:44.924955 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_analytic_events: Close
[0m23:26:44.925817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275F549810>]}
[0m23:26:44.926882 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dw_dw.fact_analytic_events ................... [[32mSELECT 37169[0m in 1.08s]
[0m23:26:44.927993 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_analytic_events
[0m23:26:44.961549 [debug] [Thread-4 (]: SQL status: SELECT 20924 in 0.851 seconds
[0m23:26:44.966930 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:26:44.967555 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m23:26:44.968687 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.972590 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:26:44.973562 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:26:44.975713 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:44.978823 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:26:44.980165 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:26:44.981222 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:26:44.985780 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:26:44.989284 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m23:26:44.990457 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:26:44.991004 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m23:26:44.999118 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m23:26:45.001244 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m23:26:45.002442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0b7ea3-d844-4c71-9707-fbce76e85848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275F458AD0>]}
[0m23:26:45.004080 [info ] [Thread-4 (]: 4 of 4 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20924[0m in 1.15s]
[0m23:26:45.005398 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m23:26:45.008798 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:45.009542 [debug] [MainThread]: On master: BEGIN
[0m23:26:45.010248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:45.078411 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m23:26:45.078939 [debug] [MainThread]: On master: COMMIT
[0m23:26:45.079568 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:45.080077 [debug] [MainThread]: On master: COMMIT
[0m23:26:45.081141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:45.081965 [debug] [MainThread]: On master: Close
[0m23:26:45.082845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:45.083345 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:26:45.083819 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:26:45.084191 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:26:45.084600 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:26:45.085062 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:26:45.085512 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_analytic_events' was properly closed.
[0m23:26:45.085968 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_invoices' was properly closed.
[0m23:26:45.086410 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m23:26:45.086821 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_feedback' was properly closed.
[0m23:26:45.087354 [info ] [MainThread]: 
[0m23:26:45.087842 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m23:26:45.089727 [debug] [MainThread]: Command end result
[0m23:26:45.166777 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:26:45.173984 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:26:45.190893 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:26:45.192075 [info ] [MainThread]: 
[0m23:26:45.193200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:45.194519 [info ] [MainThread]: 
[0m23:26:45.196319 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:26:45.200274 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:45.199903 after 3.95 seconds
[0m23:26:45.201318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275E9CF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012758B7ED60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001275E7DC0B0>]}
[0m23:26:45.202073 [debug] [MainThread]: Flushing usage events
[0m23:26:46.504051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:00.874277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020251FE0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020252888B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020252EC8E10>]}


============================== 23:27:00.880911 | 28952cfb-0cd0-4ebd-b93d-3ea489394db9 ==============================
[0m23:27:00.880911 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:27:00.881722 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'printer_width': '80', 'target_path': 'None'}
[0m23:27:01.260763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28952cfb-0cd0-4ebd-b93d-3ea489394db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020252219F30>]}
[0m23:27:01.360321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28952cfb-0cd0-4ebd-b93d-3ea489394db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025400FDF0>]}
[0m23:27:01.362050 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:27:01.959767 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:27:02.306983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:02.307533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:02.402756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28952cfb-0cd0-4ebd-b93d-3ea489394db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025431B350>]}
[0m23:27:02.585714 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:27:02.592731 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:27:02.752769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28952cfb-0cd0-4ebd-b93d-3ea489394db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025482A6C0>]}
[0m23:27:02.755551 [info ] [MainThread]: Found 29 models, 1 snapshot, 72 data tests, 14 sources, 449 macros
[0m23:27:02.756956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28952cfb-0cd0-4ebd-b93d-3ea489394db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025416E890>]}
[0m23:27:02.763729 [info ] [MainThread]: 
[0m23:27:02.764364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:27:02.764885 [info ] [MainThread]: 
[0m23:27:02.765938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:02.777710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:27:02.786595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:27:02.800412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:27:02.805315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m23:27:02.981793 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:27:02.982659 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:27:02.983226 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:27:02.983775 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:27:02.984470 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:27:02.985143 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:27:02.985848 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:27:02.986480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:02.987341 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:27:02.988096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:02.988604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:02.989384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:03.114179 [debug] [ThreadPool]: SQL status: BEGIN in 0.125 seconds
[0m23:27:03.115230 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:27:03.116408 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:27:03.117679 [debug] [ThreadPool]: SQL status: BEGIN in 0.129 seconds
[0m23:27:03.119039 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:27:03.120366 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:27:03.128279 [debug] [ThreadPool]: SQL status: BEGIN in 0.140 seconds
[0m23:27:03.129350 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:27:03.130417 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:27:03.140055 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:27:03.140955 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m23:27:03.144259 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:27:03.147149 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:27:03.148177 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m23:27:03.148945 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.018 seconds
[0m23:27:03.149540 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:27:03.150096 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:27:03.150610 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:27:03.152575 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:27:03.153624 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:27:03.155316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dw)
[0m23:27:03.156687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:27:03.158119 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:27:03.162143 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:27:03.165617 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:27:03.166547 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:27:03.167875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:27:03.168814 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:27:03.177511 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:27:03.178265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:03.183343 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:27:03.184307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:03.187226 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:27:03.188608 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:27:03.189752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:03.190449 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:27:03.192130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_snapshots)
[0m23:27:03.196537 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:27:03.197425 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:27:03.198117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:03.370358 [debug] [ThreadPool]: SQL status: BEGIN in 0.186 seconds
[0m23:27:03.371772 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:27:03.372964 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:27:03.380835 [debug] [ThreadPool]: SQL status: BEGIN in 0.191 seconds
[0m23:27:03.381807 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:27:03.382769 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:27:03.389129 [debug] [ThreadPool]: SQL status: BEGIN in 0.211 seconds
[0m23:27:03.390317 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:27:03.391674 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:27:03.392845 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:27:03.396100 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:27:03.397208 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:27:03.400687 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m23:27:03.401594 [debug] [ThreadPool]: SQL status: BEGIN in 0.203 seconds
[0m23:27:03.404911 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:27:03.405992 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:27:03.407506 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:27:03.408588 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.016 seconds
[0m23:27:03.409182 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:27:03.411521 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:27:03.412735 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:27:03.423821 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m23:27:03.425819 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:27:03.426723 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:27:03.436201 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:03.437113 [debug] [MainThread]: On master: BEGIN
[0m23:27:03.438274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:03.519068 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m23:27:03.519983 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:03.521251 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:27:03.541323 [debug] [MainThread]: SQL status: SELECT 18 in 0.019 seconds
[0m23:27:03.544841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28952cfb-0cd0-4ebd-b93d-3ea489394db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020254A994A0>]}
[0m23:27:03.545922 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:03.546931 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:03.547433 [debug] [MainThread]: On master: BEGIN
[0m23:27:03.548323 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:27:03.548804 [debug] [MainThread]: On master: COMMIT
[0m23:27:03.549251 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:03.549659 [debug] [MainThread]: On master: COMMIT
[0m23:27:03.550241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:27:03.550679 [debug] [MainThread]: On master: Close
[0m23:27:03.562408 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:27:03.563115 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:27:03.563760 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:27:03.564357 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:27:03.565055 [info ] [Thread-1 (]: 1 of 21 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m23:27:03.565795 [info ] [Thread-4 (]: 4 of 21 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m23:27:03.566793 [info ] [Thread-3 (]: 3 of 21 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m23:27:03.568111 [info ] [Thread-2 (]: 2 of 21 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m23:27:03.569718 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m23:27:03.571858 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m23:27:03.573161 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m23:27:03.574184 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m23:27:03.574855 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:27:03.575508 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:27:03.576081 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:27:03.576701 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:27:03.607103 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:27:03.614200 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:27:03.622086 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:27:03.628210 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:27:03.630625 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:27:03.667897 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:27:03.668653 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:27:03.677731 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:27:03.678924 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:27:03.684491 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:27:03.685927 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:27:03.688061 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:27:03.689267 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:27:03.693781 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:27:03.694628 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m23:27:03.695311 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m23:27:03.696306 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:27:03.697889 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:27:03.699109 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:27:03.700282 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m23:27:03.702271 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:27:03.703658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:27:03.704913 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m23:27:03.706550 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:27:03.810419 [debug] [Thread-4 (]: SQL status: BEGIN in 0.111 seconds
[0m23:27:03.811285 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:27:03.812086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.114 seconds
[0m23:27:03.812922 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:03.813734 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:27:03.814988 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:03.819204 [debug] [Thread-3 (]: SQL status: BEGIN in 0.116 seconds
[0m23:27:03.820422 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:27:03.821618 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:03.826879 [debug] [Thread-2 (]: SQL status: BEGIN in 0.120 seconds
[0m23:27:03.828098 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:27:03.829246 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:03.834498 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:27:03.835550 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:27:03.844944 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m23:27:03.845708 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:27:03.848381 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m23:27:03.850960 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m23:27:03.851594 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m23:27:03.852707 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m23:27:03.854533 [info ] [Thread-3 (]: 3 of 21 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.28s]
[0m23:27:03.856304 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m23:27:03.859553 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:27:03.857986 [info ] [Thread-4 (]: 4 of 21 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.29s]
[0m23:27:03.861170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m23:27:03.862529 [info ] [Thread-2 (]: 2 of 21 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.29s]
[0m23:27:03.863825 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:27:03.865425 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:27:03.869157 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m23:27:03.871466 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:27:03.872839 [info ] [Thread-3 (]: 5 of 21 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m23:27:03.874574 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:27:03.876181 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:27:03.877275 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m23:27:03.878506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m23:27:03.879781 [info ] [Thread-4 (]: 6 of 21 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m23:27:03.881190 [info ] [Thread-2 (]: 7 of 21 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m23:27:03.882666 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:27:03.885016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m23:27:03.884144 [info ] [Thread-1 (]: 1 of 21 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.31s]
[0m23:27:03.886824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m23:27:03.898252 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:27:03.899291 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:27:03.900531 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:27:03.901547 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:27:03.909217 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:27:03.910317 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:27:03.920122 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:27:03.923277 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:27:03.922210 [info ] [Thread-1 (]: 8 of 21 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m23:27:03.931505 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:27:03.932717 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:27:03.934101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m23:27:03.939620 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:27:03.940497 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:27:03.941305 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:27:03.947165 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:27:03.956344 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:27:03.957547 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:27:03.958697 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:27:03.959789 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m23:27:03.960614 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m23:27:03.961548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:03.962794 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:27:03.963638 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:27:03.964915 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:27:03.969294 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:27:03.971548 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m23:27:03.973039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:27:03.975743 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:27:03.977111 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m23:27:03.978120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:04.100586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.122 seconds
[0m23:27:04.101806 [debug] [Thread-2 (]: SQL status: BEGIN in 0.129 seconds
[0m23:27:04.103154 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:27:04.104492 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:27:04.105672 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.106940 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.112978 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m23:27:04.114141 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:27:04.115250 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.121785 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:27:04.125579 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m23:27:04.126990 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m23:27:04.128123 [debug] [Thread-3 (]: SQL status: BEGIN in 0.167 seconds
[0m23:27:04.129222 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:27:04.131780 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.130780 [info ] [Thread-4 (]: 6 of 21 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.25s]
[0m23:27:04.133917 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:27:04.135133 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:27:04.136315 [info ] [Thread-4 (]: 9 of 21 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m23:27:04.137734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m23:27:04.138799 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:27:04.139776 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:27:04.143716 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m23:27:04.144902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.037 seconds
[0m23:27:04.155011 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:27:04.156155 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.048 seconds
[0m23:27:04.159735 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m23:27:04.160941 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m23:27:04.164448 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m23:27:04.165872 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m23:27:04.168391 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m23:27:04.167417 [info ] [Thread-3 (]: 5 of 21 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.29s]
[0m23:27:04.170141 [info ] [Thread-1 (]: 8 of 21 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.24s]
[0m23:27:04.171969 [info ] [Thread-2 (]: 7 of 21 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.29s]
[0m23:27:04.173756 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:27:04.175247 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:27:04.176836 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:27:04.177878 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:27:04.179068 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:27:04.180265 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:27:04.181494 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:27:04.187833 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:27:04.189375 [info ] [Thread-3 (]: 10 of 21 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m23:27:04.191137 [info ] [Thread-1 (]: 11 of 21 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:27:04.192574 [info ] [Thread-2 (]: 12 of 21 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:27:04.194197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m23:27:04.195430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m23:27:04.196549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m23:27:04.197803 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:27:04.199016 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:27:04.200249 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:27:04.201211 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:27:04.211727 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:27:04.236454 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m23:27:04.235044 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:27:04.250537 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:27:04.252054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:27:04.256346 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:27:04.267007 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:27:04.268633 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:27:04.274784 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:27:04.281467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:27:04.284002 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:27:04.288253 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:27:04.289822 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m23:27:04.291330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:04.293152 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:27:04.294571 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:27:04.296209 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m23:27:04.297475 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m23:27:04.298608 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:04.299694 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:27:04.406703 [debug] [Thread-4 (]: SQL status: BEGIN in 0.155 seconds
[0m23:27:04.408021 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:27:04.409216 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.421006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.130 seconds
[0m23:27:04.422319 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:27:04.423638 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.425054 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m23:27:04.430139 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m23:27:04.431845 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m23:27:04.433763 [info ] [Thread-4 (]: 9 of 21 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.30s]
[0m23:27:04.435889 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:27:04.437231 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:27:04.438643 [info ] [Thread-4 (]: 13 of 21 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:27:04.440381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m23:27:04.441728 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:27:04.449664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.150 seconds
[0m23:27:04.450963 [debug] [Thread-3 (]: SQL status: BEGIN in 0.152 seconds
[0m23:27:04.457696 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:27:04.458466 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:27:04.459410 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:27:04.460712 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.461773 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.463346 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:27:04.469506 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:27:04.471782 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:27:04.475718 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m23:27:04.477619 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:27:04.478969 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:27:04.480148 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m23:27:04.481380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.055 seconds
[0m23:27:04.485197 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m23:27:04.486544 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m23:27:04.490349 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m23:27:04.492091 [info ] [Thread-2 (]: 12 of 21 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.30s]
[0m23:27:04.493719 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:27:04.495043 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m23:27:04.496609 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:27:04.497410 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m23:27:04.498747 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:27:04.500550 [info ] [Thread-3 (]: 10 of 21 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.31s]
[0m23:27:04.506128 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:27:04.501869 [info ] [Thread-2 (]: 14 of 21 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:27:04.507966 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:27:04.509285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m23:27:04.503445 [info ] [Thread-1 (]: 11 of 21 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.31s]
[0m23:27:04.510968 [info ] [Thread-3 (]: 15 of 21 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m23:27:04.512286 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:27:04.513845 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:27:04.515002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m23:27:04.527072 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:27:04.527964 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:27:04.529049 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:27:04.530613 [info ] [Thread-1 (]: 16 of 21 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:27:04.544305 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:27:04.545094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m23:27:04.546223 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:27:04.553652 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:27:04.557305 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:27:04.561364 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:27:04.563352 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:27:04.568090 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:27:04.570276 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:27:04.576870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:27:04.579287 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:27:04.580563 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m23:27:04.581933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:04.583741 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:27:04.585383 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m23:27:04.586589 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:27:04.588111 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:27:04.589324 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m23:27:04.590649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:04.601681 [debug] [Thread-4 (]: SQL status: BEGIN in 0.108 seconds
[0m23:27:04.602875 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:27:04.604058 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.622057 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:27:04.625970 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m23:27:04.627240 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m23:27:04.628919 [info ] [Thread-4 (]: 13 of 21 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.19s]
[0m23:27:04.630687 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:27:04.632086 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:27:04.633340 [info ] [Thread-4 (]: 17 of 21 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:27:04.634586 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m23:27:04.635694 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:27:04.646598 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:27:04.649796 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:27:04.656469 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:27:04.659209 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:27:04.661022 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m23:27:04.662064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:27:04.700009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.112 seconds
[0m23:27:04.700919 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m23:27:04.701591 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:27:04.702407 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:27:04.703549 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.704934 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.709402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m23:27:04.710641 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:27:04.711768 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.713239 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:27:04.716207 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m23:27:04.717221 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m23:27:04.718390 [error] [Thread-2 (]: 14 of 21 FAIL 1112 relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[31mFAIL 1112[0m in 0.21s]
[0m23:27:04.720154 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:27:04.721330 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:27:04.722406 [info ] [Thread-2 (]: 18 of 21 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m23:27:04.723899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m23:27:04.724955 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:27:04.736940 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:27:04.738598 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.032 seconds
[0m23:27:04.739717 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m23:27:04.742488 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m23:27:04.745624 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m23:27:04.747131 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m23:27:04.748125 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:27:04.749017 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m23:27:04.755442 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:27:04.757150 [info ] [Thread-3 (]: 15 of 21 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.24s]
[0m23:27:04.759051 [error] [Thread-1 (]: 16 of 21 FAIL 47 relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[31mFAIL 47[0m in 0.21s]
[0m23:27:04.761441 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:27:04.763215 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:27:04.764504 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:27:04.765703 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:27:04.766408 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m23:27:04.767301 [info ] [Thread-3 (]: 19 of 21 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m23:27:04.768475 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:27:04.769371 [info ] [Thread-1 (]: 20 of 21 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m23:27:04.770851 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:27:04.772053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m23:27:04.772955 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m23:27:04.773668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m23:27:04.774364 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:27:04.775096 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:27:04.775712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:27:04.776296 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:27:04.790154 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:27:04.797432 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:27:04.798430 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:27:04.802818 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m23:27:04.804722 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m23:27:04.805943 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:27:04.812295 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:27:04.814981 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:27:04.813934 [error] [Thread-4 (]: 17 of 21 FAIL 18769 relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[31mFAIL 18769[0m in 0.18s]
[0m23:27:04.822302 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:27:04.823595 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:27:04.824792 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:27:04.825823 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:27:04.826785 [info ] [Thread-4 (]: 21 of 21 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m23:27:04.828197 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m23:27:04.829350 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m23:27:04.830289 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:04.831495 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:27:04.832505 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:27:04.833908 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m23:27:04.843478 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:27:04.844379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:04.846608 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:27:04.853813 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:27:04.857375 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:27:04.858502 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m23:27:04.859550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:27:04.903432 [debug] [Thread-2 (]: SQL status: BEGIN in 0.128 seconds
[0m23:27:04.904628 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:27:04.905768 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:27:04.943558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m23:27:04.944736 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:27:04.945517 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:27:04.951068 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:27:04.955025 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m23:27:04.956429 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m23:27:04.958177 [info ] [Thread-3 (]: 19 of 21 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.19s]
[0m23:27:04.960103 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:27:04.962777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.118 seconds
[0m23:27:04.963924 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:27:04.965248 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.058 seconds
[0m23:27:04.966452 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:27:04.969671 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m23:27:04.970991 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m23:27:04.971977 [debug] [Thread-4 (]: SQL status: BEGIN in 0.112 seconds
[0m23:27:04.974504 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:27:04.975649 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:27:04.973529 [info ] [Thread-2 (]: 18 of 21 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.25s]
[0m23:27:04.977596 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:27:04.981690 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:27:04.985486 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m23:27:04.986469 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m23:27:04.987829 [info ] [Thread-4 (]: 21 of 21 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.16s]
[0m23:27:04.989666 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:27:04.990612 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:27:04.993207 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m23:27:04.994508 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m23:27:04.995681 [info ] [Thread-1 (]: 20 of 21 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.22s]
[0m23:27:04.997745 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:27:05.000423 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:05.001068 [debug] [MainThread]: On master: BEGIN
[0m23:27:05.001554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:05.182035 [debug] [MainThread]: SQL status: BEGIN in 0.180 seconds
[0m23:27:05.183061 [debug] [MainThread]: On master: COMMIT
[0m23:27:05.184111 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:05.184772 [debug] [MainThread]: On master: COMMIT
[0m23:27:05.185656 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:27:05.186516 [debug] [MainThread]: On master: Close
[0m23:27:05.187686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:05.188739 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:27:05.189666 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:27:05.190476 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:27:05.191407 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:27:05.192129 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m23:27:05.192771 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m23:27:05.193333 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e' was properly closed.
[0m23:27:05.193871 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd' was properly closed.
[0m23:27:05.194501 [info ] [MainThread]: 
[0m23:27:05.195212 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m23:27:05.201650 [debug] [MainThread]: Command end result
[0m23:27:05.302038 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:27:05.311060 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:27:05.330628 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:27:05.331638 [info ] [MainThread]: 
[0m23:27:05.332735 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:27:05.333803 [info ] [MainThread]: 
[0m23:27:05.335116 [error] [MainThread]: [31mFailure in test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_ (models\dw\dw.yml)[0m
[0m23:27:05.337168 [error] [MainThread]:   Got 1112 results, configured to fail if != 0
[0m23:27:05.338703 [info ] [MainThread]: 
[0m23:27:05.340260 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_reviews_ad613a1d0d4e9a21698cf227f766fd77.sql
[0m23:27:05.341456 [info ] [MainThread]: 
[0m23:27:05.343031 [error] [MainThread]: [31mFailure in test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_ (models\dw\dw.yml)[0m
[0m23:27:05.344297 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m23:27:05.345222 [info ] [MainThread]: 
[0m23:27:05.346292 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_sales_d4911c7fbe94a687baf4d24871f270a7.sql
[0m23:27:05.347219 [info ] [MainThread]: 
[0m23:27:05.348301 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_nk__product_nk__ref_dim_product_ (models\dw\dw.yml)[0m
[0m23:27:05.349441 [error] [MainThread]:   Got 18769 results, configured to fail if != 0
[0m23:27:05.350154 [info ] [MainThread]: 
[0m23:27:05.351174 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\relationships_fact_sales_8cdccf20451339f43c0b6fe22e9adc5b.sql
[0m23:27:05.352277 [info ] [MainThread]: 
[0m23:27:05.353308 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=21
[0m23:27:05.357191 [debug] [MainThread]: Command `dbt test` failed at 23:27:05.356872 after 4.76 seconds
[0m23:27:05.357884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020252D12450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202547E5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202547E52E0>]}
[0m23:27:05.358499 [debug] [MainThread]: Flushing usage events
[0m23:27:06.510190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:27.781608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AB3B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ABC58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AD298E10>]}


============================== 23:31:27.813869 | 075a3e35-a0da-4d8e-9893-c59a91b1cae8 ==============================
[0m23:31:27.813869 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:31:27.818799 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_metabase_people stg_metabase_orders stg_metabase_reviews', 'printer_width': '80', 'target_path': 'None'}
[0m23:31:28.588489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AB5E9F30>]}
[0m23:31:28.825961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AD31FDF0>]}
[0m23:31:28.834717 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:31:30.083455 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:31:31.361425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m23:31:31.362948 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\staging\metabase\stg_metabase_people.sql
[0m23:31:31.368320 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\staging.yml
[0m23:31:31.369258 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m23:31:31.370034 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\intermediate\int_customers.sql
[0m23:31:31.370785 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_reviews.sql
[0m23:31:34.192218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AD8DE650>]}
[0m23:31:34.511956 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:31:34.519842 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:31:34.664480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ADB176B0>]}
[0m23:31:34.666018 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:31:34.667538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ADC21EF0>]}
[0m23:31:34.680517 [info ] [MainThread]: 
[0m23:31:34.681682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:34.683504 [info ] [MainThread]: 
[0m23:31:34.685460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:34.697082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:31:35.279724 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:31:35.280434 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:31:35.280979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:35.451977 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.171 seconds
[0m23:31:35.454374 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:31:35.462952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:31:35.472870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:31:35.478845 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:31:35.482810 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:31:35.484012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:31:35.484739 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:31:35.485834 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:31:35.488561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m23:31:35.494390 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:31:35.495580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:35.496443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:35.500239 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:31:35.501069 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:31:35.502155 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:31:35.502979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:35.503922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:35.616885 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m23:31:35.617958 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:31:35.618986 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:31:35.627217 [debug] [ThreadPool]: SQL status: BEGIN in 0.131 seconds
[0m23:31:35.628413 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:31:35.629506 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:31:35.637902 [debug] [ThreadPool]: SQL status: BEGIN in 0.134 seconds
[0m23:31:35.638655 [debug] [ThreadPool]: SQL status: BEGIN in 0.136 seconds
[0m23:31:35.639402 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:31:35.640333 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:31:35.641853 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:31:35.643290 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:31:35.646534 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m23:31:35.648860 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:31:35.649811 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.019 seconds
[0m23:31:35.653400 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:31:35.654395 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:31:35.655460 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:31:35.657372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dw)
[0m23:31:35.664038 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:31:35.665293 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:31:35.666279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_snapshots)
[0m23:31:35.667059 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m23:31:35.670354 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:31:35.672873 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:31:35.679772 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:31:35.682982 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:31:35.683938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:35.685042 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:31:35.685978 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:31:35.687092 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:31:35.687840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:35.689540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:31:35.691132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:31:35.696813 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:31:35.702079 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:31:35.703123 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:31:35.703977 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:31:35.705249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:35.706273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:35.839460 [debug] [ThreadPool]: SQL status: BEGIN in 0.152 seconds
[0m23:31:35.840698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:31:35.842036 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:31:35.850490 [debug] [ThreadPool]: SQL status: BEGIN in 0.166 seconds
[0m23:31:35.851508 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:31:35.852486 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:31:35.862987 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m23:31:35.864266 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:31:35.865377 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:31:35.867712 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m23:31:35.868806 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.025 seconds
[0m23:31:35.870033 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:31:35.873774 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:31:35.875192 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:31:35.876672 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.023 seconds
[0m23:31:35.878058 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:31:35.881952 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:31:35.884147 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:31:35.897285 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.031 seconds
[0m23:31:35.900174 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:31:35.901001 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m23:31:35.903577 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:31:35.904442 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:31:35.905493 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:31:35.928085 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:35.929040 [debug] [MainThread]: On master: BEGIN
[0m23:31:35.929843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:36.037207 [debug] [MainThread]: SQL status: BEGIN in 0.107 seconds
[0m23:31:36.038226 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:36.039413 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:31:36.067479 [debug] [MainThread]: SQL status: SELECT 18 in 0.026 seconds
[0m23:31:36.070230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AF025980>]}
[0m23:31:36.071415 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:36.072300 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:36.072806 [debug] [MainThread]: On master: BEGIN
[0m23:31:36.074750 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:31:36.076278 [debug] [MainThread]: On master: COMMIT
[0m23:31:36.077506 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:36.078159 [debug] [MainThread]: On master: COMMIT
[0m23:31:36.078983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:31:36.079542 [debug] [MainThread]: On master: Close
[0m23:31:36.096870 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:31:36.097902 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:31:36.098693 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_people
[0m23:31:36.100042 [info ] [Thread-1 (]: 1 of 3 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m23:31:36.101756 [info ] [Thread-3 (]: 3 of 3 START sql view model dw_stg.stg_metabase_reviews ........................ [RUN]
[0m23:31:36.103230 [info ] [Thread-2 (]: 2 of 3 START sql view model dw_stg.stg_metabase_people ......................... [RUN]
[0m23:31:36.104866 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m23:31:36.106130 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_reviews'
[0m23:31:36.107667 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_people'
[0m23:31:36.109354 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m23:31:36.110711 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:31:36.111813 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_people
[0m23:31:36.165704 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.171799 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.206143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.209879 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_people
[0m23:31:36.304161 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:31:36.376669 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.378631 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m23:31:36.385509 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.399440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.401922 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.403496 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: BEGIN
[0m23:31:36.404799 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.406308 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:31:36.409745 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: BEGIN
[0m23:31:36.411342 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.413224 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:31:36.414636 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m23:31:36.417276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:31:36.621660 [debug] [Thread-3 (]: SQL status: BEGIN in 0.208 seconds
[0m23:31:36.622871 [debug] [Thread-2 (]: SQL status: BEGIN in 0.217 seconds
[0m23:31:36.623986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.207 seconds
[0m23:31:36.625280 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.626719 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.628204 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.629577 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp"
    
    
  as (
    

-- Reviews p√∫blicos dos produtos Metabase Sample.
select
    'METABASE'                               as source_system,
    r.id                                     as source_review_id,
    'METABASE_RV_' || r.id                   as review_nk,
    case
        when prod.id is not null then 'METABASE_' || prod.id::varchar
        else 'METABASE_' || upper(trim(r.product_id))
    end                                      as product_nk,
    r.product_id                             as source_product_id,
    r.reviewer                               as reviewer_name,
    cast(r.rating as numeric(5,2))           as rating_score,
    case
        when r.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then r.created_at::timestamp
        else null
    end                                      as created_at,
    r.body                                   as review_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."reviews" r
left join "dw_northwind_metabase"."public"."products" prod
       on lower(prod.title) = lower(r.product_id)
  );
[0m23:31:36.631132 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp"
    
    
  as (
    

-- Registros da tabela people (usados pelos pedidos B2C que n√£o mapeiam para accounts).
select
    'METABASE'                               as source_system,
    p.id                                     as source_customer_id,
    'METABASE_' || upper(trim(p.name))       as customer_nk,
    p.name                                   as customer_name,
    null::varchar                            as contact_name,
    null::varchar                            as contact_title,
    split_part(p.name, ' ', 1)               as first_name,
    nullif(split_part(p.name, ' ', 2), '')   as last_name,
    p.address                                as address,
    p.city                                   as city,
    p.state                                  as region,
    null::varchar                            as country,
    p.zip::varchar                           as postal_code,
    null::varchar                            as plan,
    p.source                                 as segment,
    null::int                                as seats,
    null::boolean                            as trial_converted,
    null::boolean                            as active_subscription,
    null::boolean                            as legacy_plan,
    null::timestamp                          as created_at,
    null::timestamp                          as trial_ends_at,
    null::timestamp                          as canceled_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."people" p
  );
[0m23:31:36.632453 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else 'METABASE_' || upper(trim(o.user_id))
    end                                       as customer_nk,
    case
        when prod.id is not null then 'METABASE_' || prod.id::varchar
        else 'METABASE_' || upper(trim(o.product_id))
    end                                       as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(concat_ws(' ', acc.first_name, acc.last_name)) = lower(o.user_id)
left join "dw_northwind_metabase"."public"."products" prod
       on lower(prod.title) = lower(o.product_id)
  );
[0m23:31:36.668194 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m23:31:36.677119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m23:31:36.688776 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.689894 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.056 seconds
[0m23:31:36.698373 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.699646 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp" rename to "stg_metabase_people"
[0m23:31:36.707312 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.709624 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m23:31:36.711783 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews" rename to "stg_metabase_reviews__dbt_backup"
[0m23:31:36.720917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:31:36.721767 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m23:31:36.722727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m23:31:36.732836 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.772918 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.777798 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m23:31:36.779308 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp" rename to "stg_metabase_reviews"
[0m23:31:36.780312 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m23:31:36.781077 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.782240 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m23:31:36.783495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:31:36.784578 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:31:36.794697 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:31:36.796032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:31:36.800387 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:31:36.801754 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.818566 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup"
[0m23:31:36.819472 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.820543 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:31:36.836294 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:31:36.837105 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:31:36.838014 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup" cascade
[0m23:31:36.841519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:31:36.842975 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:31:36.849644 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m23:31:36.850814 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m23:31:36.858537 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: Close
[0m23:31:36.861994 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:31:36.868732 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup"
[0m23:31:36.870279 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m23:31:36.876828 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:31:36.878705 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup" cascade
[0m23:31:36.883629 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:31:36.884785 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:31:36.888415 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_reviews: Close
[0m23:31:36.892605 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m23:31:36.895783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ADCBFDD0>]}
[0m23:31:36.896901 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ADD5AFC0>]}
[0m23:31:36.897885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075a3e35-a0da-4d8e-9893-c59a91b1cae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ADD5AAF0>]}
[0m23:31:36.900335 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dw_stg.stg_metabase_people .................... [[32mCREATE VIEW[0m in 0.76s]
[0m23:31:36.902242 [info ] [Thread-3 (]: 3 of 3 OK created sql view model dw_stg.stg_metabase_reviews ................... [[32mCREATE VIEW[0m in 0.79s]
[0m23:31:36.905751 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.79s]
[0m23:31:36.909205 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_people
[0m23:31:36.911339 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:31:36.913399 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:31:36.917038 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:36.917698 [debug] [MainThread]: On master: BEGIN
[0m23:31:36.918272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:37.026504 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m23:31:37.027539 [debug] [MainThread]: On master: COMMIT
[0m23:31:37.028344 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:37.029250 [debug] [MainThread]: On master: COMMIT
[0m23:31:37.030616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:31:37.031538 [debug] [MainThread]: On master: Close
[0m23:31:37.032800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:37.034717 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:31:37.035803 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:31:37.036715 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:31:37.037627 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:31:37.038532 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:31:37.039280 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m23:31:37.039991 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_reviews' was properly closed.
[0m23:31:37.040939 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_people' was properly closed.
[0m23:31:37.042014 [info ] [MainThread]: 
[0m23:31:37.043395 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m23:31:37.047314 [debug] [MainThread]: Command end result
[0m23:31:37.184241 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:31:37.195921 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:31:37.229745 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:31:37.230933 [info ] [MainThread]: 
[0m23:31:37.232605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:37.233692 [info ] [MainThread]: 
[0m23:31:37.235290 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:31:37.238887 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:37.238505 after 10.07 seconds
[0m23:31:37.239921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AD474250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0ADC2ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0AD2BF310>]}
[0m23:31:37.241461 [debug] [MainThread]: Flushing usage events
[0m23:31:39.101413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:58.511569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D99DB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9B658B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9BC98E10>]}


============================== 23:31:58.529278 | 27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9 ==============================
[0m23:31:58.529278 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:31:58.531900 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select int_customers', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m23:31:59.057696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D99FE9F30>]}
[0m23:31:59.231018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9BD1FDF0>]}
[0m23:31:59.234991 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:32:00.063168 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:32:00.922708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:00.923691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:01.065511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9C01F350>]}
[0m23:32:01.308783 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:32:01.315252 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:32:01.621190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D967B8F50>]}
[0m23:32:01.623408 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:32:01.624430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9BEDD9B0>]}
[0m23:32:01.632085 [info ] [MainThread]: 
[0m23:32:01.633815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:01.635993 [info ] [MainThread]: 
[0m23:32:01.637729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:01.640460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:32:02.104988 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:32:02.106450 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:32:02.107855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:02.251974 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.144 seconds
[0m23:32:02.256090 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:32:02.273733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:32:02.289313 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:32:02.290621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:32:02.291636 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:32:02.297305 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:32:02.298949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:32:02.300334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:02.302536 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:32:02.304324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:32:02.310110 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:32:02.312177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:02.317970 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:32:02.319647 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:32:02.321913 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:32:02.323362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:02.324433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:02.483507 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m23:32:02.484724 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:32:02.486212 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:32:02.495753 [debug] [ThreadPool]: SQL status: BEGIN in 0.196 seconds
[0m23:32:02.496806 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:32:02.497988 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:32:02.502357 [debug] [ThreadPool]: SQL status: BEGIN in 0.190 seconds
[0m23:32:02.503566 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:32:02.504797 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:32:02.510034 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m23:32:02.513958 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:32:02.515505 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:32:02.517722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:32:02.524767 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:32:02.525934 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:32:02.526872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:02.529619 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.030 seconds
[0m23:32:02.530690 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m23:32:02.535098 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:32:02.539263 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:32:02.541017 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:32:02.542089 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:32:02.543791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:32:02.545422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:32:02.550901 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:32:02.564022 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:32:02.565141 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:32:02.567478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:02.566212 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:32:02.570111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:02.641932 [debug] [ThreadPool]: SQL status: BEGIN in 0.317 seconds
[0m23:32:02.642945 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:32:02.644033 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:32:02.669322 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.024 seconds
[0m23:32:02.672673 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:32:02.674114 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:32:02.675973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dw)
[0m23:32:02.681346 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:32:02.682416 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:32:02.683397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:02.809690 [debug] [ThreadPool]: SQL status: BEGIN in 0.283 seconds
[0m23:32:02.810783 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:32:02.811984 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:32:02.839747 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m23:32:02.844342 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:32:02.846432 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:32:02.879380 [debug] [ThreadPool]: SQL status: BEGIN in 0.312 seconds
[0m23:32:02.880733 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:32:02.881804 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:32:02.910096 [debug] [ThreadPool]: SQL status: BEGIN in 0.340 seconds
[0m23:32:02.911402 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:32:02.913801 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:32:02.917731 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m23:32:02.921692 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:32:02.924365 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:32:02.945054 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.028 seconds
[0m23:32:02.951471 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:32:02.952999 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:32:02.982540 [debug] [ThreadPool]: SQL status: BEGIN in 0.299 seconds
[0m23:32:02.984576 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:32:02.985784 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:32:03.019407 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.032 seconds
[0m23:32:03.024035 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:32:03.025536 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:32:03.076613 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:03.077633 [debug] [MainThread]: On master: BEGIN
[0m23:32:03.078651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:03.322315 [debug] [MainThread]: SQL status: BEGIN in 0.244 seconds
[0m23:32:03.323580 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:03.324715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:32:03.360060 [debug] [MainThread]: SQL status: SELECT 21 in 0.034 seconds
[0m23:32:03.365424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9C6AD640>]}
[0m23:32:03.366741 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:03.368560 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:03.369611 [debug] [MainThread]: On master: BEGIN
[0m23:32:03.371151 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:03.372211 [debug] [MainThread]: On master: COMMIT
[0m23:32:03.373158 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:03.374145 [debug] [MainThread]: On master: COMMIT
[0m23:32:03.375706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:03.376808 [debug] [MainThread]: On master: Close
[0m23:32:03.393446 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m23:32:03.397403 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m23:32:03.400930 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m23:32:03.404526 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m23:32:03.456380 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m23:32:03.466426 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m23:32:03.602715 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m23:32:03.606904 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m23:32:03.608305 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m23:32:03.609370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:03.754257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m23:32:03.758176 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m23:32:03.759972 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
    dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
),
metabase_people as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        first_name,
        last_name,
        address,
        city,
        region,
        country,
        postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
)
select * from northwind
union all
select * from metabase
union all
select * from metabase_people
  );
[0m23:32:03.847019 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.085 seconds
[0m23:32:03.865451 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m23:32:03.866598 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m23:32:03.870706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:32:03.927520 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m23:32:03.928874 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m23:32:03.929967 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m23:32:03.939989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:32:03.978799 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m23:32:04.024770 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m23:32:04.026456 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m23:32:04.029937 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:32:04.038136 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m23:32:04.043821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cc1d2d-e45d-4e76-bbb1-ef3f064f6bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9C8D01D0>]}
[0m23:32:04.045853 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.64s]
[0m23:32:04.048091 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m23:32:04.054267 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:04.055620 [debug] [MainThread]: On master: BEGIN
[0m23:32:04.057055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:04.213155 [debug] [MainThread]: SQL status: BEGIN in 0.156 seconds
[0m23:32:04.214323 [debug] [MainThread]: On master: COMMIT
[0m23:32:04.215307 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:04.216171 [debug] [MainThread]: On master: COMMIT
[0m23:32:04.217648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:04.219630 [debug] [MainThread]: On master: Close
[0m23:32:04.221382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:04.222473 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:32:04.223534 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:32:04.224453 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:32:04.225335 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:32:04.226623 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:32:04.227575 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m23:32:04.228562 [info ] [MainThread]: 
[0m23:32:04.229578 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m23:32:04.231940 [debug] [MainThread]: Command end result
[0m23:32:04.399269 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:32:04.411920 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:32:04.441322 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:32:04.442444 [info ] [MainThread]: 
[0m23:32:04.445626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:04.447206 [info ] [MainThread]: 
[0m23:32:04.448514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:04.452046 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:04.451532 after 6.30 seconds
[0m23:32:04.453867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9C43BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9C365770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9C364D70>]}
[0m23:32:04.455731 [debug] [MainThread]: Flushing usage events
[0m23:32:06.106669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:23.874019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF82CB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF84558B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF84B98E10>]}


============================== 23:32:23.884270 | 992e8979-d5e7-498b-92b7-aea03bfbd8ee ==============================
[0m23:32:23.884270 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:32:23.885837 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'printer_width': '80', 'target_path': 'None'}
[0m23:32:24.411157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF82EE9F30>]}
[0m23:32:24.600340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF84C1FDF0>]}
[0m23:32:24.603345 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:32:25.631685 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:32:26.282204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:26.284369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:26.473750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF84F1B350>]}
[0m23:32:26.848934 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:32:26.860080 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:32:27.155638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7F698F50>]}
[0m23:32:27.157159 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:32:27.158287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF84DD99B0>]}
[0m23:32:27.164489 [info ] [MainThread]: 
[0m23:32:27.165298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:27.165994 [info ] [MainThread]: 
[0m23:32:27.167994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:27.170764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:32:27.612603 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:32:27.614356 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:32:27.615655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:27.764759 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.149 seconds
[0m23:32:27.769248 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:32:27.787675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:32:27.796156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:32:27.807016 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:32:27.816716 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:32:27.817731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:32:27.819000 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:32:27.820308 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:32:27.821400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:32:27.825491 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:32:27.827108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:27.830275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:27.836028 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:32:27.836815 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:32:27.838279 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:32:27.839237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:27.840329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:28.100395 [debug] [ThreadPool]: SQL status: BEGIN in 0.271 seconds
[0m23:32:28.101436 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:32:28.102944 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:32:28.116514 [debug] [ThreadPool]: SQL status: BEGIN in 0.290 seconds
[0m23:32:28.117502 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:32:28.119054 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:32:28.127435 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m23:32:28.132114 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:32:28.133585 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:32:28.135877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dw)
[0m23:32:28.141556 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:32:28.142658 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m23:32:28.147254 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:32:28.151234 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:32:28.153255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:28.155072 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:32:28.157026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:32:28.166783 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:32:28.167790 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:32:28.169162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:28.184996 [debug] [ThreadPool]: SQL status: BEGIN in 0.345 seconds
[0m23:32:28.186653 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:32:28.187815 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:32:28.207956 [debug] [ThreadPool]: SQL status: BEGIN in 0.369 seconds
[0m23:32:28.208942 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:32:28.210066 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:32:28.221083 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m23:32:28.224495 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:32:28.225937 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:32:28.228299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_snapshots)
[0m23:32:28.234935 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:32:28.236441 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m23:32:28.237316 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:32:28.240483 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:32:28.241776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:28.243117 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:32:28.245474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_stg)
[0m23:32:28.251002 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:32:28.252105 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:32:28.253266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:28.389881 [debug] [ThreadPool]: SQL status: BEGIN in 0.237 seconds
[0m23:32:28.391110 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:32:28.392344 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:32:28.419616 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.026 seconds
[0m23:32:28.423449 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:32:28.424787 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:32:28.483702 [debug] [ThreadPool]: SQL status: BEGIN in 0.230 seconds
[0m23:32:28.484687 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:32:28.485927 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:32:28.488339 [debug] [ThreadPool]: SQL status: BEGIN in 0.247 seconds
[0m23:32:28.489328 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:32:28.490308 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:32:28.509225 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.022 seconds
[0m23:32:28.510334 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m23:32:28.515199 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:32:28.518691 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:32:28.520620 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:32:28.521519 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:32:28.554604 [debug] [ThreadPool]: SQL status: BEGIN in 0.386 seconds
[0m23:32:28.555656 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:32:28.556655 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:32:28.583869 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m23:32:28.587670 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:32:28.589000 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:32:28.608391 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:28.609369 [debug] [MainThread]: On master: BEGIN
[0m23:32:28.626316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:28.766126 [debug] [MainThread]: SQL status: BEGIN in 0.140 seconds
[0m23:32:28.767129 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:28.768152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:32:28.793023 [debug] [MainThread]: SQL status: SELECT 24 in 0.023 seconds
[0m23:32:28.799674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF855A98B0>]}
[0m23:32:28.800849 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:28.802160 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:28.803223 [debug] [MainThread]: On master: BEGIN
[0m23:32:28.804423 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:28.804983 [debug] [MainThread]: On master: COMMIT
[0m23:32:28.805718 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:28.806429 [debug] [MainThread]: On master: COMMIT
[0m23:32:28.807418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:28.808150 [debug] [MainThread]: On master: Close
[0m23:32:28.823272 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m23:32:28.824748 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m23:32:28.826134 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m23:32:28.830438 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m23:32:28.857125 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m23:32:29.072745 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:29.074802 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select customer_name, city, country, plan, segment, trial_converted, active_subscription, legacy_plan from (
                



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:32:29.078419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:29.340821 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.264 seconds
[0m23:32:29.381444 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:29.382814 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m23:32:29.384974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:32:29.386071 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:29.387431 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:32:29.482428 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.094 seconds
[0m23:32:29.504688 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:29.505680 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:32:29.514585 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.008 seconds
[0m23:32:29.642480 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:29.645815 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp233229619724"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m23:32:30.085992 [debug] [Thread-1 (]: SQL status: SELECT 2500 in 0.438 seconds
[0m23:32:30.092193 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.093279 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp233229619724'
        
      order by ordinal_position

  
[0m23:32:30.103520 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.009 seconds
[0m23:32:30.112484 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.113713 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:32:30.124051 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.009 seconds
[0m23:32:30.134702 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.135916 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp233229619724'
        
      order by ordinal_position

  
[0m23:32:30.147156 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.009 seconds
[0m23:32:30.159324 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.160598 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m23:32:30.170899 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.009 seconds
[0m23:32:30.194297 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.197400 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp233229619724'
        
      order by ordinal_position

  
[0m23:32:30.208121 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.009 seconds
[0m23:32:30.291589 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.296518 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m23:32:30.303841 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:32:30.318913 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.320257 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:32:30.322031 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:32:30.323445 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.328666 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.332207 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      update "dw_northwind_metabase"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp233229619724" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_valid_to is null;
      


    insert into "dw_northwind_metabase"."snapshots"."customers_snapshot" ("customer_nk", "source_system", "source_customer_id", "customer_name", "contact_name", "contact_title", "first_name", "last_name", "address", "city", "region", "country", "postal_code", "plan", "segment", "seats", "trial_converted", "active_subscription", "legacy_plan", "created_at", "trial_ends_at", "canceled_at", "dw_load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_nk",DBT_INTERNAL_SOURCE."source_system",DBT_INTERNAL_SOURCE."source_customer_id",DBT_INTERNAL_SOURCE."customer_name",DBT_INTERNAL_SOURCE."contact_name",DBT_INTERNAL_SOURCE."contact_title",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."region",DBT_INTERNAL_SOURCE."country",DBT_INTERNAL_SOURCE."postal_code",DBT_INTERNAL_SOURCE."plan",DBT_INTERNAL_SOURCE."segment",DBT_INTERNAL_SOURCE."seats",DBT_INTERNAL_SOURCE."trial_converted",DBT_INTERNAL_SOURCE."active_subscription",DBT_INTERNAL_SOURCE."legacy_plan",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."trial_ends_at",DBT_INTERNAL_SOURCE."canceled_at",DBT_INTERNAL_SOURCE."dw_load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp233229619724" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:32:30.370379 [debug] [Thread-1 (]: SQL status: INSERT 0 2500 in 0.034 seconds
[0m23:32:30.440206 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m23:32:30.441702 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m23:32:30.442554 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m23:32:30.453136 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m23:32:30.465944 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m23:32:30.472077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '992e8979-d5e7-498b-92b7-aea03bfbd8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF857F0950>]}
[0m23:32:30.474368 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mINSERT 0 2500[0m in 1.64s]
[0m23:32:30.476583 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m23:32:30.484369 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:30.485804 [debug] [MainThread]: On master: BEGIN
[0m23:32:30.486740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:30.687610 [debug] [MainThread]: SQL status: BEGIN in 0.201 seconds
[0m23:32:30.688871 [debug] [MainThread]: On master: COMMIT
[0m23:32:30.690059 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:30.691108 [debug] [MainThread]: On master: COMMIT
[0m23:32:30.692448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:30.693475 [debug] [MainThread]: On master: Close
[0m23:32:30.699015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:30.700069 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:32:30.701100 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:32:30.701895 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:32:30.702677 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:32:30.703417 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:32:30.704165 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m23:32:30.705370 [info ] [MainThread]: 
[0m23:32:30.706810 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m23:32:30.710070 [debug] [MainThread]: Command end result
[0m23:32:30.932181 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:32:30.945028 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:32:30.969754 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:32:30.972981 [info ] [MainThread]: 
[0m23:32:30.974578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:30.979257 [info ] [MainThread]: 
[0m23:32:30.980887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:30.984970 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:32:30.984580 after 7.41 seconds
[0m23:32:30.986050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8567FAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8586D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8586D950>]}
[0m23:32:30.987262 [debug] [MainThread]: Flushing usage events
[0m23:32:32.461237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:49.499572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096CAB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096E358B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096E998E10>]}


============================== 23:32:49.514477 | 12b91e8c-553b-447c-86ae-d06723f2d6a7 ==============================
[0m23:32:49.514477 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:32:49.516898 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select dim_customer', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m23:32:50.454141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096CCE9F30>]}
[0m23:32:51.113586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096EA1FDF0>]}
[0m23:32:51.129684 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:32:53.892510 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:32:54.543925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:54.546651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:54.746627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096ED1F350>]}
[0m23:32:55.085450 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:32:55.097098 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:32:55.409273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209694D8F50>]}
[0m23:32:55.410755 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:32:55.412005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096EBD99B0>]}
[0m23:32:55.425043 [info ] [MainThread]: 
[0m23:32:55.426966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:55.428087 [info ] [MainThread]: 
[0m23:32:55.430677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:55.434189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:32:55.842556 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:32:55.843745 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:32:55.844835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.120943 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.276 seconds
[0m23:32:56.125792 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:32:56.148182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:32:56.166231 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:32:56.167533 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:32:56.168945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:32:56.169791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.183484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:32:56.186731 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:32:56.197187 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:32:56.198373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:32:56.199339 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:32:56.200606 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:32:56.205497 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:32:56.209304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.210955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.212368 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:32:56.216335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.375122 [debug] [ThreadPool]: SQL status: BEGIN in 0.205 seconds
[0m23:32:56.378345 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:32:56.380522 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:32:56.412850 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.031 seconds
[0m23:32:56.416485 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:32:56.417962 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:32:56.419700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dw)
[0m23:32:56.428183 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:32:56.429421 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:32:56.430415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:56.446827 [debug] [ThreadPool]: SQL status: BEGIN in 0.237 seconds
[0m23:32:56.447924 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:32:56.448994 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:32:56.477237 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.027 seconds
[0m23:32:56.481334 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:32:56.482777 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:32:56.483959 [debug] [ThreadPool]: SQL status: BEGIN in 0.268 seconds
[0m23:32:56.485251 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:32:56.486380 [debug] [ThreadPool]: SQL status: BEGIN in 0.275 seconds
[0m23:32:56.487459 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:32:56.490253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:32:56.499631 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:32:56.506476 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:32:56.504879 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:32:56.512421 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:32:56.513482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:56.531277 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.023 seconds
[0m23:32:56.532393 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m23:32:56.535905 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:32:56.539373 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:32:56.541806 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:32:56.542856 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:32:56.545186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:32:56.550851 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:32:56.553080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:32:56.553961 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:32:56.564714 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:32:56.565837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:56.566857 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:32:56.568037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:56.652152 [debug] [ThreadPool]: SQL status: BEGIN in 0.222 seconds
[0m23:32:56.653164 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:32:56.654607 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:32:56.681448 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.025 seconds
[0m23:32:56.685073 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:32:56.686387 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:32:56.718961 [debug] [ThreadPool]: SQL status: BEGIN in 0.205 seconds
[0m23:32:56.719998 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:32:56.723029 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:32:56.760062 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.036 seconds
[0m23:32:56.763960 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:32:56.765569 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:32:56.814702 [debug] [ThreadPool]: SQL status: BEGIN in 0.249 seconds
[0m23:32:56.815765 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:32:56.816980 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:32:56.831554 [debug] [ThreadPool]: SQL status: BEGIN in 0.263 seconds
[0m23:32:56.832682 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:32:56.833862 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:32:56.841799 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m23:32:56.845526 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:32:56.846950 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:32:56.853979 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:32:56.858520 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:32:56.860288 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:32:56.880656 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.881731 [debug] [MainThread]: On master: BEGIN
[0m23:32:56.882571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:57.086581 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m23:32:57.089056 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:57.090595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:32:57.138435 [debug] [MainThread]: SQL status: SELECT 24 in 0.045 seconds
[0m23:32:57.145556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096F3BD4A0>]}
[0m23:32:57.147031 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:57.148577 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:57.149978 [debug] [MainThread]: On master: BEGIN
[0m23:32:57.151652 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:57.152630 [debug] [MainThread]: On master: COMMIT
[0m23:32:57.153802 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:57.155596 [debug] [MainThread]: On master: COMMIT
[0m23:32:57.158198 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:32:57.161993 [debug] [MainThread]: On master: Close
[0m23:32:57.228488 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m23:32:57.235711 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m23:32:57.241528 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m23:32:57.243523 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m23:32:57.350336 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m23:32:57.356151 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m23:32:57.630265 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m23:32:57.637259 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m23:32:57.641897 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m23:32:57.652053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:57.892479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m23:32:57.894561 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m23:32:57.896382 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m23:32:58.043362 [debug] [Thread-1 (]: SQL status: SELECT 5086 in 0.145 seconds
[0m23:32:58.072741 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m23:32:58.074086 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m23:32:58.077215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:58.091558 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m23:32:58.093917 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:32:58.099190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:58.175179 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m23:32:58.176962 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m23:32:58.179236 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m23:32:58.182946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:32:58.203592 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m23:32:58.226286 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m23:32:58.229753 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m23:32:58.244783 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m23:32:58.252229 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m23:32:58.263922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b91e8c-553b-447c-86ae-d06723f2d6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096F678350>]}
[0m23:32:58.266108 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 5086[0m in 1.01s]
[0m23:32:58.269617 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m23:32:58.280093 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:58.281114 [debug] [MainThread]: On master: BEGIN
[0m23:32:58.281996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:58.417598 [debug] [MainThread]: SQL status: BEGIN in 0.136 seconds
[0m23:32:58.418691 [debug] [MainThread]: On master: COMMIT
[0m23:32:58.419503 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:58.420330 [debug] [MainThread]: On master: COMMIT
[0m23:32:58.421968 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:32:58.423526 [debug] [MainThread]: On master: Close
[0m23:32:58.425497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:58.426521 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:32:58.427322 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:32:58.428070 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:32:58.428808 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:32:58.429491 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:32:58.430214 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m23:32:58.430982 [info ] [MainThread]: 
[0m23:32:58.431933 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m23:32:58.434422 [debug] [MainThread]: Command end result
[0m23:32:58.568005 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:32:58.577740 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:32:58.597626 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:32:58.600180 [info ] [MainThread]: 
[0m23:32:58.602642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:58.603739 [info ] [MainThread]: 
[0m23:32:58.607132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:58.611022 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:58.610488 after 9.44 seconds
[0m23:32:58.612824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096F13BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020969801770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096F283D90>]}
[0m23:32:58.614300 [debug] [MainThread]: Flushing usage events
[0m23:33:00.245999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:19.881931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA51B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA5A54B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA7098E10>]}


============================== 23:33:19.894381 | 90c372e8-c09e-46a2-a3fe-547b81aefa30 ==============================
[0m23:33:19.894381 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:33:19.896941 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt run --select fact_sales', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m23:33:20.807224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA53E9F30>]}
[0m23:33:21.163374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA711FDF0>]}
[0m23:33:21.170192 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:33:22.448118 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:33:23.708104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:23.708840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:23.910635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA741F350>]}
[0m23:33:24.266249 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:33:24.277106 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:33:24.510437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA1BC8F50>]}
[0m23:33:24.511901 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:33:24.513015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA72DD9B0>]}
[0m23:33:24.523331 [info ] [MainThread]: 
[0m23:33:24.524349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:24.526347 [info ] [MainThread]: 
[0m23:33:24.529091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:24.536045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:33:24.858205 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:33:24.859568 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:33:24.860390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:24.989176 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.129 seconds
[0m23:33:24.993883 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:33:25.014893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:33:25.037621 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:33:25.039030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:33:25.040484 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:33:25.042049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:33:25.051290 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:33:25.052547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:25.054095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:33:25.059812 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:33:25.061505 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:33:25.067218 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:33:25.068681 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:33:25.071262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:25.072548 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:33:25.073736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:25.075560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:25.237272 [debug] [ThreadPool]: SQL status: BEGIN in 0.163 seconds
[0m23:33:25.238409 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:33:25.239444 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:33:25.259683 [debug] [ThreadPool]: SQL status: BEGIN in 0.184 seconds
[0m23:33:25.261116 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:33:25.262144 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.021 seconds
[0m23:33:25.263252 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:33:25.267865 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:33:25.269998 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:33:25.272175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_stg)
[0m23:33:25.278410 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:33:25.279621 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:33:25.280564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:25.288598 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.019 seconds
[0m23:33:25.293150 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:33:25.295440 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:33:25.296555 [debug] [ThreadPool]: SQL status: BEGIN in 0.244 seconds
[0m23:33:25.297695 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:33:25.299876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:33:25.301026 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:33:25.313271 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:33:25.314667 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:33:25.315848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:25.346242 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.032 seconds
[0m23:33:25.349942 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:33:25.351521 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:33:25.353979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:33:25.360950 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:33:25.362599 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:33:25.363891 [debug] [ThreadPool]: SQL status: BEGIN in 0.293 seconds
[0m23:33:25.365212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:25.366512 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:33:25.368050 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:33:25.388879 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:33:25.392003 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:33:25.394410 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:33:25.396342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:33:25.405155 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:33:25.406322 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:33:25.407146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:25.489091 [debug] [ThreadPool]: SQL status: BEGIN in 0.208 seconds
[0m23:33:25.490337 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:33:25.491503 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:33:25.520118 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.027 seconds
[0m23:33:25.524218 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:33:25.526528 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:33:25.528141 [debug] [ThreadPool]: SQL status: BEGIN in 0.163 seconds
[0m23:33:25.529424 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:33:25.531051 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:33:25.551677 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:33:25.555400 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:33:25.556823 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:33:25.573790 [debug] [ThreadPool]: SQL status: BEGIN in 0.258 seconds
[0m23:33:25.574875 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:33:25.576182 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:33:25.596005 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:33:25.599585 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:33:25.601640 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:33:25.610304 [debug] [ThreadPool]: SQL status: BEGIN in 0.203 seconds
[0m23:33:25.612081 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:33:25.613381 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:33:25.634276 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:33:25.637639 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:33:25.639300 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:33:25.658397 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:25.660178 [debug] [MainThread]: On master: BEGIN
[0m23:33:25.661389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:25.874693 [debug] [MainThread]: SQL status: BEGIN in 0.213 seconds
[0m23:33:25.875637 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:25.877354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:33:25.902990 [debug] [MainThread]: SQL status: SELECT 24 in 0.024 seconds
[0m23:33:25.908639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA7AA9D90>]}
[0m23:33:25.910375 [debug] [MainThread]: On master: ROLLBACK
[0m23:33:25.911631 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:25.912286 [debug] [MainThread]: On master: BEGIN
[0m23:33:25.913434 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:33:25.914384 [debug] [MainThread]: On master: COMMIT
[0m23:33:25.915435 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:25.916520 [debug] [MainThread]: On master: COMMIT
[0m23:33:25.918255 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:33:25.919490 [debug] [MainThread]: On master: Close
[0m23:33:25.933471 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m23:33:25.936694 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m23:33:25.939483 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m23:33:25.942289 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m23:33:25.971719 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m23:33:25.979966 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m23:33:26.095608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m23:33:26.100676 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:33:26.104360 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m23:33:26.105851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:33:26.228273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.123 seconds
[0m23:33:26.229602 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:33:26.231018 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m23:33:27.353165 [debug] [Thread-1 (]: SQL status: SELECT 21098 in 1.120 seconds
[0m23:33:27.375534 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:33:27.376713 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m23:33:27.380687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:33:27.391260 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:33:27.392543 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:33:27.396206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:33:27.456078 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:33:27.458233 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:33:27.459461 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:33:27.467668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:33:27.492446 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m23:33:27.530713 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:33:27.536706 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m23:33:27.561856 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m23:33:27.571977 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m23:33:27.587106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c372e8-c09e-46a2-a3fe-547b81aefa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA7CE4350>]}
[0m23:33:27.590283 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 21098[0m in 1.64s]
[0m23:33:27.592763 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m23:33:27.608798 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:27.610258 [debug] [MainThread]: On master: BEGIN
[0m23:33:27.611918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:27.905843 [debug] [MainThread]: SQL status: BEGIN in 0.294 seconds
[0m23:33:27.906950 [debug] [MainThread]: On master: COMMIT
[0m23:33:27.908011 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:27.909385 [debug] [MainThread]: On master: COMMIT
[0m23:33:27.911155 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:33:27.912264 [debug] [MainThread]: On master: Close
[0m23:33:27.913875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:27.914846 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:33:27.915844 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:33:27.917640 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:33:27.918866 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:33:27.919984 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:33:27.920971 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m23:33:27.922406 [info ] [MainThread]: 
[0m23:33:27.924463 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m23:33:27.928867 [debug] [MainThread]: Command end result
[0m23:33:28.125816 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:33:28.135067 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:33:28.157240 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:33:28.158595 [info ] [MainThread]: 
[0m23:33:28.162941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:28.165038 [info ] [MainThread]: 
[0m23:33:28.168052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:33:28.174163 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:28.173749 after 8.68 seconds
[0m23:33:28.175414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA7B7F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA1EF1770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA79898B0>]}
[0m23:33:28.176380 [debug] [MainThread]: Flushing usage events
[0m23:33:29.966841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:52.534967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D7CC0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D8568B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D8BA8E10>]}


============================== 23:33:52.548341 | a644e3d9-54ad-43ab-b2df-bba9bc9465d2 ==============================
[0m23:33:52.548341 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:33:52.550377 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_reviews', 'printer_width': '80', 'write_json': 'True'}
[0m23:33:53.521426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D7EF9F30>]}
[0m23:33:53.717731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D8C2FDF0>]}
[0m23:33:53.720957 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:33:54.766886 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:33:55.268449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:55.269337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:55.413634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242DA01F350>]}
[0m23:33:55.725897 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:33:55.734143 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:33:55.932479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D4708F50>]}
[0m23:33:55.934389 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:33:55.935435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D8E119B0>]}
[0m23:33:55.942921 [info ] [MainThread]: 
[0m23:33:55.944269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:55.945500 [info ] [MainThread]: 
[0m23:33:55.946960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:55.949227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:33:56.297135 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:33:56.297813 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:33:56.298536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:56.418663 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.120 seconds
[0m23:33:56.422024 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:33:56.440783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:33:56.458116 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:33:56.459242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:33:56.459877 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:33:56.470910 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:33:56.472073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:33:56.473015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:56.475096 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:33:56.476265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:33:56.482637 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:33:56.484455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:56.489167 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:33:56.490708 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:33:56.492331 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:33:56.493525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:56.495292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:56.621460 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m23:33:56.622497 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:33:56.623695 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:33:56.639795 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m23:33:56.641962 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:33:56.643438 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:33:56.647323 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m23:33:56.650940 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:33:56.652443 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:33:56.654522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_stg)
[0m23:33:56.666361 [debug] [ThreadPool]: SQL status: BEGIN in 0.173 seconds
[0m23:33:56.667535 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:33:56.669843 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:33:56.671005 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:33:56.672364 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:33:56.674257 [debug] [ThreadPool]: SQL status: BEGIN in 0.179 seconds
[0m23:33:56.675452 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.031 seconds
[0m23:33:56.676435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:56.679815 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:33:56.683337 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:33:56.684951 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:33:56.686402 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:33:56.688186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_snapshots)
[0m23:33:56.693242 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:33:56.694914 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:33:56.696314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:56.706546 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m23:33:56.711038 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:33:56.712302 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.037 seconds
[0m23:33:56.715818 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:33:56.716775 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:33:56.717926 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:33:56.719324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:33:56.726857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:33:56.732531 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:33:56.737499 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:33:56.738629 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:33:56.739644 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:33:56.741200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:56.742243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:56.851975 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m23:33:56.853035 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:33:56.854033 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:33:56.875655 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m23:33:56.880200 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:33:56.881738 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:33:56.882972 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m23:33:56.884196 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:33:56.886276 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:33:56.904192 [debug] [ThreadPool]: SQL status: BEGIN in 0.163 seconds
[0m23:33:56.905382 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:33:56.906526 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:33:56.908060 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:33:56.909061 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m23:33:56.912952 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:33:56.914611 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:33:56.916339 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:33:56.917389 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:33:56.939427 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.021 seconds
[0m23:33:56.944957 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:33:56.946141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m23:33:56.950357 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:33:56.951394 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:33:56.952765 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:33:56.978867 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:56.979971 [debug] [MainThread]: On master: BEGIN
[0m23:33:56.980863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:57.084220 [debug] [MainThread]: SQL status: BEGIN in 0.103 seconds
[0m23:33:57.085125 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:57.086216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:33:57.108065 [debug] [MainThread]: SQL status: SELECT 24 in 0.020 seconds
[0m23:33:57.116453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242DA6A9300>]}
[0m23:33:57.117826 [debug] [MainThread]: On master: ROLLBACK
[0m23:33:57.119766 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:57.121827 [debug] [MainThread]: On master: BEGIN
[0m23:33:57.129565 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:33:57.130852 [debug] [MainThread]: On master: COMMIT
[0m23:33:57.131861 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:57.132778 [debug] [MainThread]: On master: COMMIT
[0m23:33:57.134114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:33:57.135870 [debug] [MainThread]: On master: Close
[0m23:33:57.154729 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_reviews
[0m23:33:57.156285 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.fact_reviews ................................ [RUN]
[0m23:33:57.159038 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_reviews'
[0m23:33:57.160447 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_reviews
[0m23:33:57.203196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.212643 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_reviews
[0m23:33:57.429391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.439519 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.443393 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: BEGIN
[0m23:33:57.445561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:33:57.587530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m23:33:57.588622 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.589597 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de reviews p√∫blicos (produtos Metabase).
select
    review_nk,
    source_system,
    source_review_id,
    product_nk,
    source_product_id,
    reviewer_name,
    rating_score,
    created_at,
    review_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
  );
  
[0m23:33:57.844827 [debug] [Thread-1 (]: SQL status: SELECT 1127 in 0.254 seconds
[0m23:33:57.868139 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.869270 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews" rename to "fact_reviews__dbt_backup"
[0m23:33:57.871264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:33:57.880256 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.881472 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp" rename to "fact_reviews"
[0m23:33:57.883420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:33:57.932906 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:33:57.933757 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.934773 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:33:57.938282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:33:57.955124 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup"
[0m23:33:57.969366 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:33:57.970507 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup" cascade
[0m23:33:57.983657 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m23:33:57.990083 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: Close
[0m23:33:57.996297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a644e3d9-54ad-43ab-b2df-bba9bc9465d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242DA904290>]}
[0m23:33:57.998195 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.fact_reviews ........................... [[32mSELECT 1127[0m in 0.83s]
[0m23:33:58.000137 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_reviews
[0m23:33:58.007087 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:58.010061 [debug] [MainThread]: On master: BEGIN
[0m23:33:58.011837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:58.137703 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m23:33:58.138584 [debug] [MainThread]: On master: COMMIT
[0m23:33:58.139398 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:58.140196 [debug] [MainThread]: On master: COMMIT
[0m23:33:58.141387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:33:58.142899 [debug] [MainThread]: On master: Close
[0m23:33:58.144814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:58.145885 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:33:58.146439 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:33:58.146909 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:33:58.147545 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:33:58.148276 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:33:58.148833 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_reviews' was properly closed.
[0m23:33:58.149388 [info ] [MainThread]: 
[0m23:33:58.150011 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m23:33:58.152165 [debug] [MainThread]: Command end result
[0m23:33:58.306440 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:33:58.316426 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:33:58.336956 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:33:58.338097 [info ] [MainThread]: 
[0m23:33:58.339695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:58.341022 [info ] [MainThread]: 
[0m23:33:58.343080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:33:58.345933 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:58.345675 after 6.09 seconds
[0m23:33:58.346897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242DA43BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242D4A31770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242DA567F70>]}
[0m23:33:58.347851 [debug] [MainThread]: Flushing usage events
[0m23:34:00.137748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:34:45.937797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195310D0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019531978B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019533098E10>]}


============================== 23:34:45.956620 | 83ae125b-5f1f-4acd-a645-d926888f5d72 ==============================
[0m23:34:45.956620 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:34:45.958540 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'invocation_command': 'dbt test --select fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m23:34:47.295423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ae125b-5f1f-4acd-a645-d926888f5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019531309F30>]}
[0m23:34:47.535673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ae125b-5f1f-4acd-a645-d926888f5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019533127DF0>]}
[0m23:34:47.539768 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:34:49.319179 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:34:50.012813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:50.014646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:50.218913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ae125b-5f1f-4acd-a645-d926888f5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953341F350>]}
[0m23:34:50.745320 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:34:50.755187 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:34:51.186161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ae125b-5f1f-4acd-a645-d926888f5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195339226C0>]}
[0m23:34:51.187681 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:34:51.189967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ae125b-5f1f-4acd-a645-d926888f5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953326CD70>]}
[0m23:34:51.217581 [info ] [MainThread]: 
[0m23:34:51.220932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:51.222230 [info ] [MainThread]: 
[0m23:34:51.226067 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:51.250331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:34:51.287871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:34:51.296704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:34:51.306163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:34:51.858407 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:34:51.859848 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:34:51.860938 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:34:51.861922 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:34:51.863031 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:34:51.864487 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:34:51.866497 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:34:51.867696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:51.868903 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:34:51.869946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:51.871064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:51.872473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:52.115761 [debug] [ThreadPool]: SQL status: BEGIN in 0.246 seconds
[0m23:34:52.116866 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:34:52.117927 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:34:52.120584 [debug] [ThreadPool]: SQL status: BEGIN in 0.253 seconds
[0m23:34:52.121847 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:34:52.122912 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:34:52.126165 [debug] [ThreadPool]: SQL status: BEGIN in 0.254 seconds
[0m23:34:52.127300 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:34:52.128588 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:34:52.136930 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m23:34:52.140682 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:34:52.141857 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.018 seconds
[0m23:34:52.142790 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:34:52.146824 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:34:52.148149 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:34:52.150168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:34:52.155052 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:34:52.156307 [debug] [ThreadPool]: SQL status: BEGIN in 0.285 seconds
[0m23:34:52.157324 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:34:52.163015 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:34:52.164440 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:34:52.166437 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:34:52.168582 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:34:52.170184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:34:52.171473 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:34:52.180731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:52.188414 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:34:52.189925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:34:52.191695 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:34:52.199370 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:34:52.199989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:52.203201 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:34:52.204525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:52.211133 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m23:34:52.214998 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:34:52.216890 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:34:52.219517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:34:52.224182 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:34:52.230717 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:34:52.232298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:52.442418 [debug] [ThreadPool]: SQL status: BEGIN in 0.242 seconds
[0m23:34:52.443634 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:34:52.444793 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:34:52.470895 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.024 seconds
[0m23:34:52.475584 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:34:52.477044 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:34:52.483212 [debug] [ThreadPool]: SQL status: BEGIN in 0.302 seconds
[0m23:34:52.484420 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:34:52.485616 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:34:52.488391 [debug] [ThreadPool]: SQL status: BEGIN in 0.256 seconds
[0m23:34:52.489400 [debug] [ThreadPool]: SQL status: BEGIN in 0.285 seconds
[0m23:34:52.490271 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:34:52.491249 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:34:52.492622 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:34:52.493791 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:34:52.512447 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m23:34:52.515925 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:34:52.518047 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:34:52.529607 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m23:34:52.536535 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:34:52.539933 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:34:52.545155 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m23:34:52.553052 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:34:52.558354 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:34:52.587414 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:52.589182 [debug] [MainThread]: On master: BEGIN
[0m23:34:52.591363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:52.738398 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m23:34:52.739728 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:52.741114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:34:52.770141 [debug] [MainThread]: SQL status: SELECT 24 in 0.028 seconds
[0m23:34:52.778526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ae125b-5f1f-4acd-a645-d926888f5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195339A7110>]}
[0m23:34:52.779916 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:52.781369 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:52.787809 [debug] [MainThread]: On master: BEGIN
[0m23:34:52.789583 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:34:52.790711 [debug] [MainThread]: On master: COMMIT
[0m23:34:52.791652 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:52.792669 [debug] [MainThread]: On master: COMMIT
[0m23:34:52.794072 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:52.795034 [debug] [MainThread]: On master: Close
[0m23:34:52.809893 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:34:52.811133 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:34:52.812364 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:34:52.813656 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:34:52.815232 [info ] [Thread-1 (]: 1 of 21 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m23:34:52.820167 [info ] [Thread-2 (]: 2 of 21 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m23:34:52.822481 [info ] [Thread-4 (]: 4 of 21 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m23:34:52.827379 [info ] [Thread-3 (]: 3 of 21 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m23:34:52.829633 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m23:34:52.831989 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m23:34:52.835090 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m23:34:52.836785 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m23:34:52.838097 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:34:52.839688 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:34:52.841074 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:34:52.842399 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:34:52.924813 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:34:52.933177 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:34:52.937843 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:34:52.952475 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:34:52.956956 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:34:53.020906 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:34:53.022459 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:34:53.024030 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:34:53.025737 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:34:53.049905 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:34:53.058961 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:34:53.065270 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:34:53.070003 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:34:53.072068 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:34:53.075274 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m23:34:53.076671 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m23:34:53.077955 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:34:53.084716 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m23:34:53.078996 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:34:53.083221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:34:53.080906 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:34:53.086447 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:34:53.089727 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m23:34:53.092080 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:34:53.277380 [debug] [Thread-2 (]: SQL status: BEGIN in 0.198 seconds
[0m23:34:53.278549 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:34:53.279695 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.290197 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:34:53.308183 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m23:34:53.309700 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m23:34:53.310858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m23:34:53.312174 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:34:53.315177 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.313863 [info ] [Thread-2 (]: 2 of 21 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.48s]
[0m23:34:53.318060 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:34:53.319427 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:34:53.320800 [info ] [Thread-2 (]: 5 of 21 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m23:34:53.322335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m23:34:53.323676 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:34:53.340276 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:34:53.343154 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:34:53.353626 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:34:53.355903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.270 seconds
[0m23:34:53.357069 [debug] [Thread-3 (]: SQL status: BEGIN in 0.265 seconds
[0m23:34:53.358196 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:34:53.359510 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:34:53.360876 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.362148 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.364570 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:34:53.369389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.053 seconds
[0m23:34:53.371253 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m23:34:53.375516 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m23:34:53.376817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:53.377914 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:34:53.379138 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:34:53.380859 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m23:34:53.387040 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m23:34:53.390976 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m23:34:53.393350 [info ] [Thread-1 (]: 1 of 21 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.56s]
[0m23:34:53.394761 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m23:34:53.396136 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m23:34:53.397799 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:34:53.400968 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:34:53.399871 [info ] [Thread-4 (]: 4 of 21 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.56s]
[0m23:34:53.406186 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:34:53.407698 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:34:53.402733 [info ] [Thread-3 (]: 3 of 21 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.57s]
[0m23:34:53.403753 [info ] [Thread-1 (]: 6 of 21 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m23:34:53.412186 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:34:53.409684 [info ] [Thread-4 (]: 7 of 21 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m23:34:53.413715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m23:34:53.415219 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:34:53.416627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m23:34:53.417939 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:34:53.419448 [info ] [Thread-3 (]: 8 of 21 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m23:34:53.421046 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:34:53.433936 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:34:53.435820 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m23:34:53.449562 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:34:53.451154 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:34:53.461949 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:34:53.463720 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:34:53.466453 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:34:53.473318 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:34:53.479294 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:34:53.480659 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:34:53.488722 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:34:53.491117 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:34:53.492309 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m23:34:53.493494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:53.495436 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:34:53.496907 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:34:53.500662 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m23:34:53.502919 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m23:34:53.504195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:53.505454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:34:53.507563 [debug] [Thread-2 (]: SQL status: BEGIN in 0.131 seconds
[0m23:34:53.508691 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:34:53.509897 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.520384 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:34:53.524852 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m23:34:53.526676 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m23:34:53.528821 [info ] [Thread-2 (]: 5 of 21 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.21s]
[0m23:34:53.530809 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:34:53.534250 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:34:53.535492 [info ] [Thread-2 (]: 9 of 21 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m23:34:53.537066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m23:34:53.538489 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:34:53.549895 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:34:53.573526 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:34:53.586627 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:34:53.589872 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:34:53.591072 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m23:34:53.592482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:53.799675 [debug] [Thread-3 (]: SQL status: BEGIN in 0.295 seconds
[0m23:34:53.800714 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:34:53.801816 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.823826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.330 seconds
[0m23:34:53.825103 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:34:53.826495 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.827701 [debug] [Thread-4 (]: SQL status: BEGIN in 0.322 seconds
[0m23:34:53.828878 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:34:53.829943 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.832105 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.029 seconds
[0m23:34:53.833357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:34:53.837583 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m23:34:53.842317 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m23:34:53.843605 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:34:53.847702 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m23:34:53.849000 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m23:34:53.851101 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m23:34:53.852862 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m23:34:53.854655 [info ] [Thread-1 (]: 6 of 21 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.44s]
[0m23:34:53.859222 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:34:53.860413 [debug] [Thread-2 (]: SQL status: BEGIN in 0.268 seconds
[0m23:34:53.863208 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:34:53.856967 [info ] [Thread-3 (]: 8 of 21 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.42s]
[0m23:34:53.864749 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:34:53.861997 [info ] [Thread-4 (]: 7 of 21 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.45s]
[0m23:34:53.867002 [info ] [Thread-1 (]: 10 of 21 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m23:34:53.869237 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:34:53.870528 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:53.872948 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:34:53.874268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m23:34:53.875526 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:34:53.876957 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:34:53.878269 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:34:53.879548 [info ] [Thread-3 (]: 11 of 21 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:34:53.880896 [info ] [Thread-4 (]: 12 of 21 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:34:53.893403 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:34:53.894819 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:34:53.896025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m23:34:53.897354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m23:34:53.902140 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m23:34:53.903811 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:34:53.905120 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:34:53.906971 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m23:34:53.919331 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:34:53.947696 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:34:53.953605 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:34:53.960183 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:34:53.961790 [info ] [Thread-2 (]: 9 of 21 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.42s]
[0m23:34:53.965407 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:34:53.966711 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:34:53.968038 [info ] [Thread-2 (]: 13 of 21 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:34:53.969935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m23:34:53.971355 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:34:53.982403 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:34:53.984217 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m23:34:53.990724 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:34:53.992167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:53.993583 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:34:53.995768 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:34:54.007198 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:34:54.015552 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:34:54.021184 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:34:54.028420 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:34:54.030921 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:34:54.032233 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m23:34:54.033583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:54.035290 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:34:54.036911 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m23:34:54.038088 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:34:54.041237 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:34:54.044860 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m23:34:54.047121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:54.246486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.200 seconds
[0m23:34:54.247664 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:34:54.249008 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.252671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.260 seconds
[0m23:34:54.254002 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:34:54.255207 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.257686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.224 seconds
[0m23:34:54.258886 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:34:54.260173 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.271798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m23:34:54.275731 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m23:34:54.276861 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m23:34:54.280663 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m23:34:54.281743 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m23:34:54.285172 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m23:34:54.283923 [info ] [Thread-1 (]: 10 of 21 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.41s]
[0m23:34:54.287268 [info ] [Thread-2 (]: 13 of 21 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.32s]
[0m23:34:54.289541 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:34:54.291503 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:34:54.293030 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:34:54.294319 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:34:54.295542 [info ] [Thread-1 (]: 14 of 21 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:34:54.296898 [info ] [Thread-2 (]: 15 of 21 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m23:34:54.298328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m23:34:54.299878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m23:34:54.301208 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:34:54.302732 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:34:54.318405 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:34:54.319783 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.058 seconds
[0m23:34:54.338669 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:34:54.345056 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m23:34:54.346311 [debug] [Thread-4 (]: SQL status: BEGIN in 0.308 seconds
[0m23:34:54.348121 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:34:54.349235 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m23:34:54.350466 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.352954 [info ] [Thread-3 (]: 11 of 21 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.46s]
[0m23:34:54.355459 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:34:54.356870 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:34:54.358037 [info ] [Thread-3 (]: 16 of 21 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:34:54.359414 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:34:54.360670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m23:34:54.373424 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:34:54.374947 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:34:54.376408 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:34:54.377891 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:34:54.382056 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m23:34:54.396428 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:34:54.403315 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:34:54.405038 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:34:54.406245 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m23:34:54.408008 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m23:34:54.411506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:54.413287 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:34:54.423339 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:34:54.424601 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:34:54.410119 [info ] [Thread-4 (]: 12 of 21 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.51s]
[0m23:34:54.426503 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m23:34:54.428687 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:34:54.429817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:54.432166 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:34:54.435075 [info ] [Thread-4 (]: 17 of 21 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:34:54.436603 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m23:34:54.438504 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:34:54.455386 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:34:54.457879 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:34:54.460024 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m23:34:54.462467 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:54.464955 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:34:54.472263 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:34:54.475315 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:34:54.476652 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m23:34:54.477880 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:34:54.681644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.270 seconds
[0m23:34:54.682878 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:34:54.684399 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.700443 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m23:34:54.705662 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m23:34:54.707317 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m23:34:54.708606 [debug] [Thread-4 (]: SQL status: BEGIN in 0.231 seconds
[0m23:34:54.711564 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:34:54.714621 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.713598 [info ] [Thread-1 (]: 14 of 21 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.42s]
[0m23:34:54.716810 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:34:54.717995 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:34:54.719162 [info ] [Thread-1 (]: 18 of 21 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m23:34:54.721125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m23:34:54.722926 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:34:54.747454 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:34:54.748584 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.033 seconds
[0m23:34:54.753073 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m23:34:54.755871 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m23:34:54.758057 [info ] [Thread-4 (]: 17 of 21 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.32s]
[0m23:34:54.761560 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:34:54.762831 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:34:54.764183 [info ] [Thread-4 (]: 19 of 21 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m23:34:54.766174 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:34:54.767888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m23:34:54.804792 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:34:54.806092 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:34:54.816458 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:34:54.819087 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:34:54.820921 [debug] [Thread-2 (]: SQL status: BEGIN in 0.391 seconds
[0m23:34:54.827703 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:34:54.829137 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:34:54.830844 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.832337 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:34:54.833600 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m23:34:54.834769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:54.836987 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:34:54.838163 [debug] [Thread-3 (]: SQL status: BEGIN in 0.376 seconds
[0m23:34:54.839260 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m23:34:54.840875 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:34:54.842500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:34:54.843758 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:34:54.855447 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:34:54.860360 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m23:34:54.861861 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m23:34:54.863773 [info ] [Thread-2 (]: 15 of 21 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.56s]
[0m23:34:54.865991 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:34:54.867223 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:34:54.868396 [info ] [Thread-2 (]: 20 of 21 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m23:34:54.869636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m23:34:54.870703 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:34:54.871872 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m23:34:54.883795 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m23:34:54.890696 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m23:34:54.892733 [info ] [Thread-3 (]: 16 of 21 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.53s]
[0m23:34:54.889079 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:34:54.894805 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:34:54.896288 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:34:54.897415 [info ] [Thread-3 (]: 21 of 21 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m23:34:54.899095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m23:34:54.900248 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:34:54.913190 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:34:54.916253 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:34:54.988976 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:34:55.029953 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:34:55.031464 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:34:55.036001 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:34:55.037157 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m23:34:55.038351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:55.042141 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:34:55.044284 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m23:34:55.045839 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:55.158116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.323 seconds
[0m23:34:55.159226 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:34:55.160474 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:34:55.171893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.329 seconds
[0m23:34:55.173006 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:34:55.174102 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:34:55.180248 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:34:55.184114 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m23:34:55.185690 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m23:34:55.187690 [info ] [Thread-4 (]: 19 of 21 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.42s]
[0m23:34:55.189739 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:34:55.217996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.172 seconds
[0m23:34:55.219439 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:34:55.220714 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:34:55.229870 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m23:34:55.233773 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m23:34:55.234965 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:34:55.240200 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m23:34:55.241460 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m23:34:55.246668 [info ] [Thread-1 (]: 18 of 21 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.53s]
[0m23:34:55.248731 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:34:55.250183 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m23:34:55.260416 [error] [Thread-3 (]: 21 of 21 FAIL 15 unique_fact_reviews_review_nk ................................. [[31mFAIL 15[0m in 0.35s]
[0m23:34:55.264929 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:34:55.266901 [debug] [Thread-2 (]: SQL status: BEGIN in 0.228 seconds
[0m23:34:55.268941 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:34:55.270269 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:34:55.301840 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m23:34:55.307102 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m23:34:55.309140 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m23:34:55.312999 [info ] [Thread-2 (]: 20 of 21 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.44s]
[0m23:34:55.317011 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:34:55.377786 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:55.378787 [debug] [MainThread]: On master: BEGIN
[0m23:34:55.380007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:55.719753 [debug] [MainThread]: SQL status: BEGIN in 0.340 seconds
[0m23:34:55.723226 [debug] [MainThread]: On master: COMMIT
[0m23:34:55.724631 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:55.725575 [debug] [MainThread]: On master: COMMIT
[0m23:34:55.727274 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:34:55.728381 [debug] [MainThread]: On master: Close
[0m23:34:55.729743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:55.730656 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:34:55.731497 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:34:55.732874 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:34:55.734051 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:34:55.734909 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd' was properly closed.
[0m23:34:55.735915 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m23:34:55.737119 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e' was properly closed.
[0m23:34:55.738934 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m23:34:55.740045 [info ] [MainThread]: 
[0m23:34:55.741068 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m23:34:55.766710 [debug] [MainThread]: Command end result
[0m23:34:55.962752 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:34:55.976968 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:34:56.005250 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:34:56.010060 [info ] [MainThread]: 
[0m23:34:56.012167 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:34:56.013353 [info ] [MainThread]: 
[0m23:34:56.015600 [error] [MainThread]: [31mFailure in test unique_fact_reviews_review_nk (models\dw\dw.yml)[0m
[0m23:34:56.019460 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m23:34:56.030852 [info ] [MainThread]: 
[0m23:34:56.034046 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\unique_fact_reviews_review_nk.sql
[0m23:34:56.039440 [info ] [MainThread]: 
[0m23:34:56.043511 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=21
[0m23:34:56.048061 [debug] [MainThread]: Command `dbt test` failed at 23:34:56.047576 after 10.55 seconds
[0m23:34:56.051828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019531E06450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195338CD440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195338CE570>]}
[0m23:34:56.053756 [debug] [MainThread]: Flushing usage events
[0m23:34:58.826936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:38.054966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002184EDB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021850658B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021850C98E10>]}


============================== 23:35:38.075060 | 8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51 ==============================
[0m23:35:38.075060 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:35:38.077246 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_metabase_reviews', 'printer_width': '80', 'target_path': 'None'}
[0m23:35:39.364562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002184EFE9F30>]}
[0m23:35:39.606358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021850D1FDF0>]}
[0m23:35:39.610876 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:35:41.273798 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:35:42.103725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:42.107381 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_reviews.sql
[0m23:35:43.740868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021851344E50>]}
[0m23:35:44.163353 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:35:44.177972 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:35:44.308025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021851355400>]}
[0m23:35:44.308969 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:35:44.309636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021851375D30>]}
[0m23:35:44.313875 [info ] [MainThread]: 
[0m23:35:44.314706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:44.315562 [info ] [MainThread]: 
[0m23:35:44.316618 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:44.322554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:35:44.695426 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:35:44.696269 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:35:44.696953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:44.852947 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.156 seconds
[0m23:35:44.857337 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:35:44.873412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m23:35:44.890045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:35:44.891180 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:35:44.895149 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:35:44.896074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m23:35:44.897012 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:35:44.897905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:35:44.898686 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:35:44.905200 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:35:44.906916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:44.911709 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:35:44.912661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:44.913466 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:35:44.914444 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:35:44.915452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:44.916201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:45.063141 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m23:35:45.063968 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:35:45.065136 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:35:45.075926 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m23:35:45.077002 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:35:45.078050 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:35:45.080863 [debug] [ThreadPool]: SQL status: BEGIN in 0.165 seconds
[0m23:35:45.081833 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:35:45.082989 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:35:45.084071 [debug] [ThreadPool]: SQL status: BEGIN in 0.171 seconds
[0m23:35:45.085774 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:35:45.087546 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:35:45.090567 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.024 seconds
[0m23:35:45.094099 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:35:45.096249 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:35:45.098079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dw)
[0m23:35:45.113081 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:35:45.114105 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.029 seconds
[0m23:35:45.115123 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m23:35:45.115863 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:35:45.116659 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.037 seconds
[0m23:35:45.120756 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:35:45.125340 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:35:45.126080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:45.128260 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:35:45.129398 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:35:45.129961 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:35:45.130511 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:35:45.131764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:35:45.133043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:35:45.144986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:35:45.149338 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:35:45.157092 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:35:45.162358 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:35:45.163469 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:35:45.164525 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:35:45.165433 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:35:45.166212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:45.167026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:45.167811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:45.257388 [debug] [ThreadPool]: SQL status: BEGIN in 0.131 seconds
[0m23:35:45.258478 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:35:45.259608 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:35:45.280690 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m23:35:45.284051 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:35:45.287435 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:35:45.311477 [debug] [ThreadPool]: SQL status: BEGIN in 0.145 seconds
[0m23:35:45.312459 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:35:45.313410 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:35:45.315395 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m23:35:45.316390 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:35:45.317341 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:35:45.324565 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m23:35:45.326112 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:35:45.327326 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:35:45.335136 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:35:45.339122 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:35:45.340183 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m23:35:45.342936 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:35:45.343835 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:35:45.344992 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:35:45.346295 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:35:45.349412 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:35:45.350763 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:35:45.365680 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.366331 [debug] [MainThread]: On master: BEGIN
[0m23:35:45.366878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:45.474749 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m23:35:45.475716 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.476722 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:35:45.504545 [debug] [MainThread]: SQL status: SELECT 24 in 0.026 seconds
[0m23:35:45.511650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021851839BF0>]}
[0m23:35:45.512744 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:45.513944 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.514757 [debug] [MainThread]: On master: BEGIN
[0m23:35:45.515954 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:35:45.516933 [debug] [MainThread]: On master: COMMIT
[0m23:35:45.518443 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.519842 [debug] [MainThread]: On master: COMMIT
[0m23:35:45.521700 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:35:45.523620 [debug] [MainThread]: On master: Close
[0m23:35:45.542511 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:35:45.543900 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.stg_metabase_reviews ........................ [RUN]
[0m23:35:45.545553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_reviews'
[0m23:35:45.546574 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:35:45.578069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.584684 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:35:45.698286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.700928 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.707122 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: BEGIN
[0m23:35:45.708652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:35:45.814606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.106 seconds
[0m23:35:45.815446 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.816412 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp"
    
    
  as (
    

-- Reviews p√∫blicos dos produtos Metabase Sample.
select
    'METABASE'                               as source_system,
    r._mb_row_id                             as source_review_id,
    'METABASE_RV_' || r._mb_row_id           as review_nk,
    case
        when prod.id is not null then 'METABASE_' || prod.id::varchar
        else 'METABASE_' || upper(trim(r.product_id))
    end                                      as product_nk,
    r.product_id                             as source_product_id,
    r.reviewer                               as reviewer_name,
    cast(r.rating as numeric(5,2))           as rating_score,
    case
        when r.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then r.created_at::timestamp
        else null
    end                                      as created_at,
    r.body                                   as review_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."reviews" r
left join "dw_northwind_metabase"."public"."products" prod
       on lower(prod.title) = lower(r.product_id)
  );
[0m23:35:45.843861 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m23:35:45.857246 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.858202 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews" rename to "stg_metabase_reviews__dbt_backup"
[0m23:35:45.860861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:35:45.867185 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.868392 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp" rename to "stg_metabase_reviews"
[0m23:35:45.872029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:35:45.916090 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:35:45.919607 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.921003 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:35:45.926058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:35:45.938257 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup"
[0m23:35:45.950435 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:35:45.951426 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup" cascade
[0m23:35:45.960340 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:35:45.966385 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: Close
[0m23:35:45.976239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54b3bf-1c3d-4a0a-a7e7-6045aacabe51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218513E37D0>]}
[0m23:35:45.978475 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.stg_metabase_reviews ................... [[32mCREATE VIEW[0m in 0.42s]
[0m23:35:45.981097 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:35:45.984113 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.986124 [debug] [MainThread]: On master: BEGIN
[0m23:35:45.988292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:46.155137 [debug] [MainThread]: SQL status: BEGIN in 0.167 seconds
[0m23:35:46.156660 [debug] [MainThread]: On master: COMMIT
[0m23:35:46.158430 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:46.159686 [debug] [MainThread]: On master: COMMIT
[0m23:35:46.160990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:46.161859 [debug] [MainThread]: On master: Close
[0m23:35:46.163110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:46.163868 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:35:46.164611 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m23:35:46.165404 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:35:46.166110 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:35:46.166808 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:35:46.167536 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_reviews' was properly closed.
[0m23:35:46.168807 [info ] [MainThread]: 
[0m23:35:46.170347 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m23:35:46.177213 [debug] [MainThread]: Command end result
[0m23:35:46.392142 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:35:46.408379 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:35:46.545502 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:35:46.548424 [info ] [MainThread]: 
[0m23:35:46.556628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:46.558396 [info ] [MainThread]: 
[0m23:35:46.561233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:35:46.569698 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:46.569228 after 9.08 seconds
[0m23:35:46.573936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218511CAFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021850DCE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021850DCD6D0>]}
[0m23:35:46.576481 [debug] [MainThread]: Flushing usage events
[0m23:35:48.248047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:02.949352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490F010830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490F8B8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490FEF8E10>]}


============================== 23:36:02.956531 | 0a3756da-a5ec-425f-ae32-b4f4fd596a8b ==============================
[0m23:36:02.956531 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:36:02.957836 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select fact_reviews', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m23:36:03.329363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490F249F30>]}
[0m23:36:03.469092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491101FDF0>]}
[0m23:36:03.470870 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:36:04.292971 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:36:04.749113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:04.749654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:04.856630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491131F350>]}
[0m23:36:05.094466 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:36:05.100753 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:36:05.254384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490BA54F50>]}
[0m23:36:05.255349 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:36:05.255981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249111DD9B0>]}
[0m23:36:05.261728 [info ] [MainThread]: 
[0m23:36:05.262499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:05.263284 [info ] [MainThread]: 
[0m23:36:05.264370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:05.266311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:36:05.484030 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:36:05.484801 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:36:05.485595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:05.573141 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.087 seconds
[0m23:36:05.574954 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:36:05.589083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:36:05.595966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:36:05.601211 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:36:05.604110 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:36:05.604798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:36:05.605702 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:36:05.606562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:36:05.607207 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:36:05.610048 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:36:05.610865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:05.613767 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:36:05.614365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:05.614884 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:36:05.615612 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:36:05.616463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:05.617123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:05.705202 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m23:36:05.706032 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:36:05.706794 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:36:05.713334 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m23:36:05.714355 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:36:05.715217 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:36:05.719507 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m23:36:05.720391 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:36:05.721134 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:36:05.724516 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m23:36:05.728712 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:36:05.729680 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:36:05.732409 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:36:05.733117 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:36:05.733877 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:36:05.734773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:36:05.735481 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.014 seconds
[0m23:36:05.736784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:36:05.740374 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:36:05.742985 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:36:05.747266 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:36:05.748138 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:36:05.748821 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:36:05.749319 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:36:05.749771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:05.750401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:05.751493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_snapshots)
[0m23:36:05.760114 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:36:05.761222 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:36:05.762327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:05.834489 [debug] [ThreadPool]: SQL status: BEGIN in 0.218 seconds
[0m23:36:05.835407 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:36:05.836321 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:36:05.851648 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.014 seconds
[0m23:36:05.855056 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:36:05.856155 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:36:05.857350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:36:05.862236 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:36:05.867598 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:36:05.868427 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m23:36:05.869022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:05.869658 [debug] [ThreadPool]: SQL status: BEGIN in 0.120 seconds
[0m23:36:05.870193 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:36:05.871006 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:36:05.871800 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:36:05.872554 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:36:05.873947 [debug] [ThreadPool]: SQL status: BEGIN in 0.112 seconds
[0m23:36:05.874698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:36:05.875596 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:36:05.887089 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:36:05.888000 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:36:05.890135 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:36:05.890772 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m23:36:05.892748 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:36:05.896318 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:36:05.897191 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:36:05.897945 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:36:05.898910 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:36:05.949221 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m23:36:05.949861 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:36:05.950347 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:36:05.961041 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m23:36:05.963602 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:36:05.964475 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:36:05.974145 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:05.974742 [debug] [MainThread]: On master: BEGIN
[0m23:36:05.975495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:06.075209 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m23:36:06.076122 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:06.077219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:36:06.091844 [debug] [MainThread]: SQL status: SELECT 24 in 0.013 seconds
[0m23:36:06.098051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249119ADE60>]}
[0m23:36:06.099310 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:06.100543 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:06.101363 [debug] [MainThread]: On master: BEGIN
[0m23:36:06.102577 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:36:06.103264 [debug] [MainThread]: On master: COMMIT
[0m23:36:06.104295 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:06.105052 [debug] [MainThread]: On master: COMMIT
[0m23:36:06.106015 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:36:06.106724 [debug] [MainThread]: On master: Close
[0m23:36:06.121241 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_reviews
[0m23:36:06.122555 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.fact_reviews ................................ [RUN]
[0m23:36:06.123982 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_reviews'
[0m23:36:06.125392 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_reviews
[0m23:36:06.167467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.171713 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_reviews
[0m23:36:06.353310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.356409 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.357864 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: BEGIN
[0m23:36:06.359088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:06.529177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m23:36:06.531082 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.532743 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de reviews p√∫blicos (produtos Metabase).
select
    review_nk,
    source_system,
    source_review_id,
    product_nk,
    source_product_id,
    reviewer_name,
    rating_score,
    created_at,
    review_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
  );
  
[0m23:36:06.765494 [debug] [Thread-1 (]: SQL status: SELECT 1127 in 0.231 seconds
[0m23:36:06.788663 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.790351 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews" rename to "fact_reviews__dbt_backup"
[0m23:36:06.792668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:36:06.801694 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.802869 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp" rename to "fact_reviews"
[0m23:36:06.804739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:36:06.848745 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:36:06.849586 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.850198 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:36:06.853139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:36:06.866322 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup"
[0m23:36:06.877084 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:36:06.879001 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup" cascade
[0m23:36:06.890315 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m23:36:06.896323 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: Close
[0m23:36:06.903152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3756da-a5ec-425f-ae32-b4f4fd596a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024911C08290>]}
[0m23:36:06.904794 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.fact_reviews ........................... [[32mSELECT 1127[0m in 0.77s]
[0m23:36:06.906811 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_reviews
[0m23:36:06.913558 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:06.914545 [debug] [MainThread]: On master: BEGIN
[0m23:36:06.915398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:07.010029 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m23:36:07.011091 [debug] [MainThread]: On master: COMMIT
[0m23:36:07.012106 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:07.012781 [debug] [MainThread]: On master: COMMIT
[0m23:36:07.013821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:36:07.014480 [debug] [MainThread]: On master: Close
[0m23:36:07.015509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:07.016358 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:36:07.017124 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:36:07.017916 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:36:07.018752 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:36:07.019584 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:36:07.020378 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_reviews' was properly closed.
[0m23:36:07.021756 [info ] [MainThread]: 
[0m23:36:07.022957 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m23:36:07.024886 [debug] [MainThread]: Command end result
[0m23:36:07.213826 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:36:07.293703 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:36:07.341631 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:36:07.342705 [info ] [MainThread]: 
[0m23:36:07.353222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:07.355057 [info ] [MainThread]: 
[0m23:36:07.356788 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:36:07.369589 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:07.368803 after 4.63 seconds
[0m23:36:07.370903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491173BB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024911B53E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024911B51270>]}
[0m23:36:07.372143 [debug] [MainThread]: Flushing usage events
[0m23:36:09.124205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:32.996826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E3E5B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E3EE58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E40498E10>]}


============================== 23:36:33.007914 | af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a ==============================
[0m23:36:33.007914 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:36:33.009160 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --select fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'printer_width': '80', 'write_json': 'True'}
[0m23:36:33.524784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E3E7E9F30>]}
[0m23:36:33.685878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E4050FDF0>]}
[0m23:36:33.689783 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:36:34.549495 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:36:34.925892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:34.926477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:35.055833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E4081F350>]}
[0m23:36:35.305892 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:36:35.312224 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:36:35.568189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E40D266C0>]}
[0m23:36:35.569009 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:36:35.569831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E4066CD70>]}
[0m23:36:35.582393 [info ] [MainThread]: 
[0m23:36:35.583445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:35.584476 [info ] [MainThread]: 
[0m23:36:35.585504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:35.597592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:36:35.606177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:36:35.625105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m23:36:35.628967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:36:35.886041 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:36:35.886767 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:36:35.887873 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:36:35.889043 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:36:35.889987 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:36:35.890970 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:36:35.891740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:35.892294 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:36:35.892796 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:36:35.893298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:35.894180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:35.894843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:36.069914 [debug] [ThreadPool]: SQL status: BEGIN in 0.175 seconds
[0m23:36:36.071425 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:36:36.072616 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:36:36.080678 [debug] [ThreadPool]: SQL status: BEGIN in 0.186 seconds
[0m23:36:36.081738 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:36:36.082704 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:36:36.084903 [debug] [ThreadPool]: SQL status: BEGIN in 0.191 seconds
[0m23:36:36.086113 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:36:36.087441 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:36:36.090009 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.016 seconds
[0m23:36:36.091346 [debug] [ThreadPool]: SQL status: BEGIN in 0.199 seconds
[0m23:36:36.095762 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:36:36.096959 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:36:36.098069 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:36:36.099086 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:36:36.101027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:36:36.106758 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:36:36.109061 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m23:36:36.110504 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:36:36.118410 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.030 seconds
[0m23:36:36.122752 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:36:36.124632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:36.128124 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:36:36.129291 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.029 seconds
[0m23:36:36.130194 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:36:36.134383 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:36:36.135402 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:36:36.137122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2c)
[0m23:36:36.139546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:36:36.140989 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:36:36.145896 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:36:36.151630 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:36:36.152884 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:36:36.154543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_snapshots)
[0m23:36:36.155711 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:36:36.164518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:36.168521 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:36:36.169302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:36.171785 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:36:36.173540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:36.293960 [debug] [ThreadPool]: SQL status: BEGIN in 0.169 seconds
[0m23:36:36.294933 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:36:36.295944 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:36:36.316223 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:36:36.317276 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m23:36:36.320817 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:36:36.322360 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:36:36.323508 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m23:36:36.324940 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:36:36.326153 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:36:36.327117 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:36:36.328645 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:36:36.339483 [debug] [ThreadPool]: SQL status: BEGIN in 0.166 seconds
[0m23:36:36.340606 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:36:36.342034 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:36:36.352496 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.024 seconds
[0m23:36:36.357175 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:36:36.359342 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.029 seconds
[0m23:36:36.360554 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:36:36.364239 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:36:36.366630 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:36:36.373899 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.031 seconds
[0m23:36:36.378286 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:36:36.379856 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:36:36.410140 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:36.411122 [debug] [MainThread]: On master: BEGIN
[0m23:36:36.411982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:36.553651 [debug] [MainThread]: SQL status: BEGIN in 0.142 seconds
[0m23:36:36.555194 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:36.556551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:36:36.582920 [debug] [MainThread]: SQL status: SELECT 24 in 0.024 seconds
[0m23:36:36.588922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af80dbcf-0c95-4ba4-be6a-a5de62a8dd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E420A9300>]}
[0m23:36:36.590603 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:36.592446 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:36.593426 [debug] [MainThread]: On master: BEGIN
[0m23:36:36.594959 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:36:36.596028 [debug] [MainThread]: On master: COMMIT
[0m23:36:36.596857 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:36.598165 [debug] [MainThread]: On master: COMMIT
[0m23:36:36.599636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:36:36.600954 [debug] [MainThread]: On master: Close
[0m23:36:36.619344 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:36:36.620602 [info ] [Thread-1 (]: 1 of 21 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m23:36:36.623734 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:36:36.626232 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:36:36.628117 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:36:36.630747 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m23:36:36.632425 [info ] [Thread-2 (]: 2 of 21 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m23:36:36.638239 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:36:36.634215 [info ] [Thread-4 (]: 4 of 21 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m23:36:36.636098 [info ] [Thread-3 (]: 3 of 21 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m23:36:36.643261 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m23:36:36.667564 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m23:36:36.714372 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m23:36:36.724670 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:36:36.724198 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:36:36.727109 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:36:36.728519 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:36:36.741916 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:36:36.757857 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:36:36.780782 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:36:36.782791 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:36:36.785158 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:36:36.821449 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:36:36.839884 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:36:36.872218 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:36:36.878395 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:36:36.883293 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:36:36.895838 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:36:36.897725 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:36:36.899240 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:36:36.900819 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m23:36:36.902060 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m23:36:36.903410 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:36:36.906878 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:36:36.908395 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:36.915084 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:36:36.916419 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m23:36:36.911828 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m23:36:36.918000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:36.919502 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:37.124470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.216 seconds
[0m23:36:37.125802 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:36:37.127147 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.130615 [debug] [Thread-2 (]: SQL status: BEGIN in 0.211 seconds
[0m23:36:37.131764 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:36:37.132790 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.141123 [debug] [Thread-4 (]: SQL status: BEGIN in 0.238 seconds
[0m23:36:37.142556 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:36:37.143812 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.144847 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:36:37.156865 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m23:36:37.159562 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m23:36:37.160814 [debug] [Thread-3 (]: SQL status: BEGIN in 0.243 seconds
[0m23:36:37.161849 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:36:37.164153 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:36:37.163247 [info ] [Thread-2 (]: 2 of 21 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.52s]
[0m23:36:37.167154 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m23:36:37.168090 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.169367 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:36:37.170307 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:36:37.171069 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m23:36:37.172395 [info ] [Thread-2 (]: 5 of 21 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m23:36:37.174825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m23:36:37.178006 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:36:37.186936 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:36:37.176901 [info ] [Thread-4 (]: 4 of 21 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.51s]
[0m23:36:37.189165 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:36:37.190596 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.062 seconds
[0m23:36:37.192565 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:36:37.195313 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m23:36:37.197848 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m23:36:37.198821 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:36:37.200984 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:36:37.202181 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m23:36:37.202975 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m23:36:37.207676 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:36:37.200010 [info ] [Thread-4 (]: 6 of 21 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m23:36:37.212239 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m23:36:37.213386 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:36:37.209809 [info ] [Thread-3 (]: 3 of 21 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.50s]
[0m23:36:37.224549 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:36:37.226211 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:36:37.211232 [info ] [Thread-1 (]: 1 of 21 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.58s]
[0m23:36:37.228443 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:36:37.230373 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:36:37.231607 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:36:37.232533 [info ] [Thread-3 (]: 7 of 21 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m23:36:37.233815 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:36:37.234681 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:36:37.235636 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m23:36:37.236627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m23:36:37.237691 [info ] [Thread-1 (]: 8 of 21 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m23:36:37.242974 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:36:37.243783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:37.244450 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:36:37.245118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m23:36:37.253594 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:36:37.255060 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:36:37.265832 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:36:37.267332 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:36:37.269217 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m23:36:37.270505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:37.271906 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:36:37.273520 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:36:37.279440 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:36:37.285576 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:36:37.288927 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:36:37.290165 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m23:36:37.291349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:37.293106 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:36:37.294235 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m23:36:37.300019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:37.489798 [debug] [Thread-2 (]: SQL status: BEGIN in 0.246 seconds
[0m23:36:37.490906 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:36:37.492001 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.497140 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:36:37.501157 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m23:36:37.502839 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m23:36:37.504928 [info ] [Thread-2 (]: 5 of 21 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.33s]
[0m23:36:37.506765 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:36:37.507892 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:36:37.509105 [info ] [Thread-2 (]: 9 of 21 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m23:36:37.510463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m23:36:37.511712 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:36:37.524949 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:36:37.527558 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:36:37.535622 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:36:37.539118 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:36:37.540703 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m23:36:37.542342 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:37.548469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m23:36:37.549838 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:36:37.551299 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.556104 [debug] [Thread-4 (]: SQL status: BEGIN in 0.285 seconds
[0m23:36:37.557366 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:36:37.558643 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.563437 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:36:37.567797 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m23:36:37.569434 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m23:36:37.571549 [info ] [Thread-4 (]: 6 of 21 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.36s]
[0m23:36:37.573568 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:36:37.574652 [debug] [Thread-3 (]: SQL status: BEGIN in 0.277 seconds
[0m23:36:37.575797 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:36:37.577002 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:36:37.578239 [info ] [Thread-4 (]: 10 of 21 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m23:36:37.580081 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.581467 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m23:36:37.582876 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:36:37.594417 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:36:37.595705 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m23:36:37.596898 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:36:37.600901 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m23:36:37.605130 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m23:36:37.606761 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m23:36:37.608083 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:36:37.609161 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m23:36:37.615394 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:36:37.616988 [info ] [Thread-1 (]: 8 of 21 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.37s]
[0m23:36:37.620940 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:36:37.622474 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:36:37.619217 [info ] [Thread-3 (]: 7 of 21 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.38s]
[0m23:36:37.626163 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:36:37.627406 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:36:37.623912 [info ] [Thread-1 (]: 11 of 21 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:36:37.628865 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:36:37.630029 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m23:36:37.631231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m23:36:37.632519 [info ] [Thread-3 (]: 12 of 21 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:36:37.634105 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:37.635558 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:36:37.636918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m23:36:37.660140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:36:37.661513 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:36:37.677082 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:36:37.678866 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:36:37.684925 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:36:37.687150 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:36:37.694541 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:36:37.696465 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:36:37.697688 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m23:36:37.698775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:37.700640 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:36:37.701725 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m23:36:37.703139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:37.706495 [debug] [Thread-2 (]: SQL status: BEGIN in 0.164 seconds
[0m23:36:37.707740 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:36:37.708943 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.721726 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:36:37.726314 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m23:36:37.727928 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m23:36:37.729936 [info ] [Thread-2 (]: 9 of 21 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.22s]
[0m23:36:37.731803 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:36:37.733071 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:36:37.734363 [info ] [Thread-2 (]: 13 of 21 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:36:37.735834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m23:36:37.737101 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:36:37.751512 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:36:37.754864 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:36:37.761846 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:36:37.764546 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:36:37.765753 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m23:36:37.766777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:37.794859 [debug] [Thread-4 (]: SQL status: BEGIN in 0.161 seconds
[0m23:36:37.796013 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:36:37.797119 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.810583 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:36:37.814388 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m23:36:37.815889 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m23:36:37.817684 [info ] [Thread-4 (]: 10 of 21 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.24s]
[0m23:36:37.819580 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:36:37.820805 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:36:37.822227 [info ] [Thread-4 (]: 14 of 21 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:36:37.823632 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m23:36:37.824781 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:36:37.840886 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:36:37.843719 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:36:37.850696 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:36:37.853574 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:36:37.855094 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m23:36:37.856312 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:37.885931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.187 seconds
[0m23:36:37.887217 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:36:37.888647 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:37.958358 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m23:36:37.962515 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m23:36:37.964297 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m23:36:37.966470 [info ] [Thread-1 (]: 11 of 21 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.33s]
[0m23:36:37.968743 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:36:37.970041 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:36:37.971458 [info ] [Thread-1 (]: 15 of 21 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m23:36:37.973022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m23:36:37.974244 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:36:37.990190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:36:37.993361 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:36:37.999204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:36:38.002283 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:36:38.003450 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m23:36:38.004731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:38.055610 [debug] [Thread-4 (]: SQL status: BEGIN in 0.199 seconds
[0m23:36:38.056931 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:36:38.058371 [debug] [Thread-3 (]: SQL status: BEGIN in 0.355 seconds
[0m23:36:38.059802 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:38.061190 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:36:38.062675 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:38.070367 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:36:38.074798 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m23:36:38.076328 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:36:38.077518 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m23:36:38.081543 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m23:36:38.083720 [info ] [Thread-4 (]: 14 of 21 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.26s]
[0m23:36:38.085158 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m23:36:38.086897 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:36:38.088652 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:36:38.090384 [info ] [Thread-3 (]: 12 of 21 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.45s]
[0m23:36:38.091600 [info ] [Thread-4 (]: 16 of 21 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:36:38.094111 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:36:38.095511 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m23:36:38.097167 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:36:38.098597 [debug] [Thread-2 (]: SQL status: BEGIN in 0.332 seconds
[0m23:36:38.099678 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:36:38.100861 [info ] [Thread-3 (]: 17 of 21 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:36:38.102273 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:36:38.117224 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:36:38.118458 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m23:36:38.119815 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:38.121751 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:36:38.136526 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:36:38.138974 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:36:38.146107 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:36:38.147495 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.024 seconds
[0m23:36:38.152297 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m23:36:38.153956 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m23:36:38.155446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m23:36:38.157189 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:36:38.159136 [info ] [Thread-2 (]: 13 of 21 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.42s]
[0m23:36:38.160906 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:36:38.168175 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:36:38.170091 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:36:38.171678 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:38.173565 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:36:38.174784 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:36:38.176609 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m23:36:38.177859 [info ] [Thread-2 (]: 18 of 21 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m23:36:38.179684 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:38.181052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m23:36:38.182393 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:36:38.183893 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:36:38.185158 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m23:36:38.202675 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:36:38.203970 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.028 seconds
[0m23:36:38.205293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:38.210490 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m23:36:38.212503 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m23:36:38.215843 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:36:38.214793 [info ] [Thread-1 (]: 15 of 21 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.24s]
[0m23:36:38.241605 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:36:38.242778 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:36:38.243899 [info ] [Thread-1 (]: 19 of 21 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m23:36:38.245206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m23:36:38.246385 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:36:38.256286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:36:38.258627 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:36:38.263985 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:36:38.278909 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:36:38.279956 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m23:36:38.280857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:38.300287 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:36:38.303063 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:36:38.304056 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m23:36:38.308950 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:38.415312 [debug] [Thread-4 (]: SQL status: BEGIN in 0.236 seconds
[0m23:36:38.416467 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:36:38.417697 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:38.445438 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m23:36:38.449290 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m23:36:38.450753 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m23:36:38.452616 [info ] [Thread-4 (]: 16 of 21 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.36s]
[0m23:36:38.454519 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:36:38.455990 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:36:38.457203 [info ] [Thread-4 (]: 20 of 21 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m23:36:38.458497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m23:36:38.459644 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:36:38.470681 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:36:38.472206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.267 seconds
[0m23:36:38.473672 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:36:38.474986 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:36:38.476866 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:36:38.482948 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:36:38.485546 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:36:38.487000 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m23:36:38.488180 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:38.499437 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:36:38.503582 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m23:36:38.505233 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m23:36:38.507393 [info ] [Thread-3 (]: 17 of 21 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.39s]
[0m23:36:38.509660 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:36:38.510852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.202 seconds
[0m23:36:38.512587 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:36:38.513948 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:36:38.515106 [info ] [Thread-3 (]: 21 of 21 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m23:36:38.516559 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:36:38.517930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m23:36:38.519447 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:36:38.529843 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:36:38.532672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.252 seconds
[0m23:36:38.534055 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:36:38.535408 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:36:38.536709 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:36:38.545702 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:36:38.546955 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:36:38.551164 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m23:36:38.552669 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m23:36:38.556402 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:36:38.554976 [info ] [Thread-1 (]: 19 of 21 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.31s]
[0m23:36:38.558121 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m23:36:38.559946 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:36:38.561189 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:38.595271 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.076 seconds
[0m23:36:38.599416 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m23:36:38.600901 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m23:36:38.602757 [info ] [Thread-2 (]: 18 of 21 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.42s]
[0m23:36:38.604759 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:36:38.659913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.172 seconds
[0m23:36:38.661308 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:36:38.662681 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:36:38.698897 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.035 seconds
[0m23:36:38.703906 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m23:36:38.706097 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m23:36:38.708358 [info ] [Thread-4 (]: 20 of 21 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.25s]
[0m23:36:38.710426 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:36:38.737215 [debug] [Thread-3 (]: SQL status: BEGIN in 0.176 seconds
[0m23:36:38.738904 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:36:38.740091 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:36:38.746826 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:36:38.750766 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m23:36:38.752610 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m23:36:38.754592 [error] [Thread-3 (]: 21 of 21 FAIL 15 unique_fact_reviews_review_nk ................................. [[31mFAIL 15[0m in 0.24s]
[0m23:36:38.757429 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:36:38.762000 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:38.763191 [debug] [MainThread]: On master: BEGIN
[0m23:36:38.764170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:38.929534 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m23:36:38.930648 [debug] [MainThread]: On master: COMMIT
[0m23:36:38.931568 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:38.932459 [debug] [MainThread]: On master: COMMIT
[0m23:36:38.933648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:36:38.934656 [debug] [MainThread]: On master: Close
[0m23:36:38.936855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:38.937841 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:36:38.940626 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:36:38.941637 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m23:36:38.942674 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:36:38.943537 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e' was properly closed.
[0m23:36:38.944488 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd' was properly closed.
[0m23:36:38.945366 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m23:36:38.946518 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m23:36:38.947663 [info ] [MainThread]: 
[0m23:36:38.949121 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m23:36:38.963754 [debug] [MainThread]: Command end result
[0m23:36:39.204041 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:36:39.217820 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:36:39.289604 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:36:39.293363 [info ] [MainThread]: 
[0m23:36:39.299050 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:36:39.301716 [info ] [MainThread]: 
[0m23:36:39.303064 [error] [MainThread]: [31mFailure in test unique_fact_reviews_review_nk (models\dw\dw.yml)[0m
[0m23:36:39.304549 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m23:36:39.306062 [info ] [MainThread]: 
[0m23:36:39.307929 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dw.yml\unique_fact_reviews_review_nk.sql
[0m23:36:39.309630 [info ] [MainThread]: 
[0m23:36:39.310915 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=21
[0m23:36:39.314141 [debug] [MainThread]: Command `dbt test` failed at 23:36:39.313752 after 6.60 seconds
[0m23:36:39.315188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E402E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E40CCBB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E40CC9BD0>]}
[0m23:36:39.316133 [debug] [MainThread]: Flushing usage events
[0m23:36:40.643091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:06.510953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8B9F0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8D358B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8D998E10>]}


============================== 23:41:06.520027 | 658fd8e3-4656-4b60-baa7-5789d4cb89fe ==============================
[0m23:41:06.520027 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:41:06.521213 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select stg_metabase_orders stg_metabase_reviews', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m23:41:06.795192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8BC29F30>]}
[0m23:41:06.874288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8DA1FDF0>]}
[0m23:41:06.881895 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:41:07.317493 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:41:07.620672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:41:07.621687 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m23:41:07.622378 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_reviews.sql
[0m23:41:08.251160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8E043250>]}
[0m23:41:08.412424 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:41:08.421986 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:41:08.506223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8E05D400>]}
[0m23:41:08.507923 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:41:08.509933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8DA93AF0>]}
[0m23:41:08.520607 [info ] [MainThread]: 
[0m23:41:08.521576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:08.522870 [info ] [MainThread]: 
[0m23:41:08.524701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:08.537296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:41:08.844385 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:41:08.844820 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:41:08.845170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:08.957501 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.112 seconds
[0m23:41:08.960453 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:41:08.967845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:41:08.969585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:41:08.981433 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:41:08.987309 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:41:08.988879 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:41:08.991016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m23:41:08.992140 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:41:08.993090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:41:08.993698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:08.996393 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:41:08.997127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:09.000061 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:41:09.000906 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:41:09.002217 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:41:09.002761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:09.003305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:09.089938 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m23:41:09.090511 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:41:09.091317 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:41:09.093764 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m23:41:09.094553 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m23:41:09.095025 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:41:09.095518 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:41:09.096043 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:41:09.096604 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:41:09.105924 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m23:41:09.109405 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:41:09.110364 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m23:41:09.110911 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m23:41:09.111366 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:41:09.111798 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:41:09.112215 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:41:09.113773 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:41:09.114362 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:41:09.115378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:41:09.117672 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:41:09.122880 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:41:09.123385 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:41:09.123916 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:41:09.124655 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:41:09.125267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:09.126456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:41:09.127718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_snapshots)
[0m23:41:09.131169 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:41:09.134189 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:41:09.134786 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.014 seconds
[0m23:41:09.135251 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:41:09.135711 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:41:09.138010 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:41:09.138774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:09.139496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:09.140397 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:41:09.141851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:41:09.149927 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:41:09.150497 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:41:09.151167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:09.205485 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m23:41:09.206038 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:41:09.206515 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:41:09.220430 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:41:09.222184 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:41:09.224543 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m23:41:09.225184 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m23:41:09.228464 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:41:09.230128 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:41:09.230691 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:41:09.231319 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:41:09.232657 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:41:09.235131 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m23:41:09.235676 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:41:09.236144 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:41:09.243874 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m23:41:09.244467 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m23:41:09.245954 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:41:09.246395 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m23:41:09.247818 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:41:09.249279 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:41:09.249701 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:41:09.250282 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:41:09.250925 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:41:09.260829 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:09.261347 [debug] [MainThread]: On master: BEGIN
[0m23:41:09.261730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:09.318355 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m23:41:09.318871 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:09.319364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:41:09.336262 [debug] [MainThread]: SQL status: SELECT 24 in 0.016 seconds
[0m23:41:09.338971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8E592410>]}
[0m23:41:09.339528 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:09.340181 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:09.340567 [debug] [MainThread]: On master: BEGIN
[0m23:41:09.341360 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:09.341820 [debug] [MainThread]: On master: COMMIT
[0m23:41:09.342238 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:09.342607 [debug] [MainThread]: On master: COMMIT
[0m23:41:09.343290 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:09.343770 [debug] [MainThread]: On master: Close
[0m23:41:09.352788 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:41:09.353423 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:41:09.354093 [info ] [Thread-1 (]: 1 of 2 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m23:41:09.354868 [info ] [Thread-2 (]: 2 of 2 START sql view model dw_stg.stg_metabase_reviews ........................ [RUN]
[0m23:41:09.355831 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m23:41:09.356570 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_reviews'
[0m23:41:09.357128 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m23:41:09.357851 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:41:09.370363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.374942 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.377407 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m23:41:09.378531 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:41:09.432974 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.436222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.438174 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.439028 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: BEGIN
[0m23:41:09.439853 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:09.441611 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.442979 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m23:41:09.444015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:09.514533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m23:41:09.515612 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.516723 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp"
    
    
  as (
    

with product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Reviews p√∫blicos dos produtos Metabase Sample.
select
    'METABASE'                               as source_system,
    r._mb_row_id                             as source_review_id,
    'METABASE_RV_' || r._mb_row_id           as review_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(r.product_id))
    end                                      as product_nk,
    r.product_id                             as source_product_id,
    r.reviewer                               as reviewer_name,
    cast(r.rating as numeric(5,2))           as rating_score,
    case
        when r.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then r.created_at::timestamp
        else null
    end                                      as created_at,
    r.body                                   as review_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."reviews" r
left join product_map prod_map
       on lower(r.product_id) = prod_map.title_key
  );
[0m23:41:09.526126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m23:41:09.527334 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.528606 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

with account_name_map as (
    select
        lower(concat_ws(' ', first_name, last_name)) as full_name_key,
        min(id)                                      as account_id
    from "dw_northwind_metabase"."public"."accounts"
    where first_name is not null and last_name is not null
    group by 1
),
product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar
        else 'METABASE_' || upper(trim(o.user_id))
    end                                       as customer_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(o.product_id))
    end                                       as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join account_name_map acc_map
       on lower(o.user_id) = acc_map.full_name_key
left join product_map prod_map
       on lower(o.product_id) = prod_map.title_key
  );
[0m23:41:09.545204 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m23:41:09.557216 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.558403 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m23:41:09.559391 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews" rename to "stg_metabase_reviews__dbt_backup"
[0m23:41:09.565713 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.566762 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m23:41:09.575237 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:41:09.585875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m23:41:09.587900 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.592557 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.593609 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp" rename to "stg_metabase_reviews"
[0m23:41:09.594370 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m23:41:09.596180 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:09.596862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:41:09.623474 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:41:09.626694 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:41:09.627773 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.628391 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.629132 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:41:09.629717 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:41:09.631562 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:41:09.641495 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup"
[0m23:41:09.650742 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:41:09.651413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m23:41:09.651983 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup" cascade
[0m23:41:09.655067 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m23:41:09.656275 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:41:09.656860 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m23:41:09.660289 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:41:09.660938 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:41:09.664108 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_reviews: Close
[0m23:41:09.665850 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m23:41:09.674898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8E0CB650>]}
[0m23:41:09.675809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658fd8e3-4656-4b60-baa7-5789d4cb89fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8E0D3D80>]}
[0m23:41:09.677013 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dw_stg.stg_metabase_reviews ................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:41:09.678291 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:41:09.679565 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:41:09.680488 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:41:09.683049 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:09.683814 [debug] [MainThread]: On master: BEGIN
[0m23:41:09.684274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:09.762725 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m23:41:09.763467 [debug] [MainThread]: On master: COMMIT
[0m23:41:09.763963 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:09.764409 [debug] [MainThread]: On master: COMMIT
[0m23:41:09.765353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:09.766141 [debug] [MainThread]: On master: Close
[0m23:41:09.767149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:09.768061 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:41:09.768775 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:41:09.769781 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:41:09.770592 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:41:09.771379 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:41:09.772081 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m23:41:09.772803 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_reviews' was properly closed.
[0m23:41:09.773646 [info ] [MainThread]: 
[0m23:41:09.774283 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m23:41:09.777059 [debug] [MainThread]: Command end result
[0m23:41:09.851259 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:41:09.856245 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:41:09.868548 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:41:09.869332 [info ] [MainThread]: 
[0m23:41:09.870044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:09.870931 [info ] [MainThread]: 
[0m23:41:09.872055 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:41:09.874964 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:09.874362 after 3.56 seconds
[0m23:41:09.875987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC888F91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8E3A7B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8DB741D0>]}
[0m23:41:09.876924 [debug] [MainThread]: Flushing usage events
[0m23:41:11.270029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:22.105808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D213EB0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D214758B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D214D98E10>]}


============================== 23:41:22.112944 | df48a18e-899d-4111-9dab-c4aa6d247a8b ==============================
[0m23:41:22.112944 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:41:22.114666 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select fact_sales fact_reviews', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m23:41:22.336744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2140E9F30>]}
[0m23:41:22.419385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D214E1FDF0>]}
[0m23:41:22.421242 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:41:22.882657 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:41:23.154458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:23.155377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:23.237773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D21611F350>]}
[0m23:41:23.404550 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:41:23.411533 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:41:23.526003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2108A8F50>]}
[0m23:41:23.526704 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:41:23.527330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D214FE19B0>]}
[0m23:41:23.532767 [info ] [MainThread]: 
[0m23:41:23.533693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:23.534338 [info ] [MainThread]: 
[0m23:41:23.535268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:23.540645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:41:23.761812 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:41:23.762335 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:41:23.762723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:23.841298 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.078 seconds
[0m23:41:23.843247 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:41:23.849211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:41:23.857006 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:41:23.857723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m23:41:23.858262 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:41:23.861157 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:41:23.861930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:41:23.862437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:23.863149 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:41:23.863812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:41:23.866315 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:41:23.867230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:23.869581 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:41:23.870173 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:41:23.870907 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:41:23.871363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:23.871798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:23.946748 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m23:41:23.947644 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:41:23.948721 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:41:23.958332 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m23:41:23.959072 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m23:41:23.959595 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:41:23.960177 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:41:23.960871 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:41:23.961698 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:41:23.962318 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:41:23.964986 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:41:23.966091 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:41:23.966680 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m23:41:23.967383 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:41:23.968426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:41:23.969092 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:41:23.973218 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:41:23.973868 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:41:23.974390 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.012 seconds
[0m23:41:23.975178 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:41:23.977066 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:41:23.978971 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:41:23.979491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:23.980562 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:41:23.981143 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:41:23.982200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m23:41:23.983442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:41:23.986471 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:41:23.990254 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.016 seconds
[0m23:41:23.994587 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:41:23.995332 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:41:23.998308 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:41:23.999137 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:41:23.999699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:24.000421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:24.001117 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:41:24.002958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_snapshots)
[0m23:41:24.009608 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:41:24.010321 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:41:24.010952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:24.059283 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m23:41:24.060002 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:41:24.060563 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:41:24.073291 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:41:24.075545 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:41:24.076624 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:41:24.085986 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m23:41:24.086640 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:41:24.087456 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:41:24.094305 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m23:41:24.095120 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:41:24.095680 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:41:24.096989 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m23:41:24.097574 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:41:24.098050 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:41:24.099242 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m23:41:24.100870 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:41:24.101540 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:41:24.106037 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m23:41:24.107664 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:41:24.108181 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m23:41:24.108618 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:41:24.110261 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:41:24.111127 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:41:24.119748 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.120245 [debug] [MainThread]: On master: BEGIN
[0m23:41:24.120629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:24.176163 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m23:41:24.176655 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.177138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:41:24.188172 [debug] [MainThread]: SQL status: SELECT 24 in 0.010 seconds
[0m23:41:24.190968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2167B1300>]}
[0m23:41:24.191513 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:24.192204 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.192615 [debug] [MainThread]: On master: BEGIN
[0m23:41:24.193447 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:24.193849 [debug] [MainThread]: On master: COMMIT
[0m23:41:24.194219 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.194582 [debug] [MainThread]: On master: COMMIT
[0m23:41:24.195162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:24.195572 [debug] [MainThread]: On master: Close
[0m23:41:24.202646 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_reviews
[0m23:41:24.203591 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m23:41:24.204313 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.fact_reviews ................................ [RUN]
[0m23:41:24.205074 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m23:41:24.205954 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_reviews'
[0m23:41:24.207474 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m23:41:24.208237 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_reviews
[0m23:41:24.209021 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m23:41:24.221339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.232048 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_reviews
[0m23:41:24.228248 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m23:41:24.323112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.324648 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m23:41:24.330521 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.332928 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m23:41:24.333547 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: BEGIN
[0m23:41:24.334259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:24.335771 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:41:24.336590 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m23:41:24.337220 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:24.411021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m23:41:24.411625 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.412205 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de reviews p√∫blicos (produtos Metabase).
select
    review_nk,
    source_system,
    source_review_id,
    product_nk,
    source_product_id,
    reviewer_name,
    rating_score,
    created_at,
    review_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
  );
  
[0m23:41:24.416335 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m23:41:24.416937 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:41:24.417559 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m23:41:24.589418 [debug] [Thread-1 (]: SQL status: SELECT 1112 in 0.176 seconds
[0m23:41:24.604195 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.604913 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews" rename to "fact_reviews__dbt_backup"
[0m23:41:24.606221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.610286 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.611457 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp" rename to "fact_reviews"
[0m23:41:24.613019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.647128 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:41:24.648111 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.648907 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m23:41:24.651894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:41:24.663842 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup"
[0m23:41:24.676982 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m23:41:24.677665 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup" cascade
[0m23:41:24.686477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m23:41:24.690039 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: Close
[0m23:41:24.693586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D216A44D10>]}
[0m23:41:24.695487 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw_dw.fact_reviews ........................... [[32mSELECT 1112[0m in 0.49s]
[0m23:41:24.697313 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_reviews
[0m23:41:25.104811 [debug] [Thread-2 (]: SQL status: SELECT 20915 in 0.686 seconds
[0m23:41:25.110354 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:41:25.111021 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m23:41:25.112194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:25.116940 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:41:25.117578 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m23:41:25.119055 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:25.121265 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:41:25.122103 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:41:25.122595 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m23:41:25.126506 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:41:25.129376 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m23:41:25.130454 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m23:41:25.131156 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m23:41:25.138664 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:41:25.140662 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m23:41:25.141674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df48a18e-899d-4111-9dab-c4aa6d247a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D216884CB0>]}
[0m23:41:25.142628 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 0.94s]
[0m23:41:25.143704 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m23:41:25.146886 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:25.147764 [debug] [MainThread]: On master: BEGIN
[0m23:41:25.148580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:25.231652 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m23:41:25.232217 [debug] [MainThread]: On master: COMMIT
[0m23:41:25.232801 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:25.233404 [debug] [MainThread]: On master: COMMIT
[0m23:41:25.234207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:25.234720 [debug] [MainThread]: On master: Close
[0m23:41:25.235582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:25.236440 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:41:25.237142 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:41:25.237631 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m23:41:25.238226 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:41:25.239027 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:41:25.239711 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_reviews' was properly closed.
[0m23:41:25.240344 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m23:41:25.240907 [info ] [MainThread]: 
[0m23:41:25.241411 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m23:41:25.242745 [debug] [MainThread]: Command end result
[0m23:41:25.315969 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:41:25.319978 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:41:25.328489 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:41:25.329114 [info ] [MainThread]: 
[0m23:41:25.329822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:25.330707 [info ] [MainThread]: 
[0m23:41:25.331898 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:41:25.334515 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:25.334237 after 3.37 seconds
[0m23:41:25.335261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D216A4B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2168C39B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D214F741D0>]}
[0m23:41:25.335816 [debug] [MainThread]: Flushing usage events
[0m23:41:26.470643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:38.282591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B026B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B02F58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B04598E10>]}


============================== 23:41:38.296857 | f4e854d3-6ef4-47b3-bd2b-03e5010be7ca ==============================
[0m23:41:38.296857 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:41:38.298486 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt test --select fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m23:41:38.688652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4e854d3-6ef4-47b3-bd2b-03e5010be7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B028E9F30>]}
[0m23:41:38.877385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4e854d3-6ef4-47b3-bd2b-03e5010be7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B04627DF0>]}
[0m23:41:38.879504 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:41:39.511689 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:41:39.797969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:39.798875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:39.876231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4e854d3-6ef4-47b3-bd2b-03e5010be7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B0491F350>]}
[0m23:41:40.029722 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:41:40.034554 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:41:40.178329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4e854d3-6ef4-47b3-bd2b-03e5010be7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B04E266C0>]}
[0m23:41:40.179604 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:41:40.180400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e854d3-6ef4-47b3-bd2b-03e5010be7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B04764D70>]}
[0m23:41:40.188905 [info ] [MainThread]: 
[0m23:41:40.189933 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:40.190648 [info ] [MainThread]: 
[0m23:41:40.191692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:40.202180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:41:40.212091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:41:40.223525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:41:40.224587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m23:41:40.384272 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:41:40.385109 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:41:40.385905 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:41:40.386663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:40.388293 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:41:40.389395 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:41:40.390034 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:41:40.390935 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:41:40.391490 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:41:40.392049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:40.392794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:40.393384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:40.510347 [debug] [ThreadPool]: SQL status: BEGIN in 0.124 seconds
[0m23:41:40.511200 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:41:40.512125 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:41:40.517802 [debug] [ThreadPool]: SQL status: BEGIN in 0.126 seconds
[0m23:41:40.518459 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:41:40.518960 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:41:40.527770 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m23:41:40.530545 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:41:40.531478 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:41:40.532492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:41:40.533331 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m23:41:40.537482 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:41:40.540753 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:41:40.541468 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:41:40.542380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:40.543123 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:41:40.545284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_stg)
[0m23:41:40.554344 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:41:40.555323 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:41:40.556173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:40.618443 [debug] [ThreadPool]: SQL status: BEGIN in 0.225 seconds
[0m23:41:40.619408 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:41:40.620927 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:41:40.621894 [debug] [ThreadPool]: SQL status: BEGIN in 0.229 seconds
[0m23:41:40.622884 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:41:40.623828 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:41:40.635863 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m23:41:40.640395 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:41:40.641327 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m23:41:40.644157 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:41:40.645076 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:41:40.646306 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:41:40.647686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:41:40.652358 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:41:40.653837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_snapshots)
[0m23:41:40.654691 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:41:40.659551 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:41:40.660524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:40.661440 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:41:40.662589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:40.685568 [debug] [ThreadPool]: SQL status: BEGIN in 0.129 seconds
[0m23:41:40.686589 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m23:41:40.687545 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:41:40.688611 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:41:40.689732 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:41:40.690792 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:41:40.706204 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.014 seconds
[0m23:41:40.710524 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:41:40.711446 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m23:41:40.714297 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:41:40.715151 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:41:40.716218 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:41:40.780037 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m23:41:40.781088 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:41:40.782050 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:41:40.785677 [debug] [ThreadPool]: SQL status: BEGIN in 0.123 seconds
[0m23:41:40.787399 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:41:40.789196 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:41:40.802687 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:41:40.807066 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:41:40.808454 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:41:40.809371 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m23:41:40.812732 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:41:40.814445 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:41:40.832670 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:40.833780 [debug] [MainThread]: On master: BEGIN
[0m23:41:40.836089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:40.934634 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m23:41:40.935235 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:40.935783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:41:40.949395 [debug] [MainThread]: SQL status: SELECT 24 in 0.013 seconds
[0m23:41:40.952540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e854d3-6ef4-47b3-bd2b-03e5010be7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B050E9090>]}
[0m23:41:40.953492 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:40.954515 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:40.955088 [debug] [MainThread]: On master: BEGIN
[0m23:41:40.956043 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:40.956534 [debug] [MainThread]: On master: COMMIT
[0m23:41:40.956984 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:40.957386 [debug] [MainThread]: On master: COMMIT
[0m23:41:40.957964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:40.958411 [debug] [MainThread]: On master: Close
[0m23:41:40.965481 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:41:40.966138 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:41:40.966704 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:41:40.967238 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:41:40.967846 [info ] [Thread-4 (]: 4 of 21 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m23:41:40.968607 [info ] [Thread-3 (]: 3 of 21 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m23:41:40.969398 [info ] [Thread-1 (]: 1 of 21 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m23:41:40.970693 [info ] [Thread-2 (]: 2 of 21 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m23:41:40.972117 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m23:41:40.973169 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m23:41:40.973988 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m23:41:40.974734 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m23:41:40.975353 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:41:40.975954 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:41:40.976518 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:41:40.977056 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:41:41.014354 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:41:41.016082 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:41:41.021971 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:41:41.028015 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:41:41.030130 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:41:41.063232 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:41:41.064547 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:41:41.065339 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:41:41.065950 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:41:41.077773 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:41:41.080591 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:41:41.084336 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:41:41.085061 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:41:41.086338 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m23:41:41.087782 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:41:41.089361 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:41:41.090666 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m23:41:41.091840 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:41:41.092559 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:41:41.093681 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m23:41:41.095142 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:41:41.096500 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:41.097625 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m23:41:41.098983 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:41.185090 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m23:41:41.186128 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m23:41:41.187426 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.195721 [debug] [Thread-4 (]: SQL status: BEGIN in 0.103 seconds
[0m23:41:41.196772 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m23:41:41.197839 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.201372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m23:41:41.202406 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m23:41:41.203563 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.205314 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:41:41.206549 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:41.215753 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m23:41:41.219192 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m23:41:41.220208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.121 seconds
[0m23:41:41.221272 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m23:41:41.222320 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m23:41:41.223265 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m23:41:41.224127 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.225612 [info ] [Thread-4 (]: 4 of 21 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.25s]
[0m23:41:41.229043 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m23:41:41.230203 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:41:41.226961 [info ] [Thread-3 (]: 3 of 21 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.25s]
[0m23:41:41.232951 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m23:41:41.231236 [info ] [Thread-4 (]: 5 of 21 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m23:41:41.234230 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:41.235154 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:41:41.236419 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m23:41:41.237557 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m23:41:41.241283 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m23:41:41.242405 [info ] [Thread-3 (]: 6 of 21 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m23:41:41.245121 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m23:41:41.245979 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:41:41.246924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m23:41:41.247590 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m23:41:41.256818 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:41:41.257598 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m23:41:41.258183 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:41:41.267459 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:41:41.259425 [info ] [Thread-2 (]: 2 of 21 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.28s]
[0m23:41:41.270096 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m23:41:41.271453 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:41:41.273878 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:41:41.278142 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:41:41.266391 [info ] [Thread-1 (]: 1 of 21 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.29s]
[0m23:41:41.273026 [info ] [Thread-2 (]: 7 of 21 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m23:41:41.279874 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:41:41.281088 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m23:41:41.282482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m23:41:41.287042 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:41:41.288288 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:41:41.289021 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:41:41.289750 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:41:41.290554 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m23:41:41.291354 [info ] [Thread-1 (]: 8 of 21 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m23:41:41.297601 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:41:41.298829 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:41.300117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m23:41:41.301345 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:41:41.302824 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:41:41.304112 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m23:41:41.312497 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:41:41.313520 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:41:41.314206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:41.320138 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:41:41.323072 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:41:41.328449 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:41:41.330211 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:41:41.331353 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m23:41:41.332412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:41.334059 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:41:41.335267 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m23:41:41.336191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:41.397396 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m23:41:41.398445 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m23:41:41.399383 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.404490 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:41:41.408126 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m23:41:41.409519 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m23:41:41.411228 [info ] [Thread-4 (]: 5 of 21 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.17s]
[0m23:41:41.413034 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m23:41:41.414217 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:41:41.415386 [info ] [Thread-4 (]: 9 of 21 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m23:41:41.416614 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m23:41:41.417605 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:41:41.426624 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:41:41.428901 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:41:41.433815 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:41:41.435770 [debug] [Thread-3 (]: SQL status: BEGIN in 0.121 seconds
[0m23:41:41.437084 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m23:41:41.439789 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.441477 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:41:41.442648 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m23:41:41.443740 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m23:41:41.444685 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m23:41:41.445269 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:41:41.445933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:41.446586 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.447311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.111 seconds
[0m23:41:41.449530 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m23:41:41.450498 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m23:41:41.451348 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.452055 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m23:41:41.453757 [info ] [Thread-3 (]: 6 of 21 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.21s]
[0m23:41:41.455647 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m23:41:41.456919 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:41:41.458193 [info ] [Thread-3 (]: 10 of 21 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m23:41:41.459712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m23:41:41.460830 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:41:41.471241 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:41:41.472595 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:41:41.474074 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:41:41.477463 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m23:41:41.480840 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m23:41:41.482177 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m23:41:41.482932 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m23:41:41.483543 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:41:41.488553 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:41:41.489621 [info ] [Thread-2 (]: 7 of 21 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.21s]
[0m23:41:41.493122 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m23:41:41.494303 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:41:41.490636 [info ] [Thread-1 (]: 8 of 21 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.19s]
[0m23:41:41.497103 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:41:41.498445 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m23:41:41.495494 [info ] [Thread-2 (]: 11 of 21 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:41:41.499507 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m23:41:41.500356 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:41:41.501295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m23:41:41.501918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:41.502602 [info ] [Thread-1 (]: 12 of 21 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:41:41.503571 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:41:41.505588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m23:41:41.520735 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:41:41.533601 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:41:41.539569 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:41:41.544440 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:41:41.550312 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:41:41.552400 [debug] [Thread-4 (]: SQL status: BEGIN in 0.106 seconds
[0m23:41:41.553427 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m23:41:41.554483 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:41:41.555573 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.562258 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:41:41.563640 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:41:41.564652 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m23:41:41.565718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:41.568249 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:41:41.569325 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m23:41:41.570291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:41.574350 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:41:41.578001 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m23:41:41.579493 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m23:41:41.581514 [info ] [Thread-4 (]: 9 of 21 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.16s]
[0m23:41:41.583332 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m23:41:41.584591 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:41:41.585627 [info ] [Thread-4 (]: 13 of 21 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:41:41.586798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m23:41:41.587952 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:41:41.600508 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:41:41.603892 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:41:41.610076 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:41:41.612215 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m23:41:41.613403 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m23:41:41.614706 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.615885 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:41:41.616929 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m23:41:41.617984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:41.628243 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:41:41.631922 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m23:41:41.633305 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m23:41:41.634967 [info ] [Thread-3 (]: 10 of 21 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.18s]
[0m23:41:41.636980 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m23:41:41.638377 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:41:41.639546 [info ] [Thread-3 (]: 14 of 21 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:41:41.641039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m23:41:41.642197 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:41:41.656568 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:41:41.659081 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:41:41.664588 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:41:41.667146 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:41:41.668260 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m23:41:41.669438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:41.709904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m23:41:41.711030 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m23:41:41.712182 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.718919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.149 seconds
[0m23:41:41.720300 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m23:41:41.721515 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.725491 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:41:41.729130 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m23:41:41.730553 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m23:41:41.732426 [info ] [Thread-1 (]: 12 of 21 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.23s]
[0m23:41:41.734185 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m23:41:41.735745 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:41:41.737415 [info ] [Thread-1 (]: 15 of 21 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m23:41:41.739896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m23:41:41.741448 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:41:41.751923 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:41:41.753789 [debug] [Thread-4 (]: SQL status: BEGIN in 0.136 seconds
[0m23:41:41.754993 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m23:41:41.756456 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.758020 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:41:41.759222 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.036 seconds
[0m23:41:41.763698 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:41:41.766831 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m23:41:41.768421 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m23:41:41.772273 [debug] [Thread-3 (]: SQL status: BEGIN in 0.103 seconds
[0m23:41:41.773681 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:41:41.774997 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m23:41:41.771115 [info ] [Thread-2 (]: 11 of 21 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.27s]
[0m23:41:41.776715 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m23:41:41.778057 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.778916 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:41:41.779890 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m23:41:41.780758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:41.783795 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m23:41:41.784670 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:41:41.785925 [info ] [Thread-2 (]: 16 of 21 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m23:41:41.787196 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m23:41:41.788614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m23:41:41.789995 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:41:41.791211 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:41:41.796020 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m23:41:41.792821 [info ] [Thread-4 (]: 13 of 21 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.21s]
[0m23:41:41.810673 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:41:41.812367 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m23:41:41.813437 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m23:41:41.814946 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:41:41.816476 [info ] [Thread-4 (]: 17 of 21 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m23:41:41.817958 [info ] [Thread-3 (]: 14 of 21 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.18s]
[0m23:41:41.820217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m23:41:41.822025 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m23:41:41.823003 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:41:41.824239 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:41:41.825406 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:41:41.830791 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:41:41.842768 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:41:41.843823 [info ] [Thread-3 (]: 18 of 21 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m23:41:41.845853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m23:41:41.846985 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:41:41.864205 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:41:41.865570 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:41:41.867034 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m23:41:41.868414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:41.869878 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:41:41.876059 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:41:41.878475 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:41:41.896828 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:41:41.898868 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:41:41.899981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m23:41:41.901114 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m23:41:41.902250 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m23:41:41.903376 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:41.904601 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:41:41.905671 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:41.907225 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m23:41:41.908463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:41.928155 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:41:41.931810 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m23:41:41.933133 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m23:41:41.935038 [info ] [Thread-1 (]: 15 of 21 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.20s]
[0m23:41:41.941397 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m23:41:41.942870 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:41:41.944050 [info ] [Thread-1 (]: 19 of 21 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m23:41:41.945308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m23:41:41.946392 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:41:41.955673 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:41:41.957982 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:41:41.963551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:41:41.966119 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:41:41.967165 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m23:41:41.968634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:41.980277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.112 seconds
[0m23:41:41.981376 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m23:41:41.982461 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:42.009055 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.025 seconds
[0m23:41:42.013228 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m23:41:42.014705 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m23:41:42.016949 [info ] [Thread-2 (]: 16 of 21 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.23s]
[0m23:41:42.018833 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m23:41:42.019973 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:41:42.021161 [info ] [Thread-2 (]: 20 of 21 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m23:41:42.022759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m23:41:42.023929 [debug] [Thread-4 (]: SQL status: BEGIN in 0.121 seconds
[0m23:41:42.024875 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:41:42.025979 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m23:41:42.034419 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:41:42.035478 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m23:41:42.037627 [debug] [Thread-3 (]: SQL status: BEGIN in 0.129 seconds
[0m23:41:42.038780 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m23:41:42.040321 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:41:42.041526 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:41:42.047117 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:41:42.049738 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:41:42.050789 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m23:41:42.051943 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:42.058791 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m23:41:42.062476 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m23:41:42.063880 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m23:41:42.065793 [info ] [Thread-4 (]: 17 of 21 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.25s]
[0m23:41:42.067651 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m23:41:42.068789 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:41:42.069994 [info ] [Thread-4 (]: 21 of 21 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m23:41:42.071392 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m23:41:42.072554 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:41:42.082102 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:41:42.084633 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:41:42.091476 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:41:42.093471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.125 seconds
[0m23:41:42.094625 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m23:41:42.095906 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:41:42.097237 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:41:42.098436 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.057 seconds
[0m23:41:42.099423 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m23:41:42.103366 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m23:41:42.104482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:42.105607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:42.106851 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m23:41:42.110369 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m23:41:42.113213 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m23:41:42.112314 [info ] [Thread-3 (]: 18 of 21 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.27s]
[0m23:41:42.115163 [info ] [Thread-1 (]: 19 of 21 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.17s]
[0m23:41:42.116978 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m23:41:42.118644 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m23:41:42.153182 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m23:41:42.154286 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m23:41:42.155335 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:41:42.172752 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:41:42.175282 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m23:41:42.176585 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m23:41:42.178399 [info ] [Thread-2 (]: 20 of 21 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.16s]
[0m23:41:42.180081 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m23:41:42.199981 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m23:41:42.200724 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m23:41:42.201827 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:41:42.207627 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:42.209802 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m23:41:42.210664 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m23:41:42.211682 [info ] [Thread-4 (]: 21 of 21 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.14s]
[0m23:41:42.213255 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m23:41:42.216016 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:42.217394 [debug] [MainThread]: On master: BEGIN
[0m23:41:42.218291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:42.329541 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m23:41:42.331402 [debug] [MainThread]: On master: COMMIT
[0m23:41:42.331938 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:42.332395 [debug] [MainThread]: On master: COMMIT
[0m23:41:42.333162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:42.333784 [debug] [MainThread]: On master: Close
[0m23:41:42.334573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:42.335333 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:41:42.336238 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m23:41:42.337085 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:41:42.338100 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:41:42.339039 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m23:41:42.339752 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd' was properly closed.
[0m23:41:42.340242 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e' was properly closed.
[0m23:41:42.340686 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m23:41:42.341232 [info ] [MainThread]: 
[0m23:41:42.341843 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m23:41:42.347952 [debug] [MainThread]: Command end result
[0m23:41:42.416220 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:41:42.422228 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:41:42.436256 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:41:42.437300 [info ] [MainThread]: 
[0m23:41:42.438432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:42.439572 [info ] [MainThread]: 
[0m23:41:42.441038 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=21
[0m23:41:42.443994 [debug] [MainThread]: Command `dbt test` succeeded at 23:41:42.443725 after 4.30 seconds
[0m23:41:42.444726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B043E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B04DC9860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B04DCBC20>]}
[0m23:41:42.447497 [debug] [MainThread]: Flushing usage events
[0m23:41:43.616387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:46.651616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45D6C0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45F058910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45F69BED0>]}


============================== 23:54:46.659075 | dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959 ==============================
[0m23:54:46.659075 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:54:46.659833 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m23:54:47.061571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45D8F9F30>]}
[0m23:54:47.159155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45F723DF0>]}
[0m23:54:47.161056 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:54:47.634313 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:54:47.941929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:47.942333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:48.014443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FA23350>]}
[0m23:54:48.145726 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:54:48.151060 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:54:48.291974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45B1A8F50>]}
[0m23:54:48.292784 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m23:54:48.293540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45F8DD9B0>]}
[0m23:54:48.297716 [info ] [MainThread]: 
[0m23:54:48.298484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:48.299086 [info ] [MainThread]: 
[0m23:54:48.300111 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:48.308089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m23:54:48.523316 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m23:54:48.523754 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m23:54:48.524064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:48.612639 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.088 seconds
[0m23:54:48.614220 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m23:54:48.617994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m23:54:48.623818 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:54:48.624374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m23:54:48.624799 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m23:54:48.627058 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:54:48.627471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:48.627946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m23:54:48.628334 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m23:54:48.629087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m23:54:48.630899 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:54:48.631542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:48.633375 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:54:48.633826 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m23:54:48.634427 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m23:54:48.634826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:48.635439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:48.688670 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m23:54:48.689107 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m23:54:48.689450 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m23:54:48.690495 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m23:54:48.690904 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m23:54:48.691260 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m23:54:48.693446 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m23:54:48.693867 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m23:54:48.694298 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m23:54:48.699511 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m23:54:48.700094 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m23:54:48.702020 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m23:54:48.702956 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m23:54:48.703547 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m23:54:48.705041 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m23:54:48.705572 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m23:54:48.705945 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.011 seconds
[0m23:54:48.706394 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m23:54:48.708226 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m23:54:48.708772 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m23:54:48.709481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2b)
[0m23:54:48.713185 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:54:48.713960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_snapshots)
[0m23:54:48.714437 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m23:54:48.714936 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m23:54:48.716672 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:54:48.717147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:48.717542 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m23:54:48.718116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_sales)
[0m23:54:48.720612 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m23:54:48.721172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:48.723182 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:54:48.725312 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m23:54:48.725980 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m23:54:48.726464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:48.726913 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m23:54:48.728029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m23:54:48.734455 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:54:48.735077 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m23:54:48.735551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:48.781584 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m23:54:48.782087 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m23:54:48.782586 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m23:54:48.785098 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m23:54:48.785558 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m23:54:48.785943 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m23:54:48.790302 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m23:54:48.790899 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m23:54:48.791428 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m23:54:48.791973 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:54:48.793381 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m23:54:48.794117 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m23:54:48.794749 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m23:54:48.797010 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m23:54:48.797758 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m23:54:48.798273 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m23:54:48.798699 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m23:54:48.799252 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m23:54:48.801572 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:54:48.803003 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m23:54:48.804011 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m23:54:48.808974 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:54:48.810287 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m23:54:48.810869 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m23:54:48.817072 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.817451 [debug] [MainThread]: On master: BEGIN
[0m23:54:48.817725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:48.868628 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m23:54:48.869165 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.869740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:54:48.883427 [debug] [MainThread]: SQL status: SELECT 24 in 0.013 seconds
[0m23:54:48.886486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4600B1710>]}
[0m23:54:48.887267 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:48.887971 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.888383 [debug] [MainThread]: On master: BEGIN
[0m23:54:48.889150 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:54:48.889557 [debug] [MainThread]: On master: COMMIT
[0m23:54:48.889925 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.890269 [debug] [MainThread]: On master: COMMIT
[0m23:54:48.890812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:48.891211 [debug] [MainThread]: On master: Close
[0m23:54:48.901211 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:54:48.902350 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:54:48.905260 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:54:48.905727 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:54:48.906297 [info ] [Thread-4 (]: 4 of 13 START sql view model dw_stg.stg_metabase_invoices ...................... [RUN]
[0m23:54:48.908842 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_invoices'
[0m23:54:48.909320 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:54:48.906884 [info ] [Thread-1 (]: 1 of 13 START sql view model dw_stg.stg_metabase_accounts ...................... [RUN]
[0m23:54:48.917840 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:48.907389 [info ] [Thread-2 (]: 2 of 13 START sql view model dw_stg.stg_metabase_analytic_events ............... [RUN]
[0m23:54:48.919001 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m23:54:48.908087 [info ] [Thread-3 (]: 3 of 13 START sql view model dw_stg.stg_metabase_feedback ...................... [RUN]
[0m23:54:48.920732 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_analytic_events'
[0m23:54:48.921339 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:54:48.921946 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_feedback'
[0m23:54:48.922346 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:54:48.925826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:48.926378 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:54:48.932785 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:48.937797 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:48.939132 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:54:48.990561 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:54:48.999944 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.000765 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.001371 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:54:49.001770 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:54:49.006431 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.012357 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.013777 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.014474 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: BEGIN
[0m23:54:49.015354 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:54:49.016431 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.017143 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: BEGIN
[0m23:54:49.017897 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:54:49.019218 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.020519 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: BEGIN
[0m23:54:49.021462 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.022505 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:54:49.023243 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m23:54:49.024232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:49.090454 [debug] [Thread-4 (]: SQL status: BEGIN in 0.075 seconds
[0m23:54:49.091352 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.092268 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp"
    
    
  as (
    

-- Faturas SaaS (Metabase) com valores normalizados e v√≠nculo ao cliente.
select
    'METABASE'                               as source_system,
    i.id                                     as source_invoice_id,
    'METABASE_' || i.id                      as invoice_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else null
    end                                      as customer_nk,
    i.account_id                             as source_account_id,
    i.plan                                   as plan_name,
    cast(i.payment as numeric(12,4))         as payment_amount,
    i.expected_invoice                       as expected_invoice_flag,
    case
        when i.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then i.date_received::timestamp
        else null
    end                                      as date_received,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."invoices" i
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(acc.email) = lower(i.account_id)
  );
[0m23:54:49.097068 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m23:54:49.097838 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.098689 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp"
    
    
  as (
    

-- Feedbacks recebidos via canais de suporte Metabase.
select
    'METABASE'                               as source_system,
    f.id                                     as source_feedback_id,
    'METABASE_FB_' || f.id                   as feedback_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else null
    end                                      as customer_nk,
    f.account_id                             as source_account_id,
    f.email                                  as contact_email,
    cast(f.rating as numeric(5,2))           as rating_score,
    f.rating_mapped                          as rating_label,
    case
        when f.date_received ~ '^\d{4}-\d{2}-\d{2}'
            then f.date_received::timestamp
        else null
    end                                      as date_received,
    f.body                                   as feedback_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."feedback" f
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(acc.email) = lower(f.account_id)
  );
[0m23:54:49.102223 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m23:54:49.103177 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.104681 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp"
    
    
  as (
    

-- Eventos de analytics (produto/app) para an√°lises de comportamento.
select
    'METABASE'                               as source_system,
    ae.id                                    as source_event_id,
    'METABASE_EVT_' || ae.id                 as event_nk,
    case
        when acc.id is not null then 'METABASE_' || acc.id::varchar
        else null
    end                                      as customer_nk,
    ae.account_id                            as source_account_id,
    ae.event                                 as event_name,
    case
        when ae."timestamp" ~ '^\d{4}-\d{2}-\d{2}'
            then ae."timestamp"::timestamp
        else null
    end                                      as event_timestamp,
    ae.page_url                              as page_url,
    ae.button_label                          as button_label,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."analyticevents" ae
left join "dw_northwind_metabase"."public"."accounts" acc
       on lower(acc.email) = lower(ae.account_id)
  );
[0m23:54:49.111429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m23:54:49.112365 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.113205 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m23:54:49.114076 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    case
        when a.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.created_at::timestamp
        else null
    end                                   as created_at,
    case
        when a.trial_ends_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.trial_ends_at::timestamp
        else null
    end                                   as trial_ends_at,
    case
        when a.canceled_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.canceled_at::timestamp
        else null
    end                                   as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m23:54:49.115061 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:54:49.123559 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.124057 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m23:54:49.127352 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.128024 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices" rename to "stg_metabase_invoices__dbt_backup"
[0m23:54:49.137295 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.138443 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:54:49.139098 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback" rename to "stg_metabase_feedback__dbt_backup"
[0m23:54:49.139869 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events" rename to "stg_metabase_analytic_events__dbt_backup"
[0m23:54:49.143827 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.144494 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:54:49.145229 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m23:54:49.145701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.146357 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.151380 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.158461 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.159193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:54:49.164295 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.165370 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_tmp" rename to "stg_metabase_invoices"
[0m23:54:49.166220 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_tmp" rename to "stg_metabase_analytic_events"
[0m23:54:49.172359 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.173655 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_tmp" rename to "stg_metabase_feedback"
[0m23:54:49.174862 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m23:54:49.175739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.176584 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:54:49.177559 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.192339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m23:54:49.203930 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: COMMIT
[0m23:54:49.206088 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: COMMIT
[0m23:54:49.209903 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: COMMIT
[0m23:54:49.212304 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m23:54:49.212942 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.213603 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.214195 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.214820 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.215451 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: COMMIT
[0m23:54:49.215993 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: COMMIT
[0m23:54:49.216553 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: COMMIT
[0m23:54:49.217084 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m23:54:49.219728 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:54:49.230374 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_backup"
[0m23:54:49.231033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m23:54:49.231609 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m23:54:49.240982 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m23:54:49.241608 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m23:54:49.245197 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m23:54:49.248947 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_backup"
[0m23:54:49.249612 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_analytic_events"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events__dbt_backup" cascade
[0m23:54:49.253850 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_backup"
[0m23:54:49.255012 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m23:54:49.256098 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_invoices"
[0m23:54:49.257302 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_feedback"
[0m23:54:49.257968 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m23:54:49.258504 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_invoices"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices__dbt_backup" cascade
[0m23:54:49.259116 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_feedback"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback__dbt_backup" cascade
[0m23:54:49.262531 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:54:49.263325 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:54:49.267034 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_analytic_events: Close
[0m23:54:49.267640 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:54:49.268123 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:54:49.270663 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_invoices: Close
[0m23:54:49.273367 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_feedback: Close
[0m23:54:49.278074 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m23:54:49.287012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4602E90D0>]}
[0m23:54:49.288034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FE3BAC0>]}
[0m23:54:49.288569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F460186830>]}
[0m23:54:49.290048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45D882210>]}
[0m23:54:49.289556 [info ] [Thread-2 (]: 2 of 13 OK created sql view model dw_stg.stg_metabase_analytic_events .......... [[32mCREATE VIEW[0m in 0.35s]
[0m23:54:49.291198 [info ] [Thread-4 (]: 4 of 13 OK created sql view model dw_stg.stg_metabase_invoices ................. [[32mCREATE VIEW[0m in 0.37s]
[0m23:54:49.292203 [info ] [Thread-3 (]: 3 of 13 OK created sql view model dw_stg.stg_metabase_feedback ................. [[32mCREATE VIEW[0m in 0.36s]
[0m23:54:49.294400 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m23:54:49.293320 [info ] [Thread-1 (]: 1 of 13 OK created sql view model dw_stg.stg_metabase_accounts ................. [[32mCREATE VIEW[0m in 0.36s]
[0m23:54:49.295491 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_invoices
[0m23:54:49.296393 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_feedback
[0m23:54:49.297053 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:54:49.297946 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m23:54:49.298466 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_people
[0m23:54:49.299056 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_products
[0m23:54:49.299866 [info ] [Thread-2 (]: 5 of 13 START sql view model dw_stg.stg_metabase_orders ........................ [RUN]
[0m23:54:49.301080 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:54:49.302116 [info ] [Thread-4 (]: 6 of 13 START sql view model dw_stg.stg_metabase_people ........................ [RUN]
[0m23:54:49.303813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_analytic_events, now model.dw_northwind_metabase.stg_metabase_orders)
[0m23:54:49.302920 [info ] [Thread-3 (]: 7 of 13 START sql view model dw_stg.stg_metabase_products ...................... [RUN]
[0m23:54:49.305434 [info ] [Thread-1 (]: 8 of 13 START sql view model dw_stg.stg_metabase_reviews ....................... [RUN]
[0m23:54:49.307443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_invoices, now model.dw_northwind_metabase.stg_metabase_people)
[0m23:54:49.308279 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m23:54:49.308989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_feedback, now model.dw_northwind_metabase.stg_metabase_products)
[0m23:54:49.309842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_accounts, now model.dw_northwind_metabase.stg_metabase_reviews)
[0m23:54:49.310748 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_people
[0m23:54:49.316880 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.317638 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_products
[0m23:54:49.319324 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:54:49.325422 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.330401 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.335941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.339081 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m23:54:49.344870 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.346144 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_products
[0m23:54:49.346944 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_people
[0m23:54:49.355319 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.360483 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.362464 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.364112 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:54:49.365060 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m23:54:49.375743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.376768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:49.378944 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.380800 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.381481 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: BEGIN
[0m23:54:49.382295 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: BEGIN
[0m23:54:49.383021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:49.384176 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.385066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:49.385989 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: BEGIN
[0m23:54:49.387289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:49.450692 [debug] [Thread-2 (]: SQL status: BEGIN in 0.074 seconds
[0m23:54:49.451587 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.452663 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

with account_name_map as (
    select
        lower(concat_ws(' ', first_name, last_name)) as full_name_key,
        min(id)                                      as account_id
    from "dw_northwind_metabase"."public"."accounts"
    where first_name is not null and last_name is not null
    group by 1
),
product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar
        else 'METABASE_' || upper(trim(o.user_id))
    end                                       as customer_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(o.product_id))
    end                                       as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join account_name_map acc_map
       on lower(o.user_id) = acc_map.full_name_key
left join product_map prod_map
       on lower(o.product_id) = prod_map.title_key
  );
[0m23:54:49.459329 [debug] [Thread-3 (]: SQL status: BEGIN in 0.076 seconds
[0m23:54:49.460118 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.460857 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_tmp"
    
    
  as (
    

-- Cat√°logo de produtos Metabase Sample (B2C/SaaS) com atributos de pre√ßo e rating.
select
    'METABASE'                               as source_system,
    p.id                                     as source_product_id,
    'METABASE_' || p.id                      as product_nk,
    p.title                                  as product_name,
    p.category                               as category_name,
    p.vendor                                 as vendor_name,
    cast(p.price as numeric(12,4))           as unit_price,
    cast(p.rating as numeric(5,2))           as rating_score,
    case
        when p.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then p.created_at::timestamp
        else null
    end                                     as created_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."products" p
  );
[0m23:54:49.463908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.079 seconds
[0m23:54:49.464567 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.465179 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:54:49.465732 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp"
    
    
  as (
    

-- Registros da tabela people (usados pelos pedidos B2C que n√£o mapeiam para accounts).
select
    'METABASE'                               as source_system,
    p.id                                     as source_customer_id,
    'METABASE_' || upper(trim(p.name))       as customer_nk,
    p.name                                   as customer_name,
    null::varchar                            as contact_name,
    null::varchar                            as contact_title,
    split_part(p.name, ' ', 1)               as first_name,
    nullif(split_part(p.name, ' ', 2), '')   as last_name,
    p.address                                as address,
    p.city                                   as city,
    p.state                                  as region,
    null::varchar                            as country,
    p.zip::varchar                           as postal_code,
    null::varchar                            as plan,
    p.source                                 as segment,
    null::int                                as seats,
    null::boolean                            as trial_converted,
    null::boolean                            as active_subscription,
    null::boolean                            as legacy_plan,
    null::timestamp                          as created_at,
    null::timestamp                          as trial_ends_at,
    null::timestamp                          as canceled_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."people" p
  );
[0m23:54:49.469357 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.469872 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:54:49.470272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m23:54:49.470849 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m23:54:49.474348 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.474877 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.475438 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_products" rename to "stg_metabase_products__dbt_backup"
[0m23:54:49.475970 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp"
    
    
  as (
    

with product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Reviews p√∫blicos dos produtos Metabase Sample.
select
    'METABASE'                               as source_system,
    r._mb_row_id                             as source_review_id,
    'METABASE_RV_' || r._mb_row_id           as review_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(r.product_id))
    end                                      as product_nk,
    r.product_id                             as source_product_id,
    r.reviewer                               as reviewer_name,
    cast(r.rating as numeric(5,2))           as rating_score,
    case
        when r.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then r.created_at::timestamp
        else null
    end                                      as created_at,
    r.body                                   as review_text,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."reviews" r
left join product_map prod_map
       on lower(r.product_id) = prod_map.title_key
  );
[0m23:54:49.476505 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.479751 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.480256 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:54:49.480727 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m23:54:49.481162 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:54:49.484553 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.485042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:54:49.488373 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.488875 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:54:49.489311 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people" rename to "stg_metabase_people__dbt_backup"
[0m23:54:49.492470 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.492962 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_tmp" rename to "stg_metabase_products"
[0m23:54:49.494665 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:54:49.495217 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews" rename to "stg_metabase_reviews__dbt_backup"
[0m23:54:49.495817 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.496272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.496737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.497324 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m23:54:49.501043 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.501809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:54:49.504791 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: COMMIT
[0m23:54:49.505669 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp" rename to "stg_metabase_people"
[0m23:54:49.509292 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.509821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m23:54:49.510276 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.510960 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_tmp" rename to "stg_metabase_reviews"
[0m23:54:49.511546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.513981 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m23:54:49.514813 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: COMMIT
[0m23:54:49.517140 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m23:54:49.518026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:54:49.519401 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m23:54:49.520329 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.522657 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:54:49.523158 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:54:49.523559 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m23:54:49.523994 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m23:54:49.524391 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.526720 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_backup"
[0m23:54:49.527430 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: COMMIT
[0m23:54:49.528246 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_products"
[0m23:54:49.528675 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:54:49.529108 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_products"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_products__dbt_backup" cascade
[0m23:54:49.531495 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup"
[0m23:54:49.531935 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:54:49.532349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:54:49.533720 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m23:54:49.540162 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m23:54:49.540669 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:54:49.542819 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup"
[0m23:54:49.543276 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup" cascade
[0m23:54:49.544994 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_metabase_products: Close
[0m23:54:49.545796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46046F700>]}
[0m23:54:49.546927 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_reviews"
[0m23:54:49.548991 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FC20D70>]}
[0m23:54:49.548042 [info ] [Thread-2 (]: 5 of 13 OK created sql view model dw_stg.stg_metabase_orders ................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:54:49.549790 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:54:49.550263 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_reviews"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews__dbt_backup" cascade
[0m23:54:49.551690 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m23:54:49.550989 [info ] [Thread-3 (]: 7 of 13 OK created sql view model dw_stg.stg_metabase_products ................. [[32mCREATE VIEW[0m in 0.24s]
[0m23:54:49.553224 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_metabase_people: Close
[0m23:54:49.553765 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m23:54:49.554462 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_products
[0m23:54:49.555699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:54:49.556381 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FC20F50>]}
[0m23:54:49.555207 [info ] [Thread-2 (]: 9 of 13 START sql view model dw_stg.stg_northwind_customers .................... [RUN]
[0m23:54:49.557230 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_employees
[0m23:54:49.559827 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_reviews: Close
[0m23:54:49.561711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_customers)
[0m23:54:49.561140 [info ] [Thread-4 (]: 6 of 13 OK created sql view model dw_stg.stg_metabase_people ................... [[32mCREATE VIEW[0m in 0.25s]
[0m23:54:49.562389 [info ] [Thread-3 (]: 10 of 13 START sql view model dw_stg.stg_northwind_employees ................... [RUN]
[0m23:54:49.563143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FC203B0>]}
[0m23:54:49.563621 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m23:54:49.564640 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_people
[0m23:54:49.565444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_products, now model.dw_northwind_metabase.stg_northwind_employees)
[0m23:54:49.569954 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.566225 [info ] [Thread-1 (]: 8 of 13 OK created sql view model dw_stg.stg_metabase_reviews .................. [[32mCREATE VIEW[0m in 0.25s]
[0m23:54:49.570844 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:54:49.571556 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_employees
[0m23:54:49.572487 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m23:54:49.576528 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.573356 [info ] [Thread-4 (]: 11 of 13 START sql view model dw_stg.stg_northwind_order_details ............... [RUN]
[0m23:54:49.577168 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m23:54:49.577814 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_people, now model.dw_northwind_metabase.stg_northwind_order_details)
[0m23:54:49.578888 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:54:49.578430 [info ] [Thread-1 (]: 12 of 13 START sql view model dw_stg.stg_northwind_orders ...................... [RUN]
[0m23:54:49.583383 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.584083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_reviews, now model.dw_northwind_metabase.stg_northwind_orders)
[0m23:54:49.584840 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_employees
[0m23:54:49.585362 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m23:54:49.586122 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m23:54:49.591443 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.595479 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.598610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.599280 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:54:49.604571 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.606200 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m23:54:49.611726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.612984 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.614086 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.614761 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.615243 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m23:54:49.615952 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: BEGIN
[0m23:54:49.616463 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m23:54:49.617266 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.617802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:49.618359 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:49.618834 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:49.619451 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m23:54:49.621144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:49.691120 [debug] [Thread-4 (]: SQL status: BEGIN in 0.072 seconds
[0m23:54:49.692011 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.692721 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m23:54:49.701528 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:54:49.706239 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.706959 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m23:54:49.707632 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m23:54:49.708200 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.708614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m23:54:49.709006 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.712050 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.712770 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.713510 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_tmp"
    
    
  as (
    

-- Colaboradores Northwind com atributos de localiza√ß√£o e datas chave.
select
    'NORTHWIND'                                   as source_system,
    e.empid                                       as source_employee_id,
    'NORTHWIND_' || e.empid                       as employee_nk,
    e.firstname                                   as first_name,
    e.lastname                                    as last_name,
    e.title                                       as job_title,
    e.titleofcourtesy                             as courtesy_title,
    cast(e.birthdate as date)                     as birth_date,
    cast(e.hiredate as date)                      as hire_date,
    e.city                                        as city,
    coalesce(nullif(e.region, ''), 'N/A')         as region,
    e.country                                     as country,
    e.postalcode                                  as postal_code,
    e.phone                                       as phone,
    e.extension                                   as phone_extension,
    e.mgrid                                       as manager_empid,
    current_timestamp                             as dw_load_ts
from "dw_northwind_metabase"."public"."employee" e
  );
[0m23:54:49.714038 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m23:54:49.714528 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m23:54:49.715594 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:54:49.717257 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m23:54:49.717709 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.718080 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m23:54:49.721324 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:54:49.725031 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m23:54:49.725596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:54:49.725994 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:54:49.726710 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m23:54:49.729878 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.732648 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.733148 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m23:54:49.733610 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m23:54:49.734091 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_employees" rename to "stg_northwind_employees__dbt_backup"
[0m23:54:49.735460 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.736301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:54:49.739674 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.740210 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:54:49.743743 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.744284 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_tmp" rename to "stg_northwind_employees"
[0m23:54:49.745911 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m23:54:49.746387 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m23:54:49.747385 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FC228D0>]}
[0m23:54:49.747960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.748450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.752003 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m23:54:49.749371 [info ] [Thread-4 (]: 11 of 13 OK created sql view model dw_stg.stg_northwind_order_details .......... [[32mCREATE VIEW[0m in 0.17s]
[0m23:54:49.754442 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: COMMIT
[0m23:54:49.754961 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.755572 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m23:54:49.755986 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.756358 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m23:54:49.756780 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_products
[0m23:54:49.757203 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: COMMIT
[0m23:54:49.757756 [info ] [Thread-4 (]: 13 of 13 START sql view model dw_stg.stg_northwind_products .................... [RUN]
[0m23:54:49.758458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_products)
[0m23:54:49.759188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:54:49.759670 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_products
[0m23:54:49.760112 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:54:49.763815 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m23:54:49.768488 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.771633 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_backup"
[0m23:54:49.772603 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m23:54:49.773983 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_employees"
[0m23:54:49.774866 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m23:54:49.775487 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_employees"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_employees__dbt_backup" cascade
[0m23:54:49.776536 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_products
[0m23:54:49.781225 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.782053 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:54:49.782654 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:54:49.784446 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m23:54:49.787016 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_employees: Close
[0m23:54:49.788504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FC21EB0>]}
[0m23:54:49.789867 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.791287 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FDC3DD0>]}
[0m23:54:49.793567 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: BEGIN
[0m23:54:49.792807 [info ] [Thread-1 (]: 12 of 13 OK created sql view model dw_stg.stg_northwind_orders ................. [[32mCREATE VIEW[0m in 0.20s]
[0m23:54:49.795272 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:49.794742 [info ] [Thread-3 (]: 10 of 13 OK created sql view model dw_stg.stg_northwind_employees .............. [[32mCREATE VIEW[0m in 0.23s]
[0m23:54:49.796409 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m23:54:49.797737 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_employees
[0m23:54:49.801452 [debug] [Thread-2 (]: SQL status: BEGIN in 0.184 seconds
[0m23:54:49.801976 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.802513 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m23:54:49.810829 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:54:49.815147 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.815653 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m23:54:49.816573 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.819626 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.820294 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m23:54:49.821691 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.824037 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m23:54:49.824552 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.824921 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m23:54:49.827960 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:54:49.831086 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m23:54:49.832445 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m23:54:49.832889 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m23:54:49.834583 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:54:49.836449 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m23:54:49.837728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45F85AF90>]}
[0m23:54:49.839267 [info ] [Thread-2 (]: 9 of 13 OK created sql view model dw_stg.stg_northwind_customers ............... [[32mCREATE VIEW[0m in 0.28s]
[0m23:54:49.841108 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m23:54:49.851590 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m23:54:49.852070 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.852667 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_tmp"
    
    
  as (
    

-- Cat√°logo Northwind com categoria, fornecedor e indicadores de estoque.
select
    'NORTHWIND'                                   as source_system,
    p.productid                                   as source_product_id,
    'NORTHWIND_' || p.productid                   as product_nk,
    p.productname                                 as product_name,
    c.categoryname                                as category_name,
    s.companyname                                 as supplier_name,
    p.quantityperunit                             as package_details,
    cast(p.unitprice as numeric(12,4))            as unit_price,
    p.unitsinstock                                as units_in_stock,
    p.unitsonorder                                as units_on_order,
    p.reorderlevel                                as reorder_level,
    p.discontinued = '1'                          as is_discontinued,
    current_timestamp                             as dw_load_ts
from "dw_northwind_metabase"."public"."product" p
left join "dw_northwind_metabase"."public"."category" c
       on p.categoryid = c.categoryid
left join "dw_northwind_metabase"."public"."supplier" s
       on p.supplierid = s.supplierid
  );
[0m23:54:49.862313 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:54:49.866257 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.866755 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_products" rename to "stg_northwind_products__dbt_backup"
[0m23:54:49.868041 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.871455 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.872047 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_tmp" rename to "stg_northwind_products"
[0m23:54:49.873385 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:49.875472 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: COMMIT
[0m23:54:49.875938 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.876469 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: COMMIT
[0m23:54:49.878026 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:54:49.881009 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_backup"
[0m23:54:49.881867 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_products"
[0m23:54:49.882326 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_products"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_products__dbt_backup" cascade
[0m23:54:49.884538 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:54:49.886281 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_products: Close
[0m23:54:49.887601 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce1c4ae-d8b7-4a2d-86c7-fb938a8e4959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FE716D0>]}
[0m23:54:49.888727 [info ] [Thread-4 (]: 13 of 13 OK created sql view model dw_stg.stg_northwind_products ............... [[32mCREATE VIEW[0m in 0.13s]
[0m23:54:49.889814 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_products
[0m23:54:49.891971 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:49.892480 [debug] [MainThread]: On master: BEGIN
[0m23:54:49.892847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:49.948744 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m23:54:49.949205 [debug] [MainThread]: On master: COMMIT
[0m23:54:49.949544 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:49.949871 [debug] [MainThread]: On master: COMMIT
[0m23:54:49.950363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:49.950721 [debug] [MainThread]: On master: Close
[0m23:54:49.951268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:49.951585 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m23:54:49.951928 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m23:54:49.952218 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m23:54:49.952571 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m23:54:49.952941 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m23:54:49.953318 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_products' was properly closed.
[0m23:54:49.953781 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m23:54:49.954173 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m23:54:49.954511 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_employees' was properly closed.
[0m23:54:49.954913 [info ] [MainThread]: 
[0m23:54:49.955415 [info ] [MainThread]: Finished running 13 view models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m23:54:49.957880 [debug] [MainThread]: Command end result
[0m23:54:50.010933 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m23:54:50.014337 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m23:54:50.023258 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m23:54:50.023818 [info ] [MainThread]: 
[0m23:54:50.024526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:50.025035 [info ] [MainThread]: 
[0m23:54:50.025561 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m23:54:50.026971 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:50.026829 after 3.51 seconds
[0m23:54:50.027607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45F7C94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45DED2F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45FDC3E30>]}
[0m23:54:50.028068 [debug] [MainThread]: Flushing usage events
[0m23:54:51.815810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:36.577591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28C1B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28CA58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28E09BED0>]}


============================== 00:10:36.586850 | 50d84879-7c81-46c4-88af-006630df88f5 ==============================
[0m00:10:36.586850 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:10:36.588063 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:10:36.909779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28C3E9F30>]}
[0m00:10:36.993087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28E123DF0>]}
[0m00:10:36.995315 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:10:37.422163 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:10:37.775303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:37.775969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:37.887249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28E423350>]}
[0m00:10:38.102351 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:10:38.112046 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:10:38.264160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B288B88F50>]}
[0m00:10:38.265303 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:10:38.266399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28E2E19B0>]}
[0m00:10:38.270045 [info ] [MainThread]: 
[0m00:10:38.270830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:38.271390 [info ] [MainThread]: 
[0m00:10:38.272234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:38.273775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:10:38.517924 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:10:38.518505 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:10:38.518895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:38.625028 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.106 seconds
[0m00:10:38.626939 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:10:38.638293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m00:10:38.648180 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:10:38.648937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m00:10:38.649658 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:10:38.653488 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:10:38.654342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m00:10:38.654848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:38.655613 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:10:38.656330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m00:10:38.659231 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:10:38.660228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:38.662716 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:10:38.663724 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:10:38.664791 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:10:38.665526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:38.666146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:38.737912 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m00:10:38.738757 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:10:38.739461 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:10:38.746150 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m00:10:38.747120 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:10:38.748202 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:10:38.750372 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m00:10:38.751036 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:10:38.751712 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:10:38.754614 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.014 seconds
[0m00:10:38.757529 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:10:38.758705 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:10:38.759519 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m00:10:38.760171 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:10:38.761339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m00:10:38.762328 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:10:38.767560 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m00:10:38.769267 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:10:38.771598 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:10:38.772191 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:10:38.773625 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:10:38.774234 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:10:38.774669 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:10:38.775186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:38.775636 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:10:38.776824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dw)
[0m00:10:38.781330 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:10:38.782200 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:10:38.783204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_sales)
[0m00:10:38.783949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:38.787807 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:10:38.788681 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:10:38.789348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m00:10:38.789939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:38.792207 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:10:38.793921 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:10:38.795479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:10:38.799492 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:10:38.800348 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:10:38.801039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:38.875525 [debug] [ThreadPool]: SQL status: BEGIN in 0.100 seconds
[0m00:10:38.876163 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:10:38.876662 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:10:38.885157 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m00:10:38.885789 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:10:38.886495 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:10:38.887233 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m00:10:38.887962 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:10:38.888640 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:10:38.889402 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m00:10:38.891531 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:10:38.892271 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:10:38.893482 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m00:10:38.894215 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:10:38.894900 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:10:38.897800 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.010 seconds
[0m00:10:38.900173 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:10:38.900757 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:10:38.902393 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:10:38.902942 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:10:38.903754 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:10:38.908056 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m00:10:38.909405 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:10:38.910017 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:10:38.917817 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:38.918667 [debug] [MainThread]: On master: BEGIN
[0m00:10:38.919337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:38.968672 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:10:38.969104 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:38.969494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:10:38.980208 [debug] [MainThread]: SQL status: SELECT 21 in 0.010 seconds
[0m00:10:38.982876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28EAACD50>]}
[0m00:10:38.983471 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:38.984098 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:38.984470 [debug] [MainThread]: On master: BEGIN
[0m00:10:38.985227 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:38.985610 [debug] [MainThread]: On master: COMMIT
[0m00:10:38.985986 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:38.986342 [debug] [MainThread]: On master: COMMIT
[0m00:10:38.986845 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:38.987211 [debug] [MainThread]: On master: Close
[0m00:10:38.996160 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m00:10:38.997815 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m00:10:39.000134 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m00:10:39.000687 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m00:10:39.010065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m00:10:39.011661 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m00:10:39.077402 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m00:10:39.080475 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:10:39.081819 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m00:10:39.082863 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:39.143909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m00:10:39.144537 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:10:39.145246 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
    dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
),
metabase_people as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        first_name,
        last_name,
        address,
        city,
        region,
        country,
        postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
)
select * from northwind
union all
select * from metabase
union all
select * from metabase_people
  );
[0m00:10:39.162259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m00:10:39.171205 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:10:39.171729 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m00:10:39.174048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:10:39.200150 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m00:10:39.200745 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:10:39.201394 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m00:10:39.203190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:10:39.211791 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m00:10:39.220931 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:10:39.221626 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m00:10:39.223074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:10:39.226457 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m00:10:39.235784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50d84879-7c81-46c4-88af-006630df88f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28ECF41D0>]}
[0m00:10:39.236915 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m00:10:39.237854 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m00:10:39.239465 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.239831 [debug] [MainThread]: On master: BEGIN
[0m00:10:39.240221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:39.295642 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m00:10:39.296420 [debug] [MainThread]: On master: COMMIT
[0m00:10:39.296846 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.297391 [debug] [MainThread]: On master: COMMIT
[0m00:10:39.298334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:39.298965 [debug] [MainThread]: On master: Close
[0m00:10:39.299832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:39.300380 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m00:10:39.300829 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m00:10:39.301248 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m00:10:39.301708 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m00:10:39.302128 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m00:10:39.302537 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m00:10:39.303014 [info ] [MainThread]: 
[0m00:10:39.303589 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m00:10:39.304691 [debug] [MainThread]: Command end result
[0m00:10:39.373310 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:10:39.378497 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:10:39.390796 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:10:39.391748 [info ] [MainThread]: 
[0m00:10:39.393128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:39.393771 [info ] [MainThread]: 
[0m00:10:39.394514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:10:39.396519 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:39.396294 after 3.01 seconds
[0m00:10:39.397245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28E838470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28BC5F2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B28E1F8910>]}
[0m00:10:39.398183 [debug] [MainThread]: Flushing usage events
[0m00:10:40.889075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:46.966616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203236B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020323F58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032559BED0>]}


============================== 00:10:46.971433 | f044d48a-612a-4e93-a608-1e0d7c080d80 ==============================
[0m00:10:46.971433 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:10:46.972389 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:10:47.226427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203238E9F30>]}
[0m00:10:47.338240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032561FDF0>]}
[0m00:10:47.340798 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:10:47.868574 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:10:48.151390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:48.151901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:48.229338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032591B350>]}
[0m00:10:48.383292 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:10:48.388361 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:10:48.537301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203210A8F50>]}
[0m00:10:48.538432 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:10:48.539205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203257D99B0>]}
[0m00:10:48.543979 [info ] [MainThread]: 
[0m00:10:48.544799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:48.545922 [info ] [MainThread]: 
[0m00:10:48.546662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:48.548234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:10:48.710199 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:10:48.710671 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:10:48.711039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:48.770006 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.059 seconds
[0m00:10:48.771508 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:10:48.772611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_snapshots)
[0m00:10:48.778814 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "snapshots"
"
[0m00:10:48.785594 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_snapshots"
[0m00:10:48.786101 [debug] [ThreadPool]: On create_dw_northwind_metabase_snapshots: BEGIN
[0m00:10:48.786479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:48.833853 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m00:10:48.834266 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_snapshots"
[0m00:10:48.834555 [debug] [ThreadPool]: On create_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_snapshots"} */
create schema if not exists "snapshots"
[0m00:10:48.838142 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m00:10:48.839104 [debug] [ThreadPool]: On create_dw_northwind_metabase_snapshots: COMMIT
[0m00:10:48.839462 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_snapshots"
[0m00:10:48.839887 [debug] [ThreadPool]: On create_dw_northwind_metabase_snapshots: COMMIT
[0m00:10:48.841087 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m00:10:48.841661 [debug] [ThreadPool]: On create_dw_northwind_metabase_snapshots: Close
[0m00:10:48.850969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m00:10:48.859113 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:10:48.859914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m00:10:48.860329 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:10:48.862994 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:10:48.863875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m00:10:48.864359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:48.865022 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:10:48.865576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m00:10:48.867736 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:10:48.868754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:48.872095 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:10:48.872641 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:10:48.873380 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:10:48.873948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:48.874372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:48.935101 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m00:10:48.935760 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m00:10:48.936184 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:10:48.936668 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:10:48.937283 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:10:48.937832 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:10:48.943288 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m00:10:48.943793 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:10:48.944291 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:10:48.947129 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.009 seconds
[0m00:10:48.947725 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m00:10:48.949750 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:10:48.951596 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:10:48.952582 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:10:48.952994 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:10:48.953472 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:10:48.954165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_snapshots)
[0m00:10:48.957201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:10:48.958742 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:10:48.962621 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:10:48.964800 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:10:48.965286 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:10:48.965845 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:10:48.966237 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:10:48.966663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:48.967252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:48.968042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m00:10:48.971240 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:10:48.971879 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:10:48.972261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:49.039469 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:10:49.040144 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:10:49.040856 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:10:49.044407 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m00:10:49.045086 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:10:49.045753 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:10:49.051013 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m00:10:49.051810 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:10:49.052570 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:10:49.053399 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:10:49.055489 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:10:49.056145 [debug] [ThreadPool]: SQL status: BEGIN in 0.182 seconds
[0m00:10:49.056961 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:10:49.057667 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:10:49.058234 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:10:49.059773 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:10:49.060239 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:10:49.061319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_saas)
[0m00:10:49.062145 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:10:49.065614 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:10:49.066437 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m00:10:49.067747 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:10:49.070921 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:10:49.072559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:49.073737 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:10:49.075435 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m00:10:49.078615 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:10:49.080851 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:10:49.141903 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m00:10:49.142348 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:10:49.142699 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:10:49.149272 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m00:10:49.151541 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:10:49.152444 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:10:49.160649 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:49.161097 [debug] [MainThread]: On master: BEGIN
[0m00:10:49.161445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:49.215579 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m00:10:49.216090 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:49.216828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:10:49.231064 [debug] [MainThread]: SQL status: SELECT 24 in 0.013 seconds
[0m00:10:49.235182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020325FA9B20>]}
[0m00:10:49.236249 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:49.237011 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:49.237439 [debug] [MainThread]: On master: BEGIN
[0m00:10:49.238354 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:49.239010 [debug] [MainThread]: On master: COMMIT
[0m00:10:49.239571 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:49.240130 [debug] [MainThread]: On master: COMMIT
[0m00:10:49.241023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:49.241834 [debug] [MainThread]: On master: Close
[0m00:10:49.249756 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:10:49.251440 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m00:10:49.253823 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m00:10:49.254676 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:10:49.271453 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:10:49.404865 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:10:49.405489 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m00:10:49.406027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:49.462457 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.056 seconds
[0m00:10:49.468866 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:10:49.469653 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m00:10:49.470554 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m00:10:49.471182 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:10:49.477915 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:10:49.478603 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m00:10:49.479816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:10:49.480357 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:10:49.480765 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      
  
    

  create  table "dw_northwind_metabase"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



  );
  
  
[0m00:10:49.725640 [debug] [Thread-1 (]: SQL status: SELECT 5086 in 0.244 seconds
[0m00:10:49.748864 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m00:10:49.749352 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:10:49.749803 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m00:10:49.755177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m00:10:49.758138 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m00:10:49.761622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f044d48a-612a-4e93-a608-1e0d7c080d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020326214350>]}
[0m00:10:49.763143 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mSELECT 5086[0m in 0.51s]
[0m00:10:49.764292 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:10:49.766289 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:49.766922 [debug] [MainThread]: On master: BEGIN
[0m00:10:49.767429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:49.817053 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m00:10:49.817893 [debug] [MainThread]: On master: COMMIT
[0m00:10:49.818876 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:49.820712 [debug] [MainThread]: On master: COMMIT
[0m00:10:49.821824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:49.822311 [debug] [MainThread]: On master: Close
[0m00:10:49.822965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:49.823424 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_snapshots' was properly closed.
[0m00:10:49.823845 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m00:10:49.824231 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m00:10:49.824617 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m00:10:49.825052 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m00:10:49.825446 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m00:10:49.825929 [info ] [MainThread]: 
[0m00:10:49.826564 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m00:10:49.827422 [debug] [MainThread]: Command end result
[0m00:10:49.892958 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:10:49.897485 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:10:49.908139 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:10:49.908878 [info ] [MainThread]: 
[0m00:10:49.910214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:49.911045 [info ] [MainThread]: 
[0m00:10:49.911761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:10:49.913559 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:10:49.913314 after 3.09 seconds
[0m00:10:49.914364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020325D3BB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020326143BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020326143C50>]}
[0m00:10:49.915303 [debug] [MainThread]: Flushing usage events
[0m00:10:51.097428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:50.345066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB288B4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2A158910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2A79BED0>]}


============================== 00:11:50.351352 | 8ed0485a-07da-46ff-b41b-4c9f1aa83514 ==============================
[0m00:11:50.351352 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:11:50.352882 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dw', 'printer_width': '80', 'write_json': 'True'}
[0m00:11:50.589491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB28AE9F30>]}
[0m00:11:50.675081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2A82BDF0>]}
[0m00:11:50.679675 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:11:51.304779 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:11:51.530121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:51.530987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:51.601961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2AB23350>]}
[0m00:11:51.737719 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:11:51.741963 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:11:51.861523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB252A8F50>]}
[0m00:11:51.862939 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:11:51.864286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2A9DD9B0>]}
[0m00:11:51.868728 [info ] [MainThread]: 
[0m00:11:51.869581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:11:51.870563 [info ] [MainThread]: 
[0m00:11:51.871782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:11:51.882506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:11:52.029936 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:11:52.030341 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:11:52.030638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:52.099246 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.069 seconds
[0m00:11:52.100672 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:11:52.104437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m00:11:52.110483 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:11:52.111109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m00:11:52.111541 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:11:52.114307 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:11:52.115009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m00:11:52.115462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:52.116049 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:11:52.118067 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:11:52.118692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m00:11:52.119434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:52.119888 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:11:52.121952 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:11:52.122735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:52.123339 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:11:52.124137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:52.185625 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m00:11:52.186339 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:11:52.186878 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:11:52.187948 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:11:52.188604 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:11:52.189211 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:11:52.193070 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m00:11:52.193750 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:11:52.194484 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:11:52.197053 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m00:11:52.197574 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:11:52.198014 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:11:52.198439 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:11:52.198896 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m00:11:52.200767 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:11:52.202389 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:11:52.203112 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:11:52.203719 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m00:11:52.204281 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:11:52.206558 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:11:52.207602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_stg)
[0m00:11:52.208238 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:11:52.209305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m00:11:52.209832 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:11:52.211957 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:11:52.213551 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:11:52.215381 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:11:52.215871 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:11:52.216413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m00:11:52.218677 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:11:52.219026 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:11:52.219393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:52.221530 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:11:52.222062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:52.222820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_saas)
[0m00:11:52.223499 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:11:52.226375 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:11:52.226823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:52.227180 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:11:52.227711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:52.288764 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m00:11:52.289456 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:11:52.289927 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:11:52.294463 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:11:52.295078 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:11:52.295605 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:11:52.297153 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m00:11:52.297860 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:11:52.298405 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:11:52.300114 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.010 seconds
[0m00:11:52.302950 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:11:52.304024 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:11:52.304761 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m00:11:52.305538 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:11:52.306466 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:11:52.307391 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:11:52.309785 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:11:52.313454 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m00:11:52.313836 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:11:52.315107 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:11:52.316106 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:11:52.317190 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:11:52.319004 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:11:52.319581 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:11:52.326752 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:52.327223 [debug] [MainThread]: On master: BEGIN
[0m00:11:52.327535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:52.374412 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m00:11:52.374925 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:52.375421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:11:52.386326 [debug] [MainThread]: SQL status: SELECT 24 in 0.010 seconds
[0m00:11:52.388916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B1A8FC0>]}
[0m00:11:52.389450 [debug] [MainThread]: On master: ROLLBACK
[0m00:11:52.390096 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:52.390540 [debug] [MainThread]: On master: BEGIN
[0m00:11:52.391551 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:11:52.392052 [debug] [MainThread]: On master: COMMIT
[0m00:11:52.392472 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:52.392846 [debug] [MainThread]: On master: COMMIT
[0m00:11:52.393472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:52.394031 [debug] [MainThread]: On master: Close
[0m00:11:52.400775 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.dim_employee
[0m00:11:52.401744 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m00:11:52.402345 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_channel
[0m00:11:52.403331 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.dim_date
[0m00:11:52.403931 [info ] [Thread-4 (]: 4 of 11 START sql table model dw_dw.dim_employee ............................... [RUN]
[0m00:11:52.404540 [info ] [Thread-2 (]: 2 of 11 START sql table model dw_dw.dim_customer ............................... [RUN]
[0m00:11:52.406392 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_employee'
[0m00:11:52.406944 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m00:11:52.405139 [info ] [Thread-1 (]: 1 of 11 START sql table model dw_dw.dim_channel ................................ [RUN]
[0m00:11:52.407589 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.dim_employee
[0m00:11:52.405695 [info ] [Thread-3 (]: 3 of 11 START sql table model dw_dw.dim_date ................................... [RUN]
[0m00:11:52.408165 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m00:11:52.408815 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_channel'
[0m00:11:52.417170 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.417945 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_date'
[0m00:11:52.420981 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.421578 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_channel
[0m00:11:52.422193 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.dim_date
[0m00:11:52.426697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.431310 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_date"
[0m00:11:52.434384 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.dim_employee
[0m00:11:52.435230 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m00:11:52.492807 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.487130 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.494087 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_channel
[0m00:11:52.498159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.498718 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.dim_date
[0m00:11:52.503267 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_date"
[0m00:11:52.504955 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.505784 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: BEGIN
[0m00:11:52.506604 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:11:52.507229 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.508301 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.509107 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m00:11:52.510100 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: BEGIN
[0m00:11:52.510955 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:11:52.511971 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m00:11:52.512775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:52.514159 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: BEGIN
[0m00:11:52.515454 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:11:52.571381 [debug] [Thread-4 (]: SQL status: BEGIN in 0.065 seconds
[0m00:11:52.571863 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.572262 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de colaboradores (Northwind) para an√°lises B2B.
select
    row_number() over (order by employee_nk)   as employee_sk,
    employee_nk,
    source_system,
    source_employee_id,
    first_name,
    last_name,
    job_title,
    courtesy_title,
    birth_date,
    hire_date,
    city,
    region,
    country,
    postal_code,
    phone,
    phone_extension,
    manager_empid,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"
  );
  
[0m00:11:52.580191 [debug] [Thread-2 (]: SQL status: BEGIN in 0.069 seconds
[0m00:11:52.580778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m00:11:52.581208 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.581691 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.582279 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m00:11:52.582819 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de canais/fonte (B2B x B2C/SaaS).
select
    row_number() over (order by channel_nk) as channel_sk,
    channel_nk,
    channel_name,
    business_model
from (
    values
        ('CHANNEL_NORTHWIND', 'Northwind ERP', 'B2B'),
        ('CHANNEL_METABASE', 'Metabase Sample', 'B2C/SaaS')
) as channels(channel_nk, channel_name, business_model)
  );
  
[0m00:11:52.595355 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m00:11:52.609678 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.610443 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_channel" rename to "dim_channel__dbt_backup"
[0m00:11:52.611703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:52.615354 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.615989 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m00:11:52.617176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:52.643171 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: COMMIT
[0m00:11:52.644034 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.644661 [debug] [Thread-2 (]: SQL status: SELECT 5086 in 0.061 seconds
[0m00:11:52.645374 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: COMMIT
[0m00:11:52.650273 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.651003 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m00:11:52.652249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:52.657685 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.658487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m00:11:52.659275 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m00:11:52.669066 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_backup"
[0m00:11:52.679348 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_channel"
[0m00:11:52.680227 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m00:11:52.681076 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_channel"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_channel__dbt_backup" cascade
[0m00:11:52.684033 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m00:11:52.684925 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.112 seconds
[0m00:11:52.686618 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.692629 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.693400 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m00:11:52.694081 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m00:11:52.694732 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_employee" rename to "dim_employee__dbt_backup"
[0m00:11:52.697249 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_channel: Close
[0m00:11:52.699972 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:11:52.700740 [debug] [Thread-3 (]: SQL status: BEGIN in 0.185 seconds
[0m00:11:52.701275 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m00:11:52.704794 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.705311 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m00:11:52.707523 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m00:11:52.708029 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m00:11:52.708628 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de datas gerada via s√©rie cont√≠nua (apoia an√°lises hist√≥ricas).
with calendar as (
    select
        day::date as date_day
    from generate_series('1990-01-01'::date, '2035-12-31'::date, interval '1 day') as gs(day)
)
select
    row_number() over (order by date_day)         as date_sk,
    date_day,
    extract(year from date_day)::int              as year,
    extract(quarter from date_day)::int           as quarter,
    extract(month from date_day)::int             as month,
    to_char(date_day, 'TMMonth')                  as month_name,
    extract(day from date_day)::int               as day_of_month,
    to_char(date_day, 'IW')::int                  as iso_week,
    extract(dow from date_day)::int               as day_of_week,
    to_char(date_day, 'Dy')                       as day_name,
    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
from calendar
  );
  
[0m00:11:52.709680 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:11:52.710254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B3BCA10>]}
[0m00:11:52.710824 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:52.711437 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m00:11:52.713934 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: COMMIT
[0m00:11:52.712262 [info ] [Thread-1 (]: 1 of 11 OK created sql table model dw_dw.dim_channel ........................... [[32mSELECT 2[0m in 0.29s]
[0m00:11:52.714640 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.715454 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_channel
[0m00:11:52.715893 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: COMMIT
[0m00:11:52.716513 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_geography
[0m00:11:52.717180 [info ] [Thread-1 (]: 5 of 11 START sql table model dw_dw.dim_geography .............................. [RUN]
[0m00:11:52.717823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_channel, now model.dw_northwind_metabase.dim_geography)
[0m00:11:52.718277 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m00:11:52.718694 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_geography
[0m00:11:52.720913 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_backup"
[0m00:11:52.721392 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:11:52.725732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_geography"
[0m00:11:52.726699 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dim_employee"
[0m00:11:52.728069 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m00:11:52.728575 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_employee"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_employee__dbt_backup" cascade
[0m00:11:52.729466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B2A1DE0>]}
[0m00:11:52.731765 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_geography
[0m00:11:52.737962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_geography"
[0m00:11:52.738511 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m00:11:52.730450 [info ] [Thread-2 (]: 2 of 11 OK created sql table model dw_dw.dim_customer .......................... [[32mSELECT 5086[0m in 0.32s]
[0m00:11:52.740695 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dim_employee: Close
[0m00:11:52.742557 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m00:11:52.744087 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dim_product
[0m00:11:52.746218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B395F90>]}
[0m00:11:52.748216 [info ] [Thread-2 (]: 6 of 11 START sql table model dw_dw.dim_product ................................ [RUN]
[0m00:11:52.750933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_customer, now model.dw_northwind_metabase.dim_product)
[0m00:11:52.751620 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m00:11:52.752564 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dim_product
[0m00:11:52.749550 [info ] [Thread-4 (]: 4 of 11 OK created sql table model dw_dw.dim_employee .......................... [[32mSELECT 9[0m in 0.34s]
[0m00:11:52.753644 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: BEGIN
[0m00:11:52.759244 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_product"
[0m00:11:52.760395 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.dim_employee
[0m00:11:52.760995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:52.761646 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.fact_analytic_events
[0m00:11:52.762964 [info ] [Thread-4 (]: 7 of 11 START sql table model dw_dw.fact_analytic_events ....................... [RUN]
[0m00:11:52.764153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_employee, now model.dw_northwind_metabase.fact_analytic_events)
[0m00:11:52.765055 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.fact_analytic_events
[0m00:11:52.770684 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:52.771673 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dim_product
[0m00:11:52.782624 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_product"
[0m00:11:52.783912 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.fact_analytic_events
[0m00:11:52.791933 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:52.796784 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:52.797802 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m00:11:52.799791 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: BEGIN
[0m00:11:52.801198 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: BEGIN
[0m00:11:52.802044 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:11:52.802824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:11:52.857530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m00:11:52.858398 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m00:11:52.859291 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de geografia consolidando localidades presentes nas diferentes fontes.
with unioned as (
    select distinct
        upper(coalesce(country, 'N/A')) as country,
        upper(coalesce(region, 'N/A'))  as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"

    union

    select distinct
        upper(coalesce(country, 'N/A')) as country,
        'N/A'                           as region,
        'N/A'                           as city
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"

    union

    select distinct
        upper(coalesce(country, 'N/A')) as country,
        upper(coalesce(region, 'N/A'))  as region,
        upper(coalesce(city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"

    union

    select distinct
        upper(coalesce(ship_country, 'N/A')) as country,
        upper(coalesce(ship_region, 'N/A'))  as region,
        upper(coalesce(ship_city, 'N/A'))    as city
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_orders"
)
select
    row_number() over (order by country, region, city) as geography_sk,
    country,
    region,
    city
from unioned
  );
  
[0m00:11:52.862118 [debug] [Thread-3 (]: SQL status: SELECT 16800 in 0.151 seconds
[0m00:11:52.867243 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m00:11:52.868177 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_date" rename to "dim_date__dbt_backup"
[0m00:11:52.869589 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:52.874941 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m00:11:52.875893 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m00:11:52.877478 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:52.880486 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: COMMIT
[0m00:11:52.881324 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m00:11:52.882013 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: COMMIT
[0m00:11:52.883488 [debug] [Thread-4 (]: SQL status: BEGIN in 0.081 seconds
[0m00:11:52.884398 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:52.885226 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de eventos de produto / analytics.
select
    event_nk,
    source_system,
    source_event_id,
    customer_nk,
    source_account_id,
    event_name,
    event_timestamp,
    page_url,
    button_label,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events"
  );
  
[0m00:11:52.886041 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m00:11:52.886784 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m00:11:52.887710 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_product__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de produtos combinando cat√°logo Northwind (B2B) e Metabase (B2C/SaaS).
with unioned as (
    select
        product_nk,
        source_system,
        source_product_id,
        product_name,
        category_name,
        supplier_name,
        null::varchar                        as vendor_name,
        package_details,
        unit_price,
        units_in_stock,
        units_on_order,
        reorder_level,
        null::numeric(5,2)                   as rating_score,
        null::timestamp                      as product_created_at,
        is_discontinued,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_products"

    union all

    select
        product_nk,
        source_system,
        source_product_id,
        product_name,
        category_name,
        null::varchar                        as supplier_name,
        vendor_name,
        null::varchar                        as package_details,
        unit_price,
        null::integer                        as units_in_stock,
        null::integer                        as units_on_order,
        null::integer                        as reorder_level,
        rating_score,
        created_at                           as product_created_at,
        false                                 as is_discontinued,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_products"
)
select
    row_number() over (order by product_nk)    as product_sk,
    *
from unioned
  );
  
[0m00:11:52.917270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.034 seconds
[0m00:11:52.921522 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_date__dbt_backup"
[0m00:11:52.922844 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dim_date"
[0m00:11:52.923563 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_date"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_date__dbt_backup" cascade
[0m00:11:52.971462 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.047 seconds
[0m00:11:52.973553 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dim_date: Close
[0m00:11:52.974711 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B31FD50>]}
[0m00:11:52.976181 [info ] [Thread-3 (]: 3 of 11 OK created sql table model dw_dw.dim_date .............................. [[32mSELECT 16800[0m in 0.56s]
[0m00:11:52.978207 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.dim_date
[0m00:11:52.979016 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.fact_feedback
[0m00:11:52.980087 [info ] [Thread-3 (]: 8 of 11 START sql table model dw_dw.fact_feedback .............................. [RUN]
[0m00:11:52.981165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_date, now model.dw_northwind_metabase.fact_feedback)
[0m00:11:52.981977 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.fact_feedback
[0m00:11:52.987727 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_feedback"
[0m00:11:52.990188 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.fact_feedback
[0m00:11:52.998172 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.000770 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.001611 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: BEGIN
[0m00:11:53.002718 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:11:53.083038 [debug] [Thread-3 (]: SQL status: BEGIN in 0.080 seconds
[0m00:11:53.083585 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.084094 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de feedback (NPS / avalia√ß√µes de suporte).
select
    feedback_nk,
    source_system,
    source_feedback_id,
    customer_nk,
    source_account_id,
    contact_email,
    rating_score,
    rating_label,
    date_received,
    feedback_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback"
  );
  
[0m00:11:53.111220 [debug] [Thread-2 (]: SQL status: SELECT 277 in 0.222 seconds
[0m00:11:53.116016 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m00:11:53.116519 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_product" rename to "dim_product__dbt_backup"
[0m00:11:53.117399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:53.121106 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m00:11:53.121601 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_product__dbt_tmp" rename to "dim_product"
[0m00:11:53.122880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.125909 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: COMMIT
[0m00:11:53.126652 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m00:11:53.127396 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: COMMIT
[0m00:11:53.131761 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m00:11:53.135703 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_product__dbt_backup"
[0m00:11:53.137129 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dim_product"
[0m00:11:53.137948 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_product"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_product__dbt_backup" cascade
[0m00:11:53.145345 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:11:53.147165 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dim_product: Close
[0m00:11:53.148139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2A9D5F60>]}
[0m00:11:53.149279 [info ] [Thread-2 (]: 6 of 11 OK created sql table model dw_dw.dim_product ........................... [[32mSELECT 277[0m in 0.40s]
[0m00:11:53.150754 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dim_product
[0m00:11:53.151823 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_invoices
[0m00:11:53.152920 [info ] [Thread-2 (]: 9 of 11 START sql table model dw_dw.fact_invoices .............................. [RUN]
[0m00:11:53.156322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_product, now model.dw_northwind_metabase.fact_invoices)
[0m00:11:53.157190 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_invoices
[0m00:11:53.163756 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.165877 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_invoices
[0m00:11:53.171422 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.173487 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.174774 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: BEGIN
[0m00:11:53.175812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:11:53.185608 [debug] [Thread-1 (]: SQL status: SELECT 206 in 0.325 seconds
[0m00:11:53.190253 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m00:11:53.191326 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_geography" rename to "dim_geography__dbt_backup"
[0m00:11:53.193283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.201250 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m00:11:53.201844 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m00:11:53.202964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.204877 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: COMMIT
[0m00:11:53.205393 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m00:11:53.205825 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: COMMIT
[0m00:11:53.210786 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.126 seconds
[0m00:11:53.214075 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.214585 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_feedback" rename to "fact_feedback__dbt_backup"
[0m00:11:53.215428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:53.218837 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.219301 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_tmp" rename to "fact_feedback"
[0m00:11:53.220189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:53.221951 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: COMMIT
[0m00:11:53.222422 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.222838 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: COMMIT
[0m00:11:53.237649 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m00:11:53.241114 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_backup"
[0m00:11:53.241661 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m00:11:53.242883 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_geography"
[0m00:11:53.245889 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_backup"
[0m00:11:53.246524 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_geography"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_geography__dbt_backup" cascade
[0m00:11:53.247479 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_feedback"
[0m00:11:53.248142 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_feedback"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_feedback__dbt_backup" cascade
[0m00:11:53.251949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.076 seconds
[0m00:11:53.252475 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.252915 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de faturamento SaaS (faturas Metabase).
select
    invoice_nk,
    source_system,
    source_invoice_id,
    customer_nk,
    source_account_id,
    plan_name,
    payment_amount,
    expected_invoice_flag,
    date_received,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices"
  );
  
[0m00:11:53.253401 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:11:53.255113 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_geography: Close
[0m00:11:53.255574 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:11:53.257533 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_feedback: Close
[0m00:11:53.258680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2AFA15B0>]}
[0m00:11:53.261566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2AFA1550>]}
[0m00:11:53.260570 [info ] [Thread-1 (]: 5 of 11 OK created sql table model dw_dw.dim_geography ......................... [[32mSELECT 206[0m in 0.54s]
[0m00:11:53.264506 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_geography
[0m00:11:53.265421 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_reviews
[0m00:11:53.262935 [info ] [Thread-3 (]: 8 of 11 OK created sql table model dw_dw.fact_feedback ......................... [[32mSELECT 642[0m in 0.28s]
[0m00:11:53.268384 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.fact_feedback
[0m00:11:53.266570 [info ] [Thread-1 (]: 10 of 11 START sql table model dw_dw.fact_reviews .............................. [RUN]
[0m00:11:53.269381 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m00:11:53.270140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_geography, now model.dw_northwind_metabase.fact_reviews)
[0m00:11:53.271472 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_reviews
[0m00:11:53.270932 [info ] [Thread-3 (]: 11 of 11 START sql table model dw_dw.fact_sales ................................ [RUN]
[0m00:11:53.289606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.290238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_feedback, now model.dw_northwind_metabase.fact_sales)
[0m00:11:53.291631 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m00:11:53.297442 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.298555 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_reviews
[0m00:11:53.303327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.304276 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m00:11:53.311949 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.314241 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.314823 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: BEGIN
[0m00:11:53.315469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:53.316508 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.317234 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m00:11:53.317775 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:11:53.387356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m00:11:53.388375 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.389239 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de reviews p√∫blicos (produtos Metabase).
select
    review_nk,
    source_system,
    source_review_id,
    product_nk,
    source_product_id,
    reviewer_name,
    rating_score,
    created_at,
    review_text,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
  );
  
[0m00:11:53.394840 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m00:11:53.395715 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.396505 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m00:11:53.508063 [debug] [Thread-1 (]: SQL status: SELECT 1112 in 0.118 seconds
[0m00:11:53.513150 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.513693 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews" rename to "fact_reviews__dbt_backup"
[0m00:11:53.514656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:53.518958 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.519470 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_tmp" rename to "fact_reviews"
[0m00:11:53.520519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.522834 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m00:11:53.523629 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.524402 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: COMMIT
[0m00:11:53.530242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m00:11:53.532853 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup"
[0m00:11:53.533693 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_reviews"
[0m00:11:53.534114 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_reviews"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_reviews__dbt_backup" cascade
[0m00:11:53.541498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:11:53.543460 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_reviews: Close
[0m00:11:53.544453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2ACD47D0>]}
[0m00:11:53.545599 [info ] [Thread-1 (]: 10 of 11 OK created sql table model dw_dw.fact_reviews ......................... [[32mSELECT 1112[0m in 0.27s]
[0m00:11:53.546805 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_reviews
[0m00:11:53.578039 [debug] [Thread-2 (]: SQL status: SELECT 13856 in 0.324 seconds
[0m00:11:53.581829 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.582360 [debug] [Thread-4 (]: SQL status: SELECT 37169 in 0.696 seconds
[0m00:11:53.582780 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_invoices" rename to "fact_invoices__dbt_backup"
[0m00:11:53.586246 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:53.586830 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_analytic_events" rename to "fact_analytic_events__dbt_backup"
[0m00:11:53.587292 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.590358 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.591262 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:11:53.592002 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_tmp" rename to "fact_invoices"
[0m00:11:53.595811 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:53.596399 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_tmp" rename to "fact_analytic_events"
[0m00:11:53.596965 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.597596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.599856 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: COMMIT
[0m00:11:53.601854 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: COMMIT
[0m00:11:53.602406 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.602821 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:53.603216 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: COMMIT
[0m00:11:53.603597 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: COMMIT
[0m00:11:53.606599 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m00:11:53.609167 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_backup"
[0m00:11:53.609620 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m00:11:53.610322 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_invoices"
[0m00:11:53.612834 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_backup"
[0m00:11:53.613327 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_invoices"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_invoices__dbt_backup" cascade
[0m00:11:53.614171 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.fact_analytic_events"
[0m00:11:53.614685 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_analytic_events"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_analytic_events__dbt_backup" cascade
[0m00:11:53.621344 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:11:53.621824 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:11:53.623186 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_invoices: Close
[0m00:11:53.624644 [debug] [Thread-4 (]: On model.dw_northwind_metabase.fact_analytic_events: Close
[0m00:11:53.625491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2AF42030>]}
[0m00:11:53.626179 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2AEFCA70>]}
[0m00:11:53.626980 [info ] [Thread-2 (]: 9 of 11 OK created sql table model dw_dw.fact_invoices ......................... [[32mSELECT 13856[0m in 0.47s]
[0m00:11:53.629011 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_invoices
[0m00:11:53.627786 [info ] [Thread-4 (]: 7 of 11 OK created sql table model dw_dw.fact_analytic_events .................. [[32mSELECT 37169[0m in 0.86s]
[0m00:11:53.630443 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.fact_analytic_events
[0m00:11:53.918613 [debug] [Thread-3 (]: SQL status: SELECT 20915 in 0.521 seconds
[0m00:11:53.922426 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.922902 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m00:11:53.923834 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:11:53.928200 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.928796 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m00:11:53.929877 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:53.931637 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m00:11:53.932099 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.932517 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m00:11:53.980902 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m00:11:53.984011 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m00:11:53.984886 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:11:53.985353 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m00:11:53.992378 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m00:11:53.994452 [debug] [Thread-3 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m00:11:53.995301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0485a-07da-46ff-b41b-4c9f1aa83514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2AEFD010>]}
[0m00:11:53.996219 [info ] [Thread-3 (]: 11 of 11 OK created sql table model dw_dw.fact_sales ........................... [[32mSELECT 20915[0m in 0.71s]
[0m00:11:53.997448 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m00:11:53.999924 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:54.000625 [debug] [MainThread]: On master: BEGIN
[0m00:11:54.001178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:54.050383 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:11:54.050879 [debug] [MainThread]: On master: COMMIT
[0m00:11:54.051212 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:54.051500 [debug] [MainThread]: On master: COMMIT
[0m00:11:54.051919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:54.052217 [debug] [MainThread]: On master: Close
[0m00:11:54.052734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:54.053091 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m00:11:54.053631 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m00:11:54.054057 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m00:11:54.054483 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m00:11:54.054880 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m00:11:54.055279 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_analytic_events' was properly closed.
[0m00:11:54.055664 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_invoices' was properly closed.
[0m00:11:54.056033 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_reviews' was properly closed.
[0m00:11:54.056414 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m00:11:54.056962 [info ] [MainThread]: 
[0m00:11:54.057549 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m00:11:54.060317 [debug] [MainThread]: Command end result
[0m00:11:54.122271 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:11:54.127667 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:11:54.136098 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:11:54.136768 [info ] [MainThread]: 
[0m00:11:54.137435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:54.138220 [info ] [MainThread]: 
[0m00:11:54.139081 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m00:11:54.141091 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:54.140887 after 3.94 seconds
[0m00:11:54.141726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB28A8DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B05FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB2B05F950>]}
[0m00:11:54.142576 [debug] [MainThread]: Flushing usage events
[0m00:11:55.416344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:08.595345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF02F0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF0B98910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF229BED0>]}


============================== 00:12:08.600032 | 60ec26d7-0d77-44bb-9422-7e28ab6b2785 ==============================
[0m00:12:08.600032 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:12:08.600687 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dm_*', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:12:08.818949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60ec26d7-0d77-44bb-9422-7e28ab6b2785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF0529F30>]}
[0m00:12:08.883289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60ec26d7-0d77-44bb-9422-7e28ab6b2785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF232BDF0>]}
[0m00:12:08.884605 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:12:09.288124 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:12:09.604423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:09.605345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:09.715525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ec26d7-0d77-44bb-9422-7e28ab6b2785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF2623350>]}
[0m00:12:09.877540 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:12:09.881674 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:12:10.018157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ec26d7-0d77-44bb-9422-7e28ab6b2785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AECD38F50>]}
[0m00:12:10.019252 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:12:10.020323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ec26d7-0d77-44bb-9422-7e28ab6b2785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF24D9A90>]}
[0m00:12:10.022535 [warn ] [MainThread]: The selection criterion 'dm_*' does not match any enabled nodes
[0m00:12:10.025539 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:12:10.029599 [debug] [MainThread]: Command end result
[0m00:12:10.095377 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:12:10.100859 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:12:10.106859 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:12:10.110165 [debug] [MainThread]: Command `dbt run` succeeded at 00:12:10.109008 after 1.63 seconds
[0m00:12:10.110939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF2AC0BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF20E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AF2AB5FD0>]}
[0m00:12:10.111507 [debug] [MainThread]: Flushing usage events
[0m00:12:11.176199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:39.821386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5170C0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F517968910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51909BED0>]}


============================== 00:12:39.826578 | 1761ac54-cef4-44ea-9ed2-62089c4d7ac3 ==============================
[0m00:12:39.826578 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:12:39.827998 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m00:12:40.067765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1761ac54-cef4-44ea-9ed2-62089c4d7ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5172F9F30>]}
[0m00:12:40.155882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1761ac54-cef4-44ea-9ed2-62089c4d7ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51910FDF0>]}
[0m00:12:40.157626 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:12:40.575984 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:12:40.769878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:40.770670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:40.838463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1761ac54-cef4-44ea-9ed2-62089c4d7ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51941F350>]}
[0m00:12:40.958334 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:12:40.962727 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:12:41.086362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1761ac54-cef4-44ea-9ed2-62089c4d7ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5199266C0>]}
[0m00:12:41.087088 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:12:41.087817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1761ac54-cef4-44ea-9ed2-62089c4d7ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F519268D70>]}
[0m00:12:41.095348 [info ] [MainThread]: 
[0m00:12:41.096079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:12:41.096705 [info ] [MainThread]: 
[0m00:12:41.097586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:41.105044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m00:12:41.121690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m00:12:41.124610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m00:12:41.128933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m00:12:41.251247 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:12:41.251785 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:12:41.252192 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:12:41.252533 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:12:41.252882 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:12:41.253243 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:12:41.253584 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:12:41.253909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:41.254232 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:12:41.254540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:41.254887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:41.255391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:41.345703 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m00:12:41.346491 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:12:41.347198 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:12:41.348925 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m00:12:41.349879 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:12:41.350628 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:12:41.351530 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m00:12:41.352193 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:12:41.352861 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m00:12:41.353569 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:12:41.354230 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:12:41.355065 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:12:41.358483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:12:41.360799 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:12:41.361610 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m00:12:41.363315 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:12:41.363825 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:12:41.364197 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.009 seconds
[0m00:12:41.364517 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:12:41.364846 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:12:41.366937 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:12:41.367694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m00:12:41.369147 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:12:41.369757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:12:41.370631 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:12:41.372406 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:12:41.374190 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:12:41.374576 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:12:41.374948 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:12:41.375451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_sales)
[0m00:12:41.375982 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:12:41.379264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:41.379955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dw)
[0m00:12:41.383809 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:12:41.384363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:41.386599 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:12:41.387159 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:12:41.388105 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:12:41.388764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:41.389441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:41.456102 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m00:12:41.456701 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:12:41.457296 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:12:41.462345 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m00:12:41.462810 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:12:41.463195 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:12:41.464356 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m00:12:41.464995 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:12:41.465615 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:12:41.466327 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m00:12:41.467925 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:12:41.468571 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:12:41.471473 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m00:12:41.471964 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:12:41.472392 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:12:41.472891 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:12:41.474093 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:12:41.474750 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:12:41.475279 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:12:41.476910 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:12:41.477625 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:12:41.482125 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m00:12:41.483463 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:12:41.483977 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:12:41.491828 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:41.492238 [debug] [MainThread]: On master: BEGIN
[0m00:12:41.492568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:41.543283 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m00:12:41.543692 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:41.544196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:12:41.554843 [debug] [MainThread]: SQL status: SELECT 24 in 0.010 seconds
[0m00:12:41.557364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1761ac54-cef4-44ea-9ed2-62089c4d7ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F519BB5300>]}
[0m00:12:41.557790 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:41.558241 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:41.558530 [debug] [MainThread]: On master: BEGIN
[0m00:12:41.559149 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:12:41.559530 [debug] [MainThread]: On master: COMMIT
[0m00:12:41.559857 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:41.560202 [debug] [MainThread]: On master: COMMIT
[0m00:12:41.561241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:12:41.561761 [debug] [MainThread]: On master: Close
[0m00:12:41.566675 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m00:12:41.567145 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m00:12:41.567509 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m00:12:41.567898 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m00:12:41.568284 [info ] [Thread-1 (]: 1 of 74 START test not_null_dim_channel_channel_nk ............................. [RUN]
[0m00:12:41.568637 [info ] [Thread-3 (]: 3 of 74 START test not_null_dim_date_date_day .................................. [RUN]
[0m00:12:41.570019 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac'
[0m00:12:41.570532 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2'
[0m00:12:41.569079 [info ] [Thread-4 (]: 4 of 74 START test not_null_dim_date_date_sk ................................... [RUN]
[0m00:12:41.571034 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m00:12:41.571424 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m00:12:41.569450 [info ] [Thread-2 (]: 2 of 74 START test not_null_dim_channel_channel_sk ............................. [RUN]
[0m00:12:41.572002 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994'
[0m00:12:41.591706 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac"
[0m00:12:41.598624 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2"
[0m00:12:41.599286 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114'
[0m00:12:41.599724 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m00:12:41.600367 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m00:12:41.604250 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994"
[0m00:12:41.610923 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114"
[0m00:12:41.613527 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m00:12:41.645751 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2"
[0m00:12:41.647063 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m00:12:41.651173 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac"
[0m00:12:41.651718 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m00:12:41.654722 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994"
[0m00:12:41.655668 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m00:12:41.661216 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114"
[0m00:12:41.664172 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2"
[0m00:12:41.664897 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac"
[0m00:12:41.665457 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994"
[0m00:12:41.666180 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2: BEGIN
[0m00:12:41.666903 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac: BEGIN
[0m00:12:41.667528 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994: BEGIN
[0m00:12:41.668361 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114"
[0m00:12:41.668823 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:12:41.669528 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:12:41.670351 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:12:41.671425 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114: BEGIN
[0m00:12:41.673053 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:12:41.741233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m00:12:41.741881 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac"
[0m00:12:41.742688 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."dim_channel"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.745321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:12:41.751115 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac: ROLLBACK
[0m00:12:41.751926 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac: Close
[0m00:12:41.752510 [debug] [Thread-4 (]: SQL status: BEGIN in 0.082 seconds
[0m00:12:41.753070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.084 seconds
[0m00:12:41.753696 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994"
[0m00:12:41.755387 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2"
[0m00:12:41.755959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m00:12:41.754667 [info ] [Thread-1 (]: 1 of 74 PASS not_null_dim_channel_channel_nk ................................... [[32mPASS[0m in 0.18s]
[0m00:12:41.756604 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_sk
from "dw_northwind_metabase"."dw_dw"."dim_date"
where date_sk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.757044 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "dw_northwind_metabase"."dw_dw"."dim_date"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.757500 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114"
[0m00:12:41.758140 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m00:12:41.758770 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "dw_northwind_metabase"."dw_dw"."dim_channel"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.759492 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m00:12:41.760687 [info ] [Thread-1 (]: 5 of 74 START test not_null_dim_employee_employee_nk ........................... [RUN]
[0m00:12:41.762063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac, now test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703)
[0m00:12:41.762871 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:41.763555 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m00:12:41.766209 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114: ROLLBACK
[0m00:12:41.766791 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m00:12:41.767534 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m00:12:41.772706 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703"
[0m00:12:41.774325 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2: ROLLBACK
[0m00:12:41.774750 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114: Close
[0m00:12:41.776369 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994: ROLLBACK
[0m00:12:41.781016 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2: Close
[0m00:12:41.782271 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994: Close
[0m00:12:41.779871 [info ] [Thread-2 (]: 2 of 74 PASS not_null_dim_channel_channel_sk ................................... [[32mPASS[0m in 0.18s]
[0m00:12:41.784566 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m00:12:41.786229 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m00:12:41.783589 [info ] [Thread-3 (]: 3 of 74 PASS not_null_dim_date_date_day ........................................ [[32mPASS[0m in 0.21s]
[0m00:12:41.792168 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703"
[0m00:12:41.793448 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m00:12:41.787662 [info ] [Thread-4 (]: 4 of 74 PASS not_null_dim_date_date_sk ......................................... [[32mPASS[0m in 0.22s]
[0m00:12:41.795042 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m00:12:41.798683 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m00:12:41.797326 [info ] [Thread-2 (]: 6 of 74 START test not_null_dim_employee_employee_sk ........................... [RUN]
[0m00:12:41.799742 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m00:12:41.800952 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m00:12:41.804834 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703"
[0m00:12:41.805804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114, now test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95)
[0m00:12:41.806422 [info ] [Thread-3 (]: 7 of 74 START test not_null_dim_geography_geography_sk ......................... [RUN]
[0m00:12:41.808271 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703: BEGIN
[0m00:12:41.807111 [info ] [Thread-4 (]: 8 of 74 START test not_null_dim_product_product_nk ............................. [RUN]
[0m00:12:41.809310 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m00:12:41.810244 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2, now test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e)
[0m00:12:41.811129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:41.813123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994, now test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3)
[0m00:12:41.819332 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95"
[0m00:12:41.819951 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m00:12:41.820714 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m00:12:41.836556 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3"
[0m00:12:41.838939 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e"
[0m00:12:41.840765 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m00:12:41.846649 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95"
[0m00:12:41.848499 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m00:12:41.852533 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3"
[0m00:12:41.853691 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m00:12:41.858874 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e"
[0m00:12:41.860824 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95"
[0m00:12:41.861831 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3"
[0m00:12:41.862616 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95: BEGIN
[0m00:12:41.863362 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3: BEGIN
[0m00:12:41.863908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:41.864784 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:41.865778 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e"
[0m00:12:41.867119 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e: BEGIN
[0m00:12:41.867981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:41.902383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m00:12:41.903183 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703"
[0m00:12:41.903904 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_nk
from "dw_northwind_metabase"."dw_dw"."dim_employee"
where employee_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.908514 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:41.911728 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703: ROLLBACK
[0m00:12:41.912810 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703: Close
[0m00:12:41.914207 [info ] [Thread-1 (]: 5 of 74 PASS not_null_dim_employee_employee_nk ................................. [[32mPASS[0m in 0.15s]
[0m00:12:41.916181 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m00:12:41.917010 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m00:12:41.917772 [info ] [Thread-1 (]: 9 of 74 START test not_null_dim_product_product_sk ............................. [RUN]
[0m00:12:41.918715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703, now test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417)
[0m00:12:41.919379 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m00:12:41.926618 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417"
[0m00:12:41.928960 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m00:12:41.934543 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417"
[0m00:12:41.936340 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417"
[0m00:12:41.937196 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417: BEGIN
[0m00:12:41.938253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:41.950560 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m00:12:41.951365 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3"
[0m00:12:41.952121 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."dim_product"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.955345 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m00:12:41.958458 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3: ROLLBACK
[0m00:12:41.959813 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3: Close
[0m00:12:41.962065 [info ] [Thread-4 (]: 8 of 74 PASS not_null_dim_product_product_nk ................................... [[32mPASS[0m in 0.15s]
[0m00:12:41.965620 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m00:12:41.966550 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:12:41.967488 [info ] [Thread-4 (]: 10 of 74 START test not_null_fact_analytic_events_event_nk ..................... [RUN]
[0m00:12:41.968834 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3, now test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377)
[0m00:12:41.969749 [debug] [Thread-3 (]: SQL status: BEGIN in 0.102 seconds
[0m00:12:41.970534 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:12:41.971402 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e"
[0m00:12:41.977359 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:12:41.979457 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geography_sk
from "dw_northwind_metabase"."dw_dw"."dim_geography"
where geography_sk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.980455 [debug] [Thread-2 (]: SQL status: BEGIN in 0.116 seconds
[0m00:12:41.982049 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95"
[0m00:12:41.982976 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_sk
from "dw_northwind_metabase"."dw_dw"."dim_employee"
where employee_sk is null



  
  
      
    ) dbt_internal_test
[0m00:12:41.984505 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:41.987723 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e: ROLLBACK
[0m00:12:41.988575 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:12:41.989319 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m00:12:41.991990 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:12:41.992703 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e: Close
[0m00:12:41.996666 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95: ROLLBACK
[0m00:12:42.000503 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95: Close
[0m00:12:42.002329 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:12:42.004921 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m00:12:41.999733 [info ] [Thread-3 (]: 7 of 74 PASS not_null_dim_geography_geography_sk ............................... [[32mPASS[0m in 0.19s]
[0m00:12:42.006097 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:42.007840 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m00:12:42.008981 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:12:42.003830 [info ] [Thread-2 (]: 6 of 74 PASS not_null_dim_employee_employee_sk ................................. [[32mPASS[0m in 0.20s]
[0m00:12:42.011831 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m00:12:42.014041 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:12:42.010318 [info ] [Thread-3 (]: 11 of 74 START test not_null_fact_feedback_feedback_nk ......................... [RUN]
[0m00:12:42.016801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e, now test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901)
[0m00:12:42.017754 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:12:42.015353 [info ] [Thread-2 (]: 12 of 74 START test not_null_fact_invoices_customer_nk ......................... [RUN]
[0m00:12:42.027263 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:12:42.029489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95, now test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18)
[0m00:12:42.030584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m00:12:42.031954 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:12:42.033154 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417"
[0m00:12:42.040977 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:12:42.041910 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "dw_northwind_metabase"."dw_dw"."dim_product"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.042860 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:12:42.049863 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:12:42.050957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:12:42.054247 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417: ROLLBACK
[0m00:12:42.055922 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:12:42.056730 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417: Close
[0m00:12:42.057479 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m00:12:42.058324 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:12:42.060314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:42.067157 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:12:42.062763 [info ] [Thread-1 (]: 9 of 74 PASS not_null_dim_product_product_sk ................................... [[32mPASS[0m in 0.14s]
[0m00:12:42.068919 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m00:12:42.069720 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:12:42.070696 [info ] [Thread-1 (]: 13 of 74 START test not_null_fact_invoices_invoice_nk .......................... [RUN]
[0m00:12:42.071890 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:12:42.073019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417, now test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6)
[0m00:12:42.074107 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m00:12:42.074948 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:12:42.076019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:42.085982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:12:42.088258 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:12:42.094190 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:12:42.097219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m00:12:42.098337 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:12:42.099382 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.100738 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:12:42.101539 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m00:12:42.102252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:42.113349 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m00:12:42.116151 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m00:12:42.117218 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m00:12:42.118478 [info ] [Thread-4 (]: 10 of 74 PASS not_null_fact_analytic_events_event_nk ........................... [[32mPASS[0m in 0.15s]
[0m00:12:42.123480 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:12:42.124240 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:12:42.124931 [info ] [Thread-4 (]: 14 of 74 START test not_null_fact_reviews_product_nk ........................... [RUN]
[0m00:12:42.133148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m00:12:42.133936 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:12:42.140516 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:12:42.142375 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:12:42.148625 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:12:42.151202 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:12:42.151993 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m00:12:42.152812 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:42.170436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m00:12:42.171332 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:12:42.172315 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.176969 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:42.180486 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m00:12:42.181551 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m00:12:42.183017 [info ] [Thread-3 (]: 11 of 74 PASS not_null_fact_feedback_feedback_nk ............................... [[32mPASS[0m in 0.17s]
[0m00:12:42.184654 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:12:42.185548 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:12:42.186438 [info ] [Thread-3 (]: 15 of 74 START test not_null_fact_reviews_review_nk ............................ [RUN]
[0m00:12:42.189497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m00:12:42.190610 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:12:42.199344 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:12:42.200426 [debug] [Thread-2 (]: SQL status: BEGIN in 0.125 seconds
[0m00:12:42.201244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m00:12:42.201970 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:12:42.202756 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:12:42.203630 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.204752 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.206157 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:12:42.210846 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:12:42.212673 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:12:42.216330 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m00:12:42.217235 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:12:42.220229 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m00:12:42.221060 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m00:12:42.221750 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:12:42.222297 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m00:12:42.222977 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m00:12:42.224520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:42.223770 [info ] [Thread-1 (]: 13 of 74 PASS not_null_fact_invoices_invoice_nk ................................ [[32mPASS[0m in 0.15s]
[0m00:12:42.227646 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:12:42.228610 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:12:42.225776 [info ] [Thread-2 (]: 12 of 74 PASS not_null_fact_invoices_customer_nk ............................... [[32mPASS[0m in 0.20s]
[0m00:12:42.231747 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:12:42.229600 [info ] [Thread-1 (]: 16 of 74 START test not_null_fact_sales_channel_nk ............................. [RUN]
[0m00:12:42.233535 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:12:42.234444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m00:12:42.235648 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:12:42.235061 [info ] [Thread-2 (]: 17 of 74 START test not_null_fact_sales_customer_nk ............................ [RUN]
[0m00:12:42.242178 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:12:42.242996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m00:12:42.243984 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:12:42.249843 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m00:12:42.251207 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:12:42.251877 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:12:42.252651 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.253440 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:12:42.256438 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:12:42.257000 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:42.259140 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m00:12:42.260179 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:12:42.261037 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m00:12:42.264835 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:12:42.267489 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:12:42.266656 [info ] [Thread-4 (]: 14 of 74 PASS not_null_fact_reviews_product_nk ................................. [[32mPASS[0m in 0.13s]
[0m00:12:42.268487 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m00:12:42.269328 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:12:42.269893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:42.270680 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:12:42.272199 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:12:42.271514 [info ] [Thread-4 (]: 18 of 74 START test not_null_fact_sales_order_nk ............................... [RUN]
[0m00:12:42.273344 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m00:12:42.274284 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m00:12:42.274865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:42.275466 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:12:42.284751 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:12:42.286478 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:12:42.304499 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:12:42.305861 [debug] [Thread-3 (]: SQL status: BEGIN in 0.081 seconds
[0m00:12:42.306401 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:12:42.306966 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.307889 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:12:42.308649 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m00:12:42.309718 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:42.310527 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:42.313080 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m00:12:42.314323 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m00:12:42.315860 [info ] [Thread-3 (]: 15 of 74 PASS not_null_fact_reviews_review_nk .................................. [[32mPASS[0m in 0.13s]
[0m00:12:42.317101 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:12:42.317759 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:12:42.318509 [info ] [Thread-3 (]: 19 of 74 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m00:12:42.319530 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m00:12:42.320103 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:12:42.326213 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:12:42.328275 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:12:42.332867 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:12:42.335039 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:12:42.335747 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m00:12:42.336344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:42.356288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m00:12:42.357049 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:12:42.357710 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.360103 [debug] [Thread-2 (]: SQL status: BEGIN in 0.085 seconds
[0m00:12:42.361091 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:12:42.362371 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.368148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m00:12:42.370578 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m00:12:42.371131 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m00:12:42.372799 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m00:12:42.373341 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m00:12:42.374131 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m00:12:42.375207 [info ] [Thread-1 (]: 16 of 74 PASS not_null_fact_sales_channel_nk ................................... [[32mPASS[0m in 0.14s]
[0m00:12:42.378113 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:12:42.376991 [info ] [Thread-2 (]: 17 of 74 PASS not_null_fact_sales_customer_nk .................................. [[32mPASS[0m in 0.13s]
[0m00:12:42.379033 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:12:42.379903 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:12:42.381432 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:12:42.380654 [info ] [Thread-1 (]: 20 of 74 START test not_null_int_customers_customer_name ....................... [RUN]
[0m00:12:42.383254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57)
[0m00:12:42.383934 [debug] [Thread-4 (]: SQL status: BEGIN in 0.074 seconds
[0m00:12:42.382429 [info ] [Thread-2 (]: 21 of 74 START test not_null_int_customers_customer_nk ......................... [RUN]
[0m00:12:42.384642 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:12:42.385298 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:12:42.385905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1)
[0m00:12:42.391763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:12:42.392371 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.393128 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:12:42.402586 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:12:42.403255 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m00:12:42.406334 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m00:12:42.407613 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m00:12:42.408187 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m00:12:42.408854 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:12:42.410599 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:12:42.409831 [info ] [Thread-4 (]: 18 of 74 PASS not_null_fact_sales_order_nk ..................................... [[32mPASS[0m in 0.14s]
[0m00:12:42.411877 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:12:42.417391 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:12:42.417981 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.418970 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:12:42.422330 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:12:42.423350 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:12:42.424284 [info ] [Thread-4 (]: 22 of 74 START test not_null_int_customers_source_system ....................... [RUN]
[0m00:12:42.425291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7)
[0m00:12:42.426407 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:12:42.434059 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:12:42.434772 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m00:12:42.436918 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m00:12:42.437518 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:12:42.438163 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:12:42.438701 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m00:12:42.439221 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: BEGIN
[0m00:12:42.439722 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: BEGIN
[0m00:12:42.440352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:42.443269 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:42.441621 [info ] [Thread-3 (]: 19 of 74 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.12s]
[0m00:12:42.444314 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:12:42.446003 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:12:42.448877 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:12:42.449469 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m00:12:42.450268 [info ] [Thread-3 (]: 23 of 74 START test not_null_stg_metabase_accounts_customer_nk ................. [RUN]
[0m00:12:42.451352 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711)
[0m00:12:42.452617 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m00:12:42.460295 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711"
[0m00:12:42.461272 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:12:42.462661 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: BEGIN
[0m00:12:42.463490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:42.466693 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m00:12:42.472043 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711"
[0m00:12:42.474384 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711"
[0m00:12:42.475187 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711: BEGIN
[0m00:12:42.475891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:42.529030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m00:12:42.529795 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:12:42.530323 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.541796 [debug] [Thread-2 (]: SQL status: BEGIN in 0.099 seconds
[0m00:12:42.542530 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:12:42.543315 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.550822 [debug] [Thread-4 (]: SQL status: BEGIN in 0.087 seconds
[0m00:12:42.551653 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:12:42.552301 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_system
from "dw_northwind_metabase"."dw_stg"."int_customers"
where source_system is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.558998 [debug] [Thread-3 (]: SQL status: BEGIN in 0.083 seconds
[0m00:12:42.559968 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711"
[0m00:12:42.560878 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.564130 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:12:42.566380 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: ROLLBACK
[0m00:12:42.567415 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: Close
[0m00:12:42.568638 [info ] [Thread-4 (]: 22 of 74 PASS not_null_int_customers_source_system ............................. [[32mPASS[0m in 0.14s]
[0m00:12:42.570050 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:12:42.570959 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m00:12:42.571977 [info ] [Thread-4 (]: 24 of 74 START test not_null_stg_metabase_analytic_events_event_nk ............. [RUN]
[0m00:12:42.573619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7, now test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e)
[0m00:12:42.574371 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m00:12:42.580863 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e"
[0m00:12:42.582581 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m00:12:42.587163 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e"
[0m00:12:42.589050 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e"
[0m00:12:42.590018 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e: BEGIN
[0m00:12:42.590839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:42.663719 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.102 seconds
[0m00:12:42.666036 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711: ROLLBACK
[0m00:12:42.667253 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711: Close
[0m00:12:42.667968 [debug] [Thread-4 (]: SQL status: BEGIN in 0.077 seconds
[0m00:12:42.668753 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e"
[0m00:12:42.670603 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.669883 [info ] [Thread-3 (]: 23 of 74 PASS not_null_stg_metabase_accounts_customer_nk ....................... [[32mPASS[0m in 0.22s]
[0m00:12:42.672257 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m00:12:42.673042 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m00:12:42.673692 [info ] [Thread-3 (]: 25 of 74 START test not_null_stg_metabase_feedback_feedback_nk ................. [RUN]
[0m00:12:42.676190 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711, now test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966)
[0m00:12:42.677168 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m00:12:42.683765 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966"
[0m00:12:42.685079 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m00:12:42.688660 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966"
[0m00:12:42.690523 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966"
[0m00:12:42.691570 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966: BEGIN
[0m00:12:42.692318 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:42.722840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.192 seconds
[0m00:12:42.724583 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: ROLLBACK
[0m00:12:42.725604 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: Close
[0m00:12:42.726969 [info ] [Thread-1 (]: 20 of 74 PASS not_null_int_customers_customer_name ............................. [[32mPASS[0m in 0.34s]
[0m00:12:42.728721 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:12:42.729960 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m00:12:42.730887 [info ] [Thread-1 (]: 26 of 74 START test not_null_stg_metabase_invoices_customer_nk ................. [RUN]
[0m00:12:42.731927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57, now test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e)
[0m00:12:42.732697 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m00:12:42.740151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e"
[0m00:12:42.742017 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m00:12:42.747262 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e"
[0m00:12:42.750879 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e"
[0m00:12:42.752119 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e: BEGIN
[0m00:12:42.752893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:42.757735 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.214 seconds
[0m00:12:42.760694 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: ROLLBACK
[0m00:12:42.763129 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: Close
[0m00:12:42.765384 [info ] [Thread-2 (]: 21 of 74 PASS not_null_int_customers_customer_nk ............................... [[32mPASS[0m in 0.38s]
[0m00:12:42.766852 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:12:42.767713 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m00:12:42.768574 [info ] [Thread-2 (]: 27 of 74 START test not_null_stg_metabase_invoices_invoice_nk .................. [RUN]
[0m00:12:42.772601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1, now test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8)
[0m00:12:42.773515 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m00:12:42.782300 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8"
[0m00:12:42.784195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.092 seconds
[0m00:12:42.784994 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966"
[0m00:12:42.785760 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.786801 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m00:12:42.791625 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8"
[0m00:12:42.793539 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8"
[0m00:12:42.794435 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8: BEGIN
[0m00:12:42.795157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:42.864246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.111 seconds
[0m00:12:42.865097 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e"
[0m00:12:42.866025 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.927976 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.256 seconds
[0m00:12:42.930821 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e: ROLLBACK
[0m00:12:42.932332 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e: Close
[0m00:12:42.934426 [debug] [Thread-2 (]: SQL status: BEGIN in 0.139 seconds
[0m00:12:42.933707 [info ] [Thread-4 (]: 24 of 74 PASS not_null_stg_metabase_analytic_events_event_nk ................... [[32mPASS[0m in 0.36s]
[0m00:12:42.935533 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8"
[0m00:12:42.936614 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m00:12:42.937498 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:42.938449 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m00:12:42.939525 [info ] [Thread-4 (]: 28 of 74 START test not_null_stg_metabase_orders_customer_nk ................... [RUN]
[0m00:12:42.940602 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e, now test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290)
[0m00:12:42.941394 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m00:12:42.941964 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.155 seconds
[0m00:12:42.950657 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290"
[0m00:12:42.952713 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966: ROLLBACK
[0m00:12:42.953932 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966: Close
[0m00:12:42.956355 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m00:12:42.955334 [info ] [Thread-3 (]: 25 of 74 PASS not_null_stg_metabase_feedback_feedback_nk ....................... [[32mPASS[0m in 0.28s]
[0m00:12:42.963151 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290"
[0m00:12:42.964509 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m00:12:42.965590 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m00:12:42.966478 [info ] [Thread-3 (]: 29 of 74 START test not_null_stg_metabase_orders_order_nk ...................... [RUN]
[0m00:12:42.967431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966, now test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122)
[0m00:12:42.968191 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m00:12:42.974055 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122"
[0m00:12:42.974959 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290"
[0m00:12:42.975727 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290: BEGIN
[0m00:12:42.976624 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:42.980240 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m00:12:42.984340 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122"
[0m00:12:42.985945 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122"
[0m00:12:42.986759 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122: BEGIN
[0m00:12:42.987394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:43.055118 [debug] [Thread-4 (]: SQL status: BEGIN in 0.079 seconds
[0m00:12:43.055902 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290"
[0m00:12:43.056464 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.066373 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m00:12:43.066919 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122"
[0m00:12:43.067345 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.070483 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.204 seconds
[0m00:12:43.073288 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e: ROLLBACK
[0m00:12:43.074305 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e: Close
[0m00:12:43.075077 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.136 seconds
[0m00:12:43.078066 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8: ROLLBACK
[0m00:12:43.079440 [info ] [Thread-1 (]: 26 of 74 PASS not_null_stg_metabase_invoices_customer_nk ....................... [[32mPASS[0m in 0.35s]
[0m00:12:43.080947 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m00:12:43.081719 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8: Close
[0m00:12:43.082536 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:12:43.083523 [info ] [Thread-1 (]: 30 of 74 START test not_null_stg_metabase_people_customer_nk ................... [RUN]
[0m00:12:43.086161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e, now test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53)
[0m00:12:43.084476 [info ] [Thread-2 (]: 27 of 74 PASS not_null_stg_metabase_invoices_invoice_nk ........................ [[32mPASS[0m in 0.31s]
[0m00:12:43.087287 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:12:43.088680 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m00:12:43.097889 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:12:43.098880 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m00:12:43.099865 [info ] [Thread-2 (]: 31 of 74 START test not_null_stg_metabase_products_product_nk .................. [RUN]
[0m00:12:43.100757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8, now test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300)
[0m00:12:43.101322 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m00:12:43.106881 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300"
[0m00:12:43.107785 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:12:43.111784 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:12:43.112865 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m00:12:43.116183 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300"
[0m00:12:43.117115 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:12:43.117708 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: BEGIN
[0m00:12:43.118314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:43.119710 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300"
[0m00:12:43.120666 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300: BEGIN
[0m00:12:43.121432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:43.191877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m00:12:43.192599 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:12:43.193230 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.197102 [debug] [Thread-2 (]: SQL status: BEGIN in 0.076 seconds
[0m00:12:43.197863 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300"
[0m00:12:43.198616 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_products"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.226350 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.158 seconds
[0m00:12:43.228731 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122: ROLLBACK
[0m00:12:43.229742 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122: Close
[0m00:12:43.231093 [info ] [Thread-3 (]: 29 of 74 PASS not_null_stg_metabase_orders_order_nk ............................ [[32mPASS[0m in 0.26s]
[0m00:12:43.233758 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m00:12:43.234681 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m00:12:43.235419 [info ] [Thread-3 (]: 32 of 74 START test not_null_stg_metabase_reviews_product_nk ................... [RUN]
[0m00:12:43.238311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122, now test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d)
[0m00:12:43.239082 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m00:12:43.246378 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d"
[0m00:12:43.249263 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m00:12:43.253125 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d"
[0m00:12:43.253694 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.197 seconds
[0m00:12:43.255695 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290: ROLLBACK
[0m00:12:43.257138 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290: Close
[0m00:12:43.258686 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d"
[0m00:12:43.260914 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d: BEGIN
[0m00:12:43.262443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:43.260021 [info ] [Thread-4 (]: 28 of 74 PASS not_null_stg_metabase_orders_customer_nk ......................... [[32mPASS[0m in 0.32s]
[0m00:12:43.264752 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m00:12:43.265597 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m00:12:43.266616 [info ] [Thread-4 (]: 33 of 74 START test not_null_stg_metabase_reviews_review_nk .................... [RUN]
[0m00:12:43.267876 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290, now test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044)
[0m00:12:43.268728 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m00:12:43.276342 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044"
[0m00:12:43.278248 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m00:12:43.284273 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044"
[0m00:12:43.286225 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044"
[0m00:12:43.287162 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044: BEGIN
[0m00:12:43.287935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:43.304796 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.111 seconds
[0m00:12:43.313254 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: ROLLBACK
[0m00:12:43.314033 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.115 seconds
[0m00:12:43.316467 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300: ROLLBACK
[0m00:12:43.317194 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: Close
[0m00:12:43.319579 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300: Close
[0m00:12:43.318805 [info ] [Thread-1 (]: 30 of 74 PASS not_null_stg_metabase_people_customer_nk ......................... [[32mPASS[0m in 0.23s]
[0m00:12:43.321032 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:12:43.321936 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m00:12:43.322773 [info ] [Thread-1 (]: 34 of 74 START test not_null_stg_northwind_customers_customer_name ............. [RUN]
[0m00:12:43.325398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53, now test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef)
[0m00:12:43.326142 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m00:12:43.323739 [info ] [Thread-2 (]: 31 of 74 PASS not_null_stg_metabase_products_product_nk ........................ [[32mPASS[0m in 0.22s]
[0m00:12:43.333823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef"
[0m00:12:43.334955 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m00:12:43.335728 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m00:12:43.336319 [info ] [Thread-2 (]: 35 of 74 START test not_null_stg_northwind_customers_customer_nk ............... [RUN]
[0m00:12:43.337344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300, now test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a)
[0m00:12:43.337987 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m00:12:43.343551 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a"
[0m00:12:43.344791 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m00:12:43.352167 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef"
[0m00:12:43.354002 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m00:12:43.354987 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef"
[0m00:12:43.359711 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a"
[0m00:12:43.361172 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef: BEGIN
[0m00:12:43.362349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:43.364108 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a"
[0m00:12:43.366065 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a: BEGIN
[0m00:12:43.367264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:43.370150 [debug] [Thread-4 (]: SQL status: BEGIN in 0.082 seconds
[0m00:12:43.371153 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044"
[0m00:12:43.372262 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.449214 [debug] [Thread-3 (]: SQL status: BEGIN in 0.187 seconds
[0m00:12:43.450070 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d"
[0m00:12:43.450903 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.459066 [debug] [Thread-2 (]: SQL status: BEGIN in 0.092 seconds
[0m00:12:43.459790 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a"
[0m00:12:43.460636 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.466092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m00:12:43.467149 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef"
[0m00:12:43.468105 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.484325 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.111 seconds
[0m00:12:43.487592 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044: ROLLBACK
[0m00:12:43.489169 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044: Close
[0m00:12:43.490770 [info ] [Thread-4 (]: 33 of 74 PASS not_null_stg_metabase_reviews_review_nk .......................... [[32mPASS[0m in 0.22s]
[0m00:12:43.493985 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m00:12:43.494998 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m00:12:43.495824 [info ] [Thread-4 (]: 36 of 74 START test not_null_stg_northwind_employees_employee_nk ............... [RUN]
[0m00:12:43.501678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044, now test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8)
[0m00:12:43.502671 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m00:12:43.511728 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8"
[0m00:12:43.513828 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m00:12:43.518611 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8"
[0m00:12:43.520559 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8"
[0m00:12:43.521448 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8: BEGIN
[0m00:12:43.522173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:43.582881 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.131 seconds
[0m00:12:43.584910 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d: ROLLBACK
[0m00:12:43.585797 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d: Close
[0m00:12:43.586767 [info ] [Thread-3 (]: 32 of 74 PASS not_null_stg_metabase_reviews_product_nk ......................... [[32mPASS[0m in 0.35s]
[0m00:12:43.588161 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m00:12:43.588990 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m00:12:43.589788 [info ] [Thread-3 (]: 37 of 74 START test not_null_stg_northwind_order_details_order_nk .............. [RUN]
[0m00:12:43.590858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d, now test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f)
[0m00:12:43.591649 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m00:12:43.598329 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f"
[0m00:12:43.599877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.078 seconds
[0m00:12:43.600954 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8"
[0m00:12:43.601697 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"
where employee_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.602367 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m00:12:43.605429 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f"
[0m00:12:43.607099 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f"
[0m00:12:43.608025 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.146 seconds
[0m00:12:43.608836 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f: BEGIN
[0m00:12:43.611846 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a: ROLLBACK
[0m00:12:43.613089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:43.614312 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.145 seconds
[0m00:12:43.614977 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a: Close
[0m00:12:43.617361 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef: ROLLBACK
[0m00:12:43.619395 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef: Close
[0m00:12:43.618668 [info ] [Thread-2 (]: 35 of 74 PASS not_null_stg_northwind_customers_customer_nk ..................... [[32mPASS[0m in 0.28s]
[0m00:12:43.620846 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m00:12:43.622834 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m00:12:43.621988 [info ] [Thread-1 (]: 34 of 74 PASS not_null_stg_northwind_customers_customer_name ................... [[32mPASS[0m in 0.30s]
[0m00:12:43.625144 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m00:12:43.623826 [info ] [Thread-2 (]: 38 of 74 START test not_null_stg_northwind_order_details_product_nk ............ [RUN]
[0m00:12:43.627919 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m00:12:43.629235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a, now test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa)
[0m00:12:43.631258 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m00:12:43.639275 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa"
[0m00:12:43.630296 [info ] [Thread-1 (]: 39 of 74 START test not_null_stg_northwind_orders_customer_nk .................. [RUN]
[0m00:12:43.640247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef, now test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119)
[0m00:12:43.640937 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m00:12:43.649047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119"
[0m00:12:43.650291 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m00:12:43.654091 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa"
[0m00:12:43.655070 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m00:12:43.659593 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119"
[0m00:12:43.661162 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa"
[0m00:12:43.662059 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa: BEGIN
[0m00:12:43.662911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:43.664622 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119"
[0m00:12:43.665467 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119: BEGIN
[0m00:12:43.666237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:43.700636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m00:12:43.701156 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f"
[0m00:12:43.701595 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.713485 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.111 seconds
[0m00:12:43.715220 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8: ROLLBACK
[0m00:12:43.716104 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8: Close
[0m00:12:43.717373 [info ] [Thread-4 (]: 36 of 74 PASS not_null_stg_northwind_employees_employee_nk ..................... [[32mPASS[0m in 0.22s]
[0m00:12:43.719886 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m00:12:43.720717 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m00:12:43.721562 [info ] [Thread-4 (]: 40 of 74 START test not_null_stg_northwind_orders_order_nk ..................... [RUN]
[0m00:12:43.722938 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8, now test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0)
[0m00:12:43.723744 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m00:12:43.732107 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0"
[0m00:12:43.734001 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m00:12:43.738390 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0"
[0m00:12:43.741695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m00:12:43.742407 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa"
[0m00:12:43.743210 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0"
[0m00:12:43.743981 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.745305 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0: BEGIN
[0m00:12:43.746597 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:43.752460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m00:12:43.753169 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119"
[0m00:12:43.753926 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_orders"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.811629 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.109 seconds
[0m00:12:43.814396 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f: ROLLBACK
[0m00:12:43.815305 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f: Close
[0m00:12:43.816439 [info ] [Thread-3 (]: 37 of 74 PASS not_null_stg_northwind_order_details_order_nk .................... [[32mPASS[0m in 0.23s]
[0m00:12:43.818211 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m00:12:43.819163 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m00:12:43.820545 [debug] [Thread-4 (]: SQL status: BEGIN in 0.074 seconds
[0m00:12:43.821377 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0"
[0m00:12:43.819907 [info ] [Thread-3 (]: 41 of 74 START test not_null_stg_northwind_products_product_nk ................. [RUN]
[0m00:12:43.822390 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_orders"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.823377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f, now test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4)
[0m00:12:43.824259 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m00:12:43.831600 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4"
[0m00:12:43.834284 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m00:12:43.838694 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4"
[0m00:12:43.840524 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4"
[0m00:12:43.841380 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4: BEGIN
[0m00:12:43.842163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:43.856045 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.110 seconds
[0m00:12:43.858869 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa: ROLLBACK
[0m00:12:43.859883 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa: Close
[0m00:12:43.861281 [info ] [Thread-2 (]: 38 of 74 PASS not_null_stg_northwind_order_details_product_nk .................. [[32mPASS[0m in 0.23s]
[0m00:12:43.863159 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m00:12:43.864032 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:12:43.865640 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.111 seconds
[0m00:12:43.867720 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119: ROLLBACK
[0m00:12:43.864963 [info ] [Thread-2 (]: 42 of 74 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:12:43.868563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m00:12:43.869111 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119: Close
[0m00:12:43.869721 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:12:43.884053 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:12:43.884774 [info ] [Thread-1 (]: 39 of 74 PASS not_null_stg_northwind_orders_customer_nk ........................ [[32mPASS[0m in 0.24s]
[0m00:12:43.885855 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m00:12:43.886465 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:12:43.887143 [info ] [Thread-1 (]: 43 of 74 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:12:43.888253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m00:12:43.889114 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:12:43.889784 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:12:43.897770 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:12:43.900303 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:12:43.902255 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:12:43.903092 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m00:12:43.903854 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:43.904673 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:12:43.908624 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:12:43.911032 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:12:43.912159 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m00:12:43.913935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:43.918354 [debug] [Thread-3 (]: SQL status: BEGIN in 0.076 seconds
[0m00:12:43.919557 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4"
[0m00:12:43.920419 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_stg"."stg_northwind_products"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.933049 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.109 seconds
[0m00:12:43.935465 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0: ROLLBACK
[0m00:12:43.936388 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0: Close
[0m00:12:43.937295 [info ] [Thread-4 (]: 40 of 74 PASS not_null_stg_northwind_orders_order_nk ........................... [[32mPASS[0m in 0.21s]
[0m00:12:43.938548 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m00:12:43.939364 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:12:43.940177 [info ] [Thread-4 (]: 44 of 74 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:12:43.941265 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m00:12:43.942129 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:12:43.952756 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:12:43.954750 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:12:43.958263 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:12:43.959715 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:12:43.960613 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m00:12:43.961467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:43.985734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m00:12:43.986284 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:12:43.986766 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:43.994072 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:12:43.997308 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m00:12:43.998450 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m00:12:43.999641 [info ] [Thread-1 (]: 43 of 74 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.11s]
[0m00:12:44.000739 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:12:44.001292 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:12:44.002015 [info ] [Thread-1 (]: 45 of 74 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m00:12:44.002892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m00:12:44.003370 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:12:44.009575 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:12:44.011993 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:12:44.015536 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:12:44.017250 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:12:44.017879 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m00:12:44.018349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.020925 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.100 seconds
[0m00:12:44.022715 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4: ROLLBACK
[0m00:12:44.023624 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4: Close
[0m00:12:44.024604 [info ] [Thread-3 (]: 41 of 74 PASS not_null_stg_northwind_products_product_nk ....................... [[32mPASS[0m in 0.20s]
[0m00:12:44.025826 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m00:12:44.026398 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:12:44.027383 [info ] [Thread-3 (]: 46 of 74 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m00:12:44.033504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m00:12:44.034340 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:12:44.040608 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:12:44.042243 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:12:44.047260 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:12:44.049672 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:12:44.050223 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m00:12:44.050722 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:44.090035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.186 seconds
[0m00:12:44.090745 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:12:44.091347 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:44.091956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m00:12:44.092512 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:12:44.093037 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:44.097822 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:44.100531 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m00:12:44.101625 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m00:12:44.102954 [info ] [Thread-1 (]: 45 of 74 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.10s]
[0m00:12:44.104480 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:12:44.105410 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:12:44.106280 [info ] [Thread-1 (]: 47 of 74 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:12:44.107994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m00:12:44.108849 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:12:44.117885 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:12:44.119439 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.027 seconds
[0m00:12:44.122598 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m00:12:44.123692 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:12:44.128818 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:12:44.130142 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m00:12:44.131197 [debug] [Thread-3 (]: SQL status: BEGIN in 0.080 seconds
[0m00:12:44.132979 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:12:44.135210 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:44.134292 [info ] [Thread-2 (]: 42 of 74 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.27s]
[0m00:12:44.137213 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:12:44.138501 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:12:44.140665 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:12:44.139586 [info ] [Thread-2 (]: 48 of 74 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m00:12:44.141843 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m00:12:44.142803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m00:12:44.144028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.145083 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:12:44.156960 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:12:44.158425 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m00:12:44.159323 [debug] [Thread-4 (]: SQL status: BEGIN in 0.198 seconds
[0m00:12:44.162435 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m00:12:44.163909 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:12:44.165167 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:44.166290 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m00:12:44.167315 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:12:44.173828 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:12:44.169023 [info ] [Thread-3 (]: 46 of 74 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.14s]
[0m00:12:44.175648 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:12:44.176511 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m00:12:44.179597 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:12:44.180600 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m00:12:44.181751 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:44.184007 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m00:12:44.177600 [info ] [Thread-3 (]: 49 of 74 START test unique_dim_channel_channel_nk .............................. [RUN]
[0m00:12:44.187936 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m00:12:44.188906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919)
[0m00:12:44.189879 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m00:12:44.190671 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m00:12:44.220938 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919"
[0m00:12:44.212621 [info ] [Thread-4 (]: 44 of 74 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.27s]
[0m00:12:44.222480 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:12:44.223395 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m00:12:44.225196 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m00:12:44.231008 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919"
[0m00:12:44.224247 [info ] [Thread-4 (]: 50 of 74 START test unique_dim_channel_channel_sk .............................. [RUN]
[0m00:12:44.233775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8)
[0m00:12:44.234686 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m00:12:44.244477 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919"
[0m00:12:44.245643 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8"
[0m00:12:44.246892 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919: BEGIN
[0m00:12:44.248516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:44.251923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.108 seconds
[0m00:12:44.253083 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m00:12:44.254011 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:12:44.258269 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8"
[0m00:12:44.259266 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:44.261959 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8"
[0m00:12:44.262897 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8: BEGIN
[0m00:12:44.264460 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:44.282828 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m00:12:44.285888 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m00:12:44.287055 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m00:12:44.288617 [info ] [Thread-1 (]: 47 of 74 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.18s]
[0m00:12:44.293875 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:12:44.294919 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m00:12:44.295738 [info ] [Thread-1 (]: 51 of 74 START test unique_dim_date_date_day ................................... [RUN]
[0m00:12:44.299996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199)
[0m00:12:44.300901 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m00:12:44.309549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199"
[0m00:12:44.311995 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m00:12:44.317776 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199"
[0m00:12:44.319638 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199"
[0m00:12:44.320579 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199: BEGIN
[0m00:12:44.321451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.333032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.151 seconds
[0m00:12:44.334189 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:12:44.335002 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:12:44.352859 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m00:12:44.355886 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m00:12:44.357038 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m00:12:44.358905 [info ] [Thread-2 (]: 48 of 74 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.22s]
[0m00:12:44.363538 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:12:44.364568 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m00:12:44.365424 [info ] [Thread-2 (]: 52 of 74 START test unique_dim_date_date_sk .................................... [RUN]
[0m00:12:44.370258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34)
[0m00:12:44.371362 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m00:12:44.380362 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34"
[0m00:12:44.382032 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m00:12:44.387086 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34"
[0m00:12:44.389128 [debug] [Thread-4 (]: SQL status: BEGIN in 0.125 seconds
[0m00:12:44.390064 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8"
[0m00:12:44.390895 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34"
[0m00:12:44.391707 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_sk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_channel"
where channel_sk is not null
group by channel_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.392667 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34: BEGIN
[0m00:12:44.393710 [debug] [Thread-3 (]: SQL status: BEGIN in 0.145 seconds
[0m00:12:44.396009 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919"
[0m00:12:44.395072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:44.397224 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_channel"
where channel_nk is not null
group by channel_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.398527 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:44.401953 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8: ROLLBACK
[0m00:12:44.403175 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:44.404225 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8: Close
[0m00:12:44.407556 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919: ROLLBACK
[0m00:12:44.410299 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919: Close
[0m00:12:44.409437 [info ] [Thread-4 (]: 50 of 74 PASS unique_dim_channel_channel_sk .................................... [[32mPASS[0m in 0.18s]
[0m00:12:44.416262 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m00:12:44.417219 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m00:12:44.413577 [info ] [Thread-3 (]: 49 of 74 PASS unique_dim_channel_channel_nk .................................... [[32mPASS[0m in 0.22s]
[0m00:12:44.419431 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m00:12:44.418133 [info ] [Thread-4 (]: 53 of 74 START test unique_dim_employee_employee_nk ............................ [RUN]
[0m00:12:44.420552 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m00:12:44.421569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8, now test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43)
[0m00:12:44.423137 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m00:12:44.422453 [info ] [Thread-3 (]: 54 of 74 START test unique_dim_employee_employee_sk ............................ [RUN]
[0m00:12:44.433065 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43"
[0m00:12:44.434205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919, now test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8)
[0m00:12:44.435380 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m00:12:44.443888 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8"
[0m00:12:44.447016 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m00:12:44.447971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.126 seconds
[0m00:12:44.454768 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43"
[0m00:12:44.455757 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199"
[0m00:12:44.457024 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_date"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.458031 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m00:12:44.466929 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8"
[0m00:12:44.468332 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43"
[0m00:12:44.469309 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43: BEGIN
[0m00:12:44.470121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:44.471570 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8"
[0m00:12:44.472544 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8: BEGIN
[0m00:12:44.473310 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:44.483335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m00:12:44.486416 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199: ROLLBACK
[0m00:12:44.487485 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199: Close
[0m00:12:44.489357 [info ] [Thread-1 (]: 51 of 74 PASS unique_dim_date_date_day ......................................... [[32mPASS[0m in 0.19s]
[0m00:12:44.491631 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m00:12:44.492545 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m00:12:44.493395 [info ] [Thread-1 (]: 55 of 74 START test unique_dim_geography_geography_sk .......................... [RUN]
[0m00:12:44.495941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199, now test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594)
[0m00:12:44.496831 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m00:12:44.504891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594"
[0m00:12:44.507880 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m00:12:44.514058 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594"
[0m00:12:44.516160 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594"
[0m00:12:44.516994 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594: BEGIN
[0m00:12:44.517847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.527812 [debug] [Thread-2 (]: SQL status: BEGIN in 0.132 seconds
[0m00:12:44.528676 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34"
[0m00:12:44.529493 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_sk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_date"
where date_sk is not null
group by date_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.551282 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m00:12:44.554587 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34: ROLLBACK
[0m00:12:44.556004 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34: Close
[0m00:12:44.557589 [info ] [Thread-2 (]: 52 of 74 PASS unique_dim_date_date_sk .......................................... [[32mPASS[0m in 0.19s]
[0m00:12:44.559516 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m00:12:44.560656 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m00:12:44.561791 [info ] [Thread-2 (]: 56 of 74 START test unique_dim_product_product_nk .............................. [RUN]
[0m00:12:44.563531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34, now test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e)
[0m00:12:44.564358 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m00:12:44.572784 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e"
[0m00:12:44.574793 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m00:12:44.580680 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e"
[0m00:12:44.581658 [debug] [Thread-3 (]: SQL status: BEGIN in 0.108 seconds
[0m00:12:44.582910 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8"
[0m00:12:44.583839 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    employee_sk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_employee"
where employee_sk is not null
group by employee_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.585577 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e"
[0m00:12:44.586474 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e: BEGIN
[0m00:12:44.587309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:44.588409 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:44.592140 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8: ROLLBACK
[0m00:12:44.593322 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8: Close
[0m00:12:44.595561 [info ] [Thread-3 (]: 54 of 74 PASS unique_dim_employee_employee_sk .................................. [[32mPASS[0m in 0.16s]
[0m00:12:44.597873 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m00:12:44.598895 [debug] [Thread-4 (]: SQL status: BEGIN in 0.129 seconds
[0m00:12:44.600055 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m00:12:44.601077 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43"
[0m00:12:44.603367 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    employee_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_employee"
where employee_nk is not null
group by employee_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.602155 [info ] [Thread-3 (]: 57 of 74 START test unique_dim_product_product_sk .............................. [RUN]
[0m00:12:44.604862 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8, now test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c)
[0m00:12:44.605753 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m00:12:44.616363 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c"
[0m00:12:44.617483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m00:12:44.620437 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43: ROLLBACK
[0m00:12:44.621579 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43: Close
[0m00:12:44.622498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m00:12:44.624480 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594"
[0m00:12:44.623762 [info ] [Thread-4 (]: 53 of 74 PASS unique_dim_employee_employee_nk .................................. [[32mPASS[0m in 0.20s]
[0m00:12:44.625716 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geography_sk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_geography"
where geography_sk is not null
group by geography_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.627191 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m00:12:44.628960 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m00:12:44.629951 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:12:44.635324 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c"
[0m00:12:44.636175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m00:12:44.636871 [info ] [Thread-4 (]: 58 of 74 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m00:12:44.640211 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594: ROLLBACK
[0m00:12:44.641124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m00:12:44.642150 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:12:44.650097 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:12:44.650721 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c"
[0m00:12:44.652239 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594: Close
[0m00:12:44.653223 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c: BEGIN
[0m00:12:44.654247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:44.655713 [info ] [Thread-1 (]: 55 of 74 PASS unique_dim_geography_geography_sk ................................ [[32mPASS[0m in 0.16s]
[0m00:12:44.657595 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m00:12:44.658865 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:12:44.660836 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:12:44.666988 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:12:44.659695 [info ] [Thread-1 (]: 59 of 74 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m00:12:44.668655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m00:12:44.669653 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:12:44.678828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:12:44.681251 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m00:12:44.682307 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:12:44.683520 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e"
[0m00:12:44.684967 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:12:44.689251 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:12:44.690004 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_product"
where product_nk is not null
group by product_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.690985 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m00:12:44.691983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:44.693430 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:12:44.695864 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:44.697091 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m00:12:44.699807 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e: ROLLBACK
[0m00:12:44.700516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.701378 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e: Close
[0m00:12:44.702805 [info ] [Thread-2 (]: 56 of 74 PASS unique_dim_product_product_nk .................................... [[32mPASS[0m in 0.14s]
[0m00:12:44.704403 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m00:12:44.705306 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:12:44.706172 [info ] [Thread-2 (]: 60 of 74 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m00:12:44.708195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m00:12:44.709166 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:12:44.717528 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:12:44.719378 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:12:44.723623 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:12:44.726288 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:12:44.727969 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m00:12:44.729324 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:44.750057 [debug] [Thread-3 (]: SQL status: BEGIN in 0.096 seconds
[0m00:12:44.750644 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c"
[0m00:12:44.751191 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_sk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."dim_product"
where product_sk is not null
group by product_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.754443 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:12:44.757170 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c: ROLLBACK
[0m00:12:44.758235 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c: Close
[0m00:12:44.759482 [info ] [Thread-3 (]: 57 of 74 PASS unique_dim_product_product_sk .................................... [[32mPASS[0m in 0.15s]
[0m00:12:44.762086 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m00:12:44.763013 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:12:44.763783 [info ] [Thread-3 (]: 61 of 74 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m00:12:44.765308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m00:12:44.766194 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:12:44.773823 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:12:44.775255 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:12:44.781525 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:12:44.783650 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m00:12:44.784617 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:12:44.785446 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.786543 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:12:44.787344 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m00:12:44.788266 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:44.796730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m00:12:44.797862 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:12:44.798820 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.803797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:44.806571 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m00:12:44.807756 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m00:12:44.809092 [info ] [Thread-1 (]: 59 of 74 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.14s]
[0m00:12:44.810641 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:12:44.811983 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:12:44.812899 [info ] [Thread-1 (]: 62 of 74 START test unique_int_customers_customer_nk ........................... [RUN]
[0m00:12:44.815327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e, now test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd)
[0m00:12:44.816539 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:12:44.822278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:12:44.823691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m00:12:44.824448 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:12:44.825341 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:12:44.826005 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.830141 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:12:44.832701 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:12:44.833780 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: BEGIN
[0m00:12:44.834584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.835356 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.049 seconds
[0m00:12:44.837336 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m00:12:44.838343 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m00:12:44.839776 [info ] [Thread-4 (]: 58 of 74 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.20s]
[0m00:12:44.841425 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:12:44.842335 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m00:12:44.843167 [info ] [Thread-4 (]: 63 of 74 START test unique_stg_metabase_accounts_customer_nk ................... [RUN]
[0m00:12:44.845791 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m00:12:44.846799 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd, now test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1)
[0m00:12:44.850149 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m00:12:44.851073 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m00:12:44.857771 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1"
[0m00:12:44.858514 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m00:12:44.861133 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m00:12:44.868157 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1"
[0m00:12:44.859659 [info ] [Thread-2 (]: 60 of 74 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.15s]
[0m00:12:44.869658 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:12:44.870161 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m00:12:44.870754 [info ] [Thread-2 (]: 64 of 74 START test unique_stg_metabase_analytic_events_event_nk ............... [RUN]
[0m00:12:44.872029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d, now test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0)
[0m00:12:44.872893 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1"
[0m00:12:44.873399 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m00:12:44.873956 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1: BEGIN
[0m00:12:44.879648 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0"
[0m00:12:44.880729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:44.883454 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m00:12:44.900331 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0"
[0m00:12:44.902015 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0"
[0m00:12:44.902838 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0: BEGIN
[0m00:12:44.903708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:44.912013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m00:12:44.912919 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:12:44.913800 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.961053 [debug] [Thread-4 (]: SQL status: BEGIN in 0.080 seconds
[0m00:12:44.961886 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1"
[0m00:12:44.962677 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.977949 [debug] [Thread-3 (]: SQL status: BEGIN in 0.190 seconds
[0m00:12:44.978676 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:12:44.979411 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.983073 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m00:12:44.983869 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:12:44.984387 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0"
[0m00:12:44.986803 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m00:12:44.987708 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:44.988866 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m00:12:44.990001 [info ] [Thread-3 (]: 61 of 74 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.22s]
[0m00:12:44.991548 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:12:44.992442 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m00:12:44.993240 [info ] [Thread-3 (]: 65 of 74 START test unique_stg_metabase_feedback_feedback_nk ................... [RUN]
[0m00:12:44.994565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e, now test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a)
[0m00:12:44.995513 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m00:12:45.004587 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a"
[0m00:12:45.006814 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m00:12:45.011963 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a"
[0m00:12:45.014763 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a"
[0m00:12:45.015660 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a: BEGIN
[0m00:12:45.016661 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:45.075905 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.112 seconds
[0m00:12:45.079259 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1: ROLLBACK
[0m00:12:45.080692 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1: Close
[0m00:12:45.082108 [info ] [Thread-4 (]: 63 of 74 PASS unique_stg_metabase_accounts_customer_nk ......................... [[32mPASS[0m in 0.24s]
[0m00:12:45.083688 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m00:12:45.084610 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m00:12:45.085507 [info ] [Thread-4 (]: 66 of 74 START test unique_stg_metabase_invoices_invoice_nk .................... [RUN]
[0m00:12:45.086842 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1, now test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e)
[0m00:12:45.087638 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m00:12:45.093968 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e"
[0m00:12:45.095760 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m00:12:45.096739 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a"
[0m00:12:45.097905 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.099056 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m00:12:45.104768 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e"
[0m00:12:45.106846 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e"
[0m00:12:45.107981 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e: BEGIN
[0m00:12:45.108601 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:45.167297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.252 seconds
[0m00:12:45.170324 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: ROLLBACK
[0m00:12:45.171952 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: Close
[0m00:12:45.173419 [error] [Thread-1 (]: 62 of 74 FAIL 1 unique_int_customers_customer_nk ............................... [[31mFAIL 1[0m in 0.36s]
[0m00:12:45.176004 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:12:45.176900 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m00:12:45.177696 [info ] [Thread-1 (]: 67 of 74 START test unique_stg_metabase_orders_order_nk ........................ [RUN]
[0m00:12:45.181739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd, now test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2)
[0m00:12:45.182597 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m00:12:45.189753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2"
[0m00:12:45.191898 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m00:12:45.198663 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2"
[0m00:12:45.200628 [debug] [Thread-4 (]: SQL status: BEGIN in 0.092 seconds
[0m00:12:45.201545 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e"
[0m00:12:45.203609 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.204957 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2"
[0m00:12:45.205650 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2: BEGIN
[0m00:12:45.206264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:45.223357 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.124 seconds
[0m00:12:45.225735 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a: ROLLBACK
[0m00:12:45.226772 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a: Close
[0m00:12:45.228306 [info ] [Thread-3 (]: 65 of 74 PASS unique_stg_metabase_feedback_feedback_nk ......................... [[32mPASS[0m in 0.23s]
[0m00:12:45.231535 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m00:12:45.232511 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:12:45.233302 [info ] [Thread-3 (]: 68 of 74 START test unique_stg_metabase_people_customer_nk ..................... [RUN]
[0m00:12:45.238438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a, now test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460)
[0m00:12:45.239363 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:12:45.244982 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:12:45.246545 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:12:45.252461 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:12:45.254376 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:12:45.255402 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: BEGIN
[0m00:12:45.256205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:45.289025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m00:12:45.289713 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2"
[0m00:12:45.290388 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
where order_nk is not null
group by order_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.325290 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m00:12:45.325919 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:12:45.326367 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.420843 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.094 seconds
[0m00:12:45.423204 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: ROLLBACK
[0m00:12:45.424345 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: Close
[0m00:12:45.425550 [error] [Thread-3 (]: 68 of 74 FAIL 1 unique_stg_metabase_people_customer_nk ......................... [[31mFAIL 1[0m in 0.19s]
[0m00:12:45.427106 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:12:45.427976 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.223 seconds
[0m00:12:45.428880 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m00:12:45.431699 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e: ROLLBACK
[0m00:12:45.432544 [info ] [Thread-3 (]: 69 of 74 START test unique_stg_metabase_products_product_nk .................... [RUN]
[0m00:12:45.433507 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460, now test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14)
[0m00:12:45.434191 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e: Close
[0m00:12:45.434943 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m00:12:45.442984 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14"
[0m00:12:45.447301 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m00:12:45.452399 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14"
[0m00:12:45.444204 [info ] [Thread-4 (]: 66 of 74 PASS unique_stg_metabase_invoices_invoice_nk .......................... [[32mPASS[0m in 0.36s]
[0m00:12:45.454398 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m00:12:45.455162 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m00:12:45.455861 [info ] [Thread-4 (]: 70 of 74 START test unique_stg_metabase_reviews_review_nk ...................... [RUN]
[0m00:12:45.456947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e, now test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc)
[0m00:12:45.457845 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m00:12:45.458753 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14"
[0m00:12:45.467756 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc"
[0m00:12:45.468495 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.178 seconds
[0m00:12:45.469325 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14: BEGIN
[0m00:12:45.472313 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2: ROLLBACK
[0m00:12:45.473303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:45.474613 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2: Close
[0m00:12:45.477011 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m00:12:45.481863 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc"
[0m00:12:45.484646 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc"
[0m00:12:45.486100 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc: BEGIN
[0m00:12:45.476173 [info ] [Thread-1 (]: 67 of 74 PASS unique_stg_metabase_orders_order_nk .............................. [[32mPASS[0m in 0.29s]
[0m00:12:45.487778 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:45.489034 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m00:12:45.490126 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m00:12:45.491014 [info ] [Thread-1 (]: 71 of 74 START test unique_stg_northwind_customers_customer_nk ................. [RUN]
[0m00:12:45.493649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2, now test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487)
[0m00:12:45.494640 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m00:12:45.503750 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487"
[0m00:12:45.505954 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m00:12:45.511734 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487"
[0m00:12:45.513912 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487"
[0m00:12:45.515116 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487: BEGIN
[0m00:12:45.516034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:45.550960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.562 seconds
[0m00:12:45.553821 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0: ROLLBACK
[0m00:12:45.555516 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0: Close
[0m00:12:45.557019 [info ] [Thread-2 (]: 64 of 74 PASS unique_stg_metabase_analytic_events_event_nk ..................... [[32mPASS[0m in 0.69s]
[0m00:12:45.559749 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m00:12:45.560902 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m00:12:45.561787 [info ] [Thread-2 (]: 72 of 74 START test unique_stg_northwind_employees_employee_nk ................. [RUN]
[0m00:12:45.563409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0, now test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c)
[0m00:12:45.564268 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m00:12:45.570080 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c"
[0m00:12:45.571981 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m00:12:45.578919 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c"
[0m00:12:45.581167 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c"
[0m00:12:45.582123 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c: BEGIN
[0m00:12:45.582939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:45.591729 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m00:12:45.592657 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc"
[0m00:12:45.593521 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.616143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m00:12:45.616980 [debug] [Thread-3 (]: SQL status: BEGIN in 0.144 seconds
[0m00:12:45.617704 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487"
[0m00:12:45.618412 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14"
[0m00:12:45.619241 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.620050 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_products"
where product_nk is not null
group by product_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.664642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m00:12:45.665658 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c"
[0m00:12:45.666486 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    employee_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_northwind_employees"
where employee_nk is not null
group by employee_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.706454 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.112 seconds
[0m00:12:45.709393 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc: ROLLBACK
[0m00:12:45.710796 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc: Close
[0m00:12:45.712232 [info ] [Thread-4 (]: 70 of 74 PASS unique_stg_metabase_reviews_review_nk ............................ [[32mPASS[0m in 0.26s]
[0m00:12:45.716988 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m00:12:45.717881 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m00:12:45.718842 [info ] [Thread-4 (]: 73 of 74 START test unique_stg_northwind_orders_order_nk ....................... [RUN]
[0m00:12:45.722453 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc, now test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995)
[0m00:12:45.723263 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m00:12:45.731661 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995"
[0m00:12:45.732493 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.112 seconds
[0m00:12:45.734903 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14: ROLLBACK
[0m00:12:45.736329 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14: Close
[0m00:12:45.738515 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m00:12:45.743916 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995"
[0m00:12:45.737625 [info ] [Thread-3 (]: 69 of 74 PASS unique_stg_metabase_products_product_nk .......................... [[32mPASS[0m in 0.30s]
[0m00:12:45.745552 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.125 seconds
[0m00:12:45.747625 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m00:12:45.751282 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487: ROLLBACK
[0m00:12:45.752518 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m00:12:45.754500 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995"
[0m00:12:45.753684 [info ] [Thread-3 (]: 74 of 74 START test unique_stg_northwind_products_product_nk ................... [RUN]
[0m00:12:45.755587 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487: Close
[0m00:12:45.756616 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995: BEGIN
[0m00:12:45.757388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14, now test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8)
[0m00:12:45.758214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:12:45.760081 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m00:12:45.759383 [info ] [Thread-1 (]: 71 of 74 PASS unique_stg_northwind_customers_customer_nk ....................... [[32mPASS[0m in 0.27s]
[0m00:12:45.771588 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8"
[0m00:12:45.772832 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m00:12:45.774794 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m00:12:45.780179 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8"
[0m00:12:45.783099 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8"
[0m00:12:45.784009 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8: BEGIN
[0m00:12:45.785148 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:12:45.786821 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.119 seconds
[0m00:12:45.789765 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c: ROLLBACK
[0m00:12:45.791282 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c: Close
[0m00:12:45.792766 [info ] [Thread-2 (]: 72 of 74 PASS unique_stg_northwind_employees_employee_nk ....................... [[32mPASS[0m in 0.23s]
[0m00:12:45.794265 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m00:12:45.844076 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m00:12:45.844959 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995"
[0m00:12:45.845760 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_northwind_orders"
where order_nk is not null
group by order_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.859447 [debug] [Thread-3 (]: SQL status: BEGIN in 0.074 seconds
[0m00:12:45.860083 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8"
[0m00:12:45.860598 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_northwind_products"
where product_nk is not null
group by product_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:12:45.937837 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.092 seconds
[0m00:12:45.939543 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995: ROLLBACK
[0m00:12:45.940273 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995: Close
[0m00:12:45.941094 [info ] [Thread-4 (]: 73 of 74 PASS unique_stg_northwind_orders_order_nk ............................. [[32mPASS[0m in 0.22s]
[0m00:12:45.942391 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m00:12:45.946598 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.085 seconds
[0m00:12:45.948471 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8: ROLLBACK
[0m00:12:45.949261 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8: Close
[0m00:12:45.950045 [info ] [Thread-3 (]: 74 of 74 PASS unique_stg_northwind_products_product_nk ......................... [[32mPASS[0m in 0.19s]
[0m00:12:45.951278 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m00:12:45.954802 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:45.955704 [debug] [MainThread]: On master: BEGIN
[0m00:12:45.956643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:46.021879 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m00:12:46.022468 [debug] [MainThread]: On master: COMMIT
[0m00:12:46.022826 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:46.023188 [debug] [MainThread]: On master: COMMIT
[0m00:12:46.023872 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:12:46.024459 [debug] [MainThread]: On master: Close
[0m00:12:46.025161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:46.025716 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m00:12:46.026230 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m00:12:46.026580 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m00:12:46.026966 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m00:12:46.027479 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487' was properly closed.
[0m00:12:46.027953 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8' was properly closed.
[0m00:12:46.028365 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995' was properly closed.
[0m00:12:46.028674 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c' was properly closed.
[0m00:12:46.029120 [info ] [MainThread]: 
[0m00:12:46.029870 [info ] [MainThread]: Finished running 74 data tests in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m00:12:46.047134 [debug] [MainThread]: Command end result
[0m00:12:46.105446 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:12:46.109071 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:12:46.121518 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:12:46.122113 [info ] [MainThread]: 
[0m00:12:46.122974 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:12:46.123587 [info ] [MainThread]: 
[0m00:12:46.124194 [error] [MainThread]: [31mFailure in test unique_int_customers_customer_nk (models\intermediate\intermediate.yml)[0m
[0m00:12:46.124769 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:12:46.125400 [info ] [MainThread]: 
[0m00:12:46.126065 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\intermediate\intermediate.yml\unique_int_customers_customer_nk.sql
[0m00:12:46.126616 [info ] [MainThread]: 
[0m00:12:46.127174 [error] [MainThread]: [31mFailure in test unique_stg_metabase_people_customer_nk (models\staging\staging.yml)[0m
[0m00:12:46.127773 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:12:46.128290 [info ] [MainThread]: 
[0m00:12:46.129402 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\staging.yml\unique_stg_metabase_people_customer_nk.sql
[0m00:12:46.130286 [info ] [MainThread]: 
[0m00:12:46.130963 [info ] [MainThread]: Done. PASS=72 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=74
[0m00:12:46.132361 [debug] [MainThread]: Command `dbt test` failed at 00:12:46.132219 after 6.43 seconds
[0m00:12:46.132734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F517DF2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5198D9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5198D9BD0>]}
[0m00:12:46.133126 [debug] [MainThread]: Flushing usage events
[0m00:12:47.146721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:19.769188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C9420590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C9CC8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CB39BED0>]}


============================== 00:31:19.788022 | 63c01555-f4af-496f-a039-fda7e9acfdf4 ==============================
[0m00:31:19.788022 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:31:19.788914 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select stg_metabase_people stg_metabase_orders', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m00:31:20.624349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C9659F30>]}
[0m00:31:20.703837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CB423DF0>]}
[0m00:31:20.716887 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:31:21.461924 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:31:23.881502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:31:23.882390 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m00:31:23.882833 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_people.sql
[0m00:31:24.414591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBA46350>]}
[0m00:31:24.546275 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:24.601154 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:24.986482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBA555E0>]}
[0m00:31:24.987215 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:31:24.988012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBC109F0>]}
[0m00:31:24.993908 [info ] [MainThread]: 
[0m00:31:24.994776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:24.995679 [info ] [MainThread]: 
[0m00:31:24.996563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:25.001906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:31:29.629935 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:31:29.630772 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:31:29.631689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:29.801054 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.169 seconds
[0m00:31:29.802486 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:31:29.806607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m00:31:29.812350 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:29.812765 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:31:29.813239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:29.813920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m00:31:29.816881 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:29.817556 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:31:29.818692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m00:31:29.819083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:29.821105 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:29.821825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m00:31:29.822778 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:31:29.825638 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:29.826094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:29.826471 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:31:29.827039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:29.876255 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m00:31:29.876992 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:29.877630 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:31:29.884004 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m00:31:29.884603 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:29.885133 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:31:29.892537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m00:31:29.895739 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:31:29.896360 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m00:31:29.898472 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:31:29.899018 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m00:31:29.899539 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:31:29.900244 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:31:29.900920 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:29.901557 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m00:31:29.902657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m00:31:29.903485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:31:29.903930 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:31:29.907121 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:29.910228 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:29.912224 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:29.912842 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:31:29.913324 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:31:29.913709 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:31:29.914219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:29.914589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:29.922035 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m00:31:29.924350 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:31:29.925050 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:31:29.927126 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:31:29.927714 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:31:29.928513 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:31:29.929448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dw)
[0m00:31:29.931230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_saas)
[0m00:31:29.935051 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:29.938202 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:29.938935 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:31:29.939567 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:31:29.940193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:29.940870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:29.988595 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m00:31:29.989322 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:29.989985 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:31:29.992906 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m00:31:29.993636 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:29.994317 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:31:30.001085 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:31:30.003254 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:31:30.004399 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:31:30.005251 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:31:30.007538 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:31:30.008855 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:31:30.020066 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m00:31:30.020528 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:30.020890 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:31:30.022196 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m00:31:30.022616 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:30.022985 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:31:30.029171 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m00:31:30.030849 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:31:30.031290 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m00:31:30.032750 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:31:30.033313 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:31:30.034171 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:31:30.044412 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:30.044981 [debug] [MainThread]: On master: BEGIN
[0m00:31:30.045365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:30.095619 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m00:31:30.096092 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:30.096498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:30.109327 [debug] [MainThread]: SQL status: SELECT 24 in 0.012 seconds
[0m00:31:30.111681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBF2DA50>]}
[0m00:31:30.112180 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:30.112656 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:30.112976 [debug] [MainThread]: On master: BEGIN
[0m00:31:30.113541 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:31:30.113863 [debug] [MainThread]: On master: COMMIT
[0m00:31:30.114174 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:30.114487 [debug] [MainThread]: On master: COMMIT
[0m00:31:30.114895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:30.115220 [debug] [MainThread]: On master: Close
[0m00:31:30.163951 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m00:31:30.165754 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_people
[0m00:31:30.168167 [info ] [Thread-1 (]: 1 of 2 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m00:31:30.173625 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m00:31:30.170864 [info ] [Thread-2 (]: 2 of 2 START sql view model dw_stg.stg_metabase_people ......................... [RUN]
[0m00:31:30.175991 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m00:31:30.177914 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_people'
[0m00:31:30.201251 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_people
[0m00:31:30.223959 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.227367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.229573 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_people
[0m00:31:30.262991 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m00:31:30.285111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.288386 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.290080 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.290895 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m00:31:30.291771 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.292328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:30.292831 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: BEGIN
[0m00:31:30.293511 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:31:30.354378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m00:31:30.355092 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.355749 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

with account_name_map as (
    select
        lower(concat_ws(' ', first_name, last_name)) as full_name_key,
        min(id)                                      as account_id
    from "dw_northwind_metabase"."public"."accounts"
    where first_name is not null and last_name is not null
    group by 1
),
people_name_map as (
    select
        lower(name) as full_name_key,
        min(id)     as person_id
    from "dw_northwind_metabase"."public"."people"
    where name is not null
    group by 1
),
product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar
        when people_map.person_id is not null then 'METABASE_PERSON_' || people_map.person_id::varchar
        else 'METABASE_ORPHAN_' || upper(trim(o.user_id))
    end                                       as customer_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(o.product_id))
    end                                       as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join account_name_map acc_map
       on lower(o.user_id) = acc_map.full_name_key
left join people_name_map people_map
       on acc_map.account_id is null
      and lower(o.user_id) = people_map.full_name_key
left join product_map prod_map
       on lower(o.product_id) = prod_map.title_key
  );
[0m00:31:30.356555 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m00:31:30.357206 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.357798 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp"
    
    
  as (
    

-- Registros da tabela people (usados pelos pedidos B2C que n√£o mapeiam para accounts).
select
    'METABASE'                               as source_system,
    p.id                                     as source_customer_id,
    'METABASE_PERSON_' || p.id               as customer_nk,
    p.name                                   as customer_name,
    null::varchar                            as contact_name,
    null::varchar                            as contact_title,
    split_part(p.name, ' ', 1)               as first_name,
    nullif(split_part(p.name, ' ', 2), '')   as last_name,
    p.address                                as address,
    p.city                                   as city,
    p.state                                  as region,
    null::varchar                            as country,
    p.zip::varchar                           as postal_code,
    null::varchar                            as plan,
    p.source                                 as segment,
    null::int                                as seats,
    null::boolean                            as trial_converted,
    null::boolean                            as active_subscription,
    null::boolean                            as legacy_plan,
    null::timestamp                          as created_at,
    null::timestamp                          as trial_ends_at,
    null::timestamp                          as canceled_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."people" p
  );
[0m00:31:30.376094 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m00:31:30.376683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m00:31:30.383635 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.387119 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.387607 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people" rename to "stg_metabase_people__dbt_backup"
[0m00:31:30.388320 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m00:31:30.390207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:30.393268 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.393689 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m00:31:30.394108 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m00:31:30.396833 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.397307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:31:30.397786 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp" rename to "stg_metabase_people"
[0m00:31:30.415137 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m00:31:30.415867 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.416313 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m00:31:30.416843 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:30.418952 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m00:31:30.419627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:31:30.420117 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.430286 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m00:31:30.430844 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m00:31:30.438623 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m00:31:30.439463 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m00:31:30.441039 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m00:31:30.444831 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup"
[0m00:31:30.445487 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m00:31:30.446325 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m00:31:30.449525 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m00:31:30.450489 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup" cascade
[0m00:31:30.456413 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m00:31:30.458147 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: Close
[0m00:31:30.471021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBACE750>]}
[0m00:31:30.471645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c01555-f4af-496f-a039-fda7e9acfdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CB8CB070>]}
[0m00:31:30.472401 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.28s]
[0m00:31:30.474266 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m00:31:30.473196 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dw_stg.stg_metabase_people .................... [[32mCREATE VIEW[0m in 0.28s]
[0m00:31:30.475432 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_people
[0m00:31:30.477152 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:30.477551 [debug] [MainThread]: On master: BEGIN
[0m00:31:30.477881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:30.532662 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m00:31:30.533195 [debug] [MainThread]: On master: COMMIT
[0m00:31:30.533656 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:30.534100 [debug] [MainThread]: On master: COMMIT
[0m00:31:30.534786 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:30.535321 [debug] [MainThread]: On master: Close
[0m00:31:30.536106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:30.536532 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m00:31:30.537055 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m00:31:30.537502 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m00:31:30.537918 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m00:31:30.538334 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m00:31:30.538744 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m00:31:30.539150 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_people' was properly closed.
[0m00:31:30.539699 [info ] [MainThread]: 
[0m00:31:30.540313 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m00:31:30.541436 [debug] [MainThread]: Command end result
[0m00:31:30.594430 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:30.599114 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:30.608553 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:31:30.609048 [info ] [MainThread]: 
[0m00:31:30.609866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:30.610489 [info ] [MainThread]: 
[0m00:31:30.611148 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:31:30.612651 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:30.612507 after 11.06 seconds
[0m00:31:30.613097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CD191090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBF22330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CBCB57D0>]}
[0m00:31:30.613516 [debug] [MainThread]: Flushing usage events
[0m00:31:32.169214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:35.536950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021186EB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021187758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021187D9BED0>]}


============================== 00:31:35.541584 | db5713a3-5954-44af-b5f5-64e977f253aa ==============================
[0m00:31:35.541584 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:31:35.542329 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select int_customers', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:31:35.757072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211870E9F30>]}
[0m00:31:35.824995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021187E23DF0>]}
[0m00:31:35.826328 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:31:36.204431 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:31:36.425293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:36.425662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:36.488088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021189123350>]}
[0m00:31:36.614162 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:36.617774 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:36.720272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211838C8F50>]}
[0m00:31:36.720921 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:31:36.721737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021187FDD9B0>]}
[0m00:31:36.726645 [info ] [MainThread]: 
[0m00:31:36.727882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:36.728560 [info ] [MainThread]: 
[0m00:31:36.729593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:36.731791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:31:36.866175 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:31:36.866613 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:31:36.866962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:36.926691 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.060 seconds
[0m00:31:36.928130 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:31:36.934818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m00:31:36.940806 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:36.941392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m00:31:36.941783 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:31:36.944024 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:36.944533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m00:31:36.944916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:36.945375 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:31:36.945820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m00:31:36.947525 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:36.948215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:36.950983 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:36.951735 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:31:36.952466 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:31:36.953150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:36.953889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:37.023669 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m00:31:37.024199 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:37.024592 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:31:37.026125 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:31:37.026597 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:37.026998 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:31:37.028755 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m00:31:37.029248 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:37.029782 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:31:37.032987 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m00:31:37.034402 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:31:37.034803 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m00:31:37.036173 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:31:37.036561 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:31:37.036936 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m00:31:37.037248 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:31:37.038424 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:31:37.038995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_sales)
[0m00:31:37.039975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_stg)
[0m00:31:37.042474 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:37.042912 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:31:37.044475 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:37.044851 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:31:37.045254 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:31:37.045755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_b2b)
[0m00:31:37.046132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:37.046496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:37.048400 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:37.049117 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:31:37.049425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:37.108096 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m00:31:37.108542 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:37.108905 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:31:37.111331 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m00:31:37.111884 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:37.112347 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:31:37.116731 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m00:31:37.117175 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:37.117556 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:31:37.118059 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:37.119702 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:31:37.120356 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:31:37.120907 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.008 seconds
[0m00:31:37.121682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dw)
[0m00:31:37.123562 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:31:37.125457 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:37.125985 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m00:31:37.126315 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m00:31:37.126716 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:31:37.127084 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:31:37.128249 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:31:37.128660 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:37.129069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:37.129759 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:31:37.130290 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:31:37.143488 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:31:37.144869 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:31:37.145607 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:31:37.177057 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m00:31:37.177489 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:37.177832 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:31:37.183509 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m00:31:37.184826 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:31:37.185295 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:31:37.193321 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:37.193748 [debug] [MainThread]: On master: BEGIN
[0m00:31:37.194037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:37.241257 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m00:31:37.241658 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:37.242021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:37.250194 [debug] [MainThread]: SQL status: SELECT 22 in 0.008 seconds
[0m00:31:37.251709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211897A9230>]}
[0m00:31:37.252147 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:37.252790 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:37.253341 [debug] [MainThread]: On master: BEGIN
[0m00:31:37.254160 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:31:37.254467 [debug] [MainThread]: On master: COMMIT
[0m00:31:37.254765 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:37.255052 [debug] [MainThread]: On master: COMMIT
[0m00:31:37.255480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:37.255798 [debug] [MainThread]: On master: Close
[0m00:31:37.260170 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m00:31:37.260711 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m00:31:37.261376 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m00:31:37.261727 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m00:31:37.271947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m00:31:37.273988 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m00:31:37.313306 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m00:31:37.315226 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:31:37.315839 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m00:31:37.316309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:37.375010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m00:31:37.375509 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:31:37.376121 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
    dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
),
metabase_people as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        first_name,
        last_name,
        address,
        city,
        region,
        country,
        postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
)
select * from northwind
union all
select * from metabase
union all
select * from metabase_people
  );
[0m00:31:37.389688 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m00:31:37.396324 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:31:37.396828 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m00:31:37.398562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:37.416764 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m00:31:37.417281 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:31:37.417686 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m00:31:37.419490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:31:37.427603 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m00:31:37.432776 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m00:31:37.433244 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m00:31:37.433972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:31:37.436589 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m00:31:37.439053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db5713a3-5954-44af-b5f5-64e977f253aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211899C81D0>]}
[0m00:31:37.440041 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m00:31:37.440960 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m00:31:37.442533 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:37.442918 [debug] [MainThread]: On master: BEGIN
[0m00:31:37.443237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:37.501286 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m00:31:37.501773 [debug] [MainThread]: On master: COMMIT
[0m00:31:37.502195 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:37.502774 [debug] [MainThread]: On master: COMMIT
[0m00:31:37.503663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:37.504126 [debug] [MainThread]: On master: Close
[0m00:31:37.504729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:37.505254 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m00:31:37.505770 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m00:31:37.506100 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m00:31:37.506395 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m00:31:37.506744 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m00:31:37.507067 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m00:31:37.507434 [info ] [MainThread]: 
[0m00:31:37.507988 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m00:31:37.508928 [debug] [MainThread]: Command end result
[0m00:31:37.566905 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:37.571860 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:37.581680 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:31:37.582153 [info ] [MainThread]: 
[0m00:31:37.582966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:37.583572 [info ] [MainThread]: 
[0m00:31:37.584124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:31:37.585521 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:37.585365 after 2.17 seconds
[0m00:31:37.585999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118953B960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118994EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118994EC10>]}
[0m00:31:37.586576 [debug] [MainThread]: Flushing usage events
[0m00:31:38.563314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:41.929825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBBCB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBD558910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBDB9BED0>]}


============================== 00:31:41.934192 | 35b52da7-b24b-461b-993b-1a4f91093fb1 ==============================
[0m00:31:41.934192 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:31:41.935174 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot --select customers_snapshot', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m00:31:42.158802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBBEE9F30>]}
[0m00:31:42.232071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBDC1FDF0>]}
[0m00:31:42.233550 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:31:42.634676 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:31:42.835057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:42.835433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:42.899745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBDF1B350>]}
[0m00:31:43.029558 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:43.032985 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:43.146907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB8678F50>]}
[0m00:31:43.147625 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:31:43.148568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBDDDD9B0>]}
[0m00:31:43.152493 [info ] [MainThread]: 
[0m00:31:43.153233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:43.154059 [info ] [MainThread]: 
[0m00:31:43.155160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:43.156788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:31:43.282661 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:31:43.283139 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:31:43.283581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:43.343103 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.059 seconds
[0m00:31:43.344488 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:31:43.351339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m00:31:43.357432 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:43.358038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m00:31:43.358423 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:31:43.360773 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:43.361183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:43.361640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m00:31:43.362036 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:31:43.362927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m00:31:43.364681 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:43.365302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:43.367255 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:43.367706 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:31:43.368282 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:31:43.368675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:43.369040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:43.425109 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m00:31:43.425638 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:43.426047 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:31:43.430067 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m00:31:43.430526 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:43.431153 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:31:43.434719 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m00:31:43.435211 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:43.435823 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:31:43.436545 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.010 seconds
[0m00:31:43.438771 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:31:43.439448 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:31:43.440001 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m00:31:43.440695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_saas)
[0m00:31:43.442205 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:31:43.442731 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m00:31:43.444992 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:43.446738 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:43.447193 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:43.447550 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:31:43.448651 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:31:43.449010 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:31:43.449405 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:31:43.449919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:43.450518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_sales)
[0m00:31:43.450956 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:31:43.453250 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:43.453865 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:31:43.454751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:31:43.455330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:43.458122 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:43.458737 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:31:43.459139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:43.460659 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.010 seconds
[0m00:31:43.462959 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:31:43.463639 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:31:43.464582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_snapshots)
[0m00:31:43.470768 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:43.471282 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:31:43.471723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:43.517808 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m00:31:43.518268 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:43.518814 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:31:43.526328 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m00:31:43.526812 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:43.527233 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:31:43.529060 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:31:43.531524 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:31:43.532360 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m00:31:43.532948 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:31:43.533364 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:43.534141 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:31:43.537916 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m00:31:43.538909 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:31:43.539614 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:43.541716 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:31:43.542401 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:31:43.543069 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:31:43.546113 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:31:43.547561 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:31:43.548235 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:31:43.550933 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m00:31:43.552273 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:31:43.552933 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:31:43.560391 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:43.560881 [debug] [MainThread]: On master: BEGIN
[0m00:31:43.561191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:43.622681 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m00:31:43.623532 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:43.624482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:43.639659 [debug] [MainThread]: SQL status: SELECT 25 in 0.014 seconds
[0m00:31:43.643145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBE5AD7E0>]}
[0m00:31:43.643737 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:43.644369 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:43.644808 [debug] [MainThread]: On master: BEGIN
[0m00:31:43.645661 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:31:43.646321 [debug] [MainThread]: On master: COMMIT
[0m00:31:43.646744 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:43.647134 [debug] [MainThread]: On master: COMMIT
[0m00:31:43.647780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:43.648225 [debug] [MainThread]: On master: Close
[0m00:31:43.654532 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:31:43.655581 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m00:31:43.656742 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m00:31:43.657275 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:31:43.670626 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:31:43.740425 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:43.741107 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select customer_name, city, country, plan, segment, trial_converted, active_subscription, legacy_plan from (
                



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m00:31:43.741602 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:43.793485 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.051 seconds
[0m00:31:43.829283 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:43.829985 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m00:31:43.831493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:31:43.832083 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:43.832618 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:31:43.856795 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.024 seconds
[0m00:31:43.864513 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:43.864993 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:31:43.868995 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.004 seconds
[0m00:31:43.918741 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:43.919416 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp003143911172"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m00:31:44.147726 [debug] [Thread-1 (]: SQL status: SELECT 2500 in 0.228 seconds
[0m00:31:44.150179 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.150557 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp003143911172'
        
      order by ordinal_position

  
[0m00:31:44.154372 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.003 seconds
[0m00:31:44.158793 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.159274 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:31:44.163671 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.004 seconds
[0m00:31:44.167119 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.167528 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp003143911172'
        
      order by ordinal_position

  
[0m00:31:44.172734 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.005 seconds
[0m00:31:44.175892 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.176363 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:31:44.181785 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.005 seconds
[0m00:31:44.188722 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.189256 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp003143911172'
        
      order by ordinal_position

  
[0m00:31:44.194917 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.005 seconds
[0m00:31:44.214213 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.214931 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m00:31:44.217107 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m00:31:44.222988 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.223670 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m00:31:44.224637 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m00:31:44.225254 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.226442 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.227026 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      update "dw_northwind_metabase"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp003143911172" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_valid_to is null;
      


    insert into "dw_northwind_metabase"."snapshots"."customers_snapshot" ("customer_nk", "source_system", "source_customer_id", "customer_name", "contact_name", "contact_title", "first_name", "last_name", "address", "city", "region", "country", "postal_code", "plan", "segment", "seats", "trial_converted", "active_subscription", "legacy_plan", "created_at", "trial_ends_at", "canceled_at", "dw_load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_nk",DBT_INTERNAL_SOURCE."source_system",DBT_INTERNAL_SOURCE."source_customer_id",DBT_INTERNAL_SOURCE."customer_name",DBT_INTERNAL_SOURCE."contact_name",DBT_INTERNAL_SOURCE."contact_title",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."region",DBT_INTERNAL_SOURCE."country",DBT_INTERNAL_SOURCE."postal_code",DBT_INTERNAL_SOURCE."plan",DBT_INTERNAL_SOURCE."segment",DBT_INTERNAL_SOURCE."seats",DBT_INTERNAL_SOURCE."trial_converted",DBT_INTERNAL_SOURCE."active_subscription",DBT_INTERNAL_SOURCE."legacy_plan",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."trial_ends_at",DBT_INTERNAL_SOURCE."canceled_at",DBT_INTERNAL_SOURCE."dw_load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp003143911172" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m00:31:44.239961 [debug] [Thread-1 (]: SQL status: INSERT 0 2500 in 0.012 seconds
[0m00:31:44.255710 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m00:31:44.256240 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m00:31:44.256641 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m00:31:44.261585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:31:44.266924 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m00:31:44.269827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b52da7-b24b-461b-993b-1a4f91093fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBE7CC950>]}
[0m00:31:44.270859 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mINSERT 0 2500[0m in 0.61s]
[0m00:31:44.272256 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m00:31:44.274836 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:44.275502 [debug] [MainThread]: On master: BEGIN
[0m00:31:44.276361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:44.341077 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m00:31:44.341708 [debug] [MainThread]: On master: COMMIT
[0m00:31:44.342270 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:44.342749 [debug] [MainThread]: On master: COMMIT
[0m00:31:44.343450 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:44.343811 [debug] [MainThread]: On master: Close
[0m00:31:44.344359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:44.344692 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m00:31:44.345011 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m00:31:44.345323 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m00:31:44.345607 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m00:31:44.345929 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m00:31:44.346344 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m00:31:44.346714 [info ] [MainThread]: 
[0m00:31:44.347210 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m00:31:44.348136 [debug] [MainThread]: Command end result
[0m00:31:44.411156 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:44.414701 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:44.423442 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:31:44.424415 [info ] [MainThread]: 
[0m00:31:44.425253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:44.425918 [info ] [MainThread]: 
[0m00:31:44.426677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:31:44.428747 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:31:44.428506 after 2.63 seconds
[0m00:31:44.429491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBE6A3AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBE821A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBE8218B0>]}
[0m00:31:44.430253 [debug] [MainThread]: Flushing usage events
[0m00:31:45.422226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:48.412793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B009B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B02258910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0289BED0>]}


============================== 00:31:48.417644 | 20eb5203-daa5-4809-964f-ad0581602ba9 ==============================
[0m00:31:48.417644 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:31:48.418378 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select dim_customer fact_sales', 'printer_width': '80', 'target_path': 'None'}
[0m00:31:48.627198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B00BE9F30>]}
[0m00:31:48.696470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B02923DF0>]}
[0m00:31:48.697832 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:31:49.111581 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:31:49.312174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:49.312602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:49.387719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B02C23350>]}
[0m00:31:49.579988 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:49.587039 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:49.802664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7D3D8F50>]}
[0m00:31:49.803690 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:31:49.804581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B02ADD9B0>]}
[0m00:31:49.810933 [info ] [MainThread]: 
[0m00:31:49.811996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:49.814088 [info ] [MainThread]: 
[0m00:31:49.816132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:49.826956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m00:31:49.981072 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m00:31:49.981528 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m00:31:49.981893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:50.055220 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.073 seconds
[0m00:31:50.056774 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m00:31:50.062987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m00:31:50.071261 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:50.071928 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:31:50.072636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m00:31:50.073075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:50.076066 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:50.077032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m00:31:50.078394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m00:31:50.079064 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:31:50.081552 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:50.083914 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:50.084479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:50.084994 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:31:50.085647 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:31:50.086408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:50.086981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:50.147139 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m00:31:50.147835 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:50.148436 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:31:50.156716 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:31:50.157455 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:50.158102 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:50.158531 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:31:50.158939 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:31:50.160210 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:31:50.160756 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:50.161201 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m00:31:50.161596 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:31:50.161953 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:31:50.162296 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:50.162903 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:31:50.163860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_snapshots)
[0m00:31:50.167238 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:50.167826 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:31:50.168194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:50.168936 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m00:31:50.170667 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:31:50.171240 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:50.172672 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:31:50.173117 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.009 seconds
[0m00:31:50.173481 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:31:50.173819 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:31:50.175448 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:31:50.176371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_b2b)
[0m00:31:50.177166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m00:31:50.180942 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:31:50.183143 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:50.185320 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:50.185814 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:31:50.186718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:31:50.190185 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:31:50.190674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:50.193528 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:50.194207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:50.194819 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:31:50.195317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:50.231572 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m00:31:50.232324 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:50.232921 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:31:50.243490 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m00:31:50.245070 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:31:50.245830 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:31:50.260315 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m00:31:50.260968 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:50.261592 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:31:50.266585 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m00:31:50.267196 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:50.267603 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:31:50.268647 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m00:31:50.269181 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:50.269676 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:31:50.270982 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:50.272739 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:31:50.273409 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:31:50.277835 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:31:50.279510 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:31:50.279941 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:31:50.280326 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:31:50.281541 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:31:50.282245 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:31:50.289903 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:50.290457 [debug] [MainThread]: On master: BEGIN
[0m00:31:50.290904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:50.339060 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m00:31:50.339510 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:50.339964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:50.350892 [debug] [MainThread]: SQL status: SELECT 25 in 0.010 seconds
[0m00:31:50.353365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B032B97E0>]}
[0m00:31:50.353853 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:50.354403 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:50.354783 [debug] [MainThread]: On master: BEGIN
[0m00:31:50.355441 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:31:50.355800 [debug] [MainThread]: On master: COMMIT
[0m00:31:50.356148 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:50.356494 [debug] [MainThread]: On master: COMMIT
[0m00:31:50.356938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:50.357330 [debug] [MainThread]: On master: Close
[0m00:31:50.362547 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m00:31:50.363114 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m00:31:50.363704 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m00:31:50.364875 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m00:31:50.364228 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m00:31:50.365431 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m00:31:50.366681 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m00:31:50.374917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.375475 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m00:31:50.379615 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m00:31:50.381488 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m00:31:50.422989 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m00:31:50.432261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.436400 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m00:31:50.438099 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.438958 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m00:31:50.439594 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:50.440274 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:31:50.441234 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m00:31:50.441812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:31:50.498272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m00:31:50.498759 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.499213 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m00:31:50.500189 [debug] [Thread-2 (]: SQL status: BEGIN in 0.058 seconds
[0m00:31:50.500667 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:31:50.501116 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m00:31:50.586619 [debug] [Thread-1 (]: SQL status: SELECT 7586 in 0.087 seconds
[0m00:31:50.598387 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.598895 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m00:31:50.599777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:31:50.602580 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.602986 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m00:31:50.604244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:31:50.621802 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m00:31:50.622352 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.622754 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m00:31:50.627380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:31:50.633844 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m00:31:50.639281 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m00:31:50.639710 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m00:31:50.646557 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m00:31:50.649129 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m00:31:50.652055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B03574DD0>]}
[0m00:31:50.653194 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 7586[0m in 0.29s]
[0m00:31:50.654308 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m00:31:51.191900 [debug] [Thread-2 (]: SQL status: SELECT 20915 in 0.690 seconds
[0m00:31:51.196841 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:31:51.197537 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m00:31:51.198558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:31:51.202462 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:31:51.203141 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m00:31:51.204414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:51.206684 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m00:31:51.207212 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:31:51.207717 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m00:31:51.218909 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m00:31:51.221366 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m00:31:51.222119 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m00:31:51.222528 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m00:31:51.227166 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:31:51.228768 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m00:31:51.229474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20eb5203-daa5-4809-964f-ad0581602ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0338DB20>]}
[0m00:31:51.230151 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 0.86s]
[0m00:31:51.231232 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m00:31:51.234012 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:51.235178 [debug] [MainThread]: On master: BEGIN
[0m00:31:51.235817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:51.294327 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m00:31:51.294782 [debug] [MainThread]: On master: COMMIT
[0m00:31:51.295150 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:51.295482 [debug] [MainThread]: On master: COMMIT
[0m00:31:51.295936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:51.296332 [debug] [MainThread]: On master: Close
[0m00:31:51.296880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:51.297254 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m00:31:51.297593 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m00:31:51.297898 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m00:31:51.298208 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m00:31:51.298532 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m00:31:51.298832 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m00:31:51.299142 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m00:31:51.299593 [info ] [MainThread]: 
[0m00:31:51.300164 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m00:31:51.301219 [debug] [MainThread]: Command end result
[0m00:31:51.354586 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:51.358394 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:51.366787 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:31:51.367322 [info ] [MainThread]: 
[0m00:31:51.368057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:51.368702 [info ] [MainThread]: 
[0m00:31:51.369318 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:31:51.370828 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:51.370686 after 3.09 seconds
[0m00:31:51.371265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0357BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B033CF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B02A580D0>]}
[0m00:31:51.371688 [debug] [MainThread]: Flushing usage events
[0m00:31:52.341832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:55.462104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C799AB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79B358910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79B99BED0>]}


============================== 00:31:55.467371 | d1609d9d-ad73-4156-a26a-d5b4a673c905 ==============================
[0m00:31:55.467371 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:31:55.468237 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_metabase_people int_customers fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:31:55.703645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1609d9d-ad73-4156-a26a-d5b4a673c905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C799CE9F30>]}
[0m00:31:55.772926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1609d9d-ad73-4156-a26a-d5b4a673c905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79BA1FDF0>]}
[0m00:31:55.774319 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:31:56.158745 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:31:56.359946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:56.360344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:56.427147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1609d9d-ad73-4156-a26a-d5b4a673c905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79BD1F350>]}
[0m00:31:56.557797 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:56.561222 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:56.709016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1609d9d-ad73-4156-a26a-d5b4a673c905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79C2226C0>]}
[0m00:31:56.709999 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m00:31:56.711761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1609d9d-ad73-4156-a26a-d5b4a673c905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79BB68D70>]}
[0m00:31:56.720541 [info ] [MainThread]: 
[0m00:31:56.721293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:56.721929 [info ] [MainThread]: 
[0m00:31:56.723033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:56.732970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m00:31:56.748114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m00:31:56.752437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m00:31:56.754768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m00:31:56.865724 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:56.866143 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m00:31:56.866436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:56.867014 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:56.867344 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m00:31:56.867624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:56.868094 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:56.868423 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m00:31:56.868727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:56.869104 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:56.869714 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m00:31:56.870234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:56.933951 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m00:31:56.934698 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m00:31:56.935346 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m00:31:56.936063 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m00:31:56.936737 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m00:31:56.937316 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m00:31:56.939949 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m00:31:56.940408 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m00:31:56.940786 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m00:31:56.943669 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m00:31:56.944239 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m00:31:56.944623 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m00:31:56.946551 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:56.947987 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m00:31:56.948459 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:31:56.948808 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m00:31:56.950021 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m00:31:56.950506 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m00:31:56.951259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_snapshots)
[0m00:31:56.952821 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m00:31:56.954904 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:56.955294 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m00:31:56.955734 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m00:31:56.956170 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m00:31:56.957533 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m00:31:56.958130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dw)
[0m00:31:56.958503 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m00:31:56.958894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:56.960909 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:56.961303 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m00:31:56.962044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_b2c)
[0m00:31:56.962535 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m00:31:56.966246 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:56.967137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_stg)
[0m00:31:56.967722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:56.968311 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m00:31:56.970228 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:56.971090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:56.971693 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m00:31:56.972431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:57.026657 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m00:31:57.027418 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m00:31:57.028129 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:31:57.037988 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m00:31:57.039963 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m00:31:57.040696 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m00:31:57.043736 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m00:31:57.044429 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m00:31:57.045053 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m00:31:57.045866 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m00:31:57.046596 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:31:57.047136 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m00:31:57.048859 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m00:31:57.049296 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m00:31:57.049688 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m00:31:57.055767 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m00:31:57.056382 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m00:31:57.057673 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m00:31:57.059175 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m00:31:57.059621 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.010 seconds
[0m00:31:57.060005 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m00:31:57.062166 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m00:31:57.062695 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m00:31:57.063935 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m00:31:57.077051 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:57.077478 [debug] [MainThread]: On master: BEGIN
[0m00:31:57.077789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:57.135064 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m00:31:57.135494 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:57.135904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:57.145511 [debug] [MainThread]: SQL status: SELECT 25 in 0.009 seconds
[0m00:31:57.148313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1609d9d-ad73-4156-a26a-d5b4a673c905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79C29C940>]}
[0m00:31:57.148779 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:57.149323 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:57.149670 [debug] [MainThread]: On master: BEGIN
[0m00:31:57.150295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:31:57.150625 [debug] [MainThread]: On master: COMMIT
[0m00:31:57.150934 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:57.151236 [debug] [MainThread]: On master: COMMIT
[0m00:31:57.151703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:57.152138 [debug] [MainThread]: On master: Close
[0m00:31:57.158318 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:31:57.158799 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:31:57.159192 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:31:57.159639 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:31:57.160109 [info ] [Thread-1 (]: 1 of 27 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m00:31:57.160719 [info ] [Thread-3 (]: 3 of 27 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m00:31:57.162127 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m00:31:57.161123 [info ] [Thread-4 (]: 4 of 27 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m00:31:57.162763 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m00:31:57.163200 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:31:57.161623 [info ] [Thread-2 (]: 2 of 27 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m00:31:57.163786 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m00:31:57.164209 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:31:57.185241 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:31:57.185912 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m00:31:57.186380 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:31:57.190155 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:31:57.190861 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:31:57.195399 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:31:57.202839 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:31:57.203839 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:31:57.230397 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:31:57.231473 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:31:57.238430 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:31:57.239059 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:31:57.239776 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:31:57.242304 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:31:57.246250 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:31:57.248184 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:31:57.248993 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m00:31:57.250190 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:31:57.251421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:57.252367 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m00:31:57.254035 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:31:57.254898 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:31:57.255830 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:31:57.256578 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m00:31:57.257100 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m00:31:57.257820 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:31:57.258491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:31:57.344112 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m00:31:57.344953 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m00:31:57.345849 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.346760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m00:31:57.347757 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m00:31:57.348635 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.353762 [debug] [Thread-4 (]: SQL status: BEGIN in 0.095 seconds
[0m00:31:57.354671 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m00:31:57.355501 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.357654 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m00:31:57.358545 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m00:31:57.359302 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.360875 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m00:31:57.368833 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m00:31:57.369726 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m00:31:57.370527 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m00:31:57.372831 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m00:31:57.373589 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m00:31:57.374285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m00:31:57.375920 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m00:31:57.378820 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m00:31:57.380963 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m00:31:57.380291 [info ] [Thread-3 (]: 3 of 27 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.22s]
[0m00:31:57.382005 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m00:31:57.382727 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m00:31:57.384538 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m00:31:57.386044 [info ] [Thread-2 (]: 2 of 27 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.20s]
[0m00:31:57.389871 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:31:57.391276 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m00:31:57.393177 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:31:57.387379 [info ] [Thread-4 (]: 4 of 27 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.22s]
[0m00:31:57.399022 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m00:31:57.388567 [info ] [Thread-1 (]: 1 of 27 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.23s]
[0m00:31:57.400867 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:31:57.392195 [info ] [Thread-3 (]: 5 of 27 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m00:31:57.402175 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m00:31:57.394260 [info ] [Thread-2 (]: 6 of 27 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m00:31:57.403875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m00:31:57.402763 [info ] [Thread-4 (]: 7 of 27 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m00:31:57.405128 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:31:57.405901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m00:31:57.406646 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:31:57.407229 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m00:31:57.408599 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:31:57.407945 [info ] [Thread-1 (]: 8 of 27 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m00:31:57.415868 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:31:57.416649 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:31:57.422561 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:31:57.423367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m00:31:57.431796 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:31:57.433017 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:31:57.440157 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:31:57.441510 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:31:57.442229 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:31:57.448650 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:31:57.450718 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:31:57.455146 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:31:57.458203 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:31:57.459196 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:31:57.465920 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:31:57.468108 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:31:57.469031 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:31:57.469746 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m00:31:57.470560 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m00:31:57.471486 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:31:57.472020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:57.472562 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:31:57.473058 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:57.473615 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m00:31:57.474685 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m00:31:57.475752 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:57.476572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:57.558220 [debug] [Thread-2 (]: SQL status: BEGIN in 0.086 seconds
[0m00:31:57.559002 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m00:31:57.559787 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.564382 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:31:57.567278 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m00:31:57.568310 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m00:31:57.569091 [debug] [Thread-3 (]: SQL status: BEGIN in 0.096 seconds
[0m00:31:57.569922 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m00:31:57.571804 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.571084 [info ] [Thread-2 (]: 6 of 27 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.17s]
[0m00:31:57.573704 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m00:31:57.574467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m00:31:57.575332 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:31:57.576243 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:31:57.576963 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m00:31:57.577527 [debug] [Thread-4 (]: SQL status: BEGIN in 0.102 seconds
[0m00:31:57.581052 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m00:31:57.578181 [info ] [Thread-2 (]: 9 of 27 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m00:31:57.582341 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.583338 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m00:31:57.584717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m00:31:57.585393 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m00:31:57.586176 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.586782 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:31:57.595181 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:31:57.598035 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:31:57.597169 [info ] [Thread-3 (]: 5 of 27 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.19s]
[0m00:31:57.598882 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m00:31:57.601519 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m00:31:57.602514 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m00:31:57.604756 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m00:31:57.605795 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:31:57.606709 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:31:57.607514 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m00:31:57.609229 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m00:31:57.608531 [info ] [Thread-3 (]: 10 of 27 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m00:31:57.613256 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:31:57.614476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m00:31:57.616411 [info ] [Thread-4 (]: 7 of 27 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.21s]
[0m00:31:57.617660 [info ] [Thread-1 (]: 8 of 27 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.19s]
[0m00:31:57.620051 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:31:57.621483 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m00:31:57.622602 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m00:31:57.630232 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:31:57.630959 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:31:57.631530 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:31:57.632172 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:31:57.632959 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m00:31:57.634295 [info ] [Thread-4 (]: 11 of 27 START test not_null_int_customers_customer_name ....................... [RUN]
[0m00:31:57.636670 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:31:57.637635 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:57.635350 [info ] [Thread-1 (]: 12 of 27 START test not_null_int_customers_customer_nk ......................... [RUN]
[0m00:31:57.638757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57)
[0m00:31:57.641801 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:31:57.642593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1)
[0m00:31:57.643269 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:31:57.644540 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:31:57.654290 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:31:57.661272 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:31:57.663590 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:31:57.664620 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m00:31:57.665879 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:57.668897 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:31:57.674083 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:31:57.675388 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:31:57.681814 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:31:57.684320 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:31:57.685417 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: BEGIN
[0m00:31:57.686363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:57.687436 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:31:57.688652 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: BEGIN
[0m00:31:57.689572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:57.770663 [debug] [Thread-2 (]: SQL status: BEGIN in 0.133 seconds
[0m00:31:57.771609 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m00:31:57.772469 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.784567 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:31:57.787823 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m00:31:57.789185 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m00:31:57.791596 [info ] [Thread-2 (]: 9 of 27 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.21s]
[0m00:31:57.798430 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m00:31:57.800116 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:31:57.801375 [info ] [Thread-2 (]: 13 of 27 START test not_null_int_customers_source_system ....................... [RUN]
[0m00:31:57.812875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7)
[0m00:31:57.814918 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:31:57.825048 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:31:57.827814 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:31:57.837233 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:31:57.840310 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:31:57.843002 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: BEGIN
[0m00:31:57.847634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:57.873361 [debug] [Thread-3 (]: SQL status: BEGIN in 0.207 seconds
[0m00:31:57.874394 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m00:31:57.875445 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.887388 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:31:57.890975 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m00:31:57.892316 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m00:31:57.896611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.207 seconds
[0m00:31:57.897667 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m00:31:57.898665 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.899836 [debug] [Thread-4 (]: SQL status: BEGIN in 0.213 seconds
[0m00:31:57.894769 [info ] [Thread-3 (]: 10 of 27 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.28s]
[0m00:31:57.901257 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m00:31:57.903013 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m00:31:57.904299 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.905562 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:31:57.906973 [info ] [Thread-3 (]: 14 of 27 START test not_null_stg_metabase_people_customer_nk ................... [RUN]
[0m00:31:57.908425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53)
[0m00:31:57.909492 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:31:57.921325 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:31:57.924542 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:31:57.931787 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:31:57.935411 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:31:57.936449 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: BEGIN
[0m00:31:57.937559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:57.979373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.132 seconds
[0m00:31:57.980284 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m00:31:57.980894 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_system
from "dw_northwind_metabase"."dw_stg"."int_customers"
where source_system is null



  
  
      
    ) dbt_internal_test
[0m00:31:57.994075 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m00:31:57.997327 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: ROLLBACK
[0m00:31:57.998511 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: Close
[0m00:31:57.999837 [info ] [Thread-2 (]: 13 of 27 PASS not_null_int_customers_source_system ............................. [[32mPASS[0m in 0.19s]
[0m00:31:58.001507 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m00:31:58.002436 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:31:58.003380 [info ] [Thread-2 (]: 15 of 27 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:31:58.004506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m00:31:58.005355 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:31:58.025382 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:31:58.028503 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:31:58.034883 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:31:58.037120 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:31:58.038002 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m00:31:58.039152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:58.049010 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m00:31:58.050613 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m00:31:58.051685 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.128481 [debug] [Thread-2 (]: SQL status: BEGIN in 0.089 seconds
[0m00:31:58.129493 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m00:31:58.130518 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.161607 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.255 seconds
[0m00:31:58.164583 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: ROLLBACK
[0m00:31:58.165512 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.034 seconds
[0m00:31:58.168242 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m00:31:58.168937 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: Close
[0m00:31:58.169473 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.117 seconds
[0m00:31:58.172298 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: ROLLBACK
[0m00:31:58.174312 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m00:31:58.173426 [info ] [Thread-4 (]: 11 of 27 PASS not_null_int_customers_customer_name ............................. [[32mPASS[0m in 0.53s]
[0m00:31:58.176279 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m00:31:58.177186 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: Close
[0m00:31:58.178152 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:31:58.179520 [info ] [Thread-2 (]: 15 of 27 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.17s]
[0m00:31:58.185646 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m00:31:58.180826 [info ] [Thread-4 (]: 16 of 27 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:31:58.186998 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:31:58.182289 [info ] [Thread-3 (]: 14 of 27 PASS not_null_stg_metabase_people_customer_nk ......................... [[32mPASS[0m in 0.27s]
[0m00:31:58.188569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m00:31:58.191348 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m00:31:58.190077 [info ] [Thread-2 (]: 17 of 27 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:31:58.192577 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:31:58.193411 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:31:58.194578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.294 seconds
[0m00:31:58.195484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m00:31:58.204074 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:31:58.207035 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: ROLLBACK
[0m00:31:58.204843 [info ] [Thread-3 (]: 18 of 27 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m00:31:58.207854 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:31:58.208745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m00:31:58.209286 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: Close
[0m00:31:58.217970 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:31:58.218702 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:31:58.231016 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:31:58.219853 [info ] [Thread-1 (]: 12 of 27 PASS not_null_int_customers_customer_nk ............................... [[32mPASS[0m in 0.58s]
[0m00:31:58.233791 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m00:31:58.234975 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:31:58.236169 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:31:58.241520 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:31:58.243942 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:31:58.250338 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:31:58.251811 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:31:58.242738 [info ] [Thread-1 (]: 19 of 27 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m00:31:58.260777 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:31:58.262122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m00:31:58.263719 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:31:58.275049 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:31:58.275754 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:31:58.276338 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:31:58.277552 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m00:31:58.278644 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m00:31:58.279670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:58.280623 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:58.282018 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:31:58.283035 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:31:58.284297 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m00:31:58.289360 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:31:58.290592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:58.293145 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:31:58.294698 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m00:31:58.295762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:58.381550 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m00:31:58.382543 [debug] [Thread-3 (]: SQL status: BEGIN in 0.092 seconds
[0m00:31:58.383264 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m00:31:58.383936 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m00:31:58.384937 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.386043 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.391804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m00:31:58.392428 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m00:31:58.392946 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m00:31:58.396307 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m00:31:58.397526 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.398597 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m00:31:58.399244 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m00:31:58.401243 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m00:31:58.403583 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m00:31:58.402716 [info ] [Thread-3 (]: 18 of 27 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.19s]
[0m00:31:58.405336 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m00:31:58.407142 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:31:58.406454 [info ] [Thread-4 (]: 16 of 27 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.22s]
[0m00:31:58.409974 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m00:31:58.410953 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:31:58.408235 [info ] [Thread-3 (]: 20 of 27 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m00:31:58.413516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m00:31:58.411943 [info ] [Thread-4 (]: 21 of 27 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m00:31:58.415726 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:31:58.416950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m00:31:58.424812 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m00:31:58.428518 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:31:58.429809 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:31:58.432548 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m00:31:58.442606 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:31:58.443927 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m00:31:58.448125 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:31:58.455220 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:31:58.445876 [info ] [Thread-1 (]: 19 of 27 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.18s]
[0m00:31:58.457831 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m00:31:58.458783 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:31:58.459908 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:31:58.466464 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:31:58.467632 [info ] [Thread-1 (]: 22 of 27 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m00:31:58.469198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m00:31:58.470311 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:31:58.471324 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:31:58.472171 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m00:31:58.486329 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:31:58.487404 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:58.489484 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:31:58.491454 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m00:31:58.492373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:58.494356 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:31:58.495815 [debug] [Thread-2 (]: SQL status: BEGIN in 0.216 seconds
[0m00:31:58.502716 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:31:58.504174 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m00:31:58.505558 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.508225 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:31:58.509221 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m00:31:58.510185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:58.593037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.106 seconds
[0m00:31:58.594124 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m00:31:58.595118 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.596281 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m00:31:58.597307 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m00:31:58.598382 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:58.601085 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.094 seconds
[0m00:31:58.604352 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m00:31:58.605518 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m00:31:58.607934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m00:31:58.607052 [info ] [Thread-2 (]: 17 of 27 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.41s]
[0m00:31:58.609087 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m00:31:58.610204 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m00:31:58.611033 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:58.611843 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:31:58.613009 [info ] [Thread-2 (]: 23 of 27 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m00:31:58.614664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m00:31:58.615624 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:31:58.624775 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:31:58.625737 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.030 seconds
[0m00:31:58.626895 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.027 seconds
[0m00:31:58.630688 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m00:31:58.634129 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m00:31:58.635738 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m00:31:58.636681 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:31:58.637550 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m00:31:58.642865 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:31:58.648724 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:31:58.650040 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m00:31:58.651746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:58.644243 [info ] [Thread-3 (]: 20 of 27 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.23s]
[0m00:31:58.654968 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m00:31:58.656036 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:31:58.646126 [info ] [Thread-4 (]: 21 of 27 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.23s]
[0m00:31:58.658767 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m00:31:58.659799 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:31:58.657106 [info ] [Thread-3 (]: 24 of 27 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m00:31:58.662233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m00:31:58.663328 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:31:58.660834 [info ] [Thread-4 (]: 25 of 27 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m00:31:58.674412 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.061 seconds
[0m00:31:58.676037 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:31:58.677268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m00:31:58.680798 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m00:31:58.682247 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:31:58.689633 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m00:31:58.694055 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:31:58.697569 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:31:58.695994 [info ] [Thread-1 (]: 22 of 27 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.23s]
[0m00:31:58.706661 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m00:31:58.704407 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:31:58.707977 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:31:58.708928 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:31:58.716214 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:31:58.710255 [info ] [Thread-1 (]: 26 of 27 START test unique_int_customers_customer_nk ........................... [RUN]
[0m00:31:58.718457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd, now test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd)
[0m00:31:58.719505 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:31:58.720615 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:31:58.729829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:31:58.731166 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m00:31:58.733204 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:58.734437 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:31:58.735896 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m00:31:58.736871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:58.737942 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:31:58.745066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:31:58.748160 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:31:58.749561 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: BEGIN
[0m00:31:58.750686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:58.775429 [debug] [Thread-2 (]: SQL status: BEGIN in 0.124 seconds
[0m00:31:58.776469 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m00:31:58.777515 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:58.785012 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m00:31:58.788368 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m00:31:58.789599 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m00:31:58.791147 [info ] [Thread-2 (]: 23 of 27 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.18s]
[0m00:31:58.794232 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m00:31:58.795307 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:31:58.796508 [info ] [Thread-2 (]: 27 of 27 START test unique_stg_metabase_people_customer_nk ..................... [RUN]
[0m00:31:58.801171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e, now test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460)
[0m00:31:58.802220 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:31:58.811006 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:31:58.813398 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:31:58.819386 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:31:58.822455 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:31:58.823569 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: BEGIN
[0m00:31:58.824354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:58.873021 [debug] [Thread-3 (]: SQL status: BEGIN in 0.140 seconds
[0m00:31:58.874067 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m00:31:58.875124 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:58.876959 [debug] [Thread-4 (]: SQL status: BEGIN in 0.140 seconds
[0m00:31:58.878131 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m00:31:58.879229 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:58.883864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.133 seconds
[0m00:31:58.884822 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m00:31:58.885720 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m00:31:58.886637 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:58.889827 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m00:31:58.891134 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m00:31:58.893594 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m00:31:58.892767 [info ] [Thread-4 (]: 25 of 27 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.22s]
[0m00:31:58.897536 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m00:31:58.899072 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m00:31:58.900349 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m00:31:58.902116 [info ] [Thread-3 (]: 24 of 27 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.24s]
[0m00:31:58.904597 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m00:31:58.928725 [debug] [Thread-2 (]: SQL status: BEGIN in 0.104 seconds
[0m00:31:58.930013 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m00:31:58.931073 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:59.037448 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.105 seconds
[0m00:31:59.039637 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: ROLLBACK
[0m00:31:59.040605 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: Close
[0m00:31:59.041650 [info ] [Thread-2 (]: 27 of 27 PASS unique_stg_metabase_people_customer_nk ........................... [[32mPASS[0m in 0.24s]
[0m00:31:59.043394 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m00:31:59.127683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.237 seconds
[0m00:31:59.129687 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: ROLLBACK
[0m00:31:59.130820 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: Close
[0m00:31:59.131728 [info ] [Thread-1 (]: 26 of 27 PASS unique_int_customers_customer_nk ................................. [[32mPASS[0m in 0.41s]
[0m00:31:59.132895 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m00:31:59.134930 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:59.135445 [debug] [MainThread]: On master: BEGIN
[0m00:31:59.135861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:59.205764 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m00:31:59.206272 [debug] [MainThread]: On master: COMMIT
[0m00:31:59.206714 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:59.207078 [debug] [MainThread]: On master: COMMIT
[0m00:31:59.207636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:59.208039 [debug] [MainThread]: On master: Close
[0m00:31:59.208651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:59.209012 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m00:31:59.209512 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m00:31:59.210031 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m00:31:59.210542 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m00:31:59.211087 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd' was properly closed.
[0m00:31:59.211600 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m00:31:59.212123 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m00:31:59.212630 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460' was properly closed.
[0m00:31:59.213149 [info ] [MainThread]: 
[0m00:31:59.213826 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m00:31:59.219650 [debug] [MainThread]: Command end result
[0m00:31:59.279279 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m00:31:59.283731 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m00:31:59.294391 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m00:31:59.295261 [info ] [MainThread]: 
[0m00:31:59.296276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:59.296948 [info ] [MainThread]: 
[0m00:31:59.297561 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=27
[0m00:31:59.299142 [debug] [MainThread]: Command `dbt test` succeeded at 00:31:59.298993 after 3.97 seconds
[0m00:31:59.299604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79B7DE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79C1D3D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79C1D12E0>]}
[0m00:31:59.300082 [debug] [MainThread]: Flushing usage events
[0m00:32:00.449637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:19.760323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D7BB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D9458910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D9A9BED0>]}


============================== 01:00:19.773550 | f3d82710-bc5b-4c97-82a5-9f4be72f7312 ==============================
[0m01:00:19.773550 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:00:19.775640 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --select stg_metabase_people stg_metabase_orders', 'target_path': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m01:00:20.210864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D7DE9F30>]}
[0m01:00:20.352862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D9B23DF0>]}
[0m01:00:20.359574 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:00:21.026835 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:00:21.391595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:21.392060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:21.546349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D9E23350>]}
[0m01:00:21.789964 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:21.794077 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:21.923494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D4598F50>]}
[0m01:00:21.924163 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:00:21.924805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D9CDD9B0>]}
[0m01:00:21.928772 [info ] [MainThread]: 
[0m01:00:21.929728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:21.930383 [info ] [MainThread]: 
[0m01:00:21.931416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:21.937733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:00:22.208503 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:00:22.209175 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:00:22.209569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:22.313740 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.104 seconds
[0m01:00:22.315189 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:00:22.319587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m01:00:22.325968 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:22.326542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:00:22.326897 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:00:22.329103 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:22.329512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:22.330015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:00:22.330515 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:00:22.331030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:00:22.333586 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:22.334148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:22.337076 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:22.337949 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:00:22.338782 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:00:22.339423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:22.339848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:22.402692 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m01:00:22.403427 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:22.403972 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:22.408720 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m01:00:22.409444 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:22.409934 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:00:22.414098 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m01:00:22.414568 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:22.415069 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:00:22.415645 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m01:00:22.416207 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m01:00:22.417720 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:00:22.418209 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:22.418583 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.008 seconds
[0m01:00:22.419087 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:00:22.419538 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:00:22.421368 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:00:22.422346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:00:22.423474 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:00:22.426137 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:22.426810 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.011 seconds
[0m01:00:22.427424 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:00:22.428244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:00:22.429925 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:00:22.432677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:22.433051 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:00:22.434855 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:22.436489 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:00:22.436898 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:00:22.437329 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:00:22.437821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:22.438427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m01:00:22.438784 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:00:22.443609 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:22.444342 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:00:22.445157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:00:22.445761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:22.448536 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:22.449371 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:00:22.449923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:22.507218 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m01:00:22.507778 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:22.508361 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:00:22.519690 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m01:00:22.520614 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:22.521534 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:00:22.522812 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m01:00:22.524983 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:00:22.525890 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:00:22.528188 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m01:00:22.528996 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:22.529814 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:00:22.532880 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:00:22.533644 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m01:00:22.535578 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:00:22.536441 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:22.537486 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:00:22.538378 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:00:22.542961 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:00:22.544703 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:00:22.545342 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:00:22.548946 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:00:22.550595 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:00:22.551190 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:00:22.560493 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:22.561111 [debug] [MainThread]: On master: BEGIN
[0m01:00:22.561519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:22.622578 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m01:00:22.623036 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:22.623421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:22.636988 [debug] [MainThread]: SQL status: SELECT 25 in 0.013 seconds
[0m01:00:22.641135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266DA4ADD90>]}
[0m01:00:22.641937 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:22.642651 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:22.643024 [debug] [MainThread]: On master: BEGIN
[0m01:00:22.643702 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:22.644032 [debug] [MainThread]: On master: COMMIT
[0m01:00:22.644357 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:22.644677 [debug] [MainThread]: On master: COMMIT
[0m01:00:22.645117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:22.645450 [debug] [MainThread]: On master: Close
[0m01:00:22.658748 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_people
[0m01:00:22.659497 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m01:00:22.660225 [info ] [Thread-2 (]: 2 of 2 START sql view model dw_stg.stg_metabase_people ......................... [RUN]
[0m01:00:22.661578 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_people'
[0m01:00:22.660877 [info ] [Thread-1 (]: 1 of 2 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m01:00:22.662774 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_people
[0m01:00:22.663327 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m01:00:22.673029 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.674386 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m01:00:22.681161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.682627 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_people
[0m01:00:22.746653 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.747527 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m01:00:22.753594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.755193 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.756071 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: BEGIN
[0m01:00:22.756724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:00:22.757748 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.758593 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m01:00:22.759253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:22.833986 [debug] [Thread-2 (]: SQL status: BEGIN in 0.077 seconds
[0m01:00:22.834890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m01:00:22.835586 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.836337 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.836945 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp"
    
    
  as (
    

-- Registros da tabela people (usados pelos pedidos B2C que n√£o mapeiam para accounts).
select
    'METABASE'                               as source_system,
    p.id                                     as source_customer_id,
    'METABASE_PERSON_' || p.id               as customer_nk,
    p.name                                   as customer_name,
    null::varchar                            as contact_name,
    null::varchar                            as contact_title,
    split_part(p.name, ' ', 1)               as first_name,
    nullif(split_part(p.name, ' ', 2), '')   as last_name,
    p.address                                as address,
    p.city                                   as city,
    p.state                                  as region,
    null::varchar                            as country,
    p.zip::varchar                           as postal_code,
    null::varchar                            as plan,
    p.source                                 as segment,
    null::int                                as seats,
    null::boolean                            as trial_converted,
    null::boolean                            as active_subscription,
    null::boolean                            as legacy_plan,
    null::timestamp                          as created_at,
    null::timestamp                          as trial_ends_at,
    null::timestamp                          as canceled_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."people" p
  );
[0m01:00:22.837630 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

with account_name_map as (
    select
        lower(concat_ws(' ', first_name, last_name)) as full_name_key,
        min(id)                                      as account_id
    from "dw_northwind_metabase"."public"."accounts"
    where first_name is not null and last_name is not null
    group by 1
),
people_name_map as (
    select
        lower(name) as full_name_key,
        min(id)     as person_id
    from "dw_northwind_metabase"."public"."people"
    where name is not null
    group by 1
),
product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar
        when people_map.person_id is not null then 'METABASE_PERSON_' || people_map.person_id::varchar
        else 'METABASE_ORPHAN_' || upper(trim(o.user_id))
    end                                       as customer_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(o.product_id))
    end                                       as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join account_name_map acc_map
       on lower(o.user_id) = acc_map.full_name_key
left join people_name_map people_map
       on acc_map.account_id is null
      and lower(o.user_id) = people_map.full_name_key
left join product_map prod_map
       on lower(o.product_id) = prod_map.title_key
  );
[0m01:00:22.856382 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m01:00:22.856994 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m01:00:22.864498 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.868165 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.868701 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people" rename to "stg_metabase_people__dbt_backup"
[0m01:00:22.869194 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m01:00:22.871477 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:22.872037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:22.875662 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.880475 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.881159 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp" rename to "stg_metabase_people"
[0m01:00:22.881770 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m01:00:22.883199 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:22.883770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:22.904859 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m01:00:22.907276 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m01:00:22.908137 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.908782 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.909296 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m01:00:22.909840 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m01:00:22.911780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:22.912547 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:22.919854 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m01:00:22.923563 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup"
[0m01:00:22.930781 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:00:22.931834 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:00:22.932372 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m01:00:22.932877 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup" cascade
[0m01:00:22.942005 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m01:00:22.942684 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m01:00:22.945622 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m01:00:22.947392 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: Close
[0m01:00:22.952347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266DA6EC890>]}
[0m01:00:22.953185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d82710-bc5b-4c97-82a5-9f4be72f7312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266DA581BD0>]}
[0m01:00:22.954541 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dw_stg.stg_metabase_people .................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:00:22.956561 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_people
[0m01:00:22.955508 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:00:22.957913 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m01:00:22.959754 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:22.960198 [debug] [MainThread]: On master: BEGIN
[0m01:00:22.960569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:23.033722 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m01:00:23.034192 [debug] [MainThread]: On master: COMMIT
[0m01:00:23.034616 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:23.034964 [debug] [MainThread]: On master: COMMIT
[0m01:00:23.035459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:23.035830 [debug] [MainThread]: On master: Close
[0m01:00:23.036676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:23.037404 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:00:23.037993 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:00:23.038510 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:00:23.039067 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m01:00:23.039575 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:00:23.040056 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_people' was properly closed.
[0m01:00:23.040555 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m01:00:23.041221 [info ] [MainThread]: 
[0m01:00:23.041981 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m01:00:23.043369 [debug] [MainThread]: Command end result
[0m01:00:23.115261 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:23.119304 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:23.130523 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:00:23.131264 [info ] [MainThread]: 
[0m01:00:23.132150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:23.133135 [info ] [MainThread]: 
[0m01:00:23.133895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:00:23.135461 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:23.135260 after 3.64 seconds
[0m01:00:23.136908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266DA7319F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266DA5BFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266D9C580D0>]}
[0m01:00:23.138357 [debug] [MainThread]: Flushing usage events
[0m01:00:24.672918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:28.852634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB38B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB5158910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB579BED0>]}


============================== 01:00:28.857761 | a051605a-ee99-420b-bc70-597cfa526c9c ==============================
[0m01:00:28.857761 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:00:28.858790 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run --select int_customers', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m01:00:29.135555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB3AE9F30>]}
[0m01:00:29.214927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB5823DF0>]}
[0m01:00:29.216223 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:00:29.735579 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:00:30.041445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:30.041892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:30.117519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB5B23350>]}
[0m01:00:30.275957 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:30.279613 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:30.377696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB0248F50>]}
[0m01:00:30.378368 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:00:30.379058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB59DD9B0>]}
[0m01:00:30.381983 [info ] [MainThread]: 
[0m01:00:30.382797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:30.383609 [info ] [MainThread]: 
[0m01:00:30.384422 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:30.385834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:00:30.518483 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:00:30.518919 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:00:30.519265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:30.586104 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.067 seconds
[0m01:00:30.587517 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:00:30.596001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m01:00:30.601835 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:30.602408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:00:30.602827 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:00:30.605310 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:30.606036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:00:30.606560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:30.607304 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:00:30.608242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m01:00:30.610442 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:30.611222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:30.614537 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:30.615143 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:00:30.615941 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:00:30.616531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:30.617183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:30.692755 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m01:00:30.693530 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:30.694244 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:00:30.695708 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m01:00:30.696395 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:30.697026 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:00:30.701518 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m01:00:30.702086 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:30.702616 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:00:30.703789 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m01:00:30.704419 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:30.705069 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:00:30.705770 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:00:30.707792 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:00:30.708296 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.011 seconds
[0m01:00:30.710917 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:00:30.711464 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:00:30.712266 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:00:30.713336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_stg)
[0m01:00:30.714211 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:00:30.715680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:00:30.718610 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:30.721463 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m01:00:30.722918 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:00:30.724749 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:30.725129 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:00:30.726260 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:00:30.726690 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:00:30.727017 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:00:30.727322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:30.727723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:30.728047 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:00:30.728875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m01:00:30.732226 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:30.732990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_snapshots)
[0m01:00:30.733595 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:00:30.735708 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:30.736217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:30.736886 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:00:30.737751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:30.796210 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m01:00:30.796833 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:30.797382 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:00:30.801080 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m01:00:30.801559 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:30.802205 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:00:30.803976 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m01:00:30.804380 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:30.804725 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:30.806184 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m01:00:30.808422 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:00:30.809278 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:00:30.811998 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:00:30.813995 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:00:30.814432 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m01:00:30.815804 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:00:30.816164 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:00:30.816680 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:00:30.896714 [debug] [ThreadPool]: SQL status: BEGIN in 0.169 seconds
[0m01:00:30.897217 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:30.897577 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:00:30.906808 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.009 seconds
[0m01:00:30.908393 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:00:30.908897 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:00:30.917478 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:30.917874 [debug] [MainThread]: On master: BEGIN
[0m01:00:30.918184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:30.974852 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m01:00:30.975311 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:30.975703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:30.986447 [debug] [MainThread]: SQL status: SELECT 22 in 0.010 seconds
[0m01:00:30.988210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB61AD300>]}
[0m01:00:30.988717 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:30.989281 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:30.989645 [debug] [MainThread]: On master: BEGIN
[0m01:00:30.990276 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:30.990606 [debug] [MainThread]: On master: COMMIT
[0m01:00:30.990927 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:30.991244 [debug] [MainThread]: On master: COMMIT
[0m01:00:30.991711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:30.992067 [debug] [MainThread]: On master: Close
[0m01:00:30.997444 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m01:00:30.998028 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m01:00:30.998848 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m01:00:30.999235 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m01:00:31.008697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m01:00:31.009966 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m01:00:31.055023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m01:00:31.057009 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:00:31.057998 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m01:00:31.058847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:31.119183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m01:00:31.119718 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:00:31.120268 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
    dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
),
metabase_people as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        first_name,
        last_name,
        address,
        city,
        region,
        country,
        postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
)
select * from northwind
union all
select * from metabase
union all
select * from metabase_people
  );
[0m01:00:31.133572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m01:00:31.140812 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:00:31.141657 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m01:00:31.143563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:31.162114 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m01:00:31.162677 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:00:31.163114 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m01:00:31.168831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:00:31.176194 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m01:00:31.181650 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:00:31.182112 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m01:00:31.183244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:00:31.185803 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m01:00:31.188421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a051605a-ee99-420b-bc70-597cfa526c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB6400290>]}
[0m01:00:31.190043 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m01:00:31.191543 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m01:00:31.193646 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:31.194228 [debug] [MainThread]: On master: BEGIN
[0m01:00:31.194708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:31.262539 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m01:00:31.262989 [debug] [MainThread]: On master: COMMIT
[0m01:00:31.263349 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:31.263684 [debug] [MainThread]: On master: COMMIT
[0m01:00:31.264197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:31.264582 [debug] [MainThread]: On master: Close
[0m01:00:31.265130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:31.265482 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:00:31.265835 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m01:00:31.266133 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:00:31.266424 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m01:00:31.266742 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m01:00:31.267082 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m01:00:31.267532 [info ] [MainThread]: 
[0m01:00:31.268844 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m01:00:31.270325 [debug] [MainThread]: Command end result
[0m01:00:31.334108 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:31.337717 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:31.348413 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:00:31.349598 [info ] [MainThread]: 
[0m01:00:31.350511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:31.351387 [info ] [MainThread]: 
[0m01:00:31.352209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:00:31.354283 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:31.354077 after 2.68 seconds
[0m01:00:31.354846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB5F3BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB6353930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB6353890>]}
[0m01:00:31.355338 [debug] [MainThread]: Flushing usage events
[0m01:00:32.519683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:36.176257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A978B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A99158910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9979BED0>]}


============================== 01:00:36.181709 | c0aee3ea-8e67-4c80-9d10-4b112cc57a44 ==============================
[0m01:00:36.181709 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:00:36.182677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:00:36.431263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97AE9F30>]}
[0m01:00:36.522246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9981FDF0>]}
[0m01:00:36.523703 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:00:37.035182 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:00:37.248079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:37.248520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:37.317662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A99B2B350>]}
[0m01:00:37.462777 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:37.466947 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:37.574245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A942E8F50>]}
[0m01:00:37.575625 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:00:37.576415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A999E99B0>]}
[0m01:00:37.579170 [info ] [MainThread]: 
[0m01:00:37.579895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:37.580601 [info ] [MainThread]: 
[0m01:00:37.581595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:37.583284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:00:37.749357 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:00:37.749832 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:00:37.750188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.822873 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.073 seconds
[0m01:00:37.824317 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:00:37.832127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m01:00:37.839631 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:37.840317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:00:37.840771 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:00:37.843830 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:37.844421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m01:00:37.844757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.845289 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:00:37.845762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:00:37.847569 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:37.848269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.850317 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:37.850894 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:00:37.851804 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:00:37.852261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.852704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:37.930134 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m01:00:37.930904 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:37.931544 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:00:37.936094 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m01:00:37.936811 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:37.937387 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:00:37.940712 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m01:00:37.941350 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:37.942069 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.010 seconds
[0m01:00:37.942803 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:00:37.946180 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:00:37.947578 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:00:37.949560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:00:37.955747 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m01:00:37.959527 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:37.960335 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m01:00:37.962394 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:00:37.963031 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:00:37.965235 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:00:37.966232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:37.966920 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:00:37.967721 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:00:37.968977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_sales)
[0m01:00:37.972599 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:37.973432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dw)
[0m01:00:37.974137 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:00:37.977987 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:37.978778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:37.979453 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:00:37.980317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:38.046644 [debug] [ThreadPool]: SQL status: BEGIN in 0.202 seconds
[0m01:00:38.047389 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:38.048059 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:00:38.057387 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m01:00:38.058246 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:38.059103 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:00:38.060105 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:00:38.062577 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:00:38.063565 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:00:38.064829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_snapshots)
[0m01:00:38.068612 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:38.069649 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:00:38.070494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:38.072261 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:00:38.074712 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:00:38.075801 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:00:38.077294 [debug] [ThreadPool]: SQL status: BEGIN in 0.098 seconds
[0m01:00:38.078163 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:38.079452 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:00:38.086673 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m01:00:38.087410 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:38.088095 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:00:38.091273 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:00:38.093669 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:00:38.094689 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:00:38.100033 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.011 seconds
[0m01:00:38.102738 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:00:38.103740 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:00:38.153090 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m01:00:38.153559 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:38.153953 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:38.164104 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:00:38.165967 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:00:38.166669 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:00:38.176625 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:38.177128 [debug] [MainThread]: On master: BEGIN
[0m01:00:38.177498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:38.241945 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m01:00:38.242702 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:38.243218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:38.253841 [debug] [MainThread]: SQL status: SELECT 25 in 0.010 seconds
[0m01:00:38.256703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9A1CDCC0>]}
[0m01:00:38.257535 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:38.258527 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:38.259265 [debug] [MainThread]: On master: BEGIN
[0m01:00:38.260219 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:38.260727 [debug] [MainThread]: On master: COMMIT
[0m01:00:38.261142 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:38.261501 [debug] [MainThread]: On master: COMMIT
[0m01:00:38.262093 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:38.262499 [debug] [MainThread]: On master: Close
[0m01:00:38.267710 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:00:38.269007 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m01:00:38.269849 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m01:00:38.270271 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:00:38.279664 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:00:38.353489 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.354007 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select customer_name, city, country, plan, segment, trial_converted, active_subscription, legacy_plan from (
                



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m01:00:38.354461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:38.429826 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.075 seconds
[0m01:00:38.445763 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.446289 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m01:00:38.447220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m01:00:38.447693 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.448123 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:38.472144 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.023 seconds
[0m01:00:38.482607 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.483175 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:38.488246 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.005 seconds
[0m01:00:38.546858 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.547735 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp010038537546"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m01:00:38.860693 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.312 seconds
[0m01:00:38.864299 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.864864 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp010038537546'
        
      order by ordinal_position

  
[0m01:00:38.871385 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.006 seconds
[0m01:00:38.874980 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.875841 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:38.881575 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.005 seconds
[0m01:00:38.886099 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.886674 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp010038537546'
        
      order by ordinal_position

  
[0m01:00:38.890876 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.004 seconds
[0m01:00:38.895326 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.895878 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:00:38.900030 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.004 seconds
[0m01:00:38.907908 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.908436 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp010038537546'
        
      order by ordinal_position

  
[0m01:00:38.914202 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.005 seconds
[0m01:00:38.941846 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.942784 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m01:00:38.945959 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m01:00:38.950970 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.951495 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m01:00:38.952214 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m01:00:38.952833 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.954339 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.955345 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      update "dw_northwind_metabase"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp010038537546" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_valid_to is null;
      


    insert into "dw_northwind_metabase"."snapshots"."customers_snapshot" ("customer_nk", "source_system", "source_customer_id", "customer_name", "contact_name", "contact_title", "first_name", "last_name", "address", "city", "region", "country", "postal_code", "plan", "segment", "seats", "trial_converted", "active_subscription", "legacy_plan", "created_at", "trial_ends_at", "canceled_at", "dw_load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_nk",DBT_INTERNAL_SOURCE."source_system",DBT_INTERNAL_SOURCE."source_customer_id",DBT_INTERNAL_SOURCE."customer_name",DBT_INTERNAL_SOURCE."contact_name",DBT_INTERNAL_SOURCE."contact_title",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."region",DBT_INTERNAL_SOURCE."country",DBT_INTERNAL_SOURCE."postal_code",DBT_INTERNAL_SOURCE."plan",DBT_INTERNAL_SOURCE."segment",DBT_INTERNAL_SOURCE."seats",DBT_INTERNAL_SOURCE."trial_converted",DBT_INTERNAL_SOURCE."active_subscription",DBT_INTERNAL_SOURCE."legacy_plan",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."trial_ends_at",DBT_INTERNAL_SOURCE."canceled_at",DBT_INTERNAL_SOURCE."dw_load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp010038537546" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m01:00:38.960365 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m01:00:38.979538 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m01:00:38.980305 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:00:38.980823 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m01:00:38.983213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:38.989809 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m01:00:38.994290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0aee3ea-8e67-4c80-9d10-4b112cc57a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9A3EC950>]}
[0m01:00:38.996400 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mINSERT 0 0[0m in 0.72s]
[0m01:00:38.998788 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:00:39.001915 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:39.002699 [debug] [MainThread]: On master: BEGIN
[0m01:00:39.005432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:39.085473 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m01:00:39.086120 [debug] [MainThread]: On master: COMMIT
[0m01:00:39.086588 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:39.086978 [debug] [MainThread]: On master: COMMIT
[0m01:00:39.087650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:39.088111 [debug] [MainThread]: On master: Close
[0m01:00:39.088940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:39.089622 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:00:39.090256 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m01:00:39.090899 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:00:39.091533 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m01:00:39.092094 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m01:00:39.092770 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m01:00:39.093480 [info ] [MainThread]: 
[0m01:00:39.094346 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m01:00:39.095753 [debug] [MainThread]: Command end result
[0m01:00:39.173913 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:39.180926 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:39.194715 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:00:39.195804 [info ] [MainThread]: 
[0m01:00:39.197311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:39.198425 [info ] [MainThread]: 
[0m01:00:39.199426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:00:39.202359 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:00:39.202023 after 3.17 seconds
[0m01:00:39.203266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9A2A7AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9A400AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9A400910>]}
[0m01:00:39.203978 [debug] [MainThread]: Flushing usage events
[0m01:00:40.320822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:43.714932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C04B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C0D58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C239BED0>]}


============================== 01:00:43.720233 | 37fb8153-f959-4f75-8af9-65a3c499e22c ==============================
[0m01:00:43.720233 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:00:43.721374 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run --select dim_customer fact_sales', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:00:44.103107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C06E9F30>]}
[0m01:00:44.204015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C2423DF0>]}
[0m01:00:44.205580 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:00:44.754630 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:00:45.036666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:45.037163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:45.143513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C271F350>]}
[0m01:00:45.317876 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:45.322037 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:45.434101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243BCEA8F50>]}
[0m01:00:45.435269 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:00:45.436172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C25DD9B0>]}
[0m01:00:45.440399 [info ] [MainThread]: 
[0m01:00:45.441054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:45.441780 [info ] [MainThread]: 
[0m01:00:45.442824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:45.451663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:00:45.610990 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:00:45.611648 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:00:45.612043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:45.691328 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.079 seconds
[0m01:00:45.693065 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:00:45.699421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:00:45.706298 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:45.706953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:00:45.707383 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:00:45.710891 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:45.711863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m01:00:45.712952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:45.714008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:00:45.714866 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:00:45.717291 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:45.719799 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:45.720357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:45.720882 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:00:45.721499 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:00:45.722237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:45.722881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:45.806682 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m01:00:45.807521 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:45.808090 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:00:45.819761 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m01:00:45.822816 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:00:45.823430 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m01:00:45.824218 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:00:45.824780 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m01:00:45.825187 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:45.825807 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:45.826633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_snapshots)
[0m01:00:45.827336 [debug] [ThreadPool]: SQL status: BEGIN in 0.105 seconds
[0m01:00:45.832360 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:00:45.833132 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:00:45.836604 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:45.837392 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:45.838383 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:00:45.839171 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:00:45.839870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:45.850541 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:00:45.851270 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m01:00:45.853634 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:00:45.854394 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m01:00:45.856719 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:00:45.859165 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:00:45.859930 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:00:45.860851 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:00:45.862207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:00:45.862917 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:00:45.867067 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:45.868318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:00:45.869254 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:00:45.870284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dw)
[0m01:00:45.874427 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:45.875226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:45.878570 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:45.879335 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:00:45.880376 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:00:45.881043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:45.881673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:45.935614 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m01:00:45.936356 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:45.937060 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:45.948586 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m01:00:45.951093 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:00:45.952071 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:00:45.968213 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m01:00:45.968807 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:45.969283 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:00:45.977933 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m01:00:45.978792 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:45.979473 [debug] [ThreadPool]: SQL status: BEGIN in 0.098 seconds
[0m01:00:45.980119 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:00:45.980716 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:00:45.981342 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:45.983108 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:00:45.983618 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:00:45.984371 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:00:45.991966 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.010 seconds
[0m01:00:45.993845 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:00:45.994421 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:00:45.995015 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:00:45.996790 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:00:45.997981 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:00:46.013921 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.014586 [debug] [MainThread]: On master: BEGIN
[0m01:00:46.015179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:46.086391 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m01:00:46.086845 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.087323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:46.099616 [debug] [MainThread]: SQL status: SELECT 25 in 0.012 seconds
[0m01:00:46.102354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C2DA9710>]}
[0m01:00:46.102928 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:46.103581 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.103990 [debug] [MainThread]: On master: BEGIN
[0m01:00:46.104716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:46.105092 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.105477 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.105826 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.106333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:46.106711 [debug] [MainThread]: On master: Close
[0m01:00:46.112021 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m01:00:46.112794 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m01:00:46.113664 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m01:00:46.115783 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m01:00:46.114370 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m01:00:46.116447 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m01:00:46.117051 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m01:00:46.125624 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m01:00:46.127218 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.134825 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.136766 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m01:00:46.186977 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m01:00:46.192370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.198164 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.200101 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.200814 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m01:00:46.201490 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:46.202633 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.203514 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m01:00:46.204319 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:00:46.270462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m01:00:46.271169 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.271741 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m01:00:46.274169 [debug] [Thread-2 (]: SQL status: BEGIN in 0.070 seconds
[0m01:00:46.275062 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.275992 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m01:00:46.378691 [debug] [Thread-1 (]: SQL status: SELECT 7586 in 0.106 seconds
[0m01:00:46.391402 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.391941 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m01:00:46.393127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:46.398454 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.399030 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m01:00:46.400110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:46.418951 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m01:00:46.419503 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.419923 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m01:00:46.424203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:00:46.431260 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m01:00:46.437891 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:00:46.438412 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m01:00:46.447414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m01:00:46.451151 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m01:00:46.453981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C4044DD0>]}
[0m01:00:46.454989 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 7586[0m in 0.34s]
[0m01:00:46.456229 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m01:00:46.879160 [debug] [Thread-2 (]: SQL status: SELECT 20915 in 0.602 seconds
[0m01:00:46.883120 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.883778 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m01:00:46.884703 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:46.887610 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.888041 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m01:00:46.889060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:46.890733 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m01:00:46.891163 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.891535 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m01:00:46.902993 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m01:00:46.905688 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m01:00:46.906543 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:00:46.906985 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m01:00:46.914048 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m01:00:46.915883 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m01:00:46.916802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fb8153-f959-4f75-8af9-65a3c499e22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C2E7D910>]}
[0m01:00:46.917607 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 0.80s]
[0m01:00:46.918592 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m01:00:46.920594 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.921227 [debug] [MainThread]: On master: BEGIN
[0m01:00:46.921812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:46.983524 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m01:00:46.983965 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.984387 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.984730 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.985230 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:46.985589 [debug] [MainThread]: On master: Close
[0m01:00:46.986165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:46.986532 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:00:46.986883 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m01:00:46.987187 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:00:46.987499 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m01:00:46.987821 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:00:46.988178 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m01:00:46.988486 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m01:00:46.988867 [info ] [MainThread]: 
[0m01:00:46.989441 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m01:00:46.990788 [debug] [MainThread]: Command end result
[0m01:00:47.060462 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:47.066654 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:47.076760 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:00:47.077474 [info ] [MainThread]: 
[0m01:00:47.078400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:47.080215 [info ] [MainThread]: 
[0m01:00:47.081147 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:00:47.084665 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:47.082893 after 3.52 seconds
[0m01:00:47.085702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C404B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C2EBF800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C25700D0>]}
[0m01:00:47.086689 [debug] [MainThread]: Flushing usage events
[0m01:00:48.265396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:52.272905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8232B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E823B58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E82519BED0>]}


============================== 01:00:52.280315 | 2347a64d-fd1a-4c12-9082-8917c525aa77 ==============================
[0m01:00:52.280315 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:00:52.282550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --select stg_metabase_people int_customers fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:00:52.539020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2347a64d-fd1a-4c12-9082-8917c525aa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8234E9F30>]}
[0m01:00:52.618987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2347a64d-fd1a-4c12-9082-8917c525aa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E825227DF0>]}
[0m01:00:52.620431 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:00:53.122355 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:00:53.341835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:53.342267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:53.416642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2347a64d-fd1a-4c12-9082-8917c525aa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E82551F350>]}
[0m01:00:53.566656 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:53.570530 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:53.693614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2347a64d-fd1a-4c12-9082-8917c525aa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E825A266C0>]}
[0m01:00:53.694276 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:00:53.695071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2347a64d-fd1a-4c12-9082-8917c525aa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E825368D70>]}
[0m01:00:53.702528 [info ] [MainThread]: 
[0m01:00:53.703279 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:53.704194 [info ] [MainThread]: 
[0m01:00:53.705205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:53.712518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:00:53.720823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:00:53.735263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m01:00:53.738889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:00:53.882475 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:53.884346 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:53.885738 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:53.887171 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:53.887889 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:00:53.888578 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:00:53.889300 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:00:53.889742 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:00:53.890701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:53.891393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:53.892016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:53.892606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:54.038951 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m01:00:54.039781 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:00:54.040563 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:00:54.049198 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m01:00:54.050758 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:00:54.052289 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:00:54.053318 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m01:00:54.054387 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:00:54.055902 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:00:54.056795 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m01:00:54.059526 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:00:54.060687 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:00:54.062280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_sales)
[0m01:00:54.066532 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:54.067370 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:00:54.068167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:54.068900 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.015 seconds
[0m01:00:54.069813 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m01:00:54.070544 [debug] [ThreadPool]: SQL status: BEGIN in 0.178 seconds
[0m01:00:54.075174 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:00:54.078119 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:00:54.079029 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:00:54.080328 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:00:54.081274 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:00:54.082208 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:00:54.083690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:00:54.085120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:00:54.088905 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:54.107951 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:54.108868 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.026 seconds
[0m01:00:54.109761 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:00:54.111432 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:00:54.114319 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:00:54.115497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:54.116316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:54.118589 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:00:54.120767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:00:54.124700 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:54.127142 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:00:54.128091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:54.220888 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m01:00:54.221684 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:00:54.222497 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:00:54.238298 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m01:00:54.241564 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:00:54.243667 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:00:54.261038 [debug] [ThreadPool]: SQL status: BEGIN in 0.145 seconds
[0m01:00:54.261922 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:00:54.262690 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m01:00:54.263177 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:00:54.263700 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:00:54.264388 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:00:54.274472 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:00:54.275141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:00:54.276646 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:00:54.278232 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:00:54.278844 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m01:00:54.279495 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:00:54.280217 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:00:54.280951 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:00:54.281791 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:00:54.292975 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:00:54.294514 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:00:54.295144 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:00:54.304320 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:54.304800 [debug] [MainThread]: On master: BEGIN
[0m01:00:54.305171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:54.371162 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m01:00:54.371687 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:54.372183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:54.385461 [debug] [MainThread]: SQL status: SELECT 25 in 0.013 seconds
[0m01:00:54.388693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2347a64d-fd1a-4c12-9082-8917c525aa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E825AA7380>]}
[0m01:00:54.389246 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:54.389868 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:54.390286 [debug] [MainThread]: On master: BEGIN
[0m01:00:54.391153 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:00:54.391555 [debug] [MainThread]: On master: COMMIT
[0m01:00:54.391941 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:54.392279 [debug] [MainThread]: On master: COMMIT
[0m01:00:54.392769 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:54.393146 [debug] [MainThread]: On master: Close
[0m01:00:54.399129 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:00:54.399746 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:00:54.400279 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:00:54.401241 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:00:54.400787 [info ] [Thread-1 (]: 1 of 27 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m01:00:54.401726 [info ] [Thread-4 (]: 4 of 27 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m01:00:54.403867 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m01:00:54.402336 [info ] [Thread-2 (]: 2 of 27 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m01:00:54.404674 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m01:00:54.405216 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:00:54.403092 [info ] [Thread-3 (]: 3 of 27 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m01:00:54.405966 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m01:00:54.406447 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:00:54.430826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:00:54.432476 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m01:00:54.433233 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:00:54.439904 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:00:54.440799 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:00:54.445511 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:00:54.456361 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:00:54.459056 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:00:54.480289 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:00:54.485345 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:00:54.492219 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:00:54.493239 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:00:54.494161 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:00:54.497918 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:00:54.502126 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:00:54.503798 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:00:54.504696 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m01:00:54.505910 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:00:54.506907 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:00:54.508088 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m01:00:54.508858 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:54.509740 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:00:54.512208 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m01:00:54.511073 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:00:54.513038 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:00:54.513920 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m01:00:54.515248 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:00:54.591262 [debug] [Thread-4 (]: SQL status: BEGIN in 0.085 seconds
[0m01:00:54.591845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m01:00:54.592323 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:00:54.592847 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:00:54.593517 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.594175 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.601309 [debug] [Thread-3 (]: SQL status: BEGIN in 0.086 seconds
[0m01:00:54.601955 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:00:54.602664 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.604224 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:00:54.609355 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m01:00:54.609905 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m01:00:54.611580 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m01:00:54.612052 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m01:00:54.612641 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m01:00:54.613398 [info ] [Thread-4 (]: 4 of 27 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.21s]
[0m01:00:54.616286 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:00:54.614809 [info ] [Thread-3 (]: 3 of 27 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.18s]
[0m01:00:54.617466 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:00:54.618689 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:00:54.620307 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:00:54.619600 [info ] [Thread-4 (]: 5 of 27 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m01:00:54.622205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m01:00:54.621420 [info ] [Thread-3 (]: 6 of 27 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m01:00:54.623006 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:00:54.623690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m01:00:54.629887 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:00:54.630975 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:00:54.639398 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:00:54.640934 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m01:00:54.644279 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m01:00:54.645574 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m01:00:54.646660 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:00:54.647464 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:00:54.656735 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:00:54.649169 [info ] [Thread-1 (]: 1 of 27 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.25s]
[0m01:00:54.661545 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:00:54.663225 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:00:54.664505 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:00:54.667515 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:00:54.671022 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m01:00:54.671859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:54.673228 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:00:54.665607 [info ] [Thread-1 (]: 7 of 27 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m01:00:54.675417 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m01:00:54.676584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m01:00:54.677521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:54.678585 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:00:54.687663 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:00:54.689771 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:00:54.695158 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:00:54.697508 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:00:54.698467 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m01:00:54.699554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:54.755647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.243 seconds
[0m01:00:54.756600 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:00:54.757417 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.762158 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:00:54.764844 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m01:00:54.766083 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m01:00:54.767971 [info ] [Thread-2 (]: 2 of 27 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.36s]
[0m01:00:54.771293 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:00:54.772286 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:00:54.773294 [info ] [Thread-2 (]: 8 of 27 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m01:00:54.774659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m01:00:54.775507 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:00:54.783735 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:00:54.785882 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:00:54.791544 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:00:54.795020 [debug] [Thread-3 (]: SQL status: BEGIN in 0.123 seconds
[0m01:00:54.796047 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:00:54.796959 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.801259 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:00:54.802376 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:00:54.803569 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m01:00:54.808340 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m01:00:54.809594 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:54.810882 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m01:00:54.812684 [info ] [Thread-3 (]: 6 of 27 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.19s]
[0m01:00:54.816799 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:00:54.818998 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:00:54.820210 [info ] [Thread-3 (]: 9 of 27 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m01:00:54.822675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m01:00:54.823617 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:00:54.832284 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:00:54.834816 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:00:54.841181 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:00:54.844113 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:00:54.845433 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m01:00:54.846282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m01:00:54.846790 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:54.847448 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:00:54.848015 [debug] [Thread-4 (]: SQL status: BEGIN in 0.171 seconds
[0m01:00:54.849553 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.850735 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:00:54.852476 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.856305 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:00:54.859493 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m01:00:54.860700 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m01:00:54.864843 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:00:54.862240 [info ] [Thread-4 (]: 5 of 27 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.24s]
[0m01:00:54.868403 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m01:00:54.869703 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:00:54.870782 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:00:54.871384 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m01:00:54.871999 [info ] [Thread-4 (]: 10 of 27 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m01:00:54.874372 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m01:00:54.873364 [info ] [Thread-1 (]: 7 of 27 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.20s]
[0m01:00:54.875705 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:00:54.877288 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:00:54.886092 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:00:54.887033 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:00:54.887930 [info ] [Thread-1 (]: 11 of 27 START test not_null_int_customers_customer_name ....................... [RUN]
[0m01:00:54.889002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57)
[0m01:00:54.890048 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:00:54.896541 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:00:54.902712 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:00:54.909696 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:00:54.911177 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:00:54.914784 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:00:54.916861 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:00:54.918596 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m01:00:54.920721 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m01:00:54.922066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:54.923439 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:00:54.925947 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:00:54.926959 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.928225 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: BEGIN
[0m01:00:54.929661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:54.940171 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:00:54.943405 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m01:00:54.944709 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m01:00:54.946376 [info ] [Thread-2 (]: 8 of 27 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.17s]
[0m01:00:54.949234 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:00:54.950286 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:00:54.951375 [info ] [Thread-2 (]: 12 of 27 START test not_null_int_customers_customer_nk ......................... [RUN]
[0m01:00:54.953061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1)
[0m01:00:54.954046 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:00:54.963110 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:00:54.965202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.118 seconds
[0m01:00:54.966281 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:00:54.967889 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:54.969600 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:00:54.975419 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:00:54.978205 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:00:54.979178 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m01:00:54.980074 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: BEGIN
[0m01:00:54.983893 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m01:00:54.984915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:54.986276 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m01:00:54.987987 [info ] [Thread-3 (]: 9 of 27 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.17s]
[0m01:00:54.995305 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:00:54.996392 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:00:54.997378 [info ] [Thread-3 (]: 13 of 27 START test not_null_int_customers_source_system ....................... [RUN]
[0m01:00:54.998659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7)
[0m01:00:54.999723 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:00:55.008431 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:00:55.010841 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:00:55.017848 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:00:55.021565 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:00:55.022745 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: BEGIN
[0m01:00:55.023611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:55.050339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m01:00:55.051557 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:00:55.052619 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.063932 [debug] [Thread-4 (]: SQL status: BEGIN in 0.142 seconds
[0m01:00:55.064738 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:00:55.065885 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.076856 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m01:00:55.080164 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m01:00:55.081455 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m01:00:55.083237 [info ] [Thread-4 (]: 10 of 27 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.21s]
[0m01:00:55.086873 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:00:55.087956 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:00:55.090033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.105 seconds
[0m01:00:55.090967 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:00:55.091842 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.089050 [info ] [Thread-4 (]: 14 of 27 START test not_null_stg_metabase_people_customer_nk ................... [RUN]
[0m01:00:55.096204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53)
[0m01:00:55.097309 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:00:55.107308 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:00:55.110116 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:00:55.116377 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:00:55.120018 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:00:55.121246 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: BEGIN
[0m01:00:55.122209 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:55.140610 [debug] [Thread-3 (]: SQL status: BEGIN in 0.117 seconds
[0m01:00:55.141585 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:00:55.142549 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_system
from "dw_northwind_metabase"."dw_stg"."int_customers"
where source_system is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.158947 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m01:00:55.162268 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: ROLLBACK
[0m01:00:55.163487 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: Close
[0m01:00:55.165323 [info ] [Thread-3 (]: 13 of 27 PASS not_null_int_customers_source_system ............................. [[32mPASS[0m in 0.17s]
[0m01:00:55.167312 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:00:55.168455 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:00:55.169619 [info ] [Thread-3 (]: 15 of 27 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:00:55.171026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m01:00:55.171965 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:00:55.192206 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:00:55.195066 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:00:55.200789 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:00:55.204408 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:00:55.205851 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m01:00:55.206846 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:55.248158 [debug] [Thread-4 (]: SQL status: BEGIN in 0.126 seconds
[0m01:00:55.249134 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:00:55.250086 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.324846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.118 seconds
[0m01:00:55.325792 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:00:55.326797 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.348660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.295 seconds
[0m01:00:55.351819 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: ROLLBACK
[0m01:00:55.353275 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: Close
[0m01:00:55.354801 [info ] [Thread-1 (]: 11 of 27 PASS not_null_int_customers_customer_name ............................. [[32mPASS[0m in 0.47s]
[0m01:00:55.357303 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:00:55.358356 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:00:55.360143 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.032 seconds
[0m01:00:55.363386 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m01:00:55.364746 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m01:00:55.359304 [info ] [Thread-1 (]: 16 of 27 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:00:55.366280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m01:00:55.368728 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:00:55.382387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:00:55.367609 [info ] [Thread-3 (]: 15 of 27 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.20s]
[0m01:00:55.384778 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:00:55.386067 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:00:55.390266 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:00:55.395204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:00:55.387958 [info ] [Thread-3 (]: 17 of 27 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:00:55.397920 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m01:00:55.399558 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:00:55.411038 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:00:55.411989 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:00:55.412715 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.162 seconds
[0m01:00:55.413597 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m01:00:55.416689 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: ROLLBACK
[0m01:00:55.418156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:55.419943 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: Close
[0m01:00:55.421850 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:00:55.428774 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:00:55.433436 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:00:55.435077 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m01:00:55.436210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:55.430216 [info ] [Thread-4 (]: 14 of 27 PASS not_null_stg_metabase_people_customer_nk ......................... [[32mPASS[0m in 0.33s]
[0m01:00:55.439942 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:00:55.441044 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:00:55.443757 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.351 seconds
[0m01:00:55.447038 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: ROLLBACK
[0m01:00:55.448911 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: Close
[0m01:00:55.442142 [info ] [Thread-4 (]: 18 of 27 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m01:00:55.456762 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m01:00:55.457845 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:00:55.451794 [info ] [Thread-2 (]: 12 of 27 PASS not_null_int_customers_customer_nk ............................... [[32mPASS[0m in 0.50s]
[0m01:00:55.472118 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:00:55.473778 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:00:55.475257 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:00:55.478114 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:00:55.495291 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:00:55.476427 [info ] [Thread-2 (]: 19 of 27 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m01:00:55.496699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m01:00:55.497715 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:00:55.512277 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:00:55.513857 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:00:55.514928 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m01:00:55.516127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:55.517915 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:00:55.527203 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:00:55.529855 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:00:55.530889 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m01:00:55.532252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:55.586835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m01:00:55.587801 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:00:55.588721 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.598329 [debug] [Thread-3 (]: SQL status: BEGIN in 0.162 seconds
[0m01:00:55.599476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m01:00:55.600419 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:00:55.603565 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m01:00:55.604815 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.606138 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m01:00:55.607785 [info ] [Thread-1 (]: 16 of 27 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.24s]
[0m01:00:55.612555 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:00:55.613543 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:00:55.614495 [info ] [Thread-1 (]: 20 of 27 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:00:55.617556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m01:00:55.618510 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:00:55.631232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:00:55.634351 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:00:55.641001 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:00:55.642917 [debug] [Thread-4 (]: SQL status: BEGIN in 0.127 seconds
[0m01:00:55.644018 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:00:55.645138 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.646835 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:00:55.648024 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m01:00:55.649077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:55.652075 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:00:55.656227 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m01:00:55.658479 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m01:00:55.659503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.128 seconds
[0m01:00:55.660584 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:00:55.663019 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.661980 [info ] [Thread-4 (]: 18 of 27 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.21s]
[0m01:00:55.664958 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:00:55.666171 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:00:55.667348 [info ] [Thread-4 (]: 21 of 27 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m01:00:55.674182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m01:00:55.684321 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:00:55.697322 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:00:55.698174 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.034 seconds
[0m01:00:55.702000 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m01:00:55.703845 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m01:00:55.705831 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:00:55.712579 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:00:55.707354 [info ] [Thread-2 (]: 19 of 27 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.21s]
[0m01:00:55.714390 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:00:55.715533 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:00:55.719193 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:00:55.720708 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m01:00:55.722571 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:55.716909 [info ] [Thread-2 (]: 22 of 27 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m01:00:55.724543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m01:00:55.725653 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:00:55.741204 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:00:55.742258 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.136 seconds
[0m01:00:55.745710 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m01:00:55.747174 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m01:00:55.751606 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:00:55.760274 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:00:55.749353 [info ] [Thread-3 (]: 17 of 27 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.35s]
[0m01:00:55.762211 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:00:55.763207 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:00:55.767271 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:00:55.768424 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m01:00:55.769443 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:55.774744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.126 seconds
[0m01:00:55.775874 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:00:55.764222 [info ] [Thread-3 (]: 23 of 27 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m01:00:55.777297 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.778630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m01:00:55.779949 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:00:55.791036 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:00:55.793421 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:00:55.798295 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:00:55.801577 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:00:55.803521 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m01:00:55.804643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:55.807893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.028 seconds
[0m01:00:55.812352 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m01:00:55.813756 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m01:00:55.815374 [info ] [Thread-1 (]: 20 of 27 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.20s]
[0m01:00:55.821183 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:00:55.822133 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:00:55.823212 [info ] [Thread-1 (]: 24 of 27 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m01:00:55.829418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m01:00:55.830494 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:00:55.840849 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:00:55.843207 [debug] [Thread-4 (]: SQL status: BEGIN in 0.121 seconds
[0m01:00:55.844369 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:00:55.845576 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:00:55.847017 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:00:55.852627 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:00:55.860600 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:00:55.861521 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m01:00:55.862308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:55.872519 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m01:00:55.875833 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m01:00:55.877426 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m01:00:55.879548 [info ] [Thread-4 (]: 21 of 27 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.21s]
[0m01:00:55.888256 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:00:55.889223 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:00:55.890257 [info ] [Thread-4 (]: 25 of 27 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m01:00:55.898171 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m01:00:55.899364 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:00:55.910372 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:00:55.912567 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:00:55.918118 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:00:55.921951 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:00:55.923410 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m01:00:55.924430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:55.950469 [debug] [Thread-2 (]: SQL status: BEGIN in 0.181 seconds
[0m01:00:55.951528 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:00:55.952606 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:55.969017 [debug] [Thread-3 (]: SQL status: BEGIN in 0.164 seconds
[0m01:00:55.970111 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:00:55.971031 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:55.976001 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:00:55.979295 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m01:00:55.980579 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m01:00:55.982426 [info ] [Thread-3 (]: 23 of 27 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.20s]
[0m01:00:55.986789 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:00:55.987892 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:00:55.989017 [info ] [Thread-3 (]: 26 of 27 START test unique_int_customers_customer_nk ........................... [RUN]
[0m01:00:55.990564 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e, now test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd)
[0m01:00:55.991598 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:00:56.000124 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:00:56.003416 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:00:56.010860 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:00:56.013075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m01:00:56.014226 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:00:56.015478 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:56.016925 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.063 seconds
[0m01:00:56.020595 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m01:00:56.022360 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:00:56.023526 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: BEGIN
[0m01:00:56.024582 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:56.025463 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m01:00:56.027198 [info ] [Thread-2 (]: 22 of 27 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.30s]
[0m01:00:56.029696 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:00:56.030752 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:00:56.031739 [info ] [Thread-2 (]: 27 of 27 START test unique_stg_metabase_people_customer_nk ..................... [RUN]
[0m01:00:56.037331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m01:00:56.039554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd, now test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460)
[0m01:00:56.043153 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m01:00:56.044252 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:00:56.054814 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:00:56.056914 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m01:00:56.059668 [debug] [Thread-4 (]: SQL status: BEGIN in 0.135 seconds
[0m01:00:56.058771 [info ] [Thread-1 (]: 24 of 27 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.23s]
[0m01:00:56.061287 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:00:56.062807 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:00:56.063856 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:56.064826 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:00:56.070245 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:00:56.071656 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:00:56.076816 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m01:00:56.078206 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m01:00:56.081198 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:00:56.082356 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: BEGIN
[0m01:00:56.083473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:56.079903 [info ] [Thread-4 (]: 25 of 27 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.18s]
[0m01:00:56.085687 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:00:56.131135 [debug] [Thread-3 (]: SQL status: BEGIN in 0.107 seconds
[0m01:00:56.132300 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:00:56.133506 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:56.274825 [debug] [Thread-2 (]: SQL status: BEGIN in 0.191 seconds
[0m01:00:56.275985 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:00:56.277057 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:00:56.418395 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.284 seconds
[0m01:00:56.421580 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: ROLLBACK
[0m01:00:56.423050 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: Close
[0m01:00:56.423962 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.146 seconds
[0m01:00:56.427699 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: ROLLBACK
[0m01:00:56.424966 [info ] [Thread-3 (]: 26 of 27 PASS unique_int_customers_customer_nk ................................. [[32mPASS[0m in 0.43s]
[0m01:00:56.429649 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:00:56.430682 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: Close
[0m01:00:56.432742 [info ] [Thread-2 (]: 27 of 27 PASS unique_stg_metabase_people_customer_nk ........................... [[32mPASS[0m in 0.39s]
[0m01:00:56.436924 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:00:56.440135 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:56.441093 [debug] [MainThread]: On master: BEGIN
[0m01:00:56.441751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:56.522165 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m01:00:56.522716 [debug] [MainThread]: On master: COMMIT
[0m01:00:56.523159 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:56.523557 [debug] [MainThread]: On master: COMMIT
[0m01:00:56.524210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:56.524737 [debug] [MainThread]: On master: Close
[0m01:00:56.525433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:56.525858 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m01:00:56.526290 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:00:56.526694 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:00:56.527127 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:00:56.527628 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m01:00:56.528198 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m01:00:56.528592 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460' was properly closed.
[0m01:00:56.528980 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd' was properly closed.
[0m01:00:56.529459 [info ] [MainThread]: 
[0m01:00:56.530137 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m01:00:56.536544 [debug] [MainThread]: Command end result
[0m01:00:56.612482 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:00:56.616711 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:00:56.628352 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:00:56.628930 [info ] [MainThread]: 
[0m01:00:56.629799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:56.630492 [info ] [MainThread]: 
[0m01:00:56.631076 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=27
[0m01:00:56.632752 [debug] [MainThread]: Command `dbt test` succeeded at 01:00:56.632580 after 4.51 seconds
[0m01:00:56.633226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E823FE2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8259CDB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8259CD700>]}
[0m01:00:56.633748 [debug] [MainThread]: Flushing usage events
[0m01:00:57.668048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:13.550218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736BBB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736D458910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736DA9BED0>]}


============================== 01:02:13.558147 | 8413a55d-a44e-4b7e-86dd-09e51c1181b2 ==============================
[0m01:02:13.558147 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:02:13.558930 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select stg_metabase_people stg_metabase_orders', 'printer_width': '80', 'write_json': 'True'}
[0m01:02:13.830983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736BDE9F30>]}
[0m01:02:13.909213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736DB2BDF0>]}
[0m01:02:13.911756 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:14.535933 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:02:14.808513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:14.808906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:14.883590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736DE23350>]}
[0m01:02:15.022501 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:15.026419 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:15.158301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027368558F50>]}
[0m01:02:15.159222 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:02:15.159976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736DCDD9B0>]}
[0m01:02:15.164289 [info ] [MainThread]: 
[0m01:02:15.165192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:15.165828 [info ] [MainThread]: 
[0m01:02:15.166627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:15.176871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:02:15.397509 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:02:15.397990 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:02:15.398342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:15.521138 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.123 seconds
[0m01:02:15.522687 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:02:15.528535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:02:15.535767 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:15.536333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m01:02:15.536715 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:02:15.538972 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:15.539602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:02:15.539980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:15.540633 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:02:15.541117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m01:02:15.543114 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:15.543760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:15.546307 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:15.546981 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:02:15.547801 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:02:15.548418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:15.549049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:15.636373 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m01:02:15.636992 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m01:02:15.637472 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:15.638229 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:15.638949 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:02:15.639443 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m01:02:15.640004 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:02:15.640586 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m01:02:15.641137 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:15.641891 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:15.642616 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:02:15.643395 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:02:15.653064 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:02:15.653850 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.012 seconds
[0m01:02:15.655974 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:02:15.656750 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:02:15.658882 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:02:15.659432 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m01:02:15.661070 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:02:15.661647 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:02:15.663988 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:02:15.664939 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:02:15.666016 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:02:15.666707 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:02:15.667506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_snapshots)
[0m01:02:15.668117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:02:15.672437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_sales)
[0m01:02:15.676094 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:15.677257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_stg)
[0m01:02:15.680708 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:15.683651 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:15.684334 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:02:15.687748 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:15.688575 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:02:15.689252 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:02:15.689939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:15.690555 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:02:15.690996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:15.691395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:15.692023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:15.773796 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m01:02:15.774605 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:15.775336 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:02:15.782365 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m01:02:15.783098 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:15.783852 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:02:15.786893 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:02:15.788905 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:02:15.789730 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:02:15.790353 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m01:02:15.791116 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:15.792044 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:02:15.792741 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m01:02:15.793505 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:15.794257 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:02:15.794901 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:02:15.797245 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:02:15.798498 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:02:15.803570 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:02:15.805504 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:02:15.806025 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m01:02:15.807874 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:02:15.808417 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:02:15.809532 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:02:15.824031 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:15.824493 [debug] [MainThread]: On master: BEGIN
[0m01:02:15.824861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:15.887678 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m01:02:15.888310 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:15.888768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:15.939385 [debug] [MainThread]: SQL status: SELECT 25 in 0.050 seconds
[0m01:02:15.943709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736E4AD300>]}
[0m01:02:15.944700 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:15.946165 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:15.947425 [debug] [MainThread]: On master: BEGIN
[0m01:02:15.948711 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:02:15.949460 [debug] [MainThread]: On master: COMMIT
[0m01:02:15.950170 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:15.950823 [debug] [MainThread]: On master: COMMIT
[0m01:02:15.951776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:15.952328 [debug] [MainThread]: On master: Close
[0m01:02:15.961161 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m01:02:15.961780 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_people
[0m01:02:15.962730 [info ] [Thread-1 (]: 1 of 2 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m01:02:15.965655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m01:02:15.964196 [info ] [Thread-2 (]: 2 of 2 START sql view model dw_stg.stg_metabase_people ......................... [RUN]
[0m01:02:15.966385 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m01:02:15.968312 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_people'
[0m01:02:15.975791 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_people
[0m01:02:15.988072 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:15.991814 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:15.993562 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m01:02:16.038188 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_people
[0m01:02:16.060648 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.061302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.063119 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.064454 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: BEGIN
[0m01:02:16.065200 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:02:16.065836 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.066531 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m01:02:16.066995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:16.137077 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m01:02:16.137811 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.138533 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp"
    
    
  as (
    

-- Registros da tabela people (usados pelos pedidos B2C que n√£o mapeiam para accounts).
select
    'METABASE'                               as source_system,
    p.id                                     as source_customer_id,
    'METABASE_PERSON_' || p.id               as customer_nk,
    p.name                                   as customer_name,
    null::varchar                            as contact_name,
    null::varchar                            as contact_title,
    split_part(p.name, ' ', 1)               as first_name,
    nullif(split_part(p.name, ' ', 2), '')   as last_name,
    p.address                                as address,
    p.city                                   as city,
    p.state                                  as region,
    null::varchar                            as country,
    p.zip::varchar                           as postal_code,
    null::varchar                            as plan,
    p.source                                 as segment,
    null::int                                as seats,
    null::boolean                            as trial_converted,
    null::boolean                            as active_subscription,
    null::boolean                            as legacy_plan,
    null::timestamp                          as created_at,
    null::timestamp                          as trial_ends_at,
    null::timestamp                          as canceled_at,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."people" p
  );
[0m01:02:16.144344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m01:02:16.144976 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.146143 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

with account_name_map as (
    select
        lower(concat_ws(' ', first_name, last_name)) as full_name_key,
        min(id)                                      as account_id
    from "dw_northwind_metabase"."public"."accounts"
    where first_name is not null and last_name is not null
    group by 1
),
people_name_map as (
    select
        lower(name) as full_name_key,
        min(id)     as person_id
    from "dw_northwind_metabase"."public"."people"
    where name is not null
    group by 1
),
product_map as (
    select
        lower(title) as title_key,
        min(id)      as product_id
    from "dw_northwind_metabase"."public"."products"
    group by 1
)
-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    case
        when acc_map.account_id is not null then 'METABASE_' || acc_map.account_id::varchar
        when people_map.person_id is not null then 'METABASE_PERSON_' || people_map.person_id::varchar
        else 'METABASE_ORPHAN_' || upper(trim(o.user_id))
    end                                       as customer_nk,
    case
        when prod_map.product_id is not null then 'METABASE_' || prod_map.product_id::varchar
        else 'METABASE_' || upper(trim(o.product_id))
    end                                       as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
left join account_name_map acc_map
       on lower(o.user_id) = acc_map.full_name_key
left join people_name_map people_map
       on acc_map.account_id is null
      and lower(o.user_id) = people_map.full_name_key
left join product_map prod_map
       on lower(o.product_id) = prod_map.title_key
  );
[0m01:02:16.189578 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m01:02:16.190310 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m01:02:16.199106 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.203677 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.204327 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people" rename to "stg_metabase_people__dbt_backup"
[0m01:02:16.204914 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m01:02:16.206835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:16.207381 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:02:16.213228 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.218614 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.219436 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m01:02:16.220161 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_tmp" rename to "stg_metabase_people"
[0m01:02:16.221963 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:16.222705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:02:16.272878 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m01:02:16.273915 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.274664 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m01:02:16.275323 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m01:02:16.276063 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.276945 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: COMMIT
[0m01:02:16.278536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:02:16.291209 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m01:02:16.291895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m01:02:16.300282 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:02:16.308112 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup"
[0m01:02:16.308975 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m01:02:16.310489 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_people"
[0m01:02:16.311440 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_people"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_people__dbt_backup" cascade
[0m01:02:16.315455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:02:16.316384 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:02:16.320971 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m01:02:16.323004 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_people: Close
[0m01:02:16.332724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736E374050>]}
[0m01:02:16.333328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8413a55d-a44e-4b7e-86dd-09e51c1181b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736E5819C0>]}
[0m01:02:16.334158 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.36s]
[0m01:02:16.336730 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m01:02:16.335265 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dw_stg.stg_metabase_people .................... [[32mCREATE VIEW[0m in 0.36s]
[0m01:02:16.337833 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_people
[0m01:02:16.339925 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:16.340573 [debug] [MainThread]: On master: BEGIN
[0m01:02:16.341111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:16.423003 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m01:02:16.423544 [debug] [MainThread]: On master: COMMIT
[0m01:02:16.423932 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:16.424282 [debug] [MainThread]: On master: COMMIT
[0m01:02:16.424823 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:16.425233 [debug] [MainThread]: On master: Close
[0m01:02:16.425843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:16.426207 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:02:16.426604 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:02:16.427234 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m01:02:16.427716 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m01:02:16.428140 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m01:02:16.428537 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m01:02:16.428862 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_people' was properly closed.
[0m01:02:16.429408 [info ] [MainThread]: 
[0m01:02:16.430229 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m01:02:16.432229 [debug] [MainThread]: Command end result
[0m01:02:16.490729 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:16.494919 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:16.507409 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:02:16.508187 [info ] [MainThread]: 
[0m01:02:16.509147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:16.509875 [info ] [MainThread]: 
[0m01:02:16.510402 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:02:16.511838 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:16.511687 after 3.14 seconds
[0m01:02:16.512315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736BD72210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736E5BF4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736DC740D0>]}
[0m01:02:16.512943 [debug] [MainThread]: Flushing usage events
[0m01:02:17.731923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:21.031721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263357C0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026337158910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002633779BED0>]}


============================== 01:02:21.036757 | ba578712-6470-4e85-b5ad-1054aa60ec51 ==============================
[0m01:02:21.036757 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:02:21.037500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select int_customers', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:02:21.272982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263359F9F30>]}
[0m01:02:21.346943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026337823DF0>]}
[0m01:02:21.348364 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:21.890851 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:02:22.129635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:22.130076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:22.204704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026337B23350>]}
[0m01:02:22.337696 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:22.341555 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:22.460344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026332208F50>]}
[0m01:02:22.461444 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:02:22.462414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263379DD9B0>]}
[0m01:02:22.467704 [info ] [MainThread]: 
[0m01:02:22.468588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:22.469315 [info ] [MainThread]: 
[0m01:02:22.470496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:22.472101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:02:22.616996 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:02:22.617466 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:02:22.617799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:22.682388 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.065 seconds
[0m01:02:22.684811 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:02:22.693091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:02:22.701252 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:22.701694 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:02:22.702001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:22.702625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m01:02:22.705599 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:22.706458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:02:22.707026 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:02:22.709774 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:22.710488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_saas'
[0m01:02:22.711048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:22.711744 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:02:22.716031 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:22.717135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:22.717785 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:02:22.718576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:22.768999 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m01:02:22.769683 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:22.770290 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:02:22.779978 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:02:22.781693 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:02:22.782420 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:02:22.783470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_stg)
[0m01:02:22.784268 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m01:02:22.786652 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:22.787092 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m01:02:22.787509 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:22.787917 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:02:22.788415 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:22.789039 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m01:02:22.789572 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:02:22.790101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:22.790630 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:02:22.791189 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:22.792575 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:02:22.801134 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:02:22.801871 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:02:22.803818 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:02:22.804469 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.012 seconds
[0m01:02:22.805809 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:02:22.807361 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:02:22.807805 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:02:22.808439 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:02:22.808824 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:02:22.809426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_snapshots)
[0m01:02:22.810220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_saas, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:02:22.811229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m01:02:22.816624 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:22.819074 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:22.820994 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:22.821434 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:02:22.821816 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:02:22.822174 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:02:22.822514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:22.822859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:22.823201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:22.851085 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m01:02:22.851578 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:22.851970 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:02:22.861081 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.009 seconds
[0m01:02:22.862653 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:02:22.863206 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:02:22.890930 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m01:02:22.891383 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:22.891815 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:02:22.893784 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m01:02:22.894216 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:22.894562 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:02:22.897139 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m01:02:22.897557 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:22.897904 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:02:22.899824 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m01:02:22.901447 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:02:22.902177 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:02:22.902951 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m01:02:22.904594 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:02:22.905188 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:02:22.907024 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:02:22.908489 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:02:22.909047 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:02:22.915537 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:22.916002 [debug] [MainThread]: On master: BEGIN
[0m01:02:22.916307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:22.963456 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m01:02:22.963885 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:22.964305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:22.975662 [debug] [MainThread]: SQL status: SELECT 22 in 0.011 seconds
[0m01:02:22.977440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263381AD980>]}
[0m01:02:22.977966 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:22.978563 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:22.978909 [debug] [MainThread]: On master: BEGIN
[0m01:02:22.979652 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:02:22.979999 [debug] [MainThread]: On master: COMMIT
[0m01:02:22.980329 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:22.980658 [debug] [MainThread]: On master: COMMIT
[0m01:02:22.981194 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:22.981581 [debug] [MainThread]: On master: Close
[0m01:02:22.988315 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m01:02:22.988980 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m01:02:22.989884 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m01:02:22.990338 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m01:02:22.999882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m01:02:23.001252 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m01:02:23.045607 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m01:02:23.047180 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:02:23.047816 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m01:02:23.048315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:23.104131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m01:02:23.104579 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:02:23.105055 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
    dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
),
metabase_people as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        first_name,
        last_name,
        address,
        city,
        region,
        country,
        postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
)
select * from northwind
union all
select * from metabase
union all
select * from metabase_people
  );
[0m01:02:23.119116 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m01:02:23.125295 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:02:23.125763 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m01:02:23.127472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:23.143708 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m01:02:23.144235 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:02:23.144710 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m01:02:23.148396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:02:23.155733 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m01:02:23.161946 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m01:02:23.162451 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m01:02:23.163489 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:02:23.166231 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m01:02:23.169185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba578712-6470-4e85-b5ad-1054aa60ec51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263383F0290>]}
[0m01:02:23.170043 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m01:02:23.171002 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m01:02:23.172470 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:23.172830 [debug] [MainThread]: On master: BEGIN
[0m01:02:23.173126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:23.226875 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m01:02:23.227361 [debug] [MainThread]: On master: COMMIT
[0m01:02:23.227715 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:23.228044 [debug] [MainThread]: On master: COMMIT
[0m01:02:23.228591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:23.228960 [debug] [MainThread]: On master: Close
[0m01:02:23.229533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:23.229867 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:02:23.230241 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m01:02:23.230539 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m01:02:23.230840 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m01:02:23.231171 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:02:23.231497 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m01:02:23.231888 [info ] [MainThread]: 
[0m01:02:23.232540 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m01:02:23.233869 [debug] [MainThread]: Command end result
[0m01:02:23.287088 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:23.291833 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:23.301201 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:02:23.302910 [info ] [MainThread]: 
[0m01:02:23.304601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:23.305422 [info ] [MainThread]: 
[0m01:02:23.306095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:02:23.308362 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:23.307946 after 2.40 seconds
[0m01:02:23.309514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026337F3BB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026332531810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026337E7CD70>]}
[0m01:02:23.310184 [debug] [MainThread]: Flushing usage events
[0m01:02:24.294854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:27.466099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675EDB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026760658910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026760C9BED0>]}


============================== 01:02:27.471906 | 929d77e2-f043-4420-bfed-09843c984cf8 ==============================
[0m01:02:27.471906 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:02:27.473161 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m01:02:27.696909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675EFE9F30>]}
[0m01:02:27.766888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026760D1FDF0>]}
[0m01:02:27.768374 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:28.182598 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:02:28.389331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:28.389721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:28.458014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002676102B350>]}
[0m01:02:28.605809 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:28.613875 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:28.755511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675B7E8F50>]}
[0m01:02:28.756757 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:02:28.757701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026760EE99B0>]}
[0m01:02:28.761034 [info ] [MainThread]: 
[0m01:02:28.761711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:28.762223 [info ] [MainThread]: 
[0m01:02:28.763044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:28.764561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:02:28.939805 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:02:28.940313 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:02:28.940710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:29.025860 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.085 seconds
[0m01:02:29.027706 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:02:29.039371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:02:29.047003 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:29.047737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:02:29.048309 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:02:29.051658 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:29.053220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m01:02:29.053816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:29.054652 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:02:29.055214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m01:02:29.057128 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:29.058167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:29.060745 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:29.061317 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:02:29.062250 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:02:29.063931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:29.068717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:29.148947 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m01:02:29.149566 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:29.150107 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:02:29.153267 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m01:02:29.154281 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m01:02:29.155025 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:29.155771 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:29.156521 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:02:29.157146 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:02:29.160957 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m01:02:29.161541 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:29.162092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:02:29.162529 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:02:29.163992 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:02:29.164897 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:02:29.165780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_stg)
[0m01:02:29.169437 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:29.170191 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:02:29.170906 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:02:29.171503 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.014 seconds
[0m01:02:29.173187 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:02:29.173646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:29.175182 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:02:29.175644 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m01:02:29.176230 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:02:29.177699 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:02:29.178167 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:02:29.179165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dm_sales)
[0m01:02:29.179728 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:02:29.180462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:02:29.187096 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:29.191279 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:29.192065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:02:29.192548 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:02:29.193380 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:02:29.195280 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:29.195708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:29.196098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:29.196538 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:02:29.197296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:29.247153 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m01:02:29.247625 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:29.248168 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:02:29.259796 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m01:02:29.262671 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:02:29.264000 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:02:29.276868 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m01:02:29.277418 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:29.277846 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:02:29.279326 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m01:02:29.279794 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:29.280191 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:02:29.283915 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m01:02:29.284653 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:29.285270 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:02:29.287308 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:02:29.288691 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:02:29.289168 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m01:02:29.290662 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:02:29.291087 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:02:29.291879 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:02:29.295190 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:02:29.297020 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:02:29.297713 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:02:29.308963 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:29.309644 [debug] [MainThread]: On master: BEGIN
[0m01:02:29.310161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:29.369632 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m01:02:29.370141 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:29.370617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:29.385214 [debug] [MainThread]: SQL status: SELECT 25 in 0.014 seconds
[0m01:02:29.389383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267616CE000>]}
[0m01:02:29.389981 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:29.390605 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:29.391049 [debug] [MainThread]: On master: BEGIN
[0m01:02:29.391746 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:02:29.392134 [debug] [MainThread]: On master: COMMIT
[0m01:02:29.392570 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:29.393042 [debug] [MainThread]: On master: COMMIT
[0m01:02:29.393749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:29.394153 [debug] [MainThread]: On master: Close
[0m01:02:29.400487 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:02:29.402037 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m01:02:29.404543 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m01:02:29.405113 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:02:29.415324 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:02:29.504188 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.504794 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select customer_name, city, country, plan, segment, trial_converted, active_subscription, legacy_plan from (
                



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m01:02:29.505219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:29.572206 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.067 seconds
[0m01:02:29.588276 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.588803 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m01:02:29.589940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m01:02:29.590526 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.591079 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:02:29.616962 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.025 seconds
[0m01:02:29.626298 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.626847 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:02:29.632582 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.005 seconds
[0m01:02:29.697052 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.697896 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp010229684550"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m01:02:29.969512 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.271 seconds
[0m01:02:29.972259 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.972710 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp010229684550'
        
      order by ordinal_position

  
[0m01:02:29.977689 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.004 seconds
[0m01:02:29.981575 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.982123 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:02:29.988666 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.006 seconds
[0m01:02:29.994912 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:29.995822 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp010229684550'
        
      order by ordinal_position

  
[0m01:02:30.002357 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.006 seconds
[0m01:02:30.007131 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.007719 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_northwind_metabase".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m01:02:30.013177 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.005 seconds
[0m01:02:30.022585 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.023151 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp010229684550'
        
      order by ordinal_position

  
[0m01:02:30.027753 [debug] [Thread-1 (]: SQL status: SELECT 29 in 0.004 seconds
[0m01:02:30.051472 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.052884 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "dw_northwind_metabase"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."customer_name" != source_data."customer_name"
        or
        (
            ((snapshotted_data."customer_name" is null) and not (source_data."customer_name" is null))
            or
            ((not snapshotted_data."customer_name" is null) and (source_data."customer_name" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."plan" != source_data."plan"
        or
        (
            ((snapshotted_data."plan" is null) and not (source_data."plan" is null))
            or
            ((not snapshotted_data."plan" is null) and (source_data."plan" is null))
        ) or snapshotted_data."segment" != source_data."segment"
        or
        (
            ((snapshotted_data."segment" is null) and not (source_data."segment" is null))
            or
            ((not snapshotted_data."segment" is null) and (source_data."segment" is null))
        ) or snapshotted_data."trial_converted" != source_data."trial_converted"
        or
        (
            ((snapshotted_data."trial_converted" is null) and not (source_data."trial_converted" is null))
            or
            ((not snapshotted_data."trial_converted" is null) and (source_data."trial_converted" is null))
        ) or snapshotted_data."active_subscription" != source_data."active_subscription"
        or
        (
            ((snapshotted_data."active_subscription" is null) and not (source_data."active_subscription" is null))
            or
            ((not snapshotted_data."active_subscription" is null) and (source_data."active_subscription" is null))
        ) or snapshotted_data."legacy_plan" != source_data."legacy_plan"
        or
        (
            ((snapshotted_data."legacy_plan" is null) and not (source_data."legacy_plan" is null))
            or
            ((not snapshotted_data."legacy_plan" is null) and (source_data."legacy_plan" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m01:02:30.056609 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m01:02:30.062844 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.063374 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m01:02:30.064195 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m01:02:30.064853 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.066514 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.067178 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      update "dw_northwind_metabase"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp010229684550" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dw_northwind_metabase"."snapshots"."customers_snapshot".dbt_valid_to is null;
      


    insert into "dw_northwind_metabase"."snapshots"."customers_snapshot" ("customer_nk", "source_system", "source_customer_id", "customer_name", "contact_name", "contact_title", "first_name", "last_name", "address", "city", "region", "country", "postal_code", "plan", "segment", "seats", "trial_converted", "active_subscription", "legacy_plan", "created_at", "trial_ends_at", "canceled_at", "dw_load_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_nk",DBT_INTERNAL_SOURCE."source_system",DBT_INTERNAL_SOURCE."source_customer_id",DBT_INTERNAL_SOURCE."customer_name",DBT_INTERNAL_SOURCE."contact_name",DBT_INTERNAL_SOURCE."contact_title",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."region",DBT_INTERNAL_SOURCE."country",DBT_INTERNAL_SOURCE."postal_code",DBT_INTERNAL_SOURCE."plan",DBT_INTERNAL_SOURCE."segment",DBT_INTERNAL_SOURCE."seats",DBT_INTERNAL_SOURCE."trial_converted",DBT_INTERNAL_SOURCE."active_subscription",DBT_INTERNAL_SOURCE."legacy_plan",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."trial_ends_at",DBT_INTERNAL_SOURCE."canceled_at",DBT_INTERNAL_SOURCE."dw_load_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp010229684550" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m01:02:30.073546 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m01:02:30.095116 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m01:02:30.095642 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m01:02:30.096012 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m01:02:30.100451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:02:30.107075 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m01:02:30.110481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929d77e2-f043-4420-bfed-09843c984cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267618F4950>]}
[0m01:02:30.112101 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mINSERT 0 0[0m in 0.70s]
[0m01:02:30.113457 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:02:30.116255 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:30.116897 [debug] [MainThread]: On master: BEGIN
[0m01:02:30.117393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:30.183443 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m01:02:30.183927 [debug] [MainThread]: On master: COMMIT
[0m01:02:30.184288 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:30.184892 [debug] [MainThread]: On master: COMMIT
[0m01:02:30.185809 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:30.186549 [debug] [MainThread]: On master: Close
[0m01:02:30.187555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:30.188232 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:02:30.188769 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m01:02:30.189260 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:02:30.189853 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m01:02:30.190262 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:02:30.190606 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m01:02:30.190974 [info ] [MainThread]: 
[0m01:02:30.191605 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m01:02:30.192803 [debug] [MainThread]: Command end result
[0m01:02:30.257497 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:30.261869 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:30.271735 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:02:30.272857 [info ] [MainThread]: 
[0m01:02:30.273744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:30.274468 [info ] [MainThread]: 
[0m01:02:30.275317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:02:30.277188 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:02:30.276929 after 2.93 seconds
[0m01:02:30.277780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267617A3AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267619C5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267619C5770>]}
[0m01:02:30.278323 [debug] [MainThread]: Flushing usage events
[0m01:02:31.505757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:35.407646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993330590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993BD8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299529BED0>]}


============================== 01:02:35.412921 | 8ff79ed6-8976-4e9f-92d1-67505a05b4ff ==============================
[0m01:02:35.412921 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:02:35.414071 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run --select dim_customer fact_sales', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m01:02:35.647396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993569F30>]}
[0m01:02:35.719510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022995323DF0>]}
[0m01:02:35.721011 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:36.234829 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:02:36.471920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:36.472573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:36.545166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022995623350>]}
[0m01:02:36.680953 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:36.684690 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:36.808689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298FD78F50>]}
[0m01:02:36.809549 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:02:36.810471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229954DD9B0>]}
[0m01:02:36.815152 [info ] [MainThread]: 
[0m01:02:36.815969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:36.816744 [info ] [MainThread]: 
[0m01:02:36.818218 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:36.824623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:02:36.968616 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:02:36.969067 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:02:36.969431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:37.027509 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.058 seconds
[0m01:02:37.028918 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:02:37.033791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:02:37.041002 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:37.041657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m01:02:37.042272 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:02:37.042767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:02:37.045191 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:37.045817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:02:37.046187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:37.048229 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:37.049084 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:02:37.051290 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:37.052567 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:02:37.053429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:37.054356 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:02:37.055207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:37.056538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:37.134636 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m01:02:37.135397 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:37.136074 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:02:37.138057 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m01:02:37.142246 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:37.143092 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:02:37.148612 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m01:02:37.149350 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m01:02:37.149906 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:37.150385 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:37.151091 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:02:37.151745 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:02:37.152369 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:02:37.154837 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:02:37.155402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m01:02:37.158063 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:02:37.158610 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:02:37.159447 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:02:37.160605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:02:37.162069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:02:37.166060 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:37.167146 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.014 seconds
[0m01:02:37.167563 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m01:02:37.169965 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:37.170695 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:02:37.172638 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:02:37.174078 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:02:37.174519 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:02:37.174981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:37.175508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:37.175906 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:02:37.176328 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:02:37.177227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:02:37.178045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_stg)
[0m01:02:37.183744 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:37.186550 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:37.187316 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:02:37.188041 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:02:37.188874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:37.189626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:37.254551 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m01:02:37.255437 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:37.256332 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:02:37.258225 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m01:02:37.258992 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:37.259689 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:02:37.268141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:02:37.270070 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:02:37.270813 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:02:37.271624 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m01:02:37.274381 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:02:37.275166 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:02:37.275892 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:37.276635 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:02:37.277522 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:02:37.282387 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m01:02:37.283393 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:37.284166 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:02:37.293978 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m01:02:37.295614 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:02:37.296214 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m01:02:37.296637 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:02:37.298327 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:02:37.299136 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:02:37.315273 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:37.315950 [debug] [MainThread]: On master: BEGIN
[0m01:02:37.316422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:37.387647 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m01:02:37.388428 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:37.389685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:37.404347 [debug] [MainThread]: SQL status: SELECT 25 in 0.014 seconds
[0m01:02:37.409207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022995CA94A0>]}
[0m01:02:37.409864 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:37.410582 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:37.411132 [debug] [MainThread]: On master: BEGIN
[0m01:02:37.412178 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:02:37.412688 [debug] [MainThread]: On master: COMMIT
[0m01:02:37.413112 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:37.413471 [debug] [MainThread]: On master: COMMIT
[0m01:02:37.414201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:37.414870 [debug] [MainThread]: On master: Close
[0m01:02:37.425419 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m01:02:37.426423 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m01:02:37.427573 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m01:02:37.430442 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m01:02:37.428843 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m01:02:37.431480 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m01:02:37.432709 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m01:02:37.444596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.445215 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m01:02:37.449691 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m01:02:37.451295 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m01:02:37.505249 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m01:02:37.538985 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.544365 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m01:02:37.546369 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.547359 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m01:02:37.548367 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:37.549529 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:02:37.550642 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m01:02:37.552037 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:02:37.634608 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m01:02:37.635303 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:02:37.635923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m01:02:37.636522 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        'CHANNEL_NORTHWIND'                  as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        'CHANNEL_METABASE'                   as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m01:02:37.637129 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.638200 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m01:02:37.756927 [debug] [Thread-1 (]: SQL status: SELECT 7586 in 0.118 seconds
[0m01:02:37.776518 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.777394 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m01:02:37.778695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:37.783106 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.783827 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m01:02:37.785038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:37.811605 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m01:02:37.812191 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.812858 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m01:02:37.822616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m01:02:37.831492 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m01:02:37.841486 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m01:02:37.842336 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m01:02:37.852413 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m01:02:37.856341 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m01:02:37.860809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022997008DD0>]}
[0m01:02:37.862145 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 7586[0m in 0.43s]
[0m01:02:37.863367 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m01:02:38.310760 [debug] [Thread-2 (]: SQL status: SELECT 20915 in 0.673 seconds
[0m01:02:38.314637 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:02:38.315128 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales" rename to "fact_sales__dbt_backup"
[0m01:02:38.316018 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:02:38.319125 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:02:38.319629 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m01:02:38.321327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:38.325325 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m01:02:38.326128 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:02:38.326834 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m01:02:38.343000 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m01:02:38.346320 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m01:02:38.347731 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m01:02:38.348354 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m01:02:38.356353 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m01:02:38.359661 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m01:02:38.361185 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff79ed6-8976-4e9f-92d1-67505a05b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022995D7DC80>]}
[0m01:02:38.362709 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 0.93s]
[0m01:02:38.364280 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m01:02:38.367792 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:38.369396 [debug] [MainThread]: On master: BEGIN
[0m01:02:38.370336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:38.440594 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m01:02:38.441071 [debug] [MainThread]: On master: COMMIT
[0m01:02:38.441427 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:38.441776 [debug] [MainThread]: On master: COMMIT
[0m01:02:38.442374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:38.442758 [debug] [MainThread]: On master: Close
[0m01:02:38.443336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:38.443678 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:02:38.444132 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:02:38.444456 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:02:38.444849 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:02:38.445367 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m01:02:38.445859 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m01:02:38.446337 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m01:02:38.446970 [info ] [MainThread]: 
[0m01:02:38.447757 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m01:02:38.448918 [debug] [MainThread]: Command end result
[0m01:02:38.521306 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:38.527268 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:38.535428 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:02:38.535968 [info ] [MainThread]: 
[0m01:02:38.536606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:38.537210 [info ] [MainThread]: 
[0m01:02:38.537915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:02:38.541190 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:38.540983 after 3.27 seconds
[0m01:02:38.541729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299700F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022995DBFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229954680D0>]}
[0m01:02:38.542182 [debug] [MainThread]: Flushing usage events
[0m01:02:39.532373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:43.643244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262676B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026267F58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002626959BED0>]}


============================== 01:02:43.648277 | 870ab1ff-4553-4314-ab6d-2538c1ca3745 ==============================
[0m01:02:43.648277 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:02:43.649313 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_metabase_people int_customers fact_sales fact_invoices fact_feedback fact_reviews fact_analytic_events', 'printer_width': '80', 'write_json': 'True'}
[0m01:02:43.904932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '870ab1ff-4553-4314-ab6d-2538c1ca3745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262678E9F30>]}
[0m01:02:44.039075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '870ab1ff-4553-4314-ab6d-2538c1ca3745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002626961FDF0>]}
[0m01:02:44.042127 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:44.649929 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:02:44.936033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:44.936472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:45.009247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '870ab1ff-4553-4314-ab6d-2538c1ca3745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002626991F350>]}
[0m01:02:45.178760 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:45.184038 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:45.345503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '870ab1ff-4553-4314-ab6d-2538c1ca3745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026269E226C0>]}
[0m01:02:45.346226 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:02:45.347068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870ab1ff-4553-4314-ab6d-2538c1ca3745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026269768D70>]}
[0m01:02:45.353502 [info ] [MainThread]: 
[0m01:02:45.354204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:45.355056 [info ] [MainThread]: 
[0m01:02:45.356338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:45.365940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:02:45.383949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:02:45.388236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:02:45.394424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2c'
[0m01:02:45.589017 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:45.589849 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:45.590585 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:45.591675 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:02:45.592706 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:45.594285 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:02:45.594919 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:02:45.595465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:45.595922 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:02:45.596384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:45.597023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:45.597816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:45.696345 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m01:02:45.696880 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m01:02:45.697394 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:02:45.698083 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:02:45.699024 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:02:45.699788 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m01:02:45.700391 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:02:45.701131 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:02:45.702012 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:02:45.710923 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m01:02:45.711836 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:02:45.712512 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.011 seconds
[0m01:02:45.713081 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:02:45.713686 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:02:45.715629 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:02:45.716145 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m01:02:45.717937 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:02:45.720185 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:02:45.720877 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:02:45.721602 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:02:45.722308 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:02:45.723160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:02:45.729291 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m01:02:45.730119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_snapshots)
[0m01:02:45.730828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2c, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:02:45.732975 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:45.734585 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:02:45.736499 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:45.739263 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:45.739760 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:02:45.740281 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:02:45.740853 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:02:45.741374 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:02:45.741827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:45.742245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:45.742735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:45.743498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dw)
[0m01:02:45.747324 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:45.747962 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:02:45.748392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:45.825515 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m01:02:45.826365 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:02:45.827333 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:02:45.839804 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m01:02:45.843294 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:02:45.844450 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m01:02:45.845338 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m01:02:45.846058 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:02:45.846535 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:02:45.847279 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:02:45.848163 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:02:45.849409 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:02:45.851161 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m01:02:45.851993 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:02:45.852621 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:02:45.862113 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m01:02:45.864082 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:02:45.864702 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m01:02:45.865477 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.012 seconds
[0m01:02:45.866017 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:02:45.867956 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:02:45.870353 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:02:45.871506 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:02:45.872201 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:02:45.886965 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.887466 [debug] [MainThread]: On master: BEGIN
[0m01:02:45.887828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:45.968963 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m01:02:45.969707 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.970514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:45.985490 [debug] [MainThread]: SQL status: SELECT 25 in 0.014 seconds
[0m01:02:45.988632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870ab1ff-4553-4314-ab6d-2538c1ca3745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002626A0E54A0>]}
[0m01:02:45.989200 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:45.989808 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.990194 [debug] [MainThread]: On master: BEGIN
[0m01:02:45.991291 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:02:45.992194 [debug] [MainThread]: On master: COMMIT
[0m01:02:45.993441 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.994227 [debug] [MainThread]: On master: COMMIT
[0m01:02:45.995198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:45.995861 [debug] [MainThread]: On master: Close
[0m01:02:46.004830 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:02:46.005465 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:02:46.005929 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:02:46.006396 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:02:46.006892 [info ] [Thread-1 (]: 1 of 27 START test not_null_fact_analytic_events_event_nk ...................... [RUN]
[0m01:02:46.007595 [info ] [Thread-3 (]: 3 of 27 START test not_null_fact_invoices_customer_nk .......................... [RUN]
[0m01:02:46.008633 [info ] [Thread-4 (]: 4 of 27 START test not_null_fact_invoices_invoice_nk ........................... [RUN]
[0m01:02:46.011119 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377'
[0m01:02:46.009742 [info ] [Thread-2 (]: 2 of 27 START test not_null_fact_feedback_feedback_nk .......................... [RUN]
[0m01:02:46.011960 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18'
[0m01:02:46.012567 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6'
[0m01:02:46.013087 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:02:46.013701 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901'
[0m01:02:46.014208 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:02:46.014702 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:02:46.054686 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:02:46.055484 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:02:46.062982 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:02:46.070541 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:02:46.081004 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:02:46.083152 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:02:46.110493 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:02:46.122941 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:02:46.123719 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:02:46.124538 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:02:46.134000 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:02:46.138063 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:02:46.142451 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:02:46.145347 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:02:46.146180 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: BEGIN
[0m01:02:46.146936 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:46.148322 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:02:46.149372 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:02:46.150191 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:02:46.151561 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: BEGIN
[0m01:02:46.153592 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: BEGIN
[0m01:02:46.158717 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: BEGIN
[0m01:02:46.159746 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:02:46.160667 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:02:46.161620 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:02:46.238019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m01:02:46.238756 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:02:46.239535 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_nk
from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.248999 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m01:02:46.249850 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:02:46.250757 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.263587 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m01:02:46.264594 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:02:46.265497 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select invoice_nk
from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.266471 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m01:02:46.267258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.106 seconds
[0m01:02:46.273798 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: ROLLBACK
[0m01:02:46.274529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m01:02:46.275103 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:02:46.275776 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:02:46.278168 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: ROLLBACK
[0m01:02:46.279124 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18: Close
[0m01:02:46.281448 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: ROLLBACK
[0m01:02:46.282391 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_nk
from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.283365 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377: Close
[0m01:02:46.284182 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6: Close
[0m01:02:46.285732 [info ] [Thread-3 (]: 3 of 27 PASS not_null_fact_invoices_customer_nk ................................ [[32mPASS[0m in 0.27s]
[0m01:02:46.287359 [info ] [Thread-1 (]: 1 of 27 PASS not_null_fact_analytic_events_event_nk ............................ [[32mPASS[0m in 0.28s]
[0m01:02:46.289387 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:02:46.290537 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:02:46.288277 [info ] [Thread-4 (]: 4 of 27 PASS not_null_fact_invoices_invoice_nk ................................. [[32mPASS[0m in 0.28s]
[0m01:02:46.291772 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:02:46.294233 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: ROLLBACK
[0m01:02:46.295221 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:02:46.296389 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:02:46.297256 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:02:46.298886 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901: Close
[0m01:02:46.299709 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:02:46.298230 [info ] [Thread-3 (]: 5 of 27 START test not_null_fact_reviews_product_nk ............................ [RUN]
[0m01:02:46.300888 [info ] [Thread-1 (]: 6 of 27 START test not_null_fact_reviews_review_nk ............................. [RUN]
[0m01:02:46.302566 [info ] [Thread-4 (]: 7 of 27 START test not_null_fact_sales_channel_nk .............................. [RUN]
[0m01:02:46.304413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m01:02:46.303531 [info ] [Thread-2 (]: 2 of 27 PASS not_null_fact_feedback_feedback_nk ................................ [[32mPASS[0m in 0.29s]
[0m01:02:46.305732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m01:02:46.306439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m01:02:46.307193 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:02:46.308695 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:02:46.309789 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:02:46.310925 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:02:46.319351 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:02:46.320204 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:02:46.328808 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:02:46.333466 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:02:46.334315 [info ] [Thread-2 (]: 8 of 27 START test not_null_fact_sales_customer_nk ............................. [RUN]
[0m01:02:46.335471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m01:02:46.336160 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:02:46.343479 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:02:46.344871 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:02:46.345804 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:02:46.347406 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:02:46.352450 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:02:46.355894 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:02:46.360337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:02:46.361253 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:02:46.365708 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:02:46.367062 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:02:46.367897 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: BEGIN
[0m01:02:46.368812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:46.369982 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:02:46.370705 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: BEGIN
[0m01:02:46.371802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:02:46.372860 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:02:46.374474 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: BEGIN
[0m01:02:46.375512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.377209 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:02:46.378968 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: BEGIN
[0m01:02:46.379947 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:02:46.457819 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m01:02:46.458986 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:02:46.460189 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.463830 [debug] [Thread-4 (]: SQL status: BEGIN in 0.092 seconds
[0m01:02:46.464709 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:02:46.465500 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where channel_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.466430 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:02:46.469459 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: ROLLBACK
[0m01:02:46.470247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m01:02:46.470882 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:02:46.471358 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404: Close
[0m01:02:46.471963 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_nk
from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.474907 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m01:02:46.475900 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:02:46.473513 [info ] [Thread-3 (]: 5 of 27 PASS not_null_fact_reviews_product_nk .................................. [[32mPASS[0m in 0.17s]
[0m01:02:46.477050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:02:46.477930 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.478870 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m01:02:46.479810 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:02:46.482448 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: ROLLBACK
[0m01:02:46.485151 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: ROLLBACK
[0m01:02:46.486109 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:02:46.487598 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c: Close
[0m01:02:46.487108 [info ] [Thread-3 (]: 9 of 27 START test not_null_fact_sales_order_nk ................................ [RUN]
[0m01:02:46.488543 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0: Close
[0m01:02:46.489430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m01:02:46.491705 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m01:02:46.490549 [info ] [Thread-1 (]: 6 of 27 PASS not_null_fact_reviews_review_nk ................................... [[32mPASS[0m in 0.18s]
[0m01:02:46.494157 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:02:46.493009 [info ] [Thread-4 (]: 7 of 27 PASS not_null_fact_sales_channel_nk .................................... [[32mPASS[0m in 0.19s]
[0m01:02:46.497408 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: ROLLBACK
[0m01:02:46.498439 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:02:46.503466 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:02:46.504442 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:02:46.505103 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:02:46.505605 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4: Close
[0m01:02:46.506340 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:02:46.506966 [info ] [Thread-1 (]: 10 of 27 START test not_null_fact_sales_product_nk ............................. [RUN]
[0m01:02:46.512412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m01:02:46.507806 [info ] [Thread-4 (]: 11 of 27 START test not_null_int_customers_customer_name ....................... [RUN]
[0m01:02:46.513760 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:02:46.514562 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:02:46.509258 [info ] [Thread-2 (]: 8 of 27 PASS not_null_fact_sales_customer_nk ................................... [[32mPASS[0m in 0.17s]
[0m01:02:46.515514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57)
[0m01:02:46.522613 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:02:46.528019 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:02:46.529313 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:02:46.530187 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:02:46.531712 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:02:46.538018 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:02:46.538704 [info ] [Thread-2 (]: 12 of 27 START test not_null_int_customers_customer_nk ......................... [RUN]
[0m01:02:46.539692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1)
[0m01:02:46.540421 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:02:46.543339 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:02:46.549852 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:02:46.550715 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:02:46.555685 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:02:46.556872 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: BEGIN
[0m01:02:46.558519 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:02:46.559760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:46.563455 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:02:46.565647 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:02:46.569728 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:02:46.570847 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:02:46.571652 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: BEGIN
[0m01:02:46.572707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.574252 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:02:46.575410 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: BEGIN
[0m01:02:46.576597 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:02:46.581423 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:02:46.582810 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: BEGIN
[0m01:02:46.583631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:02:46.649946 [debug] [Thread-3 (]: SQL status: BEGIN in 0.090 seconds
[0m01:02:46.650915 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:02:46.651687 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where order_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.660011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m01:02:46.661527 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:02:46.662396 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:02:46.665109 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: ROLLBACK
[0m01:02:46.665928 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_nk
from "dw_northwind_metabase"."dw_dw"."fact_sales"
where product_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.667156 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6: Close
[0m01:02:46.668474 [info ] [Thread-3 (]: 9 of 27 PASS not_null_fact_sales_order_nk ...................................... [[32mPASS[0m in 0.18s]
[0m01:02:46.670151 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:02:46.670907 [debug] [Thread-4 (]: SQL status: BEGIN in 0.094 seconds
[0m01:02:46.671712 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:02:46.672407 [debug] [Thread-2 (]: SQL status: BEGIN in 0.089 seconds
[0m01:02:46.673277 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:02:46.674726 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:02:46.674073 [info ] [Thread-3 (]: 13 of 27 START test not_null_int_customers_source_system ....................... [RUN]
[0m01:02:46.675637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:02:46.676453 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.677399 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.678305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7)
[0m01:02:46.680851 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: ROLLBACK
[0m01:02:46.682528 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:02:46.690140 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:02:46.691686 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f: Close
[0m01:02:46.694482 [info ] [Thread-1 (]: 10 of 27 PASS not_null_fact_sales_product_nk ................................... [[32mPASS[0m in 0.18s]
[0m01:02:46.696628 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:02:46.697798 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:02:46.698771 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:02:46.704957 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:02:46.699661 [info ] [Thread-1 (]: 14 of 27 START test not_null_stg_metabase_people_customer_nk ................... [RUN]
[0m01:02:46.706166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53)
[0m01:02:46.706882 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:02:46.717902 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:02:46.719301 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:02:46.720350 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: BEGIN
[0m01:02:46.721408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:46.722797 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:02:46.729191 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:02:46.732097 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:02:46.733303 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: BEGIN
[0m01:02:46.734508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.821308 [debug] [Thread-3 (]: SQL status: BEGIN in 0.100 seconds
[0m01:02:46.822188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m01:02:46.822880 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:02:46.823687 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:02:46.824705 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_system
from "dw_northwind_metabase"."dw_stg"."int_customers"
where source_system is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.825674 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_nk
from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.840820 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m01:02:46.843973 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: ROLLBACK
[0m01:02:46.845036 [debug] [Thread-3 (]: On test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7: Close
[0m01:02:46.846149 [info ] [Thread-3 (]: 13 of 27 PASS not_null_int_customers_source_system ............................. [[32mPASS[0m in 0.17s]
[0m01:02:46.847503 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:02:46.848468 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:02:46.849435 [info ] [Thread-3 (]: 15 of 27 START test relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:02:46.850512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m01:02:46.851190 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:02:46.870826 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:02:46.872909 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:02:46.877628 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:02:46.879341 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:02:46.880198 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: BEGIN
[0m01:02:46.881175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:46.914499 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.232 seconds
[0m01:02:46.917570 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: ROLLBACK
[0m01:02:46.918848 [debug] [Thread-4 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57: Close
[0m01:02:46.920332 [info ] [Thread-4 (]: 11 of 27 PASS not_null_int_customers_customer_name ............................. [[32mPASS[0m in 0.40s]
[0m01:02:46.922118 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:02:46.923080 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:02:46.924004 [info ] [Thread-4 (]: 16 of 27 START test relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:02:46.928865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m01:02:46.930112 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:02:46.941123 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:02:46.942983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.116 seconds
[0m01:02:46.946360 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: ROLLBACK
[0m01:02:46.948039 [debug] [Thread-1 (]: On test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53: Close
[0m01:02:46.949061 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:02:46.954637 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:02:46.957044 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.275 seconds
[0m01:02:46.956097 [info ] [Thread-1 (]: 14 of 27 PASS not_null_stg_metabase_people_customer_nk ......................... [[32mPASS[0m in 0.25s]
[0m01:02:46.960929 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: ROLLBACK
[0m01:02:46.962868 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:02:46.964871 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:02:46.966440 [debug] [Thread-2 (]: On test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1: Close
[0m01:02:46.965860 [info ] [Thread-1 (]: 17 of 27 START test relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:02:46.968039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m01:02:46.968869 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:02:46.969941 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:02:46.978870 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m01:02:46.984533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:02:46.971351 [info ] [Thread-2 (]: 12 of 27 PASS not_null_int_customers_customer_nk ............................... [[32mPASS[0m in 0.43s]
[0m01:02:46.985563 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: BEGIN
[0m01:02:46.986212 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:02:46.987534 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:02:46.988349 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:02:46.989150 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.990203 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:02:46.991646 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:02:47.000979 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:02:46.993417 [info ] [Thread-2 (]: 18 of 27 START test relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [RUN]
[0m01:02:47.002690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m01:02:47.003759 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:02:47.017799 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:02:47.019291 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:02:47.020258 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: BEGIN
[0m01:02:47.021095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:47.022786 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:02:47.030130 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:02:47.031221 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.039 seconds
[0m01:02:47.035249 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: ROLLBACK
[0m01:02:47.036633 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c: Close
[0m01:02:47.040022 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:02:47.041636 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: BEGIN
[0m01:02:47.043236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:02:47.038283 [info ] [Thread-3 (]: 15 of 27 PASS relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.19s]
[0m01:02:47.046713 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:02:47.047850 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:02:47.048806 [info ] [Thread-3 (]: 19 of 27 START test relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [RUN]
[0m01:02:47.050436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m01:02:47.051549 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:02:47.070078 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:02:47.072791 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:02:47.077689 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:02:47.080035 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:02:47.081687 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: BEGIN
[0m01:02:47.082743 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:47.092938 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m01:02:47.094034 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:02:47.094961 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_feedback"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:47.104683 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:02:47.107369 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: ROLLBACK
[0m01:02:47.108787 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407: Close
[0m01:02:47.110601 [info ] [Thread-4 (]: 16 of 27 PASS relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.18s]
[0m01:02:47.112569 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:02:47.113544 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:02:47.114418 [info ] [Thread-4 (]: 20 of 27 START test relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [RUN]
[0m01:02:47.115564 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m01:02:47.116393 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:02:47.129138 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:02:47.131088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.110 seconds
[0m01:02:47.131902 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:02:47.133003 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:02:47.134031 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_invoices"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:47.134992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.092 seconds
[0m01:02:47.138032 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:02:47.139000 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:02:47.140084 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_reviews"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:47.142155 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:02:47.143185 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: BEGIN
[0m01:02:47.144294 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:02:47.146379 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:02:47.149646 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: ROLLBACK
[0m01:02:47.150977 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1: Close
[0m01:02:47.152668 [info ] [Thread-2 (]: 18 of 27 PASS relationships_fact_reviews_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.15s]
[0m01:02:47.155866 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:02:47.157074 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:02:47.159027 [info ] [Thread-2 (]: 21 of 27 START test relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [RUN]
[0m01:02:47.161224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m01:02:47.162292 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:02:47.173360 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:02:47.176613 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m01:02:47.177724 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:02:47.179428 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where channel_nk is not null
),

parent as (
    select channel_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_channel"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:47.182476 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:02:47.190521 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:02:47.197963 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:02:47.199288 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: BEGIN
[0m01:02:47.200839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:02:47.201872 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m01:02:47.205562 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: ROLLBACK
[0m01:02:47.206677 [debug] [Thread-3 (]: On test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c: Close
[0m01:02:47.209042 [info ] [Thread-3 (]: 19 of 27 PASS relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_  [[32mPASS[0m in 0.16s]
[0m01:02:47.212906 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:02:47.214025 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:02:47.215050 [info ] [Thread-3 (]: 22 of 27 START test unique_fact_analytic_events_event_nk ....................... [RUN]
[0m01:02:47.216508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m01:02:47.217734 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:02:47.234908 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:02:47.237758 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:02:47.251704 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:02:47.252750 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.114 seconds
[0m01:02:47.255350 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: ROLLBACK
[0m01:02:47.256536 [debug] [Thread-1 (]: On test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376: Close
[0m01:02:47.257383 [debug] [Thread-4 (]: SQL status: BEGIN in 0.113 seconds
[0m01:02:47.258916 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:02:47.260085 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where customer_nk is not null
),

parent as (
    select customer_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:47.263885 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:02:47.266312 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: BEGIN
[0m01:02:47.268868 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:47.262075 [info ] [Thread-1 (]: 17 of 27 PASS relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.29s]
[0m01:02:47.270797 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:02:47.271744 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:02:47.272730 [info ] [Thread-1 (]: 23 of 27 START test unique_fact_feedback_feedback_nk ........................... [RUN]
[0m01:02:47.274002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m01:02:47.275978 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:02:47.284842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:02:47.287103 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:02:47.292684 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:02:47.294979 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:02:47.297285 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.036 seconds
[0m01:02:47.298500 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: BEGIN
[0m01:02:47.301659 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: ROLLBACK
[0m01:02:47.302519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:47.303923 [debug] [Thread-4 (]: On test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b: Close
[0m01:02:47.305771 [info ] [Thread-4 (]: 20 of 27 PASS relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_  [[32mPASS[0m in 0.19s]
[0m01:02:47.308899 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:02:47.310074 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:02:47.313253 [debug] [Thread-2 (]: SQL status: BEGIN in 0.112 seconds
[0m01:02:47.314330 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:02:47.315388 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_nk as from_field
    from "dw_northwind_metabase"."dw_dw"."fact_sales"
    where product_nk is not null
),

parent as (
    select product_nk as to_field
    from "dw_northwind_metabase"."dw_dw"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:02:47.311123 [info ] [Thread-4 (]: 24 of 27 START test unique_fact_invoices_invoice_nk ............................ [RUN]
[0m01:02:47.317415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m01:02:47.318528 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:02:47.328887 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:02:47.331652 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:02:47.336880 [debug] [Thread-4 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:02:47.337959 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m01:02:47.341061 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: ROLLBACK
[0m01:02:47.342880 [debug] [Thread-2 (]: On test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e: Close
[0m01:02:47.345797 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:02:47.346747 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: BEGIN
[0m01:02:47.347845 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:02:47.344508 [info ] [Thread-2 (]: 21 of 27 PASS relationships_fact_sales_product_nk__product_nk__ref_dim_product_  [[32mPASS[0m in 0.18s]
[0m01:02:47.350025 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:02:47.351101 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:02:47.352163 [info ] [Thread-2 (]: 25 of 27 START test unique_fact_reviews_review_nk .............................. [RUN]
[0m01:02:47.354602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m01:02:47.355813 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:02:47.365976 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:02:47.368289 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:02:47.379964 [debug] [Thread-2 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:02:47.382662 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:02:47.386876 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: BEGIN
[0m01:02:47.388022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:02:47.392210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.124 seconds
[0m01:02:47.393418 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:02:47.394503 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_analytic_events"
where event_nk is not null
group by event_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:47.422042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m01:02:47.422976 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:02:47.423849 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_feedback"
where feedback_nk is not null
group by feedback_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:47.429508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:02:47.432875 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: ROLLBACK
[0m01:02:47.434088 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e: Close
[0m01:02:47.435598 [info ] [Thread-1 (]: 23 of 27 PASS unique_fact_feedback_feedback_nk ................................. [[32mPASS[0m in 0.16s]
[0m01:02:47.438771 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:02:47.439819 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:02:47.440813 [info ] [Thread-1 (]: 26 of 27 START test unique_int_customers_customer_nk ........................... [RUN]
[0m01:02:47.443305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e, now test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd)
[0m01:02:47.444466 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:02:47.453398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:02:47.454786 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.059 seconds
[0m01:02:47.457095 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: ROLLBACK
[0m01:02:47.458328 [debug] [Thread-4 (]: SQL status: BEGIN in 0.110 seconds
[0m01:02:47.459494 [debug] [Thread-4 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:02:47.460566 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd: Close
[0m01:02:47.461714 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    invoice_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_invoices"
where invoice_nk is not null
group by invoice_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:47.465939 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:02:47.464919 [info ] [Thread-3 (]: 22 of 27 PASS unique_fact_analytic_events_event_nk ............................. [[32mPASS[0m in 0.25s]
[0m01:02:47.472141 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:02:47.473656 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:02:47.475349 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:02:47.478079 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:02:47.479268 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: BEGIN
[0m01:02:47.480267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:47.476542 [info ] [Thread-3 (]: 27 of 27 START test unique_stg_metabase_people_customer_nk ..................... [RUN]
[0m01:02:47.487280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd, now test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460)
[0m01:02:47.488272 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.025 seconds
[0m01:02:47.489071 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:02:47.492791 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: ROLLBACK
[0m01:02:47.503729 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:02:47.505059 [debug] [Thread-4 (]: On test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d: Close
[0m01:02:47.506152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m01:02:47.507415 [debug] [Thread-2 (]: Using postgres connection "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:02:47.511367 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_dw"."fact_reviews"
where review_nk is not null
group by review_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:47.515650 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:02:47.520865 [debug] [Thread-3 (]: Writing runtime sql for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:02:47.509602 [info ] [Thread-4 (]: 24 of 27 PASS unique_fact_invoices_invoice_nk .................................. [[32mPASS[0m in 0.19s]
[0m01:02:47.522672 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m01:02:47.524587 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:02:47.528927 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: ROLLBACK
[0m01:02:47.530491 [debug] [Thread-2 (]: On test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e: Close
[0m01:02:47.534515 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:02:47.532078 [info ] [Thread-2 (]: 25 of 27 PASS unique_fact_reviews_review_nk .................................... [[32mPASS[0m in 0.18s]
[0m01:02:47.536564 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: BEGIN
[0m01:02:47.537896 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:02:47.539045 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:02:47.581042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m01:02:47.581686 [debug] [Thread-1 (]: Using postgres connection "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:02:47.582197 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."int_customers"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:47.623589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.085 seconds
[0m01:02:47.624232 [debug] [Thread-3 (]: Using postgres connection "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:02:47.624983 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from "dw_northwind_metabase"."dw_stg"."stg_metabase_people"
where customer_nk is not null
group by customer_nk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:47.734837 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.109 seconds
[0m01:02:47.737574 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: ROLLBACK
[0m01:02:47.738689 [debug] [Thread-3 (]: On test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460: Close
[0m01:02:47.740122 [info ] [Thread-3 (]: 27 of 27 PASS unique_stg_metabase_people_customer_nk ........................... [[32mPASS[0m in 0.25s]
[0m01:02:47.741696 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:02:47.832776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.250 seconds
[0m01:02:47.834800 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: ROLLBACK
[0m01:02:47.835864 [debug] [Thread-1 (]: On test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd: Close
[0m01:02:47.837019 [info ] [Thread-1 (]: 26 of 27 PASS unique_int_customers_customer_nk ................................. [[32mPASS[0m in 0.39s]
[0m01:02:47.838458 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:02:47.841448 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:47.842588 [debug] [MainThread]: On master: BEGIN
[0m01:02:47.843466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:47.912292 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m01:02:47.913028 [debug] [MainThread]: On master: COMMIT
[0m01:02:47.913630 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:47.914213 [debug] [MainThread]: On master: COMMIT
[0m01:02:47.915010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:47.915603 [debug] [MainThread]: On master: Close
[0m01:02:47.916486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:47.917053 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m01:02:47.917431 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m01:02:47.917807 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:02:47.918190 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:02:47.918623 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd' was properly closed.
[0m01:02:47.919098 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460' was properly closed.
[0m01:02:47.919525 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d' was properly closed.
[0m01:02:47.919920 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e' was properly closed.
[0m01:02:47.920420 [info ] [MainThread]: 
[0m01:02:47.921245 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m01:02:47.929421 [debug] [MainThread]: Command end result
[0m01:02:48.023549 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:02:48.030352 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:02:48.046800 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:02:48.047442 [info ] [MainThread]: 
[0m01:02:48.048496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:48.049405 [info ] [MainThread]: 
[0m01:02:48.050406 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=27
[0m01:02:48.054326 [debug] [MainThread]: Command `dbt test` succeeded at 01:02:48.053797 after 4.56 seconds
[0m01:02:48.055216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262693E2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026269DCD910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026269DCF5F0>]}
[0m01:02:48.055918 [debug] [MainThread]: Flushing usage events
[0m01:02:49.248832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:54.851647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2DED00590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E0658910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E0C9BED0>]}


============================== 01:06:54.858723 | 1f30aab8-c704-49ed-a0ff-eeed4eb5cf21 ==============================
[0m01:06:54.858723 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:06:54.859792 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dm_*', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m01:06:55.152477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f30aab8-c704-49ed-a0ff-eeed4eb5cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2DEF39F30>]}
[0m01:06:55.223117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f30aab8-c704-49ed-a0ff-eeed4eb5cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E0D23DF0>]}
[0m01:06:55.225594 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:06:55.664366 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:06:55.994744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:55.995423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:56.101120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f30aab8-c704-49ed-a0ff-eeed4eb5cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E1023350>]}
[0m01:06:56.254692 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:06:56.264606 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:06:56.395915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f30aab8-c704-49ed-a0ff-eeed4eb5cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2DB748F50>]}
[0m01:06:56.396839 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:06:56.397620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f30aab8-c704-49ed-a0ff-eeed4eb5cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E0EE1A90>]}
[0m01:06:56.400289 [warn ] [MainThread]: The selection criterion 'dm_*' does not match any enabled nodes
[0m01:06:56.403316 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:06:56.409217 [debug] [MainThread]: Command end result
[0m01:06:56.473739 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:06:56.477718 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:06:56.483757 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:06:56.486525 [debug] [MainThread]: Command `dbt run` succeeded at 01:06:56.485793 after 1.77 seconds
[0m01:06:56.488662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E1594BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E0AE2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2E14B9FD0>]}
[0m01:06:56.490647 [debug] [MainThread]: Flushing usage events
[0m01:06:57.594089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:18.911077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ABFB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AC858910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ACE9BED0>]}


============================== 01:08:18.916130 | 386e61d3-9de6-4b19-811a-7c2daf961798 ==============================
[0m01:08:18.916130 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:08:18.917124 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'invocation_command': 'dbt run --select dm_sales dm_b2b dm_b2c dm_saas dm_product_analytics', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:08:19.147367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AC1E9F30>]}
[0m01:08:19.221165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ACF23DF0>]}
[0m01:08:19.222438 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:08:19.611292 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:08:19.810776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:08:19.811273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:08:19.880638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE21F350>]}
[0m01:08:20.009404 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:08:20.014249 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:08:20.121139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A8968F50>]}
[0m01:08:20.122008 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:08:20.122771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE0E19B0>]}
[0m01:08:20.128811 [info ] [MainThread]: 
[0m01:08:20.129542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:08:20.130128 [info ] [MainThread]: 
[0m01:08:20.131037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:08:20.143269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:08:20.156795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:08:20.174231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:08:20.176470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m01:08:20.399145 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:08:20.399603 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:08:20.399989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.403343 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:08:20.403956 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:08:20.404466 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:08:20.405045 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:08:20.405595 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:08:20.406087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.406683 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:08:20.407164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.407950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.527745 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.120 seconds
[0m01:08:20.528163 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.128 seconds
[0m01:08:20.528472 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.122 seconds
[0m01:08:20.528760 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.122 seconds
[0m01:08:20.529989 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:08:20.531103 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:08:20.532202 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:08:20.533309 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:08:20.536406 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m01:08:20.537757 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m01:08:20.538359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:20.592875 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.054 seconds
[0m01:08:20.594321 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m01:08:20.598305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_sales'
[0m01:08:20.604192 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:08:20.604747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m01:08:20.605078 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:08:20.607275 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:08:20.607784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m01:08:20.608095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.608610 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:08:20.609101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:08:20.610830 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:08:20.611394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.613489 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:08:20.613950 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:08:20.614491 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:08:20.614875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.615199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:20.678947 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m01:08:20.679728 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m01:08:20.680210 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:08:20.680681 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:08:20.681221 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:08:20.681731 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m01:08:20.682124 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:08:20.682622 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:08:20.683127 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:08:20.684452 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m01:08:20.684827 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:08:20.685163 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:08:20.759559 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.076 seconds
[0m01:08:20.763462 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:08:20.764397 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.081 seconds
[0m01:08:20.765220 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.083 seconds
[0m01:08:20.766070 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.080 seconds
[0m01:08:20.768754 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:08:20.769591 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:08:20.772318 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:08:20.774337 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:08:20.775695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_product_analytics)
[0m01:08:20.776458 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:08:20.777103 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:08:20.780463 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:08:20.781183 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:08:20.785320 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:08:20.786120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_sales, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:08:20.787207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dw, now list_dw_northwind_metabase_dw_dm_b2b)
[0m01:08:20.791823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:20.792647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:08:20.795762 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:08:20.798867 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:08:20.801682 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:08:20.802485 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:08:20.803346 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:08:20.804154 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:08:20.804956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:20.805494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:20.806088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:20.870241 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m01:08:20.870815 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:08:20.871207 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:08:20.874089 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m01:08:20.874525 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:08:20.874862 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:08:20.878789 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m01:08:20.879202 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m01:08:20.879540 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:08:20.879869 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m01:08:20.880222 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:08:20.880590 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:08:20.881752 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:08:20.882131 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:08:20.882452 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m01:08:20.883817 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:08:20.884219 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:08:20.884567 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:08:20.892131 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:08:20.892572 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m01:08:20.893651 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:08:20.894716 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:08:20.895197 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:08:20.895525 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:08:20.901983 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:20.902367 [debug] [MainThread]: On master: BEGIN
[0m01:08:20.902656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:20.949085 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m01:08:20.949495 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:20.949878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:08:20.964659 [debug] [MainThread]: SQL status: SELECT 25 in 0.014 seconds
[0m01:08:20.967702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE8C94A0>]}
[0m01:08:20.968194 [debug] [MainThread]: On master: ROLLBACK
[0m01:08:20.968778 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:20.969142 [debug] [MainThread]: On master: BEGIN
[0m01:08:20.969872 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:08:20.970251 [debug] [MainThread]: On master: COMMIT
[0m01:08:20.970589 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:20.970910 [debug] [MainThread]: On master: COMMIT
[0m01:08:20.971427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:20.971807 [debug] [MainThread]: On master: Close
[0m01:08:20.978871 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dm_product_analytics
[0m01:08:20.979374 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dm_saas
[0m01:08:20.979838 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.dm_sales
[0m01:08:20.980386 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_dm_product_analytics.dm_product_analytics ....... [RUN]
[0m01:08:20.981987 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_product_analytics'
[0m01:08:20.980828 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_dm_saas.dm_saas ................................. [RUN]
[0m01:08:20.982533 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dm_product_analytics
[0m01:08:20.981298 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_dm_sales.dm_sales ............................... [RUN]
[0m01:08:20.983268 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_saas'
[0m01:08:20.991667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:20.992331 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_sales'
[0m01:08:20.992811 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dm_saas
[0m01:08:20.993553 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.dm_sales
[0m01:08:20.998094 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.003728 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.006205 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dm_product_analytics
[0m01:08:21.054221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:21.055005 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.dm_sales
[0m01:08:21.059094 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.059626 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dm_saas
[0m01:08:21.066455 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.067480 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:21.068552 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: BEGIN
[0m01:08:21.069479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:08:21.071931 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.072933 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: BEGIN
[0m01:08:21.073646 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:08:21.074911 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.075999 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: BEGIN
[0m01:08:21.076747 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:08:21.137464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m01:08:21.138093 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:21.138651 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_product_analytics"} */

  create view "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_tmp"
    
    
  as (
    

-- Mart que combina eventos de uso, reviews e feedbacks para an√°lises 360¬∫ do produto.
with events as (
    select
        'ANALYTIC_EVENT'                              as record_type,
        fa.event_nk                                   as record_nk,
        fa.customer_nk,
        null::varchar                                 as product_nk,
        fa.event_name                                 as metric_name,
        1::numeric                                    as metric_value,
        fa.event_timestamp                            as metric_timestamp,
        fa.page_url                                   as context_info,
        dc.customer_name,
        dc.segment,
        null::varchar                                 as product_name
    from "dw_northwind_metabase"."dw_dw"."fact_analytic_events" fa
    left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
           on fa.customer_nk = dc.customer_nk
          and dc.current_flag
),
reviews as (
    select
        'REVIEW'                                      as record_type,
        fr.review_nk                                  as record_nk,
        null::varchar                                 as customer_nk,
        fr.product_nk,
        'rating_score'                                as metric_name,
        fr.rating_score                               as metric_value,
        fr.created_at                                 as metric_timestamp,
        fr.review_text                                as context_info,
        null::varchar                                 as customer_name,
        null::varchar                                 as segment,
        dp.product_name
    from "dw_northwind_metabase"."dw_dw"."fact_reviews" fr
    left join "dw_northwind_metabase"."dw_dw"."dim_product" dp
           on fr.product_nk = dp.product_nk
),
feedback as (
    select
        'FEEDBACK'                                    as record_type,
        ff.feedback_nk                                as record_nk,
        ff.customer_nk,
        null::varchar                                 as product_nk,
        'rating_score'                                as metric_name,
        ff.rating_score                               as metric_value,
        ff.date_received                              as metric_timestamp,
        ff.feedback_text                              as context_info,
        dc.customer_name,
        dc.segment,
        null::varchar                                 as product_name
    from "dw_northwind_metabase"."dw_dw"."fact_feedback" ff
    left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
           on ff.customer_nk = dc.customer_nk
          and dc.current_flag
)
select * from events
union all
select * from reviews
union all
select * from feedback
  );
[0m01:08:21.141688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.068 seconds
[0m01:08:21.142163 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.142562 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_sales"} */

  create view "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_tmp"
    
    
  as (
    

-- Data mart consolidado de vendas usando a fato unificada.
select
    fs.*,
    dc.customer_name,
    dp.product_name,
    dp.category_name,
    dp.vendor_name
from "dw_northwind_metabase"."dw_dw"."fact_sales" fs
left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
       on fs.customer_nk = dc.customer_nk
      and dc.current_flag
left join "dw_northwind_metabase"."dw_dw"."dim_product" dp
       on fs.product_nk = dp.product_nk
  );
[0m01:08:21.157096 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m01:08:21.157576 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m01:08:21.167528 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.171868 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:21.172408 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_sales"} */
alter table "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_tmp" rename to "dm_sales"
[0m01:08:21.172873 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_product_analytics"} */
alter table "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_tmp" rename to "dm_product_analytics"
[0m01:08:21.174595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:21.175015 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:08:21.194638 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: COMMIT
[0m01:08:21.196389 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: COMMIT
[0m01:08:21.196889 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:21.197322 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.197721 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: COMMIT
[0m01:08:21.198121 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: COMMIT
[0m01:08:21.240570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m01:08:21.253424 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_backup"
[0m01:08:21.254220 [debug] [Thread-3 (]: SQL status: COMMIT in 0.055 seconds
[0m01:08:21.261081 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_product_analytics"
[0m01:08:21.265653 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_backup"
[0m01:08:21.266501 [debug] [Thread-2 (]: SQL status: BEGIN in 0.190 seconds
[0m01:08:21.267258 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_product_analytics"} */
drop view if exists "dw_northwind_metabase"."dw_dm_product_analytics"."dm_product_analytics__dbt_backup" cascade
[0m01:08:21.268668 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.dm_sales"
[0m01:08:21.269624 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.270630 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_sales"} */
drop view if exists "dw_northwind_metabase"."dw_dm_sales"."dm_sales__dbt_backup" cascade
[0m01:08:21.271500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:08:21.272297 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_saas"} */

  create view "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_tmp"
    
    
  as (
    

-- Data mart para faturamento SaaS (Metabase invoices) com enriquecimento de cliente e calend√°rio.
with invoices as (
    select
        fi.invoice_nk,
        fi.customer_nk,
        fi.plan_name,
        fi.payment_amount,
        fi.expected_invoice_flag,
        fi.date_received::date as invoice_date,
        dc.customer_name,
        dc.segment,
        dc.plan,
        dd.year,
        dd.month,
        dd.month_name
    from "dw_northwind_metabase"."dw_dw"."fact_invoices" fi
    left join "dw_northwind_metabase"."dw_dw"."dim_customer" dc
           on fi.customer_nk = dc.customer_nk
          and dc.current_flag
    left join "dw_northwind_metabase"."dw_dw"."dim_date" dd
           on fi.date_received::date = dd.date_day
)
select *
from invoices
  );
[0m01:08:21.275535 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_product_analytics: Close
[0m01:08:21.276275 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:08:21.279033 [debug] [Thread-3 (]: On model.dw_northwind_metabase.dm_sales: Close
[0m01:08:21.287256 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m01:08:21.290353 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.290815 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_saas"} */
alter table "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_tmp" rename to "dm_saas"
[0m01:08:21.291451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE9E0950>]}
[0m01:08:21.292066 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:21.293588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE9FEDB0>]}
[0m01:08:21.293101 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_dm_product_analytics.dm_product_analytics .. [[32mCREATE VIEW[0m in 0.30s]
[0m01:08:21.295370 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: COMMIT
[0m01:08:21.296813 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dm_product_analytics
[0m01:08:21.296121 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_dm_sales.dm_sales .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:08:21.297418 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.298260 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.dm_sales
[0m01:08:21.298740 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: COMMIT
[0m01:08:21.299555 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.dm_b2b
[0m01:08:21.300046 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dm_b2c
[0m01:08:21.301024 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:21.300595 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_dm_b2b.dm_b2b ................................... [RUN]
[0m01:08:21.304918 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_backup"
[0m01:08:21.302136 [info ] [Thread-1 (]: 5 of 5 START sql view model dw_dm_b2c.dm_b2c ................................... [RUN]
[0m01:08:21.305800 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dm_b2b'
[0m01:08:21.307059 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.dm_saas"
[0m01:08:21.307754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dm_product_analytics, now model.dw_northwind_metabase.dm_b2c)
[0m01:08:21.308611 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.dm_b2b
[0m01:08:21.309230 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_saas"} */
drop view if exists "dw_northwind_metabase"."dw_dm_saas"."dm_saas__dbt_backup" cascade
[0m01:08:21.309848 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dm_b2c
[0m01:08:21.314916 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.318785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.319369 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:08:21.321159 [debug] [Thread-2 (]: On model.dw_northwind_metabase.dm_saas: Close
[0m01:08:21.322118 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ACEB2030>]}
[0m01:08:21.323454 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dw_dm_saas.dm_saas ............................ [[32mCREATE VIEW[0m in 0.34s]
[0m01:08:21.325385 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dm_saas
[0m01:08:21.326132 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.dm_b2b
[0m01:08:21.326764 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dm_b2c
[0m01:08:21.331461 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.335373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.338200 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.339357 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.341026 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: BEGIN
[0m01:08:21.342415 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: BEGIN
[0m01:08:21.343360 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:08:21.344246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:21.411902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m01:08:21.412695 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.413466 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2c"} */

  create view "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_tmp"
    
    
  as (
    

-- Data mart focado nas vendas Metabase (B2C/SaaS).
select *
from "dw_northwind_metabase"."dw_dm_sales"."dm_sales"
where source_system = 'METABASE'
  );
[0m01:08:21.419713 [debug] [Thread-4 (]: SQL status: BEGIN in 0.076 seconds
[0m01:08:21.420433 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.420941 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2b"} */

  create view "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_tmp"
    
    
  as (
    

-- Data mart focado no fluxo Northwind (B2B).
select *
from "dw_northwind_metabase"."dw_dm_sales"."dm_sales"
where source_system = 'NORTHWIND'
  );
[0m01:08:21.424691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m01:08:21.428691 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.429286 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m01:08:21.429797 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2c"} */
alter table "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_tmp" rename to "dm_b2c"
[0m01:08:21.433534 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.434255 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2b"} */
alter table "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_tmp" rename to "dm_b2b"
[0m01:08:21.434900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:21.436632 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: COMMIT
[0m01:08:21.437227 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:08:21.437663 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.439135 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: COMMIT
[0m01:08:21.439566 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: COMMIT
[0m01:08:21.439991 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.440470 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: COMMIT
[0m01:08:21.441439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:21.443665 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_backup"
[0m01:08:21.444104 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m01:08:21.444865 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2c"
[0m01:08:21.447272 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_backup"
[0m01:08:21.447765 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2c"} */
drop view if exists "dw_northwind_metabase"."dw_dm_b2c"."dm_b2c__dbt_backup" cascade
[0m01:08:21.448619 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.dm_b2b"
[0m01:08:21.449227 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dm_b2b"} */
drop view if exists "dw_northwind_metabase"."dw_dm_b2b"."dm_b2b__dbt_backup" cascade
[0m01:08:21.449850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:08:21.451621 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dm_b2c: Close
[0m01:08:21.452235 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:08:21.454565 [debug] [Thread-4 (]: On model.dw_northwind_metabase.dm_b2b: Close
[0m01:08:21.455379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE952450>]}
[0m01:08:21.457419 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386e61d3-9de6-4b19-811a-7c2daf961798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE7759B0>]}
[0m01:08:21.456475 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dw_dm_b2c.dm_b2c .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m01:08:21.459610 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dm_b2c
[0m01:08:21.458738 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_dm_b2b.dm_b2b .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m01:08:21.460568 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.dm_b2b
[0m01:08:21.462170 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:21.462578 [debug] [MainThread]: On master: BEGIN
[0m01:08:21.462891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:21.528477 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m01:08:21.529091 [debug] [MainThread]: On master: COMMIT
[0m01:08:21.529481 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:21.529812 [debug] [MainThread]: On master: COMMIT
[0m01:08:21.530334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:21.530726 [debug] [MainThread]: On master: Close
[0m01:08:21.531360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:21.531767 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:08:21.532322 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:08:21.532787 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:08:21.533296 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m01:08:21.533750 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:08:21.534153 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2b' was properly closed.
[0m01:08:21.534606 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:08:21.535348 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_product_analytics' was properly closed.
[0m01:08:21.535948 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_b2c' was properly closed.
[0m01:08:21.536617 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_saas' was properly closed.
[0m01:08:21.537349 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_sales' was properly closed.
[0m01:08:21.538018 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_b2b' was properly closed.
[0m01:08:21.538738 [info ] [MainThread]: 
[0m01:08:21.539461 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m01:08:21.541147 [debug] [MainThread]: Command end result
[0m01:08:21.606530 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:08:21.610668 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:08:21.617985 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:08:21.619022 [info ] [MainThread]: 
[0m01:08:21.619989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:21.620669 [info ] [MainThread]: 
[0m01:08:21.621267 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:08:21.622834 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:21.622659 after 2.84 seconds
[0m01:08:21.623343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE717B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE717DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AE7177D0>]}
[0m01:08:21.624006 [debug] [MainThread]: Flushing usage events
[0m01:08:22.985856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:09.753380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAF7B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1058910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB169BED0>]}


============================== 01:34:09.762138 | 7463e9a6-69c2-4c08-a274-bc02176fa49b ==============================
[0m01:34:09.762138 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:34:09.763358 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m01:34:10.007070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7463e9a6-69c2-4c08-a274-bc02176fa49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAF9E9F30>]}
[0m01:34:10.074474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7463e9a6-69c2-4c08-a274-bc02176fa49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB171FDF0>]}
[0m01:34:10.076764 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:34:10.484129 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:34:10.734682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:34:10.735393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:34:10.799646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7463e9a6-69c2-4c08-a274-bc02176fa49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1A27350>]}
[0m01:34:10.877663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7463e9a6-69c2-4c08-a274-bc02176fa49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1E42A80>]}
[0m01:34:10.879121 [info ] [MainThread]: Found 30 models, 74 data tests, 1 snapshot, 15 sources, 449 macros
[0m01:34:10.880160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7463e9a6-69c2-4c08-a274-bc02176fa49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1868130>]}
[0m01:34:10.886676 [info ] [MainThread]: 
[0m01:34:10.888290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:34:10.889753 [info ] [MainThread]: 
[0m01:34:10.891066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:34:10.899377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_b2b'
[0m01:34:10.900284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m01:34:10.917220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m01:34:10.923719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dm_product_analytics'
[0m01:34:11.148746 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:34:11.149248 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:34:11.149625 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:34:11.149970 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: BEGIN
[0m01:34:11.150303 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:34:11.150670 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m01:34:11.151006 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m01:34:11.151316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:11.151622 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: BEGIN
[0m01:34:11.151935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:11.152229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:11.153457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:11.252770 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m01:34:11.253205 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m01:34:11.253521 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m01:34:11.253825 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_product_analytics"
[0m01:34:11.254130 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m01:34:11.254509 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m01:34:11.254833 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m01:34:11.255193 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_product_analytics"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_product_analytics'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_product_analytics'
  
[0m01:34:11.255881 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2b"
[0m01:34:11.256506 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m01:34:11.256921 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m01:34:11.257399 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2b"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2b'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2b'
  
[0m01:34:11.270390 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m01:34:11.272303 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: ROLLBACK
[0m01:34:11.272777 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m01:34:11.273172 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.015 seconds
[0m01:34:11.273538 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m01:34:11.274789 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: ROLLBACK
[0m01:34:11.275130 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2b: Close
[0m01:34:11.276352 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m01:34:11.277433 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m01:34:11.278002 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_product_analytics: Close
[0m01:34:11.278377 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m01:34:11.278989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_b2b, now list_dw_northwind_metabase_dw_dw)
[0m01:34:11.279389 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m01:34:11.280118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_dm_product_analytics, now list_dw_northwind_metabase_dw_dm_b2c)
[0m01:34:11.282908 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:34:11.283533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_dw_stg, now list_dw_northwind_metabase_dw_dm_sales)
[0m01:34:11.286341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase_snapshots, now list_dw_northwind_metabase_dw_dm_saas)
[0m01:34:11.288239 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:34:11.288944 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m01:34:11.294020 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:34:11.295587 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:34:11.295975 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: BEGIN
[0m01:34:11.296329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:11.296661 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: BEGIN
[0m01:34:11.297000 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: BEGIN
[0m01:34:11.297308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:11.297739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:11.298061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:11.361023 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m01:34:11.361648 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m01:34:11.362213 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:34:11.367263 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m01:34:11.367758 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_sales"
[0m01:34:11.368154 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_sales"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_sales'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_sales'
  
[0m01:34:11.370244 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m01:34:11.370745 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_b2c"
[0m01:34:11.371184 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_b2c"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_b2c'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_b2c'
  
[0m01:34:11.371790 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m01:34:11.374009 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m01:34:11.374726 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m01:34:11.375167 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m01:34:11.375789 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dm_saas"
[0m01:34:11.377191 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dm_saas"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dm_saas'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dm_saas'
  
[0m01:34:11.380264 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m01:34:11.381801 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: ROLLBACK
[0m01:34:11.382380 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_sales: Close
[0m01:34:11.382809 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:34:11.384726 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: ROLLBACK
[0m01:34:11.385854 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_b2c: Close
[0m01:34:11.390509 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:34:11.391920 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: ROLLBACK
[0m01:34:11.392595 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dm_saas: Close
[0m01:34:11.400350 [debug] [MainThread]: Using postgres connection "master"
[0m01:34:11.400789 [debug] [MainThread]: On master: BEGIN
[0m01:34:11.401102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:34:11.467940 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m01:34:11.468603 [debug] [MainThread]: Using postgres connection "master"
[0m01:34:11.469053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:34:11.484875 [debug] [MainThread]: SQL status: SELECT 38 in 0.015 seconds
[0m01:34:11.489854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7463e9a6-69c2-4c08-a274-bc02176fa49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB204FE10>]}
[0m01:34:11.490331 [debug] [MainThread]: On master: ROLLBACK
[0m01:34:11.490849 [debug] [MainThread]: On master: Close
[0m01:34:11.563713 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m01:34:11.564334 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dim_date
[0m01:34:11.564898 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m01:34:11.565693 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_channel
[0m01:34:11.566893 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_analytic_events'
[0m01:34:11.568010 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_date'
[0m01:34:11.568863 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m01:34:11.569500 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_channel'
[0m01:34:11.570016 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m01:34:11.570514 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dim_date
[0m01:34:11.571014 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m01:34:11.572100 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_channel
[0m01:34:11.581800 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_analytic_events"
[0m01:34:11.585472 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_date"
[0m01:34:11.589307 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m01:34:11.592578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_channel"
[0m01:34:11.594932 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m01:34:11.595694 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dim_date
[0m01:34:11.597420 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_analytic_events
[0m01:34:11.599054 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dim_date
[0m01:34:11.599673 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m01:34:11.600591 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_feedback
[0m01:34:11.601416 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_channel
[0m01:34:11.602204 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_invoices
[0m01:34:11.603335 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m01:34:11.604094 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_analytic_events, now model.dw_northwind_metabase.stg_metabase_feedback)
[0m01:34:11.605050 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_channel
[0m01:34:11.605650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_date, now model.dw_northwind_metabase.stg_metabase_invoices)
[0m01:34:11.606509 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m01:34:11.607244 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_feedback
[0m01:34:11.607945 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_people
[0m01:34:11.608648 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_invoices
[0m01:34:11.609230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_accounts, now model.dw_northwind_metabase.stg_metabase_orders)
[0m01:34:11.614698 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_feedback"
[0m01:34:11.615562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_channel, now model.dw_northwind_metabase.stg_metabase_people)
[0m01:34:11.619775 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_invoices"
[0m01:34:11.620392 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m01:34:11.621042 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_people
[0m01:34:11.626863 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m01:34:11.630840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_people"
[0m01:34:11.632093 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_feedback
[0m01:34:11.633689 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_feedback
[0m01:34:11.634588 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_metabase_products
[0m01:34:11.635332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_feedback, now model.dw_northwind_metabase.stg_metabase_products)
[0m01:34:11.636026 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_products
[0m01:34:11.636569 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_invoices
[0m01:34:11.640744 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_products"
[0m01:34:11.641256 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m01:34:11.642336 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_invoices
[0m01:34:11.642801 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_people
[0m01:34:11.643784 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m01:34:11.644322 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_reviews
[0m01:34:11.645646 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_people
[0m01:34:11.646564 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m01:34:11.647273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_invoices, now model.dw_northwind_metabase.stg_metabase_reviews)
[0m01:34:11.647973 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_metabase_products
[0m01:34:11.648419 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_northwind_employees
[0m01:34:11.649008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_customers)
[0m01:34:11.649546 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_reviews
[0m01:34:11.650337 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_metabase_products
[0m01:34:11.650769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_people, now model.dw_northwind_metabase.stg_northwind_employees)
[0m01:34:11.651213 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m01:34:11.655394 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_reviews"
[0m01:34:11.655952 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m01:34:11.656467 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_employees
[0m01:34:11.659362 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m01:34:11.659926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_products, now model.dw_northwind_metabase.stg_northwind_order_details)
[0m01:34:11.663221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_employees"
[0m01:34:11.663998 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m01:34:11.664655 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_reviews
[0m01:34:11.668950 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m01:34:11.669943 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_reviews
[0m01:34:11.670816 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m01:34:11.671523 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_northwind_employees
[0m01:34:11.672085 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m01:34:11.672731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_reviews, now model.dw_northwind_metabase.stg_northwind_orders)
[0m01:34:11.674061 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_northwind_employees
[0m01:34:11.675132 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m01:34:11.675605 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m01:34:11.676083 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m01:34:11.676596 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_northwind_products
[0m01:34:11.677219 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.fact_analytic_events
[0m01:34:11.678131 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m01:34:11.681343 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m01:34:11.681857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_employees, now model.dw_northwind_metabase.stg_northwind_products)
[0m01:34:11.682363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.fact_analytic_events)
[0m01:34:11.682880 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m01:34:11.683652 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_products
[0m01:34:11.684153 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.fact_analytic_events
[0m01:34:11.684845 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e)
[0m01:34:11.689379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_products"
[0m01:34:11.692914 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_analytic_events"
[0m01:34:11.693526 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m01:34:11.694027 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m01:34:11.695152 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m01:34:11.720353 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e"
[0m01:34:11.721039 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m01:34:11.722128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_orders, now test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0)
[0m01:34:11.722977 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m01:34:11.724078 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_northwind_products
[0m01:34:11.724566 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.fact_analytic_events
[0m01:34:11.731246 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0"
[0m01:34:11.732145 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_northwind_products
[0m01:34:11.732914 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.fact_analytic_events
[0m01:34:11.733312 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m01:34:11.734002 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m01:34:11.734621 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m01:34:11.735611 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e
[0m01:34:11.736158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_products, now test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2)
[0m01:34:11.736737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_analytic_events, now test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994)
[0m01:34:11.737221 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m01:34:11.737643 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m01:34:11.738121 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m01:34:11.738642 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m01:34:11.739213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_analytic_events_event_nk.7a687d085e, now test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199)
[0m01:34:11.740279 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0
[0m01:34:11.743998 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2"
[0m01:34:11.748262 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994"
[0m01:34:11.748772 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m01:34:11.749310 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m01:34:11.753460 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199"
[0m01:34:11.753997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_analytic_events_event_nk.d542cafae0, now test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34)
[0m01:34:11.754604 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m01:34:11.760423 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34"
[0m01:34:11.761280 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m01:34:11.762148 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m01:34:11.763335 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994
[0m01:34:11.763834 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m01:34:11.764635 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2
[0m01:34:11.765204 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m01:34:11.766911 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199
[0m01:34:11.767448 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m01:34:11.767993 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m01:34:11.768607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_date_date_sk.de88650994, now test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711)
[0m01:34:11.769112 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m01:34:11.769975 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34
[0m01:34:11.770435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_date_date_day.e3f312efb2, now test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1)
[0m01:34:11.770901 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m01:34:11.771503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_date_date_day.d56fd19199, now test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac)
[0m01:34:11.772014 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m01:34:11.772524 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m01:34:11.777350 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711"
[0m01:34:11.777825 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m01:34:11.778315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_date_date_sk.22c3358c34, now test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114)
[0m01:34:11.782057 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1"
[0m01:34:11.786577 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac"
[0m01:34:11.787217 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m01:34:11.792252 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114"
[0m01:34:11.793123 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m01:34:11.794670 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711
[0m01:34:11.795523 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m01:34:11.796283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_accounts_customer_nk.6d1ca26711, now test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919)
[0m01:34:11.796961 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m01:34:11.802366 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m01:34:11.803533 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919"
[0m01:34:11.804242 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m01:34:11.804753 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m01:34:11.805693 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114
[0m01:34:11.806686 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac
[0m01:34:11.807543 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1
[0m01:34:11.808054 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m01:34:11.808618 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.fact_feedback
[0m01:34:11.809244 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m01:34:11.809816 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m01:34:11.810371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_channel_channel_sk.3d43ac4114, now test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8)
[0m01:34:11.811649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_channel_channel_nk.6b465000ac, now model.dw_northwind_metabase.fact_feedback)
[0m01:34:11.812160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_accounts_customer_nk.1586691aa1, now test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966)
[0m01:34:11.813009 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919
[0m01:34:11.813454 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m01:34:11.813898 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.fact_feedback
[0m01:34:11.814333 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m01:34:11.814829 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m01:34:11.818874 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8"
[0m01:34:11.822120 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_feedback"
[0m01:34:11.828512 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966"
[0m01:34:11.829115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_channel_channel_nk.7e74c06919, now test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a)
[0m01:34:11.830084 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m01:34:11.834794 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a"
[0m01:34:11.835836 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m01:34:11.836677 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.fact_feedback
[0m01:34:11.838271 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8
[0m01:34:11.839847 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.fact_feedback
[0m01:34:11.840726 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m01:34:11.841194 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m01:34:11.841701 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_invoices
[0m01:34:11.842256 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m01:34:11.843135 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a
[0m01:34:11.844027 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966
[0m01:34:11.844505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_channel_channel_sk.bcd9a370e8, now model.dw_northwind_metabase.fact_invoices)
[0m01:34:11.844960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_feedback, now test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e)
[0m01:34:11.845423 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m01:34:11.845891 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m01:34:11.846339 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_invoices
[0m01:34:11.846763 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m01:34:11.847192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_feedback_feedback_nk.5065fdf08a, now test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8)
[0m01:34:11.847627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_feedback_feedback_nk.1b1c8ed966, now test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e)
[0m01:34:11.850679 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_invoices"
[0m01:34:11.855495 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e"
[0m01:34:11.856087 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m01:34:11.856660 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m01:34:11.861490 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8"
[0m01:34:11.866688 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e"
[0m01:34:11.867837 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_invoices
[0m01:34:11.868549 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m01:34:11.870568 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_invoices
[0m01:34:11.872108 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e
[0m01:34:11.872736 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m01:34:11.873380 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m01:34:11.874257 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m01:34:11.875288 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8
[0m01:34:11.875718 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m01:34:11.876276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_invoices, now test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290)
[0m01:34:11.876766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_invoices_customer_nk.56f59e600e, now test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122)
[0m01:34:11.877292 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m01:34:11.878195 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e
[0m01:34:11.878635 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m01:34:11.879091 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m01:34:11.879568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_invoices_invoice_nk.a582059bd8, now test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2)
[0m01:34:11.880126 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:34:11.884870 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290"
[0m01:34:11.889034 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122"
[0m01:34:11.889591 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m01:34:11.890094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_invoices_invoice_nk.134a2c5a1e, now test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53)
[0m01:34:11.894856 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2"
[0m01:34:11.895467 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:34:11.900942 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53"
[0m01:34:11.902225 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m01:34:11.903992 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122
[0m01:34:11.904936 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:34:11.905916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_orders_order_nk.aefad11122, now test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460)
[0m01:34:11.906864 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m01:34:11.907737 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:34:11.908496 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m01:34:11.909250 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:34:11.910278 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290
[0m01:34:11.914487 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460"
[0m01:34:11.915390 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2
[0m01:34:11.916754 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53
[0m01:34:11.917251 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m01:34:11.917954 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m01:34:11.918556 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_reviews
[0m01:34:11.919181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_orders_customer_nk.c36d177290, now test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300)
[0m01:34:11.919958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_orders_order_nk.d752d84bf2, now test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14)
[0m01:34:11.920940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_people_customer_nk.17317dbd53, now model.dw_northwind_metabase.fact_reviews)
[0m01:34:11.921526 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m01:34:11.922212 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:34:11.922713 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m01:34:11.923216 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_reviews
[0m01:34:11.926858 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300"
[0m01:34:11.927653 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460
[0m01:34:11.931185 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14"
[0m01:34:11.934502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_reviews"
[0m01:34:11.935410 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m01:34:11.936657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_people_customer_nk.63abc53460, now test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d)
[0m01:34:11.937235 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m01:34:11.941817 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d"
[0m01:34:11.942360 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m01:34:11.943464 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300
[0m01:34:11.943937 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m01:34:11.944554 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m01:34:11.945162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_products_product_nk.6a5d6bb300, now test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044)
[0m01:34:11.946245 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14
[0m01:34:11.946771 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m01:34:11.947302 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_reviews
[0m01:34:11.948049 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m01:34:11.948642 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m01:34:11.953425 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044"
[0m01:34:11.954335 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_reviews
[0m01:34:11.954805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_products_product_nk.e2342c2e14, now test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc)
[0m01:34:11.955672 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d
[0m01:34:11.956430 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_employee
[0m01:34:11.957002 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m01:34:11.957571 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m01:34:11.958110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_reviews, now model.dw_northwind_metabase.dim_employee)
[0m01:34:11.962766 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc"
[0m01:34:11.963399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_reviews_product_nk.ea5d14f34d, now test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8)
[0m01:34:11.963872 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_employee
[0m01:34:11.964339 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m01:34:11.965065 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m01:34:11.968611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_employee"
[0m01:34:11.969631 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044
[0m01:34:11.974636 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8"
[0m01:34:11.975569 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m01:34:11.976213 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m01:34:11.977509 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc
[0m01:34:11.978189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_metabase_reviews_review_nk.c9a16e2044, now test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c)
[0m01:34:11.978815 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.int_customers
[0m01:34:11.979515 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m01:34:11.980165 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_employee
[0m01:34:11.980997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_metabase_reviews_review_nk.41a80c61bc, now model.dw_northwind_metabase.int_customers)
[0m01:34:11.986001 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c"
[0m01:34:11.986591 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m01:34:11.987471 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_employee
[0m01:34:11.987957 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m01:34:11.988952 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8
[0m01:34:11.989548 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m01:34:11.994196 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m01:34:11.995011 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m01:34:11.995590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_employee, now test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef)
[0m01:34:11.996522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_employees_employee_nk.7f1ae826a8, now test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a)
[0m01:34:11.997370 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m01:34:11.998211 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m01:34:11.998810 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m01:34:12.004006 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef"
[0m01:34:12.005276 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c
[0m01:34:12.005857 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m01:34:12.010501 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a"
[0m01:34:12.011468 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m01:34:12.012716 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m01:34:12.013774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_northwind_employees_employee_nk.b4767c5b1c, now test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487)
[0m01:34:12.014614 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m01:34:12.015411 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m01:34:12.016255 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m01:34:12.017059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.int_customers, now test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f)
[0m01:34:12.018040 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef
[0m01:34:12.023499 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487"
[0m01:34:12.024088 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m01:34:12.024554 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m01:34:12.025112 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m01:34:12.026175 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a
[0m01:34:12.030598 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f"
[0m01:34:12.031221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_name.a8492721ef, now test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa)
[0m01:34:12.031821 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.dim_geography
[0m01:34:12.032641 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m01:34:12.033354 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m01:34:12.034110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_customers_customer_nk.de1b6eb73a, now model.dw_northwind_metabase.dim_geography)
[0m01:34:12.035537 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487
[0m01:34:12.040219 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa"
[0m01:34:12.041010 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.dim_geography
[0m01:34:12.041655 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m01:34:12.042231 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m01:34:12.047514 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_geography"
[0m01:34:12.048507 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f
[0m01:34:12.049091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_northwind_customers_customer_nk.fda34a7487, now model.dw_northwind_metabase.fact_sales)
[0m01:34:12.049989 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m01:34:12.050591 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m01:34:12.051275 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m01:34:12.051868 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_order_details_order_nk.82f092c72f, now test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119)
[0m01:34:12.052910 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa
[0m01:34:12.057122 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m01:34:12.057681 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.dim_geography
[0m01:34:12.058217 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m01:34:12.058760 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m01:34:12.059786 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.dim_geography
[0m01:34:12.064086 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119"
[0m01:34:12.064724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_order_details_product_nk.c475e84bfa, now test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0)
[0m01:34:12.065365 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m01:34:12.066323 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m01:34:12.066847 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m01:34:12.067637 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_geography, now test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995)
[0m01:34:12.072995 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0"
[0m01:34:12.074273 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m01:34:12.074931 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m01:34:12.075696 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m01:34:12.076386 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dim_product
[0m01:34:12.081174 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995"
[0m01:34:12.082307 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119
[0m01:34:12.082812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.fact_sales, now model.dw_northwind_metabase.dim_product)
[0m01:34:12.083519 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m01:34:12.084181 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m01:34:12.084761 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dim_product
[0m01:34:12.085402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_orders_customer_nk.0b4c79d119, now test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4)
[0m01:34:12.086323 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0
[0m01:34:12.092806 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_product"
[0m01:34:12.093458 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m01:34:12.094027 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m01:34:12.094521 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m01:34:12.098990 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4"
[0m01:34:12.099945 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995
[0m01:34:12.100485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_orders_order_nk.1dc9af90d0, now test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8)
[0m01:34:12.101304 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:34:12.101885 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m01:34:12.102658 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dim_product
[0m01:34:12.103306 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_northwind_orders_order_nk.76c97ee995, now test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377)
[0m01:34:12.108010 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8"
[0m01:34:12.108991 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dim_product
[0m01:34:12.109507 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:34:12.110081 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m01:34:12.110771 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:34:12.115703 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377"
[0m01:34:12.116868 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4
[0m01:34:12.117410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_product, now test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd)
[0m01:34:12.118141 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m01:34:12.118795 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:34:12.119340 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:34:12.120582 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8
[0m01:34:12.121432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_stg_northwind_products_product_nk.a7577119a4, now test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901)
[0m01:34:12.127077 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd"
[0m01:34:12.127572 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:34:12.128043 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:34:12.128554 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:34:12.129447 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377
[0m01:34:12.129913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_stg_northwind_products_product_nk.cfdc8f05b8, now test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e)
[0m01:34:12.134037 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901"
[0m01:34:12.134579 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:34:12.135096 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:34:12.135502 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:34:12.136044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_analytic_events_event_nk.ff3efd8377, now test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18)
[0m01:34:12.140266 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e"
[0m01:34:12.141141 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd
[0m01:34:12.141574 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:34:12.142375 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:34:12.143119 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:34:12.147348 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18"
[0m01:34:12.147985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_analytic_events_event_nk.bfba68d6dd, now test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6)
[0m01:34:12.148858 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901
[0m01:34:12.149443 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:34:12.149941 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:34:12.150469 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:34:12.151542 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e
[0m01:34:12.156680 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6"
[0m01:34:12.157316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_feedback_feedback_nk.b1c978b901, now test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d)
[0m01:34:12.157907 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:34:12.158478 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:34:12.159241 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:34:12.159885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_feedback_feedback_nk.811051301e, now test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404)
[0m01:34:12.160782 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18
[0m01:34:12.165192 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d"
[0m01:34:12.165776 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:34:12.166286 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:34:12.166806 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:34:12.172322 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404"
[0m01:34:12.173327 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6
[0m01:34:12.173886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_customer_nk.5c4f013d18, now test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c)
[0m01:34:12.174744 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:34:12.175415 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:34:12.176104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_invoices_invoice_nk.8e21f107a6, now test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e)
[0m01:34:12.176717 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:34:12.181393 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c"
[0m01:34:12.182025 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:34:12.182570 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:34:12.183821 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d
[0m01:34:12.189191 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e"
[0m01:34:12.190447 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404
[0m01:34:12.191235 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m01:34:12.192363 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m01:34:12.193349 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:34:12.194378 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_invoices_invoice_nk.a18787493d, now test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703)
[0m01:34:12.195203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_product_nk.267c5be404, now test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95)
[0m01:34:12.196296 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c
[0m01:34:12.196814 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m01:34:12.197338 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m01:34:12.198078 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:34:12.198676 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m01:34:12.203346 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703"
[0m01:34:12.207057 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95"
[0m01:34:12.207976 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e
[0m01:34:12.208469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_reviews_review_nk.def335248c, now test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43)
[0m01:34:12.209286 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m01:34:12.209735 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m01:34:12.210303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_fact_reviews_review_nk.8b466e6e5e, now test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8)
[0m01:34:12.215528 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43"
[0m01:34:12.216201 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m01:34:12.216830 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m01:34:12.217368 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m01:34:12.222052 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8"
[0m01:34:12.222987 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95
[0m01:34:12.223958 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703
[0m01:34:12.224644 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m01:34:12.226002 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:34:12.227371 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:34:12.229101 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43
[0m01:34:12.230037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_employee_employee_sk.d9a0361b95, now snapshot.dw_northwind_metabase.customers_snapshot)
[0m01:34:12.230605 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_employee_employee_nk.3574716703, now test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57)
[0m01:34:12.231329 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m01:34:12.232006 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:34:12.232565 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:34:12.233013 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:34:12.233806 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8
[0m01:34:12.234277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_employee_employee_nk.ebe41ade43, now test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1)
[0m01:34:12.237800 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:34:12.242681 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57"
[0m01:34:12.243275 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:34:12.243825 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:34:12.244644 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m01:34:12.245313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_employee_employee_sk.30aee5fcd8, now test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7)
[0m01:34:12.249663 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1"
[0m01:34:12.250301 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:34:12.250905 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:34:12.251621 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:34:12.252195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_northwind_metabase.customers_snapshot, now test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd)
[0m01:34:12.256430 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7"
[0m01:34:12.257478 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57
[0m01:34:12.258406 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:34:12.259459 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m01:34:12.264234 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd"
[0m01:34:12.264882 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:34:12.265362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_name.8b028a4b57, now test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e)
[0m01:34:12.266347 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1
[0m01:34:12.266986 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m01:34:12.267624 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:34:12.268304 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m01:34:12.272628 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e"
[0m01:34:12.273749 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7
[0m01:34:12.274299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_customer_nk.1dfa61bec1, now test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594)
[0m01:34:12.274857 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:34:12.275531 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:34:12.276111 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m01:34:12.276935 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd
[0m01:34:12.277398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_int_customers_source_system.f1d66d35a7, now test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0)
[0m01:34:12.282049 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594"
[0m01:34:12.282711 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:34:12.283258 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m01:34:12.283722 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:34:12.284390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_int_customers_customer_nk.3d390c40fd, now test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4)
[0m01:34:12.285301 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e
[0m01:34:12.289627 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0"
[0m01:34:12.290199 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:34:12.290727 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:34:12.291375 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m01:34:12.295239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4"
[0m01:34:12.295816 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_geography_geography_sk.ef9d5cae7e, now test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6)
[0m01:34:12.296692 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594
[0m01:34:12.297351 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:34:12.298055 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:34:12.298480 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:34:12.302670 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6"
[0m01:34:12.303240 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_geography_geography_sk.041607d594, now test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f)
[0m01:34:12.304317 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0
[0m01:34:12.304937 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:34:12.305490 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:34:12.305989 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:34:12.306927 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4
[0m01:34:12.310778 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f"
[0m01:34:12.311364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_channel_nk.5f6e786fb0, now test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c)
[0m01:34:12.311949 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m01:34:12.312636 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:34:12.313263 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:34:12.313754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_customer_nk.c8689782d4, now test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3)
[0m01:34:12.314569 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6
[0m01:34:12.324537 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c"
[0m01:34:12.325035 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:34:12.325451 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m01:34:12.325916 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m01:34:12.326869 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f
[0m01:34:12.330873 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3"
[0m01:34:12.331420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_order_nk.b93fbe1fd6, now test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417)
[0m01:34:12.331959 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:34:12.332569 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:34:12.333018 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m01:34:12.333524 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_fact_sales_product_nk.874b058d5f, now test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1)
[0m01:34:12.334633 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c
[0m01:34:12.341270 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417"
[0m01:34:12.341733 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m01:34:12.342141 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:34:12.342585 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:34:12.343440 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3
[0m01:34:12.349344 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1"
[0m01:34:12.349877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_channel_nk__channel_nk__ref_dim_channel_.7d61cbbd7c, now test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e)
[0m01:34:12.350427 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m01:34:12.351056 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m01:34:12.351586 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:34:12.352080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_product_product_nk.a2a1c943a3, now test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e)
[0m01:34:12.352872 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417
[0m01:34:12.358120 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e"
[0m01:34:12.358622 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m01:34:12.359096 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m01:34:12.359678 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:34:12.363813 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e"
[0m01:34:12.364404 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.not_null_dim_product_product_sk.271feb5417, now test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c)
[0m01:34:12.365152 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1
[0m01:34:12.365896 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m01:34:12.366611 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m01:34:12.367253 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:34:12.372258 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c"
[0m01:34:12.372860 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m01:34:12.373450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_reviews_product_nk__product_nk__ref_dim_product_.625f39e7d1, now model.dw_northwind_metabase.dim_customer)
[0m01:34:12.374246 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e
[0m01:34:12.375038 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e
[0m01:34:12.375460 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m01:34:12.376216 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m01:34:12.379301 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m01:34:12.380157 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c
[0m01:34:12.381238 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m01:34:12.382065 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m01:34:12.382848 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.dm_sales
[0m01:34:12.383284 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dm_saas
[0m01:34:12.384253 [debug] [Thread-4 (]: Began running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:34:12.384665 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.dm_product_analytics
[0m01:34:12.385091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_product_product_sk.2248c4335c, now model.dw_northwind_metabase.dm_sales)
[0m01:34:12.385618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.unique_dim_product_product_nk.6dd9ad682e, now model.dw_northwind_metabase.dm_saas)
[0m01:34:12.386126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dim_customer, now test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c)
[0m01:34:12.386574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_sales_product_nk__product_nk__ref_dim_product_.ae11081d8e, now model.dw_northwind_metabase.dm_product_analytics)
[0m01:34:12.387008 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.dm_sales
[0m01:34:12.387406 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dm_saas
[0m01:34:12.387808 [debug] [Thread-4 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:34:12.388238 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.dm_product_analytics
[0m01:34:12.391675 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_sales"
[0m01:34:12.395181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_saas"
[0m01:34:12.401172 [debug] [Thread-4 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c"
[0m01:34:12.405461 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_product_analytics"
[0m01:34:12.407529 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dm_saas
[0m01:34:12.408218 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.dm_sales
[0m01:34:12.408908 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.dm_product_analytics
[0m01:34:12.409826 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dm_saas
[0m01:34:12.410684 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.dm_sales
[0m01:34:12.411126 [debug] [Thread-4 (]: Began executing node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:34:12.411951 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.dm_product_analytics
[0m01:34:12.412431 [debug] [Thread-1 (]: Began running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:34:12.412971 [debug] [Thread-3 (]: Began running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:34:12.413814 [debug] [Thread-4 (]: Finished running node test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c
[0m01:34:12.414423 [debug] [Thread-2 (]: Began running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:34:12.415249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dm_saas, now test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407)
[0m01:34:12.415867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dm_sales, now test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376)
[0m01:34:12.416656 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.dm_b2b
[0m01:34:12.417393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dm_product_analytics, now test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b)
[0m01:34:12.417895 [debug] [Thread-1 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:34:12.418399 [debug] [Thread-3 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:34:12.418929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dw_northwind_metabase.relationships_fact_analytic_events_customer_nk__customer_nk__ref_dim_customer_.6f64c5fc0c, now model.dw_northwind_metabase.dm_b2b)
[0m01:34:12.419421 [debug] [Thread-2 (]: Began compiling node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:34:12.424392 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407"
[0m01:34:12.429497 [debug] [Thread-3 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376"
[0m01:34:12.429981 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.dm_b2b
[0m01:34:12.434676 [debug] [Thread-2 (]: Writing injected SQL for node "test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b"
[0m01:34:12.438084 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_b2b"
[0m01:34:12.439628 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.dm_b2b
[0m01:34:12.440172 [debug] [Thread-3 (]: Began executing node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:34:12.441339 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.dm_b2b
[0m01:34:12.443100 [debug] [Thread-3 (]: Finished running node test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376
[0m01:34:12.443520 [debug] [Thread-1 (]: Began executing node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:34:12.444030 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.dm_b2c
[0m01:34:12.444561 [debug] [Thread-2 (]: Began executing node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:34:12.445467 [debug] [Thread-1 (]: Finished running node test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407
[0m01:34:12.445980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.dm_b2b, now model.dw_northwind_metabase.dm_b2c)
[0m01:34:12.446770 [debug] [Thread-2 (]: Finished running node test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b
[0m01:34:12.447302 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.dm_b2c
[0m01:34:12.450312 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.dm_b2c"
[0m01:34:12.451627 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.dm_b2c
[0m01:34:12.452432 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.dm_b2c
[0m01:34:12.453696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:12.454122 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m01:34:12.454432 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_saas' was properly closed.
[0m01:34:12.454714 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_sales' was properly closed.
[0m01:34:12.454993 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dm_b2c' was properly closed.
[0m01:34:12.455259 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dm_b2c' was properly closed.
[0m01:34:12.455528 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.relationships_fact_sales_customer_nk__customer_nk__ref_dim_customer_.a567ad9a7b' was properly closed.
[0m01:34:12.455805 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.relationships_fact_invoices_customer_nk__customer_nk__ref_dim_customer_.e4c655b376' was properly closed.
[0m01:34:12.456094 [debug] [MainThread]: Connection 'test.dw_northwind_metabase.relationships_fact_feedback_customer_nk__customer_nk__ref_dim_customer_.cd1703a407' was properly closed.
[0m01:34:12.472133 [debug] [MainThread]: Command end result
[0m01:34:12.599515 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:34:12.603747 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:34:12.615204 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m01:34:13.304103 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m01:34:13.304795 [info ] [MainThread]: Building catalog
[0m01:34:13.330840 [debug] [ThreadPool]: Acquiring new postgres connection 'dw_northwind_metabase.information_schema'
[0m01:34:13.340118 [debug] [ThreadPool]: Using postgres connection "dw_northwind_metabase.information_schema"
[0m01:34:13.340728 [debug] [ThreadPool]: On dw_northwind_metabase.information_schema: BEGIN
[0m01:34:13.341186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:13.408993 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m01:34:13.409566 [debug] [ThreadPool]: Using postgres connection "dw_northwind_metabase.information_schema"
[0m01:34:13.410171 [debug] [ThreadPool]: On dw_northwind_metabase.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "dw_northwind_metabase.information_schema"} */

    
    

    select
        'dw_northwind_metabase' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dw_dm_b2c') and
           upper(tbl.relname) = upper('dm_b2c')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_feedback')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('customers_snapshot')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_reviews')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('invoices')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('fact_feedback')) or (upper(sch.nspname) = upper('dw_dm_product_analytics') and
           upper(tbl.relname) = upper('dm_product_analytics')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_people')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('feedback')) or (upper(sch.nspname) = upper('dw_dm_sales') and
           upper(tbl.relname) = upper('dm_sales')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('accounts')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_northwind_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('people')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('dim_customer')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('employee')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('fact_analytic_events')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('dim_employee')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_invoices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('salesorder')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('reviews')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_accounts')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('fact_sales')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('dim_product')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_northwind_order_details')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('int_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('supplier')) or (upper(sch.nspname) = upper('dw_dm_b2b') and
           upper(tbl.relname) = upper('dm_b2b')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('dim_geography')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('fact_reviews')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orderdetail')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_orders')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('fact_invoices')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_northwind_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('analyticevents')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_northwind_employees')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_northwind_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('category')) or (upper(sch.nspname) = upper('dw_dm_saas') and
           upper(tbl.relname) = upper('dm_saas')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('product')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customer')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('dw_stg') and
           upper(tbl.relname) = upper('stg_metabase_analytic_events')) or (upper(sch.nspname) = upper('dw_dw') and
           upper(tbl.relname) = upper('dim_channel')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m01:34:13.436904 [debug] [ThreadPool]: SQL status: SELECT 595 in 0.026 seconds
[0m01:34:13.457591 [debug] [ThreadPool]: On dw_northwind_metabase.information_schema: ROLLBACK
[0m01:34:13.458352 [debug] [ThreadPool]: On dw_northwind_metabase.information_schema: Close
[0m01:34:13.513778 [debug] [MainThread]: Wrote artifact CatalogArtifact to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\catalog.json
[0m01:34:13.599100 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m01:34:13.604609 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m01:34:13.605320 [info ] [MainThread]: Catalog written to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\catalog.json
[0m01:34:13.609307 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:34:13.608946 after 4.01 seconds
[0m01:34:13.609990 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:34:13.610375 [debug] [MainThread]: Connection 'dw_northwind_metabase.information_schema' was properly closed.
[0m01:34:13.610980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB14E2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1E82990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1E831D0>]}
[0m01:34:13.611712 [debug] [MainThread]: Flushing usage events
[0m01:34:15.014385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:30.309539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199C9E0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199E358910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199E99BED0>]}


============================== 01:34:30.314571 | 0f620a96-1644-43d0-9936-131c0461c714 ==============================
[0m01:34:30.314571 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:34:30.315394 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:34:30.556710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f620a96-1644-43d0-9936-131c0461c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199CC19F30>]}
[0m01:34:30.634551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f620a96-1644-43d0-9936-131c0461c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199EA1FF00>]}
