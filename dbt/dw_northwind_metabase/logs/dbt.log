[0m21:20:01.200355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB37B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB5054B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB5698E10>]}


============================== 21:20:01.223682 | f2ead345-30e1-43ee-94a4-fef94f2a5412 ==============================
[0m21:20:01.223682 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:20:01.225081 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:20:01.707685 [info ] [MainThread]: dbt version: 1.10.13
[0m21:20:01.708285 [info ] [MainThread]: python version: 3.13.9
[0m21:20:01.708730 [info ] [MainThread]: python path: D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\.venv\Scripts\python.exe
[0m21:20:01.709225 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:20:01.902123 [info ] [MainThread]: Using profiles dir at D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase
[0m21:20:01.903268 [info ] [MainThread]: Using profiles.yml file at D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\profiles.yml
[0m21:20:01.904200 [info ] [MainThread]: Using dbt_project.yml file at D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\dbt_project.yml
[0m21:20:01.906094 [info ] [MainThread]: adapter type: postgres
[0m21:20:01.907209 [info ] [MainThread]: adapter version: 1.9.1
[0m21:20:02.323701 [info ] [MainThread]: Configuration:
[0m21:20:02.324467 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:20:02.325840 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:20:02.327415 [info ] [MainThread]: Required dependencies:
[0m21:20:02.328965 [debug] [MainThread]: Executing "git --help"
[0m21:20:02.546255 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:20:02.547436 [debug] [MainThread]: STDERR: "b''"
[0m21:20:02.549132 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:20:02.550561 [info ] [MainThread]: Connection:
[0m21:20:02.551691 [info ] [MainThread]:   host: localhost
[0m21:20:02.552672 [info ] [MainThread]:   port: 5433
[0m21:20:02.553559 [info ] [MainThread]:   user: postgres
[0m21:20:02.554502 [info ] [MainThread]:   database: dw_northwind_metabase
[0m21:20:02.555498 [info ] [MainThread]:   schema: dw
[0m21:20:02.556412 [info ] [MainThread]:   connect_timeout: 10
[0m21:20:02.557395 [info ] [MainThread]:   role: None
[0m21:20:02.558351 [info ] [MainThread]:   search_path: None
[0m21:20:02.559163 [info ] [MainThread]:   keepalives_idle: 0
[0m21:20:02.559987 [info ] [MainThread]:   sslmode: None
[0m21:20:02.560847 [info ] [MainThread]:   sslcert: None
[0m21:20:02.561652 [info ] [MainThread]:   sslkey: None
[0m21:20:02.562512 [info ] [MainThread]:   sslrootcert: None
[0m21:20:02.563382 [info ] [MainThread]:   application_name: dbt
[0m21:20:02.564227 [info ] [MainThread]:   retries: 1
[0m21:20:02.566354 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:20:03.674058 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:20:09.612876 [debug] [MainThread]: Using postgres connection "debug"
[0m21:20:09.613425 [debug] [MainThread]: On debug: select 1 as id
[0m21:20:09.613865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:09.717244 [debug] [MainThread]: SQL status: SELECT 1 in 0.103 seconds
[0m21:20:09.719229 [debug] [MainThread]: On debug: Close
[0m21:20:09.719909 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:20:09.720529 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:20:09.722275 [debug] [MainThread]: Command `dbt debug` succeeded at 21:20:09.721943 after 8.70 seconds
[0m21:20:09.722858 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:20:09.723310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB58DF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB5A80830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB59E7F00>]}
[0m21:20:09.723857 [debug] [MainThread]: Flushing usage events
[0m21:20:10.962801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:59.975371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213EEB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213FD9BED0>]}


============================== 21:32:59.983736 | 7590e651-1e29-4139-ac4b-ba73148c476f ==============================
[0m21:32:59.983736 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:32:59.984771 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:33:00.364878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F0E9F30>]}
[0m21:33:00.469795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213FE23DF0>]}
[0m21:33:00.471248 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:33:00.994944 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:33:00.997209 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:33:00.998605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141122E50>]}
[0m21:33:05.316951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.intermediate
- snapshots.dw_northwind_metabase
[0m21:33:05.335292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221412DAD50>]}
[0m21:33:05.481140 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:33:05.520639 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:33:05.663040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221415F3070>]}
[0m21:33:05.664075 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:33:05.665070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141325230>]}
[0m21:33:05.668391 [info ] [MainThread]: 
[0m21:33:05.669273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:05.670163 [info ] [MainThread]: 
[0m21:33:05.671599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:05.680419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:33:05.800168 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:33:05.800699 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:33:05.801146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:05.886728 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.086 seconds
[0m21:33:05.894644 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:33:05.896695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_stg)
[0m21:33:05.898277 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_stg"
"
[0m21:33:05.906932 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_stg"
[0m21:33:05.907598 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: BEGIN
[0m21:33:05.908059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:06.000206 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m21:33:06.001267 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_stg"
[0m21:33:06.001966 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_stg"} */
create schema if not exists "dw_stg"
[0m21:33:06.004486 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m21:33:06.006052 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: COMMIT
[0m21:33:06.006559 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_stg"
[0m21:33:06.006980 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: COMMIT
[0m21:33:06.008977 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:33:06.009740 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_stg: Close
[0m21:33:06.016147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:33:06.026332 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:33:06.026853 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:33:06.027297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:06.108599 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m21:33:06.109152 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:33:06.109657 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:33:06.184809 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.075 seconds
[0m21:33:06.186530 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:33:06.187133 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:33:06.193929 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.194444 [debug] [MainThread]: On master: BEGIN
[0m21:33:06.194923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:06.268552 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m21:33:06.269148 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.269685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:33:06.310526 [debug] [MainThread]: SQL status: SELECT 0 in 0.040 seconds
[0m21:33:06.312143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141626990>]}
[0m21:33:06.312876 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:06.313688 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.314133 [debug] [MainThread]: On master: BEGIN
[0m21:33:06.314990 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:33:06.315402 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.315787 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.316147 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.316728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:33:06.317197 [debug] [MainThread]: On master: Close
[0m21:33:06.331576 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.332445 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.333015 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.333569 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.334330 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:33:06.334951 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:33:06.337138 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:33:06.337886 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:33:06.335680 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:33:06.338560 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.339122 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.336344 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:33:06.339912 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:33:06.350162 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.359042 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.359902 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:33:06.360510 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.361547 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.367358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.373191 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.377449 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.385501 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.416065 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.430166 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.440106 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.441858 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.443461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.448864 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.455012 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.455692 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:33:06.456547 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:06.457476 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.458319 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.459175 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:33:06.460019 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:33:06.460853 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.461486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:33:06.462164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:06.462888 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:33:06.464103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:33:06.550503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.094 seconds
[0m21:33:06.551451 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:33:06.552528 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
;
  );
[0m21:33:06.558410 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m21:33:06.559306 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:33:06.560313 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
;
  );
[0m21:33:06.561686 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: ;
         ^

[0m21:33:06.562902 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:33:06.564102 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: ;
         ^

[0m21:33:06.565076 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:33:06.566016 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:33:06.566775 [debug] [Thread-4 (]: SQL status: BEGIN in 0.105 seconds
[0m21:33:06.567884 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:33:06.568656 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:33:06.570818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.107 seconds
[0m21:33:06.571984 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
;
  );
[0m21:33:06.572842 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:33:06.575502 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
;
  );
[0m21:33:06.576678 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: ;
         ^

[0m21:33:06.578217 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:33:06.579632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: ;
         ^

[0m21:33:06.580759 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:33:06.581803 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:33:06.585288 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:33:06.626553 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  syntax error at or near ";"
  LINE 25: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:33:06.627761 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  syntax error at or near ";"
  LINE 22: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:33:06.629144 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:33:06.631167 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:33:06.649393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141942360>]}
[0m21:33:06.650065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141B394F0>]}
[0m21:33:06.651535 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141B2BD10>]}
[0m21:33:06.651040 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.29s]
[0m21:33:06.652399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F06F750>]}
[0m21:33:06.653285 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.29s]
[0m21:33:06.655921 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:33:06.654542 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.27s]
[0m21:33:06.658925 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:33:06.660044 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.661333 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  syntax error at or near ";"
  LINE 25: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:33:06.657231 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.30s]
[0m21:33:06.663760 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:33:06.667930 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:33:06.664804 [info ] [Thread-2 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:33:06.669956 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:33:06.671252 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  syntax error at or near ";"
  LINE 22: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:33:06.672455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:33:06.674174 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:33:06.675312 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.684089 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.686744 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.695969 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.700537 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.701664 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:33:06.702657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:06.797558 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m21:33:06.798240 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:33:06.798854 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
;
  );
[0m21:33:06.800093 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: ;
         ^

[0m21:33:06.800639 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:33:06.801518 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:33:06.808400 [debug] [Thread-2 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:33:06.809133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7590e651-1e29-4139-ac4b-ba73148c476f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141A64FB0>]}
[0m21:33:06.810170 [error] [Thread-2 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.14s]
[0m21:33:06.811314 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:33:06.812342 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:33:06.814514 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.815019 [debug] [MainThread]: On master: BEGIN
[0m21:33:06.815445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:06.885965 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m21:33:06.886524 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.886953 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:06.887354 [debug] [MainThread]: On master: COMMIT
[0m21:33:06.888026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:33:06.888523 [debug] [MainThread]: On master: Close
[0m21:33:06.889190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:06.889599 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:33:06.890017 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:33:06.890391 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:33:06.890762 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:33:06.891163 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:33:06.891555 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:33:06.892070 [info ] [MainThread]: 
[0m21:33:06.892746 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m21:33:06.894723 [debug] [MainThread]: Command end result
[0m21:33:06.932566 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:33:06.936556 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:33:06.945903 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:33:06.946841 [info ] [MainThread]: 
[0m21:33:06.948044 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:33:06.949314 [info ] [MainThread]: 
[0m21:33:06.950392 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:33:06.951521 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  syntax error at or near ";"
  LINE 25: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:33:06.952243 [info ] [MainThread]: 
[0m21:33:06.953159 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:33:06.953942 [info ] [MainThread]: 
[0m21:33:06.954758 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:33:06.955943 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:33:06.956825 [info ] [MainThread]: 
[0m21:33:06.957867 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:33:06.958833 [info ] [MainThread]: 
[0m21:33:06.960197 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:33:06.961266 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  syntax error at or near ";"
  LINE 22: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:33:06.964597 [info ] [MainThread]: 
[0m21:33:06.966299 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:33:06.967241 [info ] [MainThread]: 
[0m21:33:06.968391 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:33:06.969425 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:33:06.970419 [info ] [MainThread]: 
[0m21:33:06.971584 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:33:06.972488 [info ] [MainThread]: 
[0m21:33:06.973689 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:33:06.974853 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  syntax error at or near ";"
  LINE 26: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:33:06.976830 [info ] [MainThread]: 
[0m21:33:06.978285 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:33:06.980276 [info ] [MainThread]: 
[0m21:33:06.982914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:33:06.986405 [debug] [MainThread]: Command `dbt run` failed at 21:33:06.986110 after 7.23 seconds
[0m21:33:06.988595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213F75EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141BCF8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141BCFB30>]}
[0m21:33:06.989704 [debug] [MainThread]: Flushing usage events
[0m21:33:08.357711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:20.213548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE200830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAEAA8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0198E10>]}


============================== 21:34:20.219550 | 7c20ef5e-0200-4b77-a868-4263adb4463f ==============================
[0m21:34:20.219550 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:34:20.220349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:34:20.616646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE439F30>]}
[0m21:34:20.725871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0227DF0>]}
[0m21:34:20.727942 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:34:21.181455 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:34:21.459017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m21:34:21.459976 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_customers.sql
[0m21:34:21.460612 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:21.461203 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_orders.sql
[0m21:34:21.462218 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m21:34:21.462895 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:22.155904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.dw
- snapshots.dw_northwind_metabase
[0m21:34:22.178194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0768B50>]}
[0m21:34:22.313407 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:34:22.316829 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:34:22.347841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB07C4320>]}
[0m21:34:22.348519 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:34:22.349114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB03D8670>]}
[0m21:34:22.352099 [info ] [MainThread]: 
[0m21:34:22.352836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:22.353578 [info ] [MainThread]: 
[0m21:34:22.354847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:22.364262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:34:22.471081 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:34:22.471601 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:34:22.472037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:22.557385 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.085 seconds
[0m21:34:22.559566 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:34:22.562595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:34:22.569291 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:34:22.569909 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:34:22.570318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:22.638648 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m21:34:22.639400 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:34:22.640124 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:34:22.652083 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m21:34:22.653794 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:34:22.654502 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:34:22.662311 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.662993 [debug] [MainThread]: On master: BEGIN
[0m21:34:22.663487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:22.737999 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m21:34:22.738537 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.739056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:34:22.750430 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m21:34:22.752147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB08D2F70>]}
[0m21:34:22.752736 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:22.753381 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.753779 [debug] [MainThread]: On master: BEGIN
[0m21:34:22.754512 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:34:22.755085 [debug] [MainThread]: On master: COMMIT
[0m21:34:22.755832 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:22.756479 [debug] [MainThread]: On master: COMMIT
[0m21:34:22.757343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:34:22.758106 [debug] [MainThread]: On master: Close
[0m21:34:22.767449 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:22.768397 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:22.769008 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:22.769567 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:22.770494 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:34:22.771555 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:34:22.772460 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:34:22.775214 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:34:22.773537 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:34:22.776941 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:34:22.778077 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:34:22.778823 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:22.779971 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:34:22.780939 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:22.781822 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:22.787743 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:22.801485 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:22.806077 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:22.813590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:22.818047 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:22.820228 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:22.827228 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:22.873733 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:22.915565 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:22.917282 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:22.919313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:22.920654 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:22.931551 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:22.933179 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:22.934112 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:34:22.934992 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:22.935798 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:22.936599 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:34:22.937275 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:34:22.937958 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:34:22.938778 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:22.940344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:34:22.939528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:34:22.941251 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:34:22.943137 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:23.035358 [debug] [Thread-4 (]: SQL status: BEGIN in 0.099 seconds
[0m21:34:23.036149 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:34:23.036933 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
  );
[0m21:34:23.038458 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m21:34:23.039049 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:34:23.045382 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
  );
[0m21:34:23.046464 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.orderdetail"
LINE 21: from "northwind"."public"."orderdetail" od
              ^

[0m21:34:23.047689 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:34:23.048700 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.customer"
LINE 25: from "northwind"."public"."customer"
              ^

[0m21:34:23.049475 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:34:23.050255 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:34:23.051242 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:34:23.055576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m21:34:23.056542 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:34:23.057294 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
  );
[0m21:34:23.058393 [debug] [Thread-2 (]: SQL status: BEGIN in 0.115 seconds
[0m21:34:23.059281 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:34:23.059975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.accounts"
LINE 28: from "sample_metabase_pg"."public"."accounts" a
              ^

[0m21:34:23.060672 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
  );
[0m21:34:23.061584 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:34:23.063344 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:34:23.064164 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.orders"
LINE 24: from "sample_metabase_pg"."public"."orders" o
              ^

[0m21:34:23.066196 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:34:23.067165 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:34:23.094053 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:34:23.095618 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:23.098887 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:34:23.100118 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:23.101661 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0B8E210>]}
[0m21:34:23.102155 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0DA41B0>]}
[0m21:34:23.103457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB02F4E10>]}
[0m21:34:23.104010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE3C2170>]}
[0m21:34:23.103013 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.32s]
[0m21:34:23.105257 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.32s]
[0m21:34:23.106909 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.32s]
[0m21:34:23.110562 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:34:23.108650 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.32s]
[0m21:34:23.112324 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:34:23.113476 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:34:23.114443 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.115588 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:34:23.116569 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:34:23.117559 [info ] [Thread-3 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:34:23.119655 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:34:23.121057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:34:23.122322 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:34:23.123354 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.124751 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:34:23.129706 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.132202 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.139633 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.141798 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.142806 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:34:23.143444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:34:23.292993 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m21:34:23.294121 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:34:23.295330 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
  );
[0m21:34:23.297351 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.salesorder"
LINE 25: from "northwind"."public"."salesorder" o
              ^

[0m21:34:23.298144 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:34:23.299151 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:34:23.306607 [debug] [Thread-3 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:34:23.307688 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c20ef5e-0200-4b77-a868-4263adb4463f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0373540>]}
[0m21:34:23.309450 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.19s]
[0m21:34:23.311439 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:34:23.313008 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:34:23.316047 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:23.316978 [debug] [MainThread]: On master: BEGIN
[0m21:34:23.317852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:23.421730 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m21:34:23.423406 [debug] [MainThread]: On master: COMMIT
[0m21:34:23.425991 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:23.428798 [debug] [MainThread]: On master: COMMIT
[0m21:34:23.430609 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:34:23.432347 [debug] [MainThread]: On master: Close
[0m21:34:23.433940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:23.435105 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:34:23.435963 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:34:23.437319 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:34:23.438357 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:34:23.439622 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:34:23.440570 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:34:23.441847 [info ] [MainThread]: 
[0m21:34:23.443409 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m21:34:23.448593 [debug] [MainThread]: Command end result
[0m21:34:23.552215 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:34:23.559980 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:34:23.579630 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:34:23.580653 [info ] [MainThread]: 
[0m21:34:23.582018 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:34:23.583368 [info ] [MainThread]: 
[0m21:34:23.586077 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:34:23.589798 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:34:23.591084 [info ] [MainThread]: 
[0m21:34:23.596494 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:34:23.598421 [info ] [MainThread]: 
[0m21:34:23.601344 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:34:23.603997 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:34:23.605393 [info ] [MainThread]: 
[0m21:34:23.608089 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:34:23.609516 [info ] [MainThread]: 
[0m21:34:23.611182 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:34:23.612602 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:23.614644 [info ] [MainThread]: 
[0m21:34:23.616738 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:34:23.618166 [info ] [MainThread]: 
[0m21:34:23.620672 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:34:23.623511 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:23.625443 [info ] [MainThread]: 
[0m21:34:23.627859 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:34:23.630954 [info ] [MainThread]: 
[0m21:34:23.633860 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:34:23.635744 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:34:23.637831 [info ] [MainThread]: 
[0m21:34:23.640032 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:34:23.642392 [info ] [MainThread]: 
[0m21:34:23.643508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:34:23.646581 [debug] [MainThread]: Command `dbt run` failed at 21:34:23.646230 after 3.61 seconds
[0m21:34:23.647639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FAE291DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0DEB8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB0DEBB90>]}
[0m21:34:23.648625 [debug] [MainThread]: Flushing usage events
[0m21:34:25.028756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:48.507957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91D8C0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91F258910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91F89BED0>]}


============================== 21:36:48.523930 | 02d516c5-d4d3-48a3-8990-0bde6a2f6601 ==============================
[0m21:36:48.523930 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:36:48.525453 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m21:36:48.927083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91DAF9F30>]}
[0m21:36:49.037209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91F923DF0>]}
[0m21:36:49.038803 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:36:49.547891 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:36:49.839826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:49.840329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:49.847710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_sales
- snapshots.dw_northwind_metabase
[0m21:36:49.934018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FE68D50>]}
[0m21:36:50.060065 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:36:50.063577 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:36:50.185881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FEBC5F0>]}
[0m21:36:50.186568 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:36:50.187364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FA6D8D0>]}
[0m21:36:50.194414 [info ] [MainThread]: 
[0m21:36:50.195262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:50.195981 [info ] [MainThread]: 
[0m21:36:50.196899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:50.204002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:36:50.463982 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:36:50.464520 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:36:50.464908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:50.574368 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.109 seconds
[0m21:36:50.576063 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:36:50.578522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:36:50.586814 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:36:50.587308 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:36:50.587667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:50.728687 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m21:36:50.736963 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:36:50.738013 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:36:50.771427 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m21:36:50.775200 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:36:50.776485 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:36:50.790483 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.791409 [debug] [MainThread]: On master: BEGIN
[0m21:36:50.795622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:50.919612 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m21:36:50.920744 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.922024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:36:50.954180 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m21:36:50.957046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9200F2C30>]}
[0m21:36:50.958440 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:50.959901 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.960860 [debug] [MainThread]: On master: BEGIN
[0m21:36:50.962279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:36:50.963149 [debug] [MainThread]: On master: COMMIT
[0m21:36:50.963961 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:50.964911 [debug] [MainThread]: On master: COMMIT
[0m21:36:50.966058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:50.966934 [debug] [MainThread]: On master: Close
[0m21:36:50.988231 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:50.989469 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:50.990594 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:50.991707 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:50.993111 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:36:50.994483 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:36:50.999316 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:36:50.997680 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:36:51.001083 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:36:50.996374 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:36:51.002478 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:51.004858 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:36:51.007161 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:51.008742 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:36:51.036305 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:51.055561 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.056948 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.058279 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:51.069637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.079055 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.081457 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:51.093709 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:51.094889 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:51.195785 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.196892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.205417 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.206384 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:51.215678 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.217123 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.218444 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.219558 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:36:51.220873 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:36:51.222695 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.223729 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:36:51.225042 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.226163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:51.227286 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:36:51.228563 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:36:51.229926 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:36:51.230985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:36:51.335904 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m21:36:51.337018 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:36:51.338136 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
  );
[0m21:36:51.345479 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.customer"
LINE 25: from "northwind"."public"."customer"
              ^

[0m21:36:51.346673 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:36:51.348204 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:36:51.354814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.129 seconds
[0m21:36:51.355962 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:36:51.357222 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
  );
[0m21:36:51.359524 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.accounts"
LINE 28: from "sample_metabase_pg"."public"."accounts" a
              ^

[0m21:36:51.360618 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:36:51.361797 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:36:51.366000 [debug] [Thread-4 (]: SQL status: BEGIN in 0.135 seconds
[0m21:36:51.367342 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:36:51.368382 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
  );
[0m21:36:51.370327 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.orderdetail"
LINE 21: from "northwind"."public"."orderdetail" od
              ^

[0m21:36:51.371350 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:36:51.372357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.142 seconds
[0m21:36:51.373481 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:36:51.374264 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:36:51.375503 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
  );
[0m21:36:51.380034 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.orders"
LINE 24: from "sample_metabase_pg"."public"."orders" o
              ^

[0m21:36:51.381166 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:36:51.382715 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:36:51.397445 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:36:51.405153 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:36:51.406808 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:36:51.411516 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:36:51.412559 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FF0F350>]}
[0m21:36:51.413119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920142360>]}
[0m21:36:51.414717 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920348730>]}
[0m21:36:51.414141 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.40s]
[0m21:36:51.415476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91DA82210>]}
[0m21:36:51.416475 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.40s]
[0m21:36:51.418725 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:36:51.417481 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.41s]
[0m21:36:51.420818 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:36:51.421544 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.422562 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:36:51.419737 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.40s]
[0m21:36:51.423841 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:36:51.426977 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:36:51.424916 [info ] [Thread-3 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:36:51.428864 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:36:51.430753 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:36:51.431894 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:36:51.433583 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:36:51.434511 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.439321 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.440944 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.445616 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.447236 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.449165 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:36:51.450182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:36:51.528037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.078 seconds
[0m21:36:51.528894 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:36:51.529623 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
  );
[0m21:36:51.531119 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.salesorder"
LINE 25: from "northwind"."public"."salesorder" o
              ^

[0m21:36:51.531711 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:36:51.532607 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:36:51.540482 [debug] [Thread-3 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:36:51.541269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02d516c5-d4d3-48a3-8990-0bde6a2f6601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FF7BCB0>]}
[0m21:36:51.542210 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.11s]
[0m21:36:51.543468 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:36:51.544368 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:36:51.546501 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:51.547074 [debug] [MainThread]: On master: BEGIN
[0m21:36:51.547551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:51.618580 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m21:36:51.619267 [debug] [MainThread]: On master: COMMIT
[0m21:36:51.619762 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:51.620244 [debug] [MainThread]: On master: COMMIT
[0m21:36:51.621034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:51.621571 [debug] [MainThread]: On master: Close
[0m21:36:51.622275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:51.622727 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:36:51.623252 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:36:51.623640 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:36:51.624085 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:36:51.624592 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:36:51.625036 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:36:51.625605 [info ] [MainThread]: 
[0m21:36:51.626380 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m21:36:51.628768 [debug] [MainThread]: Command end result
[0m21:36:51.746736 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:36:51.751639 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:36:51.762995 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:36:51.763762 [info ] [MainThread]: 
[0m21:36:51.764738 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:36:51.765581 [info ] [MainThread]: 
[0m21:36:51.766520 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:36:51.767331 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:36:51.768029 [info ] [MainThread]: 
[0m21:36:51.768948 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:36:51.769711 [info ] [MainThread]: 
[0m21:36:51.771305 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:36:51.772492 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:36:51.773629 [info ] [MainThread]: 
[0m21:36:51.775309 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:36:51.776463 [info ] [MainThread]: 
[0m21:36:51.778022 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:36:51.780509 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:36:51.782297 [info ] [MainThread]: 
[0m21:36:51.783913 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:36:51.785146 [info ] [MainThread]: 
[0m21:36:51.786591 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:36:51.788008 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:36:51.790216 [info ] [MainThread]: 
[0m21:36:51.791729 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:36:51.792748 [info ] [MainThread]: 
[0m21:36:51.793845 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:36:51.794738 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:36:51.795692 [info ] [MainThread]: 
[0m21:36:51.796572 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:36:51.797616 [info ] [MainThread]: 
[0m21:36:51.799343 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:36:51.802005 [debug] [MainThread]: Command `dbt run` failed at 21:36:51.801687 after 3.61 seconds
[0m21:36:51.803185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C91FB34A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920388D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C920388CB0>]}
[0m21:36:51.804062 [debug] [MainThread]: Flushing usage events
[0m21:36:53.069525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:41.464858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA5FD0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6878910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6EBBED0>]}


============================== 21:37:41.470087 | c5225a24-6408-4d9e-bf73-be32a1f69ea0 ==============================
[0m21:37:41.470087 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:37:41.471077 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:37:41.712426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6209F30>]}
[0m21:37:41.897992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8023DF0>]}
[0m21:37:41.900224 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:37:42.385832 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:37:42.573856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:42.574355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:42.587588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- snapshots.dw_northwind_metabase
[0m21:37:42.676803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8564D50>]}
[0m21:37:42.812905 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:37:42.817455 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:37:42.850920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA85C85F0>]}
[0m21:37:42.851989 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:37:42.852920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA816D8D0>]}
[0m21:37:42.855770 [info ] [MainThread]: 
[0m21:37:42.856432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:42.856930 [info ] [MainThread]: 
[0m21:37:42.857826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:42.863539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:37:42.983602 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:37:42.984368 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:37:42.985177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:43.066130 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.081 seconds
[0m21:37:43.068064 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:37:43.071600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:37:43.078995 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:37:43.079530 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:37:43.079945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:43.151802 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:37:43.152344 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:37:43.152781 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:37:43.162736 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m21:37:43.164785 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:37:43.165695 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:37:43.171800 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.172326 [debug] [MainThread]: On master: BEGIN
[0m21:37:43.172713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:43.237538 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m21:37:43.238058 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.238543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:37:43.250329 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m21:37:43.251866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA87EEC30>]}
[0m21:37:43.252435 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:43.253106 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.253521 [debug] [MainThread]: On master: BEGIN
[0m21:37:43.254255 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:37:43.254649 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.255046 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.255415 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.255948 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:43.256398 [debug] [MainThread]: On master: Close
[0m21:37:43.263800 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.264449 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.265036 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.265570 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.266258 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:37:43.267010 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:37:43.269371 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:37:43.267593 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:37:43.270263 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:37:43.270921 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.268435 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:37:43.271752 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:37:43.272248 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.282257 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.283537 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:37:43.284425 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.288701 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.289502 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.294162 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.298980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.299778 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.322098 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.361136 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.364683 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.365424 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.366524 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.371505 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.378820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.379882 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.380978 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.381555 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:37:43.382137 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:37:43.382816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:37:43.383722 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:37:43.384838 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.385509 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.386373 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:37:43.387219 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:37:43.387992 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:37:43.388729 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:43.487457 [debug] [Thread-3 (]: SQL status: BEGIN in 0.105 seconds
[0m21:37:43.488542 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:37:43.489610 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "northwind"."public"."customer"
  );
[0m21:37:43.491675 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.customer"
LINE 25: from "northwind"."public"."customer"
              ^

[0m21:37:43.492644 [debug] [Thread-2 (]: SQL status: BEGIN in 0.109 seconds
[0m21:37:43.493495 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: ROLLBACK
[0m21:37:43.494515 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:37:43.495769 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "sample_metabase_pg"."public"."orders" o
  );
[0m21:37:43.497062 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:37:43.500312 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.orders"
LINE 24: from "sample_metabase_pg"."public"."orders" o
              ^

[0m21:37:43.501391 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:37:43.502874 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:37:43.509182 [debug] [Thread-4 (]: SQL status: BEGIN in 0.121 seconds
[0m21:37:43.510262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m21:37:43.511263 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:37:43.512608 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:37:43.514190 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "northwind"."public"."orderdetail" od
  );
[0m21:37:43.515632 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "sample_metabase_pg"."public"."accounts" a
  );
[0m21:37:43.517962 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.orderdetail"
LINE 21: from "northwind"."public"."orderdetail" od
              ^

[0m21:37:43.518768 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sample_metabase_pg.public.accounts"
LINE 28: from "sample_metabase_pg"."public"."accounts" a
              ^

[0m21:37:43.519355 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: ROLLBACK
[0m21:37:43.520020 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: ROLLBACK
[0m21:37:43.521502 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:37:43.522961 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:37:43.545560 [debug] [Thread-4 (]: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:37:43.548291 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:37:43.552510 [debug] [Thread-1 (]: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:37:43.556960 [debug] [Thread-3 (]: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:37:43.558760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA86031D0>]}
[0m21:37:43.559325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA883E200>]}
[0m21:37:43.560690 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA88F6710>]}
[0m21:37:43.560198 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model dw_stg.stg_northwind_order_details ........ [[31mERROR[0m in 0.28s]
[0m21:37:43.561427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA6192210>]}
[0m21:37:43.562372 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.29s]
[0m21:37:43.564445 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:37:43.563410 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model dw_stg.stg_northwind_customers ............ [[31mERROR[0m in 0.29s]
[0m21:37:43.566359 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:37:43.567294 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.565383 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dw_stg.stg_metabase_accounts .............. [[31mERROR[0m in 0.27s]
[0m21:37:43.568625 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql.
[0m21:37:43.569592 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:37:43.571673 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:37:43.570665 [info ] [Thread-4 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:37:43.573679 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:37:43.574946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:37:43.576191 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql.
[0m21:37:43.576838 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.577691 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_accounts' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql.
[0m21:37:43.584394 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.588301 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.694172 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.696916 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.697987 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:37:43.698729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:37:43.802051 [debug] [Thread-4 (]: SQL status: BEGIN in 0.103 seconds
[0m21:37:43.803719 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:37:43.804941 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "northwind"."public"."salesorder" o
  );
[0m21:37:43.807102 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "northwind.public.salesorder"
LINE 25: from "northwind"."public"."salesorder" o
              ^

[0m21:37:43.807911 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:37:43.809072 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:37:43.820929 [debug] [Thread-4 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:37:43.822012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5225a24-6408-4d9e-bf73-be32a1f69ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8A83380>]}
[0m21:37:43.823178 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.25s]
[0m21:37:43.824812 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:37:43.825913 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:37:43.829164 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.830172 [debug] [MainThread]: On master: BEGIN
[0m21:37:43.831080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:43.936931 [debug] [MainThread]: SQL status: BEGIN in 0.106 seconds
[0m21:37:43.937533 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.938008 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:43.938429 [debug] [MainThread]: On master: COMMIT
[0m21:37:43.939170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:43.940005 [debug] [MainThread]: On master: Close
[0m21:37:43.941321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:43.942007 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:37:43.942658 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:37:43.943167 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:37:43.943692 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:37:43.944326 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:37:43.944912 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:37:43.945646 [info ] [MainThread]: 
[0m21:37:43.946612 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m21:37:43.948778 [debug] [MainThread]: Command end result
[0m21:37:43.994888 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:37:43.999687 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:37:44.014029 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:37:44.014940 [info ] [MainThread]: 
[0m21:37:44.015934 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:37:44.016732 [info ] [MainThread]: 
[0m21:37:44.018314 [error] [MainThread]: [31mFailure in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)[0m
[0m21:37:44.019553 [error] [MainThread]:   Database Error in model stg_northwind_order_details (models\staging\northwind\stg_northwind_order_details.sql)
  cross-database references are not implemented: "northwind.public.orderdetail"
  LINE 21: from "northwind"."public"."orderdetail" od
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:37:44.020518 [info ] [MainThread]: 
[0m21:37:44.021924 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_order_details.sql
[0m21:37:44.023059 [info ] [MainThread]: 
[0m21:37:44.023853 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:37:44.024541 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.orders"
  LINE 24: from "sample_metabase_pg"."public"."orders" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:37:44.025149 [info ] [MainThread]: 
[0m21:37:44.025780 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:37:44.026509 [info ] [MainThread]: 
[0m21:37:44.027569 [error] [MainThread]: [31mFailure in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)[0m
[0m21:37:44.028844 [error] [MainThread]:   Database Error in model stg_northwind_customers (models\staging\northwind\stg_northwind_customers.sql)
  cross-database references are not implemented: "northwind.public.customer"
  LINE 25: from "northwind"."public"."customer"
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:37:44.029934 [info ] [MainThread]: 
[0m21:37:44.030805 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_customers.sql
[0m21:37:44.031426 [info ] [MainThread]: 
[0m21:37:44.032090 [error] [MainThread]: [31mFailure in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)[0m
[0m21:37:44.033416 [error] [MainThread]:   Database Error in model stg_metabase_accounts (models\staging\metabase\stg_metabase_accounts.sql)
  cross-database references are not implemented: "sample_metabase_pg.public.accounts"
  LINE 28: from "sample_metabase_pg"."public"."accounts" a
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:37:44.034710 [info ] [MainThread]: 
[0m21:37:44.035711 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_accounts.sql
[0m21:37:44.036508 [info ] [MainThread]: 
[0m21:37:44.037364 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:37:44.038600 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  cross-database references are not implemented: "northwind.public.salesorder"
  LINE 25: from "northwind"."public"."salesorder" o
                ^
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:37:44.039408 [info ] [MainThread]: 
[0m21:37:44.040438 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:37:44.041290 [info ] [MainThread]: 
[0m21:37:44.042634 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m21:37:44.045652 [debug] [MainThread]: Command `dbt run` failed at 21:37:44.045369 after 2.74 seconds
[0m21:37:44.046336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8A5C3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8AAFA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEA8AAFA10>]}
[0m21:37:44.046981 [debug] [MainThread]: Flushing usage events
[0m21:37:45.166961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:58.544759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8825B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C882E58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88449BED0>]}


============================== 21:39:58.550411 | 0e92d187-5895-46c1-aed0-6e22a314815d ==============================
[0m21:39:58.550411 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:39:58.551279 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select staging', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:39:58.817223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8827E9F30>]}
[0m21:39:58.901550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884523DF0>]}
[0m21:39:58.902869 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:39:59.295496 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:39:59.497544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:39:59.499038 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\staging.yml
[0m21:40:00.319207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.dw
- snapshots.dw_northwind_metabase
[0m21:40:00.335475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884A65650>]}
[0m21:40:00.446447 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:40:00.449778 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:40:00.479002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884AC8410>]}
[0m21:40:00.479639 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:40:00.480329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8846DD8D0>]}
[0m21:40:00.482845 [info ] [MainThread]: 
[0m21:40:00.483809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:40:00.484402 [info ] [MainThread]: 
[0m21:40:00.485309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:00.492916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:40:00.592158 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:40:00.592842 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:40:00.593572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:00.663695 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.070 seconds
[0m21:40:00.665407 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:40:00.668053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:40:00.675481 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:40:00.675975 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:40:00.676355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:00.750126 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m21:40:00.750630 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:40:00.751061 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:40:00.761061 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m21:40:00.762770 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:40:00.763397 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:40:00.769532 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.770041 [debug] [MainThread]: On master: BEGIN
[0m21:40:00.770413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:00.838639 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m21:40:00.839168 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.839678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:40:00.850955 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m21:40:00.852539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884FE9A50>]}
[0m21:40:00.853091 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:00.853860 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.854259 [debug] [MainThread]: On master: BEGIN
[0m21:40:00.854999 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:40:00.855380 [debug] [MainThread]: On master: COMMIT
[0m21:40:00.855749 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:00.856117 [debug] [MainThread]: On master: COMMIT
[0m21:40:00.856711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:00.857177 [debug] [MainThread]: On master: Close
[0m21:40:00.866180 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:00.866780 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:00.867363 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:00.867901 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:00.868592 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:40:00.869335 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:40:00.871588 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:40:00.872350 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:40:00.872864 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:00.870134 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:40:00.873530 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:00.870750 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:40:00.885020 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:00.886066 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:40:00.891188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:00.892026 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:40:00.892801 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:00.893763 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:00.894436 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:00.903320 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:00.908863 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:00.909880 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:00.954659 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:00.959172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:00.960311 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:00.964872 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:00.966136 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:00.966898 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:00.967458 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:00.971709 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:00.972399 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:40:00.973092 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:40:00.973864 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:00.974605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:40:00.975227 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:40:00.975845 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:40:00.976791 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:00.977860 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:40:00.978855 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:40:00.980023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:40:01.056922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m21:40:01.057867 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.058930 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m21:40:01.068204 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m21:40:01.068983 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:40:01.069617 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    o.state                                  as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m21:40:01.072369 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column o.state does not exist
LINE 16:     o.state                                  as order_state,
             ^

[0m21:40:01.073169 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:40:01.074224 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:40:01.077770 [debug] [Thread-4 (]: SQL status: BEGIN in 0.100 seconds
[0m21:40:01.078686 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.079564 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m21:40:01.080498 [debug] [Thread-3 (]: SQL status: BEGIN in 0.100 seconds
[0m21:40:01.081182 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.081865 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m21:40:01.083661 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m21:40:01.092036 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.092659 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:40:01.093247 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m21:40:01.093758 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m21:40:01.097346 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.101107 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.101979 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m21:40:01.102782 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m21:40:01.103422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:40:01.122687 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:40:01.123374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m21:40:01.124063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m21:40:01.124621 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.126668 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:40:01.128506 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:40:01.129130 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:40:01.129681 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.130251 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.130991 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:40:01.131622 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:40:01.132661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:40:01.140427 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m21:40:01.141494 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m21:40:01.142048 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m21:40:01.148719 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:40:01.151646 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m21:40:01.154397 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m21:40:01.155015 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m21:40:01.156098 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:40:01.157039 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:40:01.157746 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m21:40:01.158349 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m21:40:01.162501 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:40:01.165835 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:40:01.166417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m21:40:01.167170 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m21:40:01.168255 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.state does not exist
  LINE 16:     o.state                                  as order_state,
               ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:40:01.171907 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:40:01.173727 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:40:01.174958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884E42E10>]}
[0m21:40:01.175896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8861BC520>]}
[0m21:40:01.176620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8861BC680>]}
[0m21:40:01.177330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88619BBB0>]}
[0m21:40:01.178317 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.28s]
[0m21:40:01.182504 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:40:01.183055 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.179410 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.29s]
[0m21:40:01.184747 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:40:01.180811 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.30s]
[0m21:40:01.186279 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:40:01.181714 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.31s]
[0m21:40:01.187535 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.state does not exist
  LINE 16:     o.state                                  as order_state,
               ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:40:01.188512 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:40:01.183973 [info ] [Thread-3 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:40:01.190665 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_customers, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:40:01.191572 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.197621 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.198965 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.202867 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.204525 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.205458 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:40:01.206731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:40:01.278913 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m21:40:01.279501 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:40:01.280065 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipvia                   as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m21:40:01.282048 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column o.shipvia does not exist
LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                             ^
HINT:  Perhaps you meant to reference the column "o.shipcity".

[0m21:40:01.282609 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: ROLLBACK
[0m21:40:01.283338 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:40:01.289473 [debug] [Thread-3 (]: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  column o.shipvia does not exist
  LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                               ^
  HINT:  Perhaps you meant to reference the column "o.shipcity".
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:40:01.290215 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e92d187-5895-46c1-aed0-6e22a314815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C884ADFAF0>]}
[0m21:40:01.291036 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model dw_stg.stg_northwind_orders ............... [[31mERROR[0m in 0.10s]
[0m21:40:01.292333 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:40:01.293256 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_northwind_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  column o.shipvia does not exist
  LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                               ^
  HINT:  Perhaps you meant to reference the column "o.shipcity".
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql.
[0m21:40:01.295241 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.295688 [debug] [MainThread]: On master: BEGIN
[0m21:40:01.296065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:01.362368 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m21:40:01.362883 [debug] [MainThread]: On master: COMMIT
[0m21:40:01.363316 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.363694 [debug] [MainThread]: On master: COMMIT
[0m21:40:01.364291 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:01.364733 [debug] [MainThread]: On master: Close
[0m21:40:01.365373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:01.365772 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:40:01.366134 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:40:01.366478 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:40:01.366861 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:40:01.367204 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m21:40:01.367548 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:40:01.368026 [info ] [MainThread]: 
[0m21:40:01.368815 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m21:40:01.370848 [debug] [MainThread]: Command end result
[0m21:40:01.403473 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:40:01.409046 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:40:01.417483 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:40:01.418120 [info ] [MainThread]: 
[0m21:40:01.418852 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:40:01.419601 [info ] [MainThread]: 
[0m21:40:01.420851 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:40:01.421800 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.state does not exist
  LINE 16:     o.state                                  as order_state,
               ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:40:01.422868 [info ] [MainThread]: 
[0m21:40:01.423914 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:40:01.424951 [info ] [MainThread]: 
[0m21:40:01.426024 [error] [MainThread]: [31mFailure in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)[0m
[0m21:40:01.426898 [error] [MainThread]:   Database Error in model stg_northwind_orders (models\staging\northwind\stg_northwind_orders.sql)
  column o.shipvia does not exist
  LINE 16:     'NORTHWIND_' || o.shipvia                   as shipper_n...
                               ^
  HINT:  Perhaps you meant to reference the column "o.shipcity".
  compiled code at target\run\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:40:01.427541 [info ] [MainThread]: 
[0m21:40:01.428201 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\northwind\stg_northwind_orders.sql
[0m21:40:01.428868 [info ] [MainThread]: 
[0m21:40:01.429766 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m21:40:01.431652 [debug] [MainThread]: Command `dbt run` failed at 21:40:01.431401 after 3.06 seconds
[0m21:40:01.432236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8862C2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C882E11970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8861FF410>]}
[0m21:40:01.432763 [debug] [MainThread]: Flushing usage events
[0m21:40:02.799721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:19.549357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355CCD0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355D578B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DBB8E10>]}


============================== 21:41:19.556505 | 411553cd-3353-47e8-b672-28cf53b7437c ==============================
[0m21:41:19.556505 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:41:19.557310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'invocation_command': 'dbt run --select staging', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:41:19.829943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355CF09F30>]}
[0m21:41:19.925225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DC3FDF0>]}
[0m21:41:19.926534 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:41:20.393926 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:41:20.629284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:41:20.630151 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m21:41:20.630731 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\northwind\stg_northwind_orders.sql
[0m21:41:21.294865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
- snapshots.dw_northwind_metabase
[0m21:41:21.314782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F268B50>]}
[0m21:41:21.470220 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:21.473730 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:21.506917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F2C4410>]}
[0m21:41:21.507809 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:41:21.508549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DE1D1D0>]}
[0m21:41:21.512079 [info ] [MainThread]: 
[0m21:41:21.512734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:21.513360 [info ] [MainThread]: 
[0m21:41:21.514423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:41:21.522245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:41:21.631135 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:41:21.631731 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:41:21.632187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:21.719411 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.087 seconds
[0m21:41:21.721458 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:41:21.724566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:41:21.732179 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:21.732711 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:41:21.733161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:21.805853 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m21:41:21.806421 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:21.806880 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:41:21.820078 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.013 seconds
[0m21:41:21.822764 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:41:21.823593 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:41:21.830336 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.830874 [debug] [MainThread]: On master: BEGIN
[0m21:41:21.831262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:21.908290 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m21:41:21.908864 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.909405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:41:21.923541 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m21:41:21.926326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F8401F0>]}
[0m21:41:21.927463 [debug] [MainThread]: On master: ROLLBACK
[0m21:41:21.928496 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.929174 [debug] [MainThread]: On master: BEGIN
[0m21:41:21.930339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:41:21.931095 [debug] [MainThread]: On master: COMMIT
[0m21:41:21.931824 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:21.932510 [debug] [MainThread]: On master: COMMIT
[0m21:41:21.933665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:21.934683 [debug] [MainThread]: On master: Close
[0m21:41:22.111555 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.113123 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.114191 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.115124 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.115941 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:41:22.117068 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:41:22.118724 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:41:22.122217 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:41:22.120612 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:41:22.123767 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:41:22.124908 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:41:22.125828 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.126690 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:41:22.127427 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.128525 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.143925 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.148998 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.157849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.165025 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.172867 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.175830 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.189122 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.290570 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.291383 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.293750 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.301626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.303182 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.312326 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.313664 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.315251 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:41:22.316422 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.317626 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:41:22.318898 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:41:22.320206 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.321635 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.322869 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:41:22.323963 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:41:22.325044 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:41:22.326492 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:22.327621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:22.435996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.118 seconds
[0m21:41:22.437242 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.438552 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m21:41:22.451893 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:41:22.466358 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.467502 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m21:41:22.468769 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m21:41:22.470325 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.471568 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m21:41:22.472809 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:41:22.474379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m21:41:22.475103 [debug] [Thread-2 (]: SQL status: BEGIN in 0.149 seconds
[0m21:41:22.481181 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.482352 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.483390 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:22.484719 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m21:41:22.486525 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m21:41:22.488021 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    cast(o.price as numeric(12,4))           as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m21:41:22.490349 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m21:41:22.495369 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.496196 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column o.price does not exist
LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                  ^

[0m21:41:22.497025 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m21:41:22.497727 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:41:22.498459 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: ROLLBACK
[0m21:41:22.515367 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m21:41:22.527559 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:22.528371 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m21:41:22.533352 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.534570 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:41:22.535690 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.541449 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.542169 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m21:41:22.543029 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:22.545373 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m21:41:22.547483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:22.550522 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:22.551546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:41:22.552384 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.553226 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m21:41:22.557386 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.558202 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:22.567642 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m21:41:22.568781 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m21:41:22.577311 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:22.578241 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m21:41:22.580312 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m21:41:22.581040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:41:22.584680 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m21:41:22.588281 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:22.589765 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:22.590539 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.591187 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m21:41:22.591824 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:22.594451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:41:22.595132 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m21:41:22.598721 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m21:41:22.599322 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m21:41:22.603485 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:41:22.604961 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:22.607050 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:41:22.607868 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m21:41:22.613168 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F496510>]}
[0m21:41:22.614039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F49B8B0>]}
[0m21:41:22.615108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:41:22.616608 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.49s]
[0m21:41:22.622205 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:41:22.618800 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.49s]
[0m21:41:22.623680 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:22.630860 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:22.632265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F9BC870>]}
[0m21:41:22.633731 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.635681 [debug] [Thread-2 (]: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.price does not exist
  LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                    ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:41:22.637481 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.51s]
[0m21:41:22.638888 [info ] [Thread-4 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:41:22.640089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F84CC50>]}
[0m21:41:22.641284 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:22.642305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:41:22.644425 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.643361 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model dw_stg.stg_metabase_orders ................ [[31mERROR[0m in 0.51s]
[0m21:41:22.650025 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.651652 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:22.653161 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.stg_metabase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.price does not exist
  LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                    ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql.
[0m21:41:22.656228 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.661905 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.663764 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.664736 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:41:22.665567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:41:22.756443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m21:41:22.757265 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.757986 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m21:41:22.772404 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m21:41:22.777664 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.778332 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m21:41:22.779613 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:22.781547 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:22.782213 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.782728 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:22.785157 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:41:22.788214 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m21:41:22.789265 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:22.789800 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m21:41:22.791052 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:41:22.793475 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:41:22.794517 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411553cd-3353-47e8-b672-28cf53b7437c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F92F930>]}
[0m21:41:22.795526 [info ] [Thread-4 (]: 5 of 5 OK created sql view model dw_stg.stg_northwind_orders ................... [[32mCREATE VIEW[0m in 0.15s]
[0m21:41:22.796728 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:22.799849 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:22.800738 [debug] [MainThread]: On master: BEGIN
[0m21:41:22.801513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:22.880303 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m21:41:22.880883 [debug] [MainThread]: On master: COMMIT
[0m21:41:22.881317 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:22.881726 [debug] [MainThread]: On master: COMMIT
[0m21:41:22.882333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:22.882787 [debug] [MainThread]: On master: Close
[0m21:41:22.883470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:22.884223 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:41:22.884742 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:41:22.885127 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:41:22.885585 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:41:22.886014 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:41:22.886385 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:41:22.886912 [info ] [MainThread]: 
[0m21:41:22.887425 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m21:41:22.889838 [debug] [MainThread]: Command end result
[0m21:41:22.927322 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:22.931632 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:22.942125 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:41:22.942828 [info ] [MainThread]: 
[0m21:41:22.943383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:41:22.944132 [info ] [MainThread]: 
[0m21:41:22.945301 [error] [MainThread]: [31mFailure in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)[0m
[0m21:41:22.946671 [error] [MainThread]:   Database Error in model stg_metabase_orders (models\staging\metabase\stg_metabase_orders.sql)
  column o.price does not exist
  LINE 20:     cast(o.price as numeric(12,4))           as unit_price,
                    ^
  compiled code at target\run\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:41:22.947954 [info ] [MainThread]: 
[0m21:41:22.949450 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\staging\metabase\stg_metabase_orders.sql
[0m21:41:22.951271 [info ] [MainThread]: 
[0m21:41:22.952492 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m21:41:22.956087 [debug] [MainThread]: Command `dbt run` failed at 21:41:22.955524 after 3.60 seconds
[0m21:41:22.958363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F9C0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DAC77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F326270>]}
[0m21:41:22.959578 [debug] [MainThread]: Flushing usage events
[0m21:41:24.273091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:40.248132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E808E0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82254B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82898E10>]}


============================== 21:41:40.253982 | a3817bc2-42fa-428c-a625-83168ad5ebe6 ==============================
[0m21:41:40.253982 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:41:40.254779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:41:40.531901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E80B19F30>]}
[0m21:41:40.627069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8291FDF0>]}
[0m21:41:40.628560 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:41:41.089890 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:41:41.318849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:41:41.319830 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m21:41:42.057707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.dw_northwind_metabase.intermediate
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.dw
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- snapshots.dw_northwind_metabase
[0m21:41:42.081166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82E68950>]}
[0m21:41:42.206746 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:42.212150 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:42.243608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82EC7110>]}
[0m21:41:42.244405 [info ] [MainThread]: Found 5 models, 13 data tests, 5 sources, 449 macros
[0m21:41:42.244978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82ADC670>]}
[0m21:41:42.248422 [info ] [MainThread]: 
[0m21:41:42.249154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:42.249985 [info ] [MainThread]: 
[0m21:41:42.251068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:41:42.258376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m21:41:42.365497 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m21:41:42.366027 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m21:41:42.366428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:42.455186 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.089 seconds
[0m21:41:42.457291 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m21:41:42.461407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m21:41:42.470754 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:42.471691 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m21:41:42.472444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:42.549040 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m21:41:42.549698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m21:41:42.550221 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m21:41:42.561880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m21:41:42.563734 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m21:41:42.564503 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m21:41:42.571281 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.571787 [debug] [MainThread]: On master: BEGIN
[0m21:41:42.572223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:42.645550 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m21:41:42.646090 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.646610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:41:42.660044 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m21:41:42.661843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E834282C0>]}
[0m21:41:42.662442 [debug] [MainThread]: On master: ROLLBACK
[0m21:41:42.663174 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.663614 [debug] [MainThread]: On master: BEGIN
[0m21:41:42.664441 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:41:42.664849 [debug] [MainThread]: On master: COMMIT
[0m21:41:42.665251 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:42.665647 [debug] [MainThread]: On master: COMMIT
[0m21:41:42.666198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:42.666650 [debug] [MainThread]: On master: Close
[0m21:41:42.674468 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:42.675811 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:42.676858 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:42.677697 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:42.678634 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m21:41:42.679538 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m21:41:42.680686 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m21:41:42.681774 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m21:41:42.682930 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m21:41:42.683970 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m21:41:42.684729 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m21:41:42.685471 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m21:41:42.686321 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:42.686942 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:42.687581 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:42.688334 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:42.699364 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.704235 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.709380 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.715738 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.718172 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:42.719056 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:42.719896 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:42.739543 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:42.804234 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.808612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.814988 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.822686 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.824636 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.826274 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.827242 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m21:41:42.828273 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m21:41:42.829328 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:41:42.830384 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.831257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:42.831868 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.832715 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m21:41:42.833560 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m21:41:42.834200 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:41:42.834847 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:42.922604 [debug] [Thread-4 (]: SQL status: BEGIN in 0.093 seconds
[0m21:41:42.923659 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.924458 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m21:41:42.934056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m21:41:42.935035 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.935831 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:41:42.936545 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    cast(a.created_at as timestamp)        as created_at,
    cast(a.trial_ends_at as timestamp)     as trial_ends_at,
    cast(a.canceled_at as timestamp)       as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m21:41:42.946614 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.947432 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m21:41:42.948078 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m21:41:42.948677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m21:41:42.949201 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:42.949962 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:42.950568 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:42.951161 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m21:41:42.951917 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    cast(o.created_at as timestamp)          as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m21:41:42.956964 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:42.957973 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m21:41:42.959269 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:41:42.960333 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:42.964590 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:42.985372 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m21:41:42.986371 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m21:41:42.995677 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:42.996341 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m21:41:43.001044 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:43.004777 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.005430 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:43.006143 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m21:41:43.006744 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m21:41:43.007294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:43.007940 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m21:41:43.013393 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:43.014031 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m21:41:43.014567 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:41:43.015252 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m21:41:43.020358 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.021027 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m21:41:43.022889 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m21:41:43.023563 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m21:41:43.033038 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m21:41:43.033680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m21:41:43.034239 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:43.042487 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m21:41:43.043440 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m21:41:43.045646 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:43.046308 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m21:41:43.047081 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m21:41:43.049197 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:43.049786 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:43.050590 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.051264 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m21:41:43.051848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:41:43.052381 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m21:41:43.052894 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:43.056396 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m21:41:43.057009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:41:43.061923 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m21:41:43.062800 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:41:43.063941 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m21:41:43.066775 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m21:41:43.070581 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m21:41:43.073039 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m21:41:43.074284 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m21:41:43.075726 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m21:41:43.076914 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m21:41:43.077765 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m21:41:43.078522 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:43.079488 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8306A5D0>]}
[0m21:41:43.082256 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m21:41:43.082865 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:41:43.084244 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m21:41:43.083709 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.39s]
[0m21:41:43.087246 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m21:41:43.088384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E8309FA10>]}
[0m21:41:43.091387 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m21:41:43.093193 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m21:41:43.095141 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.40s]
[0m21:41:43.096720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E831A13B0>]}
[0m21:41:43.098069 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.099488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E834E28D0>]}
[0m21:41:43.100948 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m21:41:43.102361 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.41s]
[0m21:41:43.103630 [info ] [Thread-4 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m21:41:43.107001 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m21:41:43.105147 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.42s]
[0m21:41:43.108126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_northwind_order_details, now model.dw_northwind_metabase.stg_northwind_orders)
[0m21:41:43.109712 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m21:41:43.110403 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.115124 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.116665 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.122384 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.124192 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.125093 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m21:41:43.126021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:41:43.206791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.081 seconds
[0m21:41:43.207711 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.208638 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m21:41:43.220225 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:41:43.224691 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.225526 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m21:41:43.227298 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:43.231149 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.231726 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m21:41:43.232968 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:43.235071 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:43.235616 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.236096 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m21:41:43.238287 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:41:43.242185 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m21:41:43.243689 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m21:41:43.244375 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m21:41:43.247399 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:43.249751 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m21:41:43.250683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3817bc2-42fa-428c-a625-83168ad5ebe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E834A88A0>]}
[0m21:41:43.251624 [info ] [Thread-4 (]: 5 of 5 OK created sql view model dw_stg.stg_northwind_orders ................... [[32mCREATE VIEW[0m in 0.14s]
[0m21:41:43.252605 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m21:41:43.255701 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:43.256456 [debug] [MainThread]: On master: BEGIN
[0m21:41:43.257054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:43.336724 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m21:41:43.337322 [debug] [MainThread]: On master: COMMIT
[0m21:41:43.337742 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:43.338181 [debug] [MainThread]: On master: COMMIT
[0m21:41:43.338926 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:43.339429 [debug] [MainThread]: On master: Close
[0m21:41:43.340129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:43.340558 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m21:41:43.340996 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m21:41:43.341367 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m21:41:43.341961 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m21:41:43.342678 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m21:41:43.343530 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m21:41:43.344376 [info ] [MainThread]: 
[0m21:41:43.344993 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m21:41:43.347889 [debug] [MainThread]: Command end result
[0m21:41:43.385581 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m21:41:43.391561 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m21:41:43.402097 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m21:41:43.402803 [info ] [MainThread]: 
[0m21:41:43.403553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:43.404245 [info ] [MainThread]: 
[0m21:41:43.405421 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:41:43.407884 [debug] [MainThread]: Command `dbt run` succeeded at 21:41:43.407598 after 3.34 seconds
[0m21:41:43.408923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E80A027B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82F2BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E83507B30>]}
[0m21:41:43.410155 [debug] [MainThread]: Flushing usage events
[0m21:41:44.838395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:33.130760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249AE9B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0258B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0898E10>]}


============================== 22:36:33.150061 | 6c4702f6-4380-48e9-bf1a-79208a4a5cbd ==============================
[0m22:36:33.150061 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:36:33.151910 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'printer_width': '80', 'target_path': 'None'}
[0m22:36:33.760171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249AEBE9F30>]}
[0m22:36:33.827454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B090FDF0>]}
[0m22:36:33.830483 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:36:34.442258 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:36:35.629329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m22:36:35.630025 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\fact_sales.sql
[0m22:36:35.630466 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\intermediate\int_customers.sql
[0m22:36:35.630877 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://snapshots\customers_snapshot.sql
[0m22:36:35.631468 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dw.yml
[0m22:36:35.632010 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\intermediate\intermediate.yml
[0m22:36:35.632598 [debug] [MainThread]: Partial parsing: added file: dw_northwind_metabase://models\dw\dim_customer.sql
[0m22:36:36.463397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
[0m22:36:36.481334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0E6B150>]}
[0m22:36:36.613154 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:36:36.618772 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:36:36.911934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B109A030>]}
[0m22:36:36.913259 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:36:36.914345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B0B46B30>]}
[0m22:36:36.921499 [info ] [MainThread]: 
[0m22:36:36.922250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:36:36.922972 [info ] [MainThread]: 
[0m22:36:36.924069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:36.925894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:36:41.657787 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:36:41.658727 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:36:41.659413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.842454 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.183 seconds
[0m22:36:41.845257 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:36:41.856739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:36:41.869430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:36:41.868066 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:36:41.874884 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:36:41.875773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:36:41.876483 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:36:41.877995 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:36:41.881388 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:36:41.881864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.882225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.882584 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:36:41.883271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:41.973451 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m22:36:41.974065 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m22:36:41.974472 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:36:41.974925 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:36:41.975529 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:36:41.976041 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:36:41.976420 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m22:36:41.977021 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:36:41.977434 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:36:41.991453 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m22:36:41.992108 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m22:36:41.992559 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m22:36:41.994242 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:36:41.996018 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:36:41.998221 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:36:41.999239 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:36:41.999896 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:36:42.000524 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:36:42.011508 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.011995 [debug] [MainThread]: On master: BEGIN
[0m22:36:42.012495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:42.076442 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m22:36:42.076858 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.077234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:36:42.094111 [debug] [MainThread]: SQL status: SELECT 5 in 0.016 seconds
[0m22:36:42.095478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B141AB60>]}
[0m22:36:42.095985 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:42.096541 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.096923 [debug] [MainThread]: On master: BEGIN
[0m22:36:42.097606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:36:42.097995 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.098560 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.099071 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.099722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:36:42.100169 [debug] [MainThread]: On master: Close
[0m22:36:42.111615 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.112263 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m22:36:42.113087 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m22:36:42.114051 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.126084 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.215396 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:36:42.215984 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m22:36:42.216508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:42.289070 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_stg.int_customers" does not exist
LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
              ^

[0m22:36:42.289747 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m22:36:42.486917 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  relation "dw_stg.int_customers" does not exist
  LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
                ^
[0m22:36:42.491559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4702f6-4380-48e9-bf1a-79208a4a5cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B1216E10>]}
[0m22:36:42.492987 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.customers_snapshot ......................... [[31mERROR[0m in 0.37s]
[0m22:36:42.493909 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:36:42.494753 [debug] [Thread-7 (]: Marking all children of 'snapshot.dw_northwind_metabase.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  relation "dw_stg.int_customers" does not exist
  LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
                ^.
[0m22:36:42.497137 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.497583 [debug] [MainThread]: On master: BEGIN
[0m22:36:42.497942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:42.558380 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m22:36:42.558806 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.559144 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:42.559432 [debug] [MainThread]: On master: COMMIT
[0m22:36:42.559889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:36:42.560206 [debug] [MainThread]: On master: Close
[0m22:36:42.560716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:42.561043 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:36:42.561328 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:36:42.561628 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:36:42.561922 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:36:42.562228 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m22:36:42.562608 [info ] [MainThread]: 
[0m22:36:42.563046 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m22:36:42.564031 [debug] [MainThread]: Command end result
[0m22:36:42.597699 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:36:42.601394 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:36:42.609072 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:36:42.609520 [info ] [MainThread]: 
[0m22:36:42.610010 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:36:42.610592 [info ] [MainThread]: 
[0m22:36:42.611536 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m22:36:42.612207 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  relation "dw_stg.int_customers" does not exist
  LINE 45: from "dw_northwind_metabase"."dw_stg"."int_customers"
                ^
[0m22:36:42.612823 [info ] [MainThread]: 
[0m22:36:42.613429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:36:42.615348 [debug] [MainThread]: Command `dbt snapshot` failed at 22:36:42.615081 after 9.67 seconds
[0m22:36:42.615957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B15A1FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B1627ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249B16276B0>]}
[0m22:36:42.616491 [debug] [MainThread]: Flushing usage events
[0m22:36:43.996475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:01.297044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A70B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A7958B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A7F98E10>]}


============================== 22:37:01.303677 | a2cece7c-b3d0-45f7-8659-0c7cf869ba86 ==============================
[0m22:37:01.303677 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:37:01.305098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --select intermediate', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:37:01.621705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A72E9F30>]}
[0m22:37:01.707018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A901FDF0>]}
[0m22:37:01.708951 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:37:02.203358 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:37:02.486167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:02.489289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:02.508249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m22:37:02.637939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A931F350>]}
[0m22:37:02.826655 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:02.832929 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:02.876043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A95C4C80>]}
[0m22:37:02.877115 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:37:02.877929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A91690F0>]}
[0m22:37:02.881718 [info ] [MainThread]: 
[0m22:37:02.882417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:02.883067 [info ] [MainThread]: 
[0m22:37:02.884048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:02.885885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:37:03.039125 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:37:03.039561 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:37:03.039883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.098347 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.058 seconds
[0m22:37:03.099927 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:37:03.106473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:37:03.113452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:37:03.118054 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:03.120522 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:03.121123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:37:03.121593 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:37:03.122404 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:37:03.124087 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:03.124469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.124818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.125172 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:37:03.125881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:03.187265 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m22:37:03.187689 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:03.188026 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:37:03.190580 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m22:37:03.191201 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:03.191734 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:37:03.198223 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m22:37:03.200328 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:37:03.201034 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:37:03.203713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:37:03.205261 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:37:03.205866 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:37:03.295305 [debug] [ThreadPool]: SQL status: BEGIN in 0.170 seconds
[0m22:37:03.295983 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:03.296502 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:37:03.305919 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m22:37:03.307254 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:37:03.307786 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:37:03.314829 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.315268 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.315621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:03.370666 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m22:37:03.371046 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.371396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:37:03.382094 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:37:03.384201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9A28A10>]}
[0m22:37:03.384928 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:03.385610 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.386064 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.386872 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:03.387358 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.387824 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.388266 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.388860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:03.389330 [debug] [MainThread]: On master: Close
[0m22:37:03.395348 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m22:37:03.396787 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m22:37:03.398129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m22:37:03.398872 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m22:37:03.414509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m22:37:03.421777 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m22:37:03.474260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m22:37:03.477669 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:03.478734 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m22:37:03.479511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:03.537567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m22:37:03.538283 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:03.539089 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
)
select * from northwind
union all
select * from metabase
;
  );
[0m22:37:03.542472 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 67: ;
         ^

[0m22:37:03.542954 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: ROLLBACK
[0m22:37:03.543733 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m22:37:03.557731 [debug] [Thread-1 (]: Database Error in model int_customers (models\intermediate\int_customers.sql)
  syntax error at or near ";"
  LINE 67: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\intermediate\int_customers.sql
[0m22:37:03.561122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2cece7c-b3d0-45f7-8659-0c7cf869ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A96CB950>]}
[0m22:37:03.562457 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dw_stg.int_customers ...................... [[31mERROR[0m in 0.16s]
[0m22:37:03.563944 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m22:37:03.565102 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.int_customers' to be skipped because of status 'error'.  Reason: Database Error in model int_customers (models\intermediate\int_customers.sql)
  syntax error at or near ";"
  LINE 67: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\intermediate\int_customers.sql.
[0m22:37:03.568012 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.568668 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.569157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:03.631550 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m22:37:03.632141 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.632614 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.633080 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.633783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:03.634303 [debug] [MainThread]: On master: Close
[0m22:37:03.635131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:03.635693 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:37:03.636112 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:37:03.636521 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:37:03.637057 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:37:03.637560 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m22:37:03.638107 [info ] [MainThread]: 
[0m22:37:03.638738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m22:37:03.640016 [debug] [MainThread]: Command end result
[0m22:37:03.774539 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:03.779182 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:03.790735 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:37:03.791589 [info ] [MainThread]: 
[0m22:37:03.792444 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:37:03.793402 [info ] [MainThread]: 
[0m22:37:03.794352 [error] [MainThread]: [31mFailure in model int_customers (models\intermediate\int_customers.sql)[0m
[0m22:37:03.795247 [error] [MainThread]:   Database Error in model int_customers (models\intermediate\int_customers.sql)
  syntax error at or near ";"
  LINE 67: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\intermediate\int_customers.sql
[0m22:37:03.796156 [info ] [MainThread]: 
[0m22:37:03.796989 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\intermediate\int_customers.sql
[0m22:37:03.797720 [info ] [MainThread]: 
[0m22:37:03.798402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:03.800489 [debug] [MainThread]: Command `dbt run` failed at 22:37:03.800199 after 2.65 seconds
[0m22:37:03.801257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A96B7B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9AAE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9AAE850>]}
[0m22:37:03.801929 [debug] [MainThread]: Flushing usage events
[0m22:37:05.313436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:18.367560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3674B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F367D58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369398E10>]}


============================== 22:37:18.373517 | 3a30c182-0104-4599-82de-cd0a457ce764 ==============================
[0m22:37:18.373517 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:37:18.374184 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select intermediate', 'printer_width': '80', 'target_path': 'None'}
[0m22:37:18.610546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3676E9F30>]}
[0m22:37:18.688399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F36941FDF0>]}
[0m22:37:18.689648 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:37:19.296016 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:37:19.589175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:37:19.590374 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\intermediate\int_customers.sql
[0m22:37:20.274950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2c
[0m22:37:20.295776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F36998DE50>]}
[0m22:37:20.461982 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:20.465297 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:20.542291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3699C7980>]}
[0m22:37:20.543399 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:37:20.544095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3695D9C50>]}
[0m22:37:20.547669 [info ] [MainThread]: 
[0m22:37:20.548620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:20.549402 [info ] [MainThread]: 
[0m22:37:20.550467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:20.552609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:37:20.721594 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:37:20.722254 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:37:20.722712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.804432 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.082 seconds
[0m22:37:20.807157 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:37:20.815449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:37:20.824274 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:20.825436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:37:20.826607 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:37:20.831368 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:20.832459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:37:20.833133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.833950 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:37:20.837811 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:20.838960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.839769 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:37:20.840833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:20.944314 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m22:37:20.944868 [debug] [ThreadPool]: SQL status: BEGIN in 0.104 seconds
[0m22:37:20.945345 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:20.945788 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m22:37:20.946276 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:20.946792 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:37:20.947338 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:20.948020 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:37:20.948867 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:37:20.961783 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m22:37:20.962400 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m22:37:20.964098 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:37:20.964606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m22:37:20.966751 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:37:20.969345 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:37:20.970314 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:37:20.971319 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:37:20.972333 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:37:20.983348 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:20.983841 [debug] [MainThread]: On master: BEGIN
[0m22:37:20.984248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:21.175506 [debug] [MainThread]: SQL status: BEGIN in 0.191 seconds
[0m22:37:21.176227 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.177031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:37:21.194145 [debug] [MainThread]: SQL status: SELECT 5 in 0.016 seconds
[0m22:37:21.196759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369E746D0>]}
[0m22:37:21.197678 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:21.198760 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.199452 [debug] [MainThread]: On master: BEGIN
[0m22:37:21.200581 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:21.201682 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.203396 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.204703 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.205896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:21.206900 [debug] [MainThread]: On master: Close
[0m22:37:21.215239 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m22:37:21.216328 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m22:37:21.217420 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m22:37:21.219840 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m22:37:21.253715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m22:37:21.257150 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m22:37:21.346026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m22:37:21.347834 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.348867 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m22:37:21.349439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:21.417955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m22:37:21.418987 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.419689 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
)
select * from northwind
union all
select * from metabase
  );
[0m22:37:21.475829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m22:37:21.485065 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.485967 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m22:37:21.489144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:37:21.510367 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:37:21.511033 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.511545 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:37:21.566399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.054 seconds
[0m22:37:21.578946 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m22:37:21.588051 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:37:21.588860 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m22:37:21.590705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:37:21.593720 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m22:37:21.597171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a30c182-0104-4599-82de-cd0a457ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369A36C90>]}
[0m22:37:21.598414 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.38s]
[0m22:37:21.599740 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m22:37:21.602756 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.603556 [debug] [MainThread]: On master: BEGIN
[0m22:37:21.604204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:21.683648 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m22:37:21.684154 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.684608 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.684989 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.685862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:21.686400 [debug] [MainThread]: On master: Close
[0m22:37:21.687193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:21.687616 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:37:21.688126 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:37:21.688567 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:37:21.689008 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:37:21.689970 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m22:37:21.690633 [info ] [MainThread]: 
[0m22:37:21.691233 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m22:37:21.692642 [debug] [MainThread]: Command end result
[0m22:37:21.731789 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:21.736343 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:21.746420 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:37:21.746946 [info ] [MainThread]: 
[0m22:37:21.747664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:21.748320 [info ] [MainThread]: 
[0m22:37:21.749378 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:21.751968 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:21.751453 after 3.54 seconds
[0m22:37:21.752875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369F75D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369A47BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F369A444B0>]}
[0m22:37:21.753538 [debug] [MainThread]: Flushing usage events
[0m22:37:22.925091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:30.674783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3D4B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3DD58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F398E10>]}


============================== 22:37:30.680449 | 91bd579d-076a-4302-a882-ba8f2e9efc4b ==============================
[0m22:37:30.680449 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:37:30.681477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:37:31.010305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3D6E9F30>]}
[0m22:37:31.164192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F40FDF0>]}
[0m22:37:31.166423 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:37:31.797362 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:37:32.065198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:32.066245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:32.076205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
[0m22:37:32.154371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F72B350>]}
[0m22:37:32.305043 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:32.311949 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:32.360674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F9D4AA0>]}
[0m22:37:32.362817 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:37:32.364370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3F9D0AD0>]}
[0m22:37:32.369211 [info ] [MainThread]: 
[0m22:37:32.369976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:32.370769 [info ] [MainThread]: 
[0m22:37:32.372258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:32.374898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:37:32.533176 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:37:32.533707 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:37:32.534105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.618010 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.084 seconds
[0m22:37:32.619744 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:37:32.628070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:37:32.636148 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:32.636860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:37:32.637364 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:37:32.641077 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:32.642245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:37:32.642948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.644419 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:37:32.647251 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:32.648055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.648563 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:37:32.649353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:32.736293 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m22:37:32.737158 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:37:32.738004 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:37:32.740036 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m22:37:32.741305 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:37:32.742277 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:37:32.746329 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m22:37:32.747277 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:37:32.748063 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:37:32.752082 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m22:37:32.754171 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:37:32.755014 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:37:32.756357 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m22:37:32.760395 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:37:32.761682 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:37:32.763289 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m22:37:32.766848 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:37:32.767576 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:37:32.776399 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.776958 [debug] [MainThread]: On master: BEGIN
[0m22:37:32.777446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:32.857718 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m22:37:32.858470 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.859047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:37:32.872405 [debug] [MainThread]: SQL status: SELECT 7 in 0.013 seconds
[0m22:37:32.876347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FDB8E20>]}
[0m22:37:32.877011 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:32.877869 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.878359 [debug] [MainThread]: On master: BEGIN
[0m22:37:32.879290 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:32.880040 [debug] [MainThread]: On master: COMMIT
[0m22:37:32.880662 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:32.881333 [debug] [MainThread]: On master: COMMIT
[0m22:37:32.882377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:32.882990 [debug] [MainThread]: On master: Close
[0m22:37:32.894712 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:32.896272 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m22:37:32.898134 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m22:37:32.899198 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:32.916944 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:33.054620 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.055467 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m22:37:33.057121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:33.136506 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.080 seconds
[0m22:37:33.141815 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.142547 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m22:37:33.143962 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:37:33.145139 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.147872 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.149123 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m22:37:33.150752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:37:33.151909 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:37:33.152853 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      
  
    

  create  table "dw_northwind_metabase"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



  );
  
  
[0m22:37:33.485137 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"

[0m22:37:33.485795 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: ROLLBACK
[0m22:37:33.486804 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m22:37:33.505894 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"
  compiled code at target\run\dw_northwind_metabase\snapshots\customers_snapshot.sql
[0m22:37:33.512298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91bd579d-076a-4302-a882-ba8f2e9efc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FAD3E90>]}
[0m22:37:33.514288 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.customers_snapshot ......................... [[31mERROR[0m in 0.61s]
[0m22:37:33.515712 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:37:33.516776 [debug] [Thread-7 (]: Marking all children of 'snapshot.dw_northwind_metabase.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"
  compiled code at target\run\dw_northwind_metabase\snapshots\customers_snapshot.sql.
[0m22:37:33.519857 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:33.520426 [debug] [MainThread]: On master: BEGIN
[0m22:37:33.520907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:33.604276 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m22:37:33.604812 [debug] [MainThread]: On master: COMMIT
[0m22:37:33.605229 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:33.605732 [debug] [MainThread]: On master: COMMIT
[0m22:37:33.607336 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:37:33.608768 [debug] [MainThread]: On master: Close
[0m22:37:33.609907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:33.610497 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:37:33.611104 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:37:33.611637 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:37:33.612150 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:37:33.612632 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m22:37:33.613063 [info ] [MainThread]: 
[0m22:37:33.613555 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m22:37:33.614997 [debug] [MainThread]: Command end result
[0m22:37:33.734353 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:37:33.738401 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:37:33.749272 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:37:33.749776 [info ] [MainThread]: 
[0m22:37:33.750479 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:37:33.751251 [info ] [MainThread]: 
[0m22:37:33.752677 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m22:37:33.753777 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  invalid input syntax for type timestamp: "setembro 15, 2020, 4:11 PM"
  compiled code at target\run\dw_northwind_metabase\snapshots\customers_snapshot.sql
[0m22:37:33.754618 [info ] [MainThread]: 
[0m22:37:33.755391 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:33.759219 [debug] [MainThread]: Command `dbt snapshot` failed at 22:37:33.758957 after 3.24 seconds
[0m22:37:33.759815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FAC7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FB42D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3FB428F0>]}
[0m22:37:33.760325 [debug] [MainThread]: Flushing usage events
[0m22:37:34.924127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:47.636299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23D9D0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23F358B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23F998E10>]}


============================== 22:46:47.645213 | da51f5ed-e024-42b9-a848-3a83d0dfc364 ==============================
[0m22:46:47.645213 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:46:47.646262 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m22:46:48.024097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23DC09F30>]}
[0m22:46:48.123488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FA1FDF0>]}
[0m22:46:48.132159 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:46:48.650422 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:46:48.929845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:46:48.930674 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m22:46:48.931194 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_accounts.sql
[0m22:46:49.590298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
[0m22:46:49.618026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FF98B50>]}
[0m22:46:49.830169 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:46:49.841125 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:46:49.979670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FFC4AA0>]}
[0m22:46:49.980729 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:46:49.981451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23FBDEC10>]}
[0m22:46:49.987547 [info ] [MainThread]: 
[0m22:46:49.988807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:49.990149 [info ] [MainThread]: 
[0m22:46:49.991659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:50.051239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:46:50.371783 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:46:50.373386 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:46:50.374474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.616864 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.242 seconds
[0m22:46:50.618284 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:46:50.620837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:46:50.628799 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:46:50.629408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:46:50.629806 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:46:50.631671 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:46:50.632528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.633004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:46:50.633456 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:46:50.635438 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:46:50.635940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.636353 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:46:50.636885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.720019 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m22:46:50.721117 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:46:50.722317 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:46:50.728242 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m22:46:50.729350 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:46:50.730342 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:46:50.739266 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m22:46:50.740378 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:46:50.741325 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:46:50.742225 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m22:46:50.745209 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:46:50.746774 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:46:50.747829 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m22:46:50.751050 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:46:50.752451 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:46:50.759953 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m22:46:50.762986 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:46:50.764363 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:46:50.781234 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.782228 [debug] [MainThread]: On master: BEGIN
[0m22:46:50.782984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:50.905389 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m22:46:50.906547 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.907524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:46:50.931130 [debug] [MainThread]: SQL status: SELECT 7 in 0.022 seconds
[0m22:46:50.934041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24047CD50>]}
[0m22:46:50.934786 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:50.935597 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.936170 [debug] [MainThread]: On master: BEGIN
[0m22:46:50.937147 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:46:50.937914 [debug] [MainThread]: On master: COMMIT
[0m22:46:50.939766 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:50.941205 [debug] [MainThread]: On master: COMMIT
[0m22:46:50.942414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:46:50.943259 [debug] [MainThread]: On master: Close
[0m22:46:50.955026 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:50.957137 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:50.958548 [debug] [Thread-3 (]: Began running node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:50.959394 [debug] [Thread-4 (]: Began running node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:50.960488 [info ] [Thread-1 (]: 1 of 5 START sql view model dw_stg.stg_metabase_accounts ....................... [RUN]
[0m22:46:50.962546 [info ] [Thread-2 (]: 2 of 5 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m22:46:50.964128 [info ] [Thread-3 (]: 3 of 5 START sql view model dw_stg.stg_northwind_customers ..................... [RUN]
[0m22:46:50.966038 [info ] [Thread-4 (]: 4 of 5 START sql view model dw_stg.stg_northwind_order_details ................. [RUN]
[0m22:46:50.969648 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_accounts'
[0m22:46:50.971046 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m22:46:50.973653 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_customers'
[0m22:46:50.975526 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_northwind_order_details'
[0m22:46:50.977161 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:50.978838 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:50.980345 [debug] [Thread-3 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:50.981978 [debug] [Thread-4 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:50.994521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.000567 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.011974 [debug] [Thread-4 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.015943 [debug] [Thread-3 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.023282 [debug] [Thread-3 (]: Began executing node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:51.074004 [debug] [Thread-4 (]: Began executing node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:51.077064 [debug] [Thread-3 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.077605 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:51.081650 [debug] [Thread-4 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.086605 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.087319 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:51.093275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.094510 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.095313 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: BEGIN
[0m22:46:51.096226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:51.097691 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.098648 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.099325 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.099828 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: BEGIN
[0m22:46:51.100445 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m22:46:51.101054 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: BEGIN
[0m22:46:51.101616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:51.102282 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:46:51.102958 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:46:51.168499 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m22:46:51.169179 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.169897 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp"
    
    
  as (
    

-- Normaliza clientes B2B da base Northwind e gera a chave natural (customer_nk).
select
    'NORTHWIND'                               as source_system,
    custid                                    as source_customer_id,
    'NORTHWIND_' || custid                    as customer_nk,
    companyname                               as customer_name,
    contactname                               as contact_name,
    contacttitle                              as contact_title,
    address                                   as address,
    city                                      as city,
    coalesce(nullif(region, ''), 'N/A')       as region,
    country                                   as country,
    postalcode                                as postal_code,
    phone                                     as phone,
    fax                                       as fax,
    current_timestamp                         as dw_load_ts
from "dw_northwind_metabase"."public"."customer"
  );
[0m22:46:51.178085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m22:46:51.178948 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.179761 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp"
    
    
  as (
    

-- Contas/Clientes B2C/SaaS com atributos de plano, segmento e datas relevantes.
select
    'METABASE'                             as source_system,
    a.id                                   as source_customer_id,
    'METABASE_' || a.id                    as customer_nk,
    a.email                                as customer_name,
    a.first_name                           as first_name,
    a.last_name                            as last_name,
    upper(coalesce(a.country, 'N/A'))      as country,
    a.plan                                 as plan,
    a.source                               as segment,
    cast(a.seats as integer)               as seats,
    a.trial_converted                      as trial_converted,
    a.active_subscription                  as active_subscription,
    a.legacy_plan                          as legacy_plan,
    case
        when a.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.created_at::timestamp
        else null
    end                                   as created_at,
    case
        when a.trial_ends_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.trial_ends_at::timestamp
        else null
    end                                   as trial_ends_at,
    case
        when a.canceled_at ~ '^\d{4}-\d{2}-\d{2}'
            then a.canceled_at::timestamp
        else null
    end                                   as canceled_at,
    current_timestamp                      as dw_load_ts
from "dw_northwind_metabase"."public"."accounts" a
  );
[0m22:46:51.183872 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m22:46:51.184624 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.185175 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(5,4))     as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m22:46:51.187543 [debug] [Thread-4 (]: SQL status: BEGIN in 0.084 seconds
[0m22:46:51.188583 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m22:46:51.189468 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.200927 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.201538 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m22:46:51.202030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m22:46:51.202564 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp"
    
    
  as (
    

-- Itens de pedido Northwind com m√©tricas preparadas para a fato de vendas.
select
    'NORTHWIND'                                      as source_system,
    od.orderid                                       as source_order_id,
    'NORTHWIND_' || od.orderid                       as order_nk,
    'NORTHWIND_' || od.productid                     as product_nk,
    cast(od.qty as numeric(12,4))                    as quantity,
    cast(od.unitprice as numeric(12,4))              as unit_price,
    cast(od.discount as numeric(5,4))                as discount_pct,
    (od.unitprice * od.qty)::numeric(14,4)           as gross_amount,
    (od.unitprice * od.qty * (1 - od.discount))::numeric(14,4) as net_amount,
    current_timestamp                                as dw_load_ts
from "dw_northwind_metabase"."public"."orderdetail" od
  );
[0m22:46:51.203141 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers" rename to "stg_northwind_customers__dbt_backup"
[0m22:46:51.207990 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.212101 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.212961 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m22:46:51.213506 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts" rename to "stg_metabase_accounts__dbt_backup"
[0m22:46:51.214195 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.217766 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.218285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:46:51.218739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:46:51.219174 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_tmp" rename to "stg_northwind_customers"
[0m22:46:51.223579 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.224680 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:46:51.230821 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.232127 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_tmp" rename to "stg_metabase_accounts"
[0m22:46:51.233094 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.238183 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.241152 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m22:46:51.253987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:46:51.275067 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" rename to "stg_northwind_order_details__dbt_backup"
[0m22:46:51.281957 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m22:46:51.284217 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m22:46:51.284784 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:46:51.285516 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.286301 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.290367 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:46:51.291610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:46:51.292207 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: COMMIT
[0m22:46:51.292991 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: COMMIT
[0m22:46:51.293836 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.297340 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.298128 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:46:51.298685 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_tmp" rename to "stg_northwind_order_details"
[0m22:46:51.299721 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:46:51.300377 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.310577 [debug] [Thread-3 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup"
[0m22:46:51.311210 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m22:46:51.311729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m22:46:51.313677 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m22:46:51.320605 [debug] [Thread-3 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_customers"
[0m22:46:51.325597 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m22:46:51.328498 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup"
[0m22:46:51.329082 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.329582 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_customers__dbt_backup" cascade
[0m22:46:51.330506 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:46:51.331409 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_accounts"
[0m22:46:51.331904 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: COMMIT
[0m22:46:51.332606 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m22:46:51.333281 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_accounts"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts__dbt_backup" cascade
[0m22:46:51.335315 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:46:51.339424 [debug] [Thread-4 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup"
[0m22:46:51.341404 [debug] [Thread-4 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_order_details"
[0m22:46:51.342217 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:46:51.342967 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_order_details"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details__dbt_backup" cascade
[0m22:46:51.343735 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:46:51.346555 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m22:46:51.347052 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m22:46:51.349135 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_accounts: Close
[0m22:46:51.349913 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:46:51.351728 [debug] [Thread-3 (]: On model.dw_northwind_metabase.stg_northwind_customers: Close
[0m22:46:51.357544 [debug] [Thread-4 (]: On model.dw_northwind_metabase.stg_northwind_order_details: Close
[0m22:46:51.362983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2402F6F90>]}
[0m22:46:51.363537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2404D97B0>]}
[0m22:46:51.364397 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.38s]
[0m22:46:51.365040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2401F5D10>]}
[0m22:46:51.365594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23DB92170>]}
[0m22:46:51.366841 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dw_stg.stg_metabase_accounts .................. [[32mCREATE VIEW[0m in 0.39s]
[0m22:46:51.368348 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:46:51.369584 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dw_stg.stg_northwind_customers ................ [[32mCREATE VIEW[0m in 0.39s]
[0m22:46:51.372747 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_accounts
[0m22:46:51.373959 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.371128 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dw_stg.stg_northwind_order_details ............ [[32mCREATE VIEW[0m in 0.38s]
[0m22:46:51.375871 [debug] [Thread-3 (]: Finished running node model.dw_northwind_metabase.stg_northwind_customers
[0m22:46:51.377152 [info ] [Thread-2 (]: 5 of 5 START sql view model dw_stg.stg_northwind_orders ........................ [RUN]
[0m22:46:51.378978 [debug] [Thread-4 (]: Finished running node model.dw_northwind_metabase.stg_northwind_order_details
[0m22:46:51.380238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dw_northwind_metabase.stg_metabase_orders, now model.dw_northwind_metabase.stg_northwind_orders)
[0m22:46:51.381415 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.387623 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.390322 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.397654 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.399950 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.400925 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: BEGIN
[0m22:46:51.402139 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:51.476705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m22:46:51.477605 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.478570 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp"
    
    
  as (
    

-- Normaliza os pedidos (cabe√ßalho) da Northwind gerando NKs padronizadas.
select
    'NORTHWIND'                                 as source_system,
    o.orderid                                   as source_order_id,
    'NORTHWIND_' || o.orderid                   as order_nk,
    'NORTHWIND_' || o.custid                    as customer_nk,
    'NORTHWIND_' || o.empid                     as employee_nk,
    'NORTHWIND_' || o.shipperid                 as shipper_nk,
    cast(o.orderdate as date)                   as order_date,
    cast(o.requireddate as date)                as required_date,
    cast(o.shippeddate as date)                 as shipped_date,
    cast(o.freight as numeric(12,2))            as freight_amount,
    upper(coalesce(o.shipcountry, 'N/A'))       as ship_country,
    upper(coalesce(o.shipregion, 'N/A'))        as ship_region,
    o.shipcity                                  as ship_city,
    current_timestamp                           as dw_load_ts
from "dw_northwind_metabase"."public"."salesorder" o
  );
[0m22:46:51.498184 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m22:46:51.506108 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.507730 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" rename to "stg_northwind_orders__dbt_backup"
[0m22:46:51.510210 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.515502 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.516460 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_tmp" rename to "stg_northwind_orders"
[0m22:46:51.517900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:51.520368 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m22:46:51.521556 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.524099 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: COMMIT
[0m22:46:51.526909 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:46:51.531828 [debug] [Thread-2 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup"
[0m22:46:51.533057 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.stg_northwind_orders"
[0m22:46:51.533711 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_northwind_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_northwind_orders__dbt_backup" cascade
[0m22:46:51.539543 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:46:51.543610 [debug] [Thread-2 (]: On model.dw_northwind_metabase.stg_northwind_orders: Close
[0m22:46:51.545558 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da51f5ed-e024-42b9-a848-3a83d0dfc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24057AF20>]}
[0m22:46:51.547584 [info ] [Thread-2 (]: 5 of 5 OK created sql view model dw_stg.stg_northwind_orders ................... [[32mCREATE VIEW[0m in 0.17s]
[0m22:46:51.549418 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.stg_northwind_orders
[0m22:46:51.554899 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:51.556668 [debug] [MainThread]: On master: BEGIN
[0m22:46:51.558123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:51.761289 [debug] [MainThread]: SQL status: BEGIN in 0.203 seconds
[0m22:46:51.762319 [debug] [MainThread]: On master: COMMIT
[0m22:46:51.763562 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:51.764675 [debug] [MainThread]: On master: COMMIT
[0m22:46:51.765769 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:46:51.766544 [debug] [MainThread]: On master: Close
[0m22:46:51.767784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:51.768535 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:46:51.769428 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:46:51.771073 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:46:51.771813 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:46:51.774906 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_accounts' was properly closed.
[0m22:46:51.775765 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_orders' was properly closed.
[0m22:46:51.776372 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_customers' was properly closed.
[0m22:46:51.777004 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_northwind_order_details' was properly closed.
[0m22:46:51.777925 [info ] [MainThread]: 
[0m22:46:51.778786 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m22:46:51.781762 [debug] [MainThread]: Command end result
[0m22:46:51.837048 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:46:51.843565 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:46:51.852311 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:46:51.853028 [info ] [MainThread]: 
[0m22:46:51.853703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:51.854769 [info ] [MainThread]: 
[0m22:46:51.856883 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m22:46:51.860075 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:51.859788 after 4.40 seconds
[0m22:46:51.860890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23D7CB0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23DAF9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C240203C50>]}
[0m22:46:51.861727 [debug] [MainThread]: Flushing usage events
[0m22:46:53.364334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:02.600563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D23B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D2C58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4298E10>]}


============================== 22:47:02.605832 | bd73121a-52a3-49a8-8684-1f14313e7dcf ==============================
[0m22:47:02.605832 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:47:02.606496 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'invocation_command': 'dbt run --select intermediate', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m22:47:02.860200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D25E9F30>]}
[0m22:47:02.936128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D431FDF0>]}
[0m22:47:02.937478 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:47:03.415909 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:47:03.674597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:03.675075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:03.683844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m22:47:03.753478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D461F350>]}
[0m22:47:03.875126 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:03.880387 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:03.916770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4884C80>]}
[0m22:47:03.917428 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:47:03.917948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4469C50>]}
[0m22:47:03.920602 [info ] [MainThread]: 
[0m22:47:03.921345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:03.922002 [info ] [MainThread]: 
[0m22:47:03.922975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:03.962576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:47:04.129860 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:47:04.130526 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:47:04.131040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.191217 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.060 seconds
[0m22:47:04.193638 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:47:04.201302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:47:04.207339 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:04.207968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:47:04.208434 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:47:04.211795 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:04.212739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:47:04.213222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.214364 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:04.216415 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:04.217096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.217514 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:47:04.218124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:04.280302 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m22:47:04.280790 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:04.281193 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:47:04.282703 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m22:47:04.283158 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:04.283518 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:47:04.286921 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m22:47:04.287425 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:04.287799 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:47:04.290486 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:47:04.291945 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:47:04.292375 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:47:04.294192 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:47:04.294884 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:47:04.297321 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:47:04.297857 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m22:47:04.299356 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:47:04.300250 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:47:04.305238 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.305661 [debug] [MainThread]: On master: BEGIN
[0m22:47:04.305968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:04.356610 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m22:47:04.357060 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.357438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:47:04.368045 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:47:04.369491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D4D287A0>]}
[0m22:47:04.369987 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:04.370544 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.370924 [debug] [MainThread]: On master: BEGIN
[0m22:47:04.371631 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:04.371978 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.372295 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.372597 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.373052 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:04.373401 [debug] [MainThread]: On master: Close
[0m22:47:04.379462 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.int_customers
[0m22:47:04.380109 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.int_customers ............................... [RUN]
[0m22:47:04.380701 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.int_customers'
[0m22:47:04.381213 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.int_customers
[0m22:47:04.389849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.int_customers"
[0m22:47:04.397104 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.int_customers
[0m22:47:04.443061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.int_customers"
[0m22:47:04.447029 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.447969 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: BEGIN
[0m22:47:04.448623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:04.544507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m22:47:04.545579 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.546559 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */

  create view "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp"
    
    
  as (
    

-- Consolida clientes B2B (Northwind) e B2C/SaaS (Metabase) para alimentar snapshots SCD2.
with northwind as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        contact_name,
        contact_title,
        null::varchar                                as first_name,
        null::varchar                                as last_name,
        address,
        city,
        region,
        country,
        postal_code,
        null::varchar                                as plan,
        null::varchar                                as segment,
        null::int                                    as seats,
        null::boolean                                as trial_converted,
        null::boolean                                as active_subscription,
        null::boolean                                as legacy_plan,
        current_timestamp                            as created_at,
        null::timestamp                              as trial_ends_at,
        null::timestamp                              as canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_customers"
),
metabase as (
    select
        source_system,
        customer_nk,
        source_customer_id,
        customer_name,
        null::varchar                                as contact_name,
        null::varchar                                as contact_title,
        first_name,
        last_name,
        null::varchar                                as address,
        null::varchar                                as city,
        null::varchar                                as region,
        country,
        null::varchar                                as postal_code,
        plan,
        segment,
        seats,
        trial_converted,
        active_subscription,
        legacy_plan,
        created_at,
        trial_ends_at,
        canceled_at,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_accounts"
)
select * from northwind
union all
select * from metabase
  );
[0m22:47:04.560224 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:47:04.569683 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.570235 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
alter table "dw_northwind_metabase"."dw_stg"."int_customers__dbt_tmp" rename to "int_customers"
[0m22:47:04.571878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:47:04.590887 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:47:04.591448 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.591882 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: COMMIT
[0m22:47:04.596227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:47:04.676005 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup"
[0m22:47:04.688230 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.int_customers"
[0m22:47:04.688934 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.int_customers"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."int_customers__dbt_backup" cascade
[0m22:47:04.690286 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:47:04.694681 [debug] [Thread-1 (]: On model.dw_northwind_metabase.int_customers: Close
[0m22:47:04.699786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd73121a-52a3-49a8-8684-1f14313e7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D49C3050>]}
[0m22:47:04.701227 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.int_customers .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m22:47:04.702887 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.int_customers
[0m22:47:04.706084 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.706846 [debug] [MainThread]: On master: BEGIN
[0m22:47:04.707497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:04.782965 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:47:04.783460 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.783838 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:04.784185 [debug] [MainThread]: On master: COMMIT
[0m22:47:04.784674 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:04.785062 [debug] [MainThread]: On master: Close
[0m22:47:04.785621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:04.786002 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:47:04.786342 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:47:04.786640 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:04.786939 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:47:04.787249 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.int_customers' was properly closed.
[0m22:47:04.787716 [info ] [MainThread]: 
[0m22:47:04.788145 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m22:47:04.789283 [debug] [MainThread]: Command end result
[0m22:47:04.824894 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:04.830555 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:04.837783 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:47:04.838408 [info ] [MainThread]: 
[0m22:47:04.838978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:47:04.839623 [info ] [MainThread]: 
[0m22:47:04.840374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:04.842448 [debug] [MainThread]: Command `dbt run` succeeded at 22:47:04.842254 after 2.40 seconds
[0m22:47:04.842980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D49B7960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D43F77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D43F4F50>]}
[0m22:47:04.843791 [debug] [MainThread]: Flushing usage events
[0m22:47:05.967198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:14.685926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A2F0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744AB98B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C298E10>]}


============================== 22:47:14.692239 | c646fa1b-b33b-4be8-932c-b758a13f922e ==============================
[0m22:47:14.692239 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:47:14.693800 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select customers_snapshot', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m22:47:14.954229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A529F30>]}
[0m22:47:15.037198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C30FDF0>]}
[0m22:47:15.038614 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:47:15.489565 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:47:15.703560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:15.703979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:15.710186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
[0m22:47:15.788854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C61B350>]}
[0m22:47:15.919649 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:15.924400 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:15.982581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C8886E0>]}
[0m22:47:15.983789 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:47:15.984492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C884AD0>]}
[0m22:47:15.987367 [info ] [MainThread]: 
[0m22:47:15.988002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:15.988922 [info ] [MainThread]: 
[0m22:47:15.990135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:15.991792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:47:16.228614 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:47:16.229121 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:47:16.229488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.294210 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.065 seconds
[0m22:47:16.295705 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:47:16.302796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:47:16.309698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:16.310312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:47:16.310727 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:16.312613 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:16.313152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:47:16.313495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.315280 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:47:16.317772 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:16.318603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.319165 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:47:16.319750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:16.385218 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m22:47:16.385699 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:16.386088 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:47:16.387869 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m22:47:16.388322 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:16.388764 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:47:16.393219 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m22:47:16.393699 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:16.394113 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:47:16.394583 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:47:16.395881 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:47:16.396482 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:47:16.396987 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:47:16.399640 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:47:16.401085 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:47:16.405869 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m22:47:16.407338 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:47:16.407883 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:47:16.413874 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.414353 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.415063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:16.466899 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m22:47:16.467482 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.468050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:47:16.478550 [debug] [MainThread]: SQL status: SELECT 7 in 0.010 seconds
[0m22:47:16.480817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CCF0C80>]}
[0m22:47:16.481757 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:16.482694 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.483441 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.484451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:16.484889 [debug] [MainThread]: On master: COMMIT
[0m22:47:16.485289 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.485629 [debug] [MainThread]: On master: COMMIT
[0m22:47:16.486139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:16.486521 [debug] [MainThread]: On master: Close
[0m22:47:16.492075 [debug] [Thread-1 (]: Began running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.492777 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m22:47:16.493406 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dw_northwind_metabase.customers_snapshot'
[0m22:47:16.493831 [debug] [Thread-1 (]: Began compiling node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.503527 [debug] [Thread-1 (]: Began executing node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.592564 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.593133 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m22:47:16.593598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:16.645235 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.052 seconds
[0m22:47:16.650402 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.650945 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m22:47:16.651793 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m22:47:16.652443 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.659541 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.660168 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: BEGIN
[0m22:47:16.661545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:47:16.662503 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.663249 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "snapshot.dw_northwind_metabase.customers_snapshot"} */

      
  
    

  create  table "dw_northwind_metabase"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dw_load_ts
from "dw_northwind_metabase"."dw_stg"."int_customers"

    ) sbq



  );
  
  
[0m22:47:16.890444 [debug] [Thread-1 (]: SQL status: SELECT 2586 in 0.226 seconds
[0m22:47:16.917015 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m22:47:16.917685 [debug] [Thread-1 (]: Using postgres connection "snapshot.dw_northwind_metabase.customers_snapshot"
[0m22:47:16.918112 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: COMMIT
[0m22:47:16.921702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:47:16.923733 [debug] [Thread-1 (]: On snapshot.dw_northwind_metabase.customers_snapshot: Close
[0m22:47:16.926543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c646fa1b-b33b-4be8-932c-b758a13f922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C9CBC50>]}
[0m22:47:16.928580 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mSELECT 2586[0m in 0.43s]
[0m22:47:16.930055 [debug] [Thread-1 (]: Finished running node snapshot.dw_northwind_metabase.customers_snapshot
[0m22:47:16.933641 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.934410 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.935135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:17.002834 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m22:47:17.003357 [debug] [MainThread]: On master: COMMIT
[0m22:47:17.003735 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:17.004246 [debug] [MainThread]: On master: COMMIT
[0m22:47:17.004925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:17.005340 [debug] [MainThread]: On master: Close
[0m22:47:17.006174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:17.006676 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:47:17.007114 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:17.007435 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:47:17.007770 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:47:17.008138 [debug] [MainThread]: Connection 'snapshot.dw_northwind_metabase.customers_snapshot' was properly closed.
[0m22:47:17.008711 [info ] [MainThread]: 
[0m22:47:17.009170 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m22:47:17.010312 [debug] [MainThread]: Command end result
[0m22:47:17.125878 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:17.130366 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:17.141025 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:47:17.141640 [info ] [MainThread]: 
[0m22:47:17.142305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:47:17.142937 [info ] [MainThread]: 
[0m22:47:17.143785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:17.145927 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:47:17.145716 after 2.62 seconds
[0m22:47:17.146438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744C9B6A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CA2A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CA2A7B0>]}
[0m22:47:17.146875 [debug] [MainThread]: Flushing usage events
[0m22:47:18.247542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:28.430866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C41B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C4A58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6098E10>]}


============================== 22:47:28.438090 | 55a8576e-6e2d-47f9-ae54-8c8261956f13 ==============================
[0m22:47:28.438090 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:47:28.439616 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select dw', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:47:28.689728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C43E9F30>]}
[0m22:47:28.773701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C611FDF0>]}
[0m22:47:28.775960 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:47:29.271515 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:47:29.498901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:29.499416 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:29.510451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_saas
[0m22:47:29.633001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C641F350>]}
[0m22:47:29.840197 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:29.845981 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:29.893569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C667CC80>]}
[0m22:47:29.894687 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:47:29.895315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6269C50>]}
[0m22:47:29.898422 [info ] [MainThread]: 
[0m22:47:29.899006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:29.899455 [info ] [MainThread]: 
[0m22:47:29.900392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:29.908583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:47:30.077193 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:47:30.077732 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:47:30.078131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.161053 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.083 seconds
[0m22:47:30.162537 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:47:30.163426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_northwind_metabase, now create_dw_northwind_metabase_dw_dw)
[0m22:47:30.164119 [debug] [ThreadPool]: Creating schema "database: "dw_northwind_metabase"
schema: "dw_dw"
"
[0m22:47:30.169200 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dw"
[0m22:47:30.170052 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:30.170550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:47:30.220477 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m22:47:30.221107 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dw"
[0m22:47:30.221759 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "create_dw_northwind_metabase_dw_dw"} */
create schema if not exists "dw_dw"
[0m22:47:30.226429 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m22:47:30.227689 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: COMMIT
[0m22:47:30.228125 [debug] [ThreadPool]: Using postgres connection "create_dw_northwind_metabase_dw_dw"
[0m22:47:30.228514 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: COMMIT
[0m22:47:30.229982 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:47:30.230410 [debug] [ThreadPool]: On create_dw_northwind_metabase_dw_dw: Close
[0m22:47:30.233196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:47:30.239934 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:30.240622 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:47:30.241290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:47:30.241788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.244414 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:30.245052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:47:30.245748 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:47:30.247860 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:30.248448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.248938 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:47:30.249546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:30.307601 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m22:47:30.308067 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:47:30.308537 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:47:30.311644 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m22:47:30.312084 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:47:30.312445 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:47:30.314872 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m22:47:30.315304 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:47:30.315654 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:47:30.316682 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m22:47:30.318110 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:47:30.318737 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:47:30.321096 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m22:47:30.323911 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:47:30.324886 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:47:30.327035 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:47:30.328716 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:47:30.329479 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:47:30.334858 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.335259 [debug] [MainThread]: On master: BEGIN
[0m22:47:30.335543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:30.390808 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m22:47:30.391257 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.391671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:47:30.400835 [debug] [MainThread]: SQL status: SELECT 7 in 0.009 seconds
[0m22:47:30.404146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6B40600>]}
[0m22:47:30.404820 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:30.405578 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.405980 [debug] [MainThread]: On master: BEGIN
[0m22:47:30.406790 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:30.407152 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.407498 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.407829 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.408388 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:30.408782 [debug] [MainThread]: On master: Close
[0m22:47:30.414707 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m22:47:30.415212 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m22:47:30.415770 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m22:47:30.416369 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m22:47:30.417086 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m22:47:30.417645 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m22:47:30.418082 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m22:47:30.418483 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m22:47:30.427285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.435439 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.443509 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m22:47:30.477914 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m22:47:30.559742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.563660 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.567969 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.568559 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m22:47:30.569020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:30.571526 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.572770 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m22:47:30.573934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:47:30.632645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m22:47:30.633216 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:47:30.633715 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
;
  );
  
[0m22:47:30.639639 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m22:47:30.640187 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:47:30.640656 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        null::varchar                        as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        null::varchar                        as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
;
  );
  
[0m22:47:30.642032 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 49: ;
         ^

[0m22:47:30.642513 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: ROLLBACK
[0m22:47:30.642962 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 60: ;
         ^

[0m22:47:30.643474 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: ROLLBACK
[0m22:47:30.644008 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m22:47:30.644494 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m22:47:30.670474 [debug] [Thread-2 (]: Database Error in model fact_sales (models\dw\fact_sales.sql)
  syntax error at or near ";"
  LINE 60: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:47:30.671996 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dw\dim_customer.sql)
  syntax error at or near ";"
  LINE 49: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_customer.sql
[0m22:47:30.675044 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C67CBB90>]}
[0m22:47:30.675571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a8576e-6e2d-47f9-ae54-8c8261956f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C67B71D0>]}
[0m22:47:30.676392 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dw_dw.fact_sales ......................... [[31mERROR[0m in 0.26s]
[0m22:47:30.678564 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m22:47:30.679718 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\dw\fact_sales.sql)
  syntax error at or near ";"
  LINE 60: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql.
[0m22:47:30.677245 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dw_dw.dim_customer ....................... [[31mERROR[0m in 0.26s]
[0m22:47:30.682826 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m22:47:30.683981 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models\dw\dim_customer.sql)
  syntax error at or near ";"
  LINE 49: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_customer.sql.
[0m22:47:30.687093 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.687890 [debug] [MainThread]: On master: BEGIN
[0m22:47:30.688734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:30.818587 [debug] [MainThread]: SQL status: BEGIN in 0.130 seconds
[0m22:47:30.819108 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.819602 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:30.820318 [debug] [MainThread]: On master: COMMIT
[0m22:47:30.821337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:30.821931 [debug] [MainThread]: On master: Close
[0m22:47:30.822817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:30.823578 [debug] [MainThread]: Connection 'create_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:30.824285 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:47:30.824950 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:47:30.825407 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:47:30.825864 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m22:47:30.826235 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m22:47:30.826675 [info ] [MainThread]: 
[0m22:47:30.827122 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m22:47:30.828559 [debug] [MainThread]: Command end result
[0m22:47:30.872776 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:47:30.876429 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:47:30.884591 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:47:30.885286 [info ] [MainThread]: 
[0m22:47:30.885982 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:47:30.887683 [info ] [MainThread]: 
[0m22:47:30.888873 [error] [MainThread]: [31mFailure in model fact_sales (models\dw\fact_sales.sql)[0m
[0m22:47:30.889918 [error] [MainThread]:   Database Error in model fact_sales (models\dw\fact_sales.sql)
  syntax error at or near ";"
  LINE 60: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:47:30.890793 [info ] [MainThread]: 
[0m22:47:30.891672 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:47:30.892411 [info ] [MainThread]: 
[0m22:47:30.893196 [error] [MainThread]: [31mFailure in model dim_customer (models\dw\dim_customer.sql)[0m
[0m22:47:30.894161 [error] [MainThread]:   Database Error in model dim_customer (models\dw\dim_customer.sql)
  syntax error at or near ";"
  LINE 49: ;
           ^
  compiled code at target\run\dw_northwind_metabase\models\dw\dim_customer.sql
[0m22:47:30.894881 [info ] [MainThread]: 
[0m22:47:30.895847 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\dim_customer.sql
[0m22:47:30.896593 [info ] [MainThread]: 
[0m22:47:30.897307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m22:47:30.899137 [debug] [MainThread]: Command `dbt run` failed at 22:47:30.898922 after 2.62 seconds
[0m22:47:30.899731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C60D4AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C6B29E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C33CB750>]}
[0m22:47:30.900381 [debug] [MainThread]: Flushing usage events
[0m22:47:32.089549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:40.368417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FE5B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FEE58B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980498E10>]}


============================== 22:48:40.373930 | b17abbbc-8f0b-4d31-b56c-314b47cccca0 ==============================
[0m22:48:40.373930 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:48:40.374747 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select dw', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m22:48:40.664130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FE7E9F30>]}
[0m22:48:40.916524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998051FDF0>]}
[0m22:48:40.920398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:48:41.622059 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:48:42.099061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:48:42.101232 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\fact_sales.sql
[0m22:48:42.102257 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\dw\dim_customer.sql
[0m22:48:43.172185 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
[0m22:48:43.202007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980A8CB50>]}
[0m22:48:43.395421 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:48:43.401801 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:48:43.461241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980AA06E0>]}
[0m22:48:43.462286 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:48:43.463123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980745010>]}
[0m22:48:43.468608 [info ] [MainThread]: 
[0m22:48:43.473662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:48:43.474538 [info ] [MainThread]: 
[0m22:48:43.475888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:48:43.484691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:48:43.777381 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:48:43.777890 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:48:43.778534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.863744 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.085 seconds
[0m22:48:43.866622 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:48:43.870606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:48:43.879683 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:48:43.880513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:48:43.881175 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:48:43.884622 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:48:43.885377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:48:43.886530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.887130 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:48:43.889913 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:48:43.890741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.891143 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:48:43.891688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:43.967374 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m22:48:43.968215 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:48:43.968972 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:48:43.972669 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m22:48:43.973338 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:48:43.973996 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:48:43.979184 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m22:48:43.980049 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:48:43.981043 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m22:48:43.982278 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:48:43.984956 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:48:43.986013 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:48:43.988082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m22:48:43.990717 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:48:43.991748 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:48:43.996806 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:48:43.999348 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:48:44.000410 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:48:44.009285 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.009985 [debug] [MainThread]: On master: BEGIN
[0m22:48:44.010503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:44.083528 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m22:48:44.084155 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.084841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:48:44.097244 [debug] [MainThread]: SQL status: SELECT 7 in 0.012 seconds
[0m22:48:44.100483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299821B4A10>]}
[0m22:48:44.101256 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:44.102630 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.103377 [debug] [MainThread]: On master: BEGIN
[0m22:48:44.104429 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:48:44.104941 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.105508 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.106017 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.106838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:48:44.107398 [debug] [MainThread]: On master: Close
[0m22:48:44.115522 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m22:48:44.116673 [debug] [Thread-2 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m22:48:44.117813 [info ] [Thread-1 (]: 1 of 2 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m22:48:44.119431 [info ] [Thread-2 (]: 2 of 2 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m22:48:44.121183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m22:48:44.122255 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m22:48:44.123294 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m22:48:44.124241 [debug] [Thread-2 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m22:48:44.150609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.157902 [debug] [Thread-2 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.161093 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m22:48:44.162107 [debug] [Thread-2 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m22:48:44.258491 [debug] [Thread-2 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.267331 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.269672 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.270783 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m22:48:44.272031 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:48:44.273068 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.274219 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m22:48:44.275197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:44.381672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.109 seconds
[0m22:48:44.383403 [debug] [Thread-2 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:48:44.385078 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        null::varchar                        as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        null::varchar                        as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m22:48:44.406169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m22:48:44.407226 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.408207 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m22:48:44.466621 [debug] [Thread-1 (]: SQL status: SELECT 2586 in 0.057 seconds
[0m22:48:44.487474 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.488558 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m22:48:44.490498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:48:44.525485 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:48:44.526369 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.527208 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:48:44.529744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:48:44.545698 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m22:48:44.557380 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:48:44.558275 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m22:48:44.559552 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:48:44.564140 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m22:48:44.569745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980C7E390>]}
[0m22:48:44.571308 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 2586[0m in 0.44s]
[0m22:48:44.572838 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m22:48:44.860727 [debug] [Thread-2 (]: Postgres adapter: Postgres error: numeric field overflow
DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.

[0m22:48:44.861354 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: ROLLBACK
[0m22:48:44.862121 [debug] [Thread-2 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m22:48:44.877222 [debug] [Thread-2 (]: Database Error in model fact_sales (models\dw\fact_sales.sql)
  numeric field overflow
  DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:48:44.878243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17abbbc-8f0b-4d31-b56c-314b47cccca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029982194F70>]}
[0m22:48:44.879436 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dw_dw.fact_sales ......................... [[31mERROR[0m in 0.76s]
[0m22:48:44.881133 [debug] [Thread-2 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m22:48:44.883231 [debug] [Thread-7 (]: Marking all children of 'model.dw_northwind_metabase.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models\dw\fact_sales.sql)
  numeric field overflow
  DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql.
[0m22:48:44.886930 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.887484 [debug] [MainThread]: On master: BEGIN
[0m22:48:44.887929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:44.959876 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m22:48:44.960539 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.960948 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:44.961407 [debug] [MainThread]: On master: COMMIT
[0m22:48:44.962132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:48:44.962633 [debug] [MainThread]: On master: Close
[0m22:48:44.963380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:44.963883 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:48:44.964409 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:48:44.965310 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:48:44.966257 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:48:44.966896 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m22:48:44.967594 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m22:48:44.968392 [info ] [MainThread]: 
[0m22:48:44.969176 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m22:48:44.971113 [debug] [MainThread]: Command end result
[0m22:48:45.029623 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:48:45.036114 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:48:45.048951 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:48:45.050473 [info ] [MainThread]: 
[0m22:48:45.051571 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:48:45.052575 [info ] [MainThread]: 
[0m22:48:45.053570 [error] [MainThread]: [31mFailure in model fact_sales (models\dw\fact_sales.sql)[0m
[0m22:48:45.054580 [error] [MainThread]:   Database Error in model fact_sales (models\dw\fact_sales.sql)
  numeric field overflow
  DETAIL:  A field with precision 5, scale 4 must round to an absolute value less than 10^1.
  compiled code at target\run\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:48:45.055489 [info ] [MainThread]: 
[0m22:48:45.056366 [info ] [MainThread]:   compiled code at target\compiled\dw_northwind_metabase\models\dw\fact_sales.sql
[0m22:48:45.057071 [info ] [MainThread]: 
[0m22:48:45.057796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:48:45.060272 [debug] [MainThread]: Command `dbt run` failed at 22:48:45.060022 after 4.88 seconds
[0m22:48:45.060993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998069AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998211A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029980728BD0>]}
[0m22:48:45.061798 [debug] [MainThread]: Flushing usage events
[0m22:48:46.456675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:22.467316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BD9B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BF258B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BF898E10>]}


============================== 22:49:22.473776 | 2b307df1-03b6-4410-9c7c-a24d9581d98e ==============================
[0m22:49:22.473776 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:22.474598 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_metabase_orders', 'printer_width': '80', 'target_path': 'None'}
[0m22:49:22.798380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BDBE9F30>]}
[0m22:49:22.905759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BF91FDF0>]}
[0m22:49:22.907311 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:49:23.539667 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:23.815829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:49:23.816764 [debug] [MainThread]: Partial parsing: updated file: dw_northwind_metabase://models\staging\metabase\stg_metabase_orders.sql
[0m22:49:24.550378 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
[0m22:49:24.574327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFE81E50>]}
[0m22:49:24.720679 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:24.724476 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:24.770676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFE6EC60>]}
[0m22:49:24.771697 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:49:24.772382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFADDC50>]}
[0m22:49:24.774979 [info ] [MainThread]: 
[0m22:49:24.775579 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:24.776100 [info ] [MainThread]: 
[0m22:49:24.777245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:24.778939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:49:25.033852 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:49:25.034521 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:49:25.035159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.132375 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.097 seconds
[0m22:49:25.134367 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:49:25.141275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:49:25.150056 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:25.150972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:49:25.151694 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:49:25.154551 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:25.155240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:49:25.155674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.156225 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:49:25.158270 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:25.159062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.159528 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:49:25.160107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:25.259873 [debug] [ThreadPool]: SQL status: BEGIN in 0.104 seconds
[0m22:49:25.260661 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:25.261406 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:49:25.262061 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m22:49:25.262956 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:25.264066 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:49:25.267359 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m22:49:25.267970 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:25.268466 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:49:25.302538 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m22:49:25.303266 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m22:49:25.305334 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:49:25.305877 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m22:49:25.307620 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:49:25.310202 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:49:25.310902 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:49:25.311575 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:49:25.312439 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:49:25.325316 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.325845 [debug] [MainThread]: On master: BEGIN
[0m22:49:25.326247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:25.411008 [debug] [MainThread]: SQL status: BEGIN in 0.085 seconds
[0m22:49:25.411679 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.412317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:49:25.430953 [debug] [MainThread]: SQL status: SELECT 7 in 0.018 seconds
[0m22:49:25.434791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C037D090>]}
[0m22:49:25.435904 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:25.437081 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.437994 [debug] [MainThread]: On master: BEGIN
[0m22:49:25.439044 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:49:25.439546 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.439991 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.440436 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.441132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:25.441645 [debug] [MainThread]: On master: Close
[0m22:49:25.452271 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.453241 [info ] [Thread-1 (]: 1 of 1 START sql view model dw_stg.stg_metabase_orders ......................... [RUN]
[0m22:49:25.454442 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.stg_metabase_orders'
[0m22:49:25.455618 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.475238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.477616 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.555305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.557360 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.558177 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: BEGIN
[0m22:49:25.559182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:25.648730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m22:49:25.649780 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.650394 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */

  create view "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp"
    
    
  as (
    

-- Pedidos/eventos comerciais da base Metabase Sample.
select
    'METABASE'                               as source_system,
    o.id                                     as source_order_id,
    'METABASE_' || o.id                      as order_nk,
    'METABASE_' || o.user_id                 as customer_nk,
    'METABASE_' || o.product_id              as product_nk,
    null::varchar                            as order_state,
    case
        when o.created_at ~ '^\d{4}-\d{2}-\d{2}'
            then o.created_at::timestamp
        else null
    end                                     as order_date,
    cast(null as timestamp)                  as shipped_date,
    cast(o.quantity as numeric(12,4))        as quantity,
    (
        case
            when o.quantity is not null and o.quantity <> 0
                then (o.subtotal / o.quantity)
            else null
        end
    )::numeric(12,4)                         as unit_price,
    cast(o.discount____ as numeric(12,4))    as discount_pct,
    cast(o.total as numeric(14,4))           as total_amount,
    current_timestamp                        as dw_load_ts
from "dw_northwind_metabase"."public"."orders" o
  );
[0m22:49:25.682260 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m22:49:25.694899 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.695823 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders" rename to "stg_metabase_orders__dbt_backup"
[0m22:49:25.698089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:49:25.703851 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.704498 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
alter table "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_tmp" rename to "stg_metabase_orders"
[0m22:49:25.705646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:49:25.731706 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:49:25.733153 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.734054 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: COMMIT
[0m22:49:25.742134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m22:49:25.755395 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup"
[0m22:49:25.763067 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.stg_metabase_orders"
[0m22:49:25.764381 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.stg_metabase_orders"} */
drop view if exists "dw_northwind_metabase"."dw_stg"."stg_metabase_orders__dbt_backup" cascade
[0m22:49:25.768535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:49:25.772225 [debug] [Thread-1 (]: On model.dw_northwind_metabase.stg_metabase_orders: Close
[0m22:49:25.775792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b307df1-03b6-4410-9c7c-a24d9581d98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C01F6B10>]}
[0m22:49:25.777063 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw_stg.stg_metabase_orders .................... [[32mCREATE VIEW[0m in 0.32s]
[0m22:49:25.778352 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.stg_metabase_orders
[0m22:49:25.782217 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.783160 [debug] [MainThread]: On master: BEGIN
[0m22:49:25.783899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:25.862790 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m22:49:25.863689 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.864596 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:25.865337 [debug] [MainThread]: On master: COMMIT
[0m22:49:25.866307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:25.867162 [debug] [MainThread]: On master: Close
[0m22:49:25.868303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:25.869155 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:49:25.869822 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:49:25.870443 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:49:25.871156 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:49:25.871766 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.stg_metabase_orders' was properly closed.
[0m22:49:25.872468 [info ] [MainThread]: 
[0m22:49:25.873203 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m22:49:25.874905 [debug] [MainThread]: Command end result
[0m22:49:25.974565 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:25.984524 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:26.013182 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:49:26.015145 [info ] [MainThread]: 
[0m22:49:26.016587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:26.018073 [info ] [MainThread]: 
[0m22:49:26.019066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:49:26.022683 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:26.022350 after 3.74 seconds
[0m22:49:26.023730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFE0BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFB09B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BFB0A030>]}
[0m22:49:26.024983 [debug] [MainThread]: Flushing usage events
[0m22:49:27.106985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:38.808098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA017B0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03058B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03698E10>]}


============================== 22:49:38.817097 | 8e5e5b47-fc6d-428a-9bfc-7b361e068f9c ==============================
[0m22:49:38.817097 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:38.818522 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_sales', 'printer_width': '80', 'write_json': 'True'}
[0m22:49:39.325189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA019E9F30>]}
[0m22:49:39.509338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA0370FDF0>]}
[0m22:49:39.512754 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:49:40.572662 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:40.925952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:40.926934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:40.936997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_sales
- models.dw_northwind_metabase.marts.dm_b2b
[0m22:49:41.077716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03A1B350>]}
[0m22:49:41.273591 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:41.278502 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:41.328763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03C60C80>]}
[0m22:49:41.329819 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:49:41.330606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA038684B0>]}
[0m22:49:41.333334 [info ] [MainThread]: 
[0m22:49:41.333924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:41.334738 [info ] [MainThread]: 
[0m22:49:41.335935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:41.338568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:49:41.616645 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:49:41.617302 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:49:41.617836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.733518 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.116 seconds
[0m22:49:41.736660 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:49:41.751817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:49:41.768432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:49:41.770100 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:41.775682 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:41.776929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:49:41.777805 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:49:41.779378 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:49:41.783263 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:41.784178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.785019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.785760 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:49:41.789075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:41.917289 [debug] [ThreadPool]: SQL status: BEGIN in 0.132 seconds
[0m22:49:41.918228 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:41.919265 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:49:41.940115 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m22:49:41.943434 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:49:41.944995 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:49:41.958503 [debug] [ThreadPool]: SQL status: BEGIN in 0.174 seconds
[0m22:49:41.959698 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:41.960641 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:49:41.964777 [debug] [ThreadPool]: SQL status: BEGIN in 0.176 seconds
[0m22:49:41.965797 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:41.966648 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:49:41.977819 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m22:49:41.980913 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:49:41.982017 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:49:41.985619 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m22:49:41.991124 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:49:41.992391 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:49:42.008986 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.010054 [debug] [MainThread]: On master: BEGIN
[0m22:49:42.011138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:42.110166 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m22:49:42.110962 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.111775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:49:42.126755 [debug] [MainThread]: SQL status: SELECT 7 in 0.014 seconds
[0m22:49:42.130659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA04128460>]}
[0m22:49:42.131582 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:42.132524 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.132961 [debug] [MainThread]: On master: BEGIN
[0m22:49:42.133756 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:49:42.134377 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.134994 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:42.135564 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.136552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:42.137550 [debug] [MainThread]: On master: Close
[0m22:49:42.145478 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.fact_sales
[0m22:49:42.146241 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.fact_sales .................................. [RUN]
[0m22:49:42.147053 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.fact_sales'
[0m22:49:42.147743 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.fact_sales
[0m22:49:42.164533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.166695 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.fact_sales
[0m22:49:42.242785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.245920 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.250830 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: BEGIN
[0m22:49:42.251454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:42.318625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m22:49:42.319317 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.320445 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

-- Fato de vendas unificada (B2B + B2C) com m√©tricas financeiras padronizadas.
with northwind as (
    select
        'NORTHWIND'                          as source_system,
        od.source_order_id,
        od.order_nk,
        o.customer_nk,
        od.product_nk,
        o.employee_nk,
        o.shipper_nk,
        null::varchar                        as channel_nk,
        o.order_date,
        o.shipped_date,
        od.quantity,
        od.unit_price,
        od.discount_pct,
        od.gross_amount,
        od.net_amount,
        od.dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_northwind_order_details" od
    join "dw_northwind_metabase"."dw_stg"."stg_northwind_orders" o
      on od.order_nk = o.order_nk
),
metabase as (
    select
        'METABASE'                           as source_system,
        source_order_id,
        order_nk,
        customer_nk,
        product_nk,
        null::varchar                        as employee_nk,
        null::varchar                        as shipper_nk,
        null::varchar                        as channel_nk,
        order_date,
        shipped_date,
        quantity,
        unit_price,
        discount_pct,
        (quantity * unit_price)::numeric(14,4)                         as gross_amount,
        total_amount                                                   as net_amount,
        dw_load_ts
    from "dw_northwind_metabase"."dw_stg"."stg_metabase_orders"
)
select * from northwind
union all
select * from metabase
  );
  
[0m22:49:42.897576 [debug] [Thread-1 (]: SQL status: SELECT 20915 in 0.576 seconds
[0m22:49:42.916970 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.917990 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
alter table "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m22:49:42.919983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:49:42.960253 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m22:49:42.961146 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:42.961828 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: COMMIT
[0m22:49:42.974062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m22:49:43.076267 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup"
[0m22:49:43.085666 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.fact_sales"
[0m22:49:43.086676 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.fact_sales"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."fact_sales__dbt_backup" cascade
[0m22:49:43.088381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:49:43.092060 [debug] [Thread-1 (]: On model.dw_northwind_metabase.fact_sales: Close
[0m22:49:43.097006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e5e5b47-fc6d-428a-9bfc-7b361e068f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03DCBAD0>]}
[0m22:49:43.098610 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.fact_sales ............................. [[32mSELECT 20915[0m in 0.95s]
[0m22:49:43.100118 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.fact_sales
[0m22:49:43.103031 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:43.104248 [debug] [MainThread]: On master: BEGIN
[0m22:49:43.105596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:43.180885 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:49:43.181492 [debug] [MainThread]: On master: COMMIT
[0m22:49:43.182153 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:43.182760 [debug] [MainThread]: On master: COMMIT
[0m22:49:43.183576 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:43.184028 [debug] [MainThread]: On master: Close
[0m22:49:43.184789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:43.185410 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:49:43.185974 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:49:43.186555 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:49:43.187578 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:49:43.188521 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.fact_sales' was properly closed.
[0m22:49:43.189387 [info ] [MainThread]: 
[0m22:49:43.190122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m22:49:43.191590 [debug] [MainThread]: Command end result
[0m22:49:43.248422 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:43.254020 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:43.301625 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:49:43.302624 [info ] [MainThread]: 
[0m22:49:43.303852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:43.305532 [info ] [MainThread]: 
[0m22:49:43.306612 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:49:43.309305 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:43.308987 after 4.76 seconds
[0m22:49:43.310147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA03DB7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA01971950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA01972170>]}
[0m22:49:43.311170 [debug] [MainThread]: Flushing usage events
[0m22:49:44.474870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:57.279060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A81E0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A8A88B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA198E10>]}


============================== 22:49:57.285686 | 50ca32dd-eea3-44ca-a545-9275defb4a3c ==============================
[0m22:49:57.285686 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:57.286608 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'D:\\OneDrive\\Documentos\\Profissional\\P√≥s IA IFG\\Mat√©rias\\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\\Exerc√≠cios e Trabalhos\\DW\\dbt\\dw_northwind_metabase\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customer', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m22:49:57.666475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A8419F30>]}
[0m22:49:57.784374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA21FDF0>]}
[0m22:49:57.786605 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:49:58.441366 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:58.750701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:58.751193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:58.758510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.dw_northwind_metabase.marts.dm_b2b
- models.dw_northwind_metabase.marts.dm_b2c
- models.dw_northwind_metabase.marts.dm_saas
- models.dw_northwind_metabase.marts.dm_product_analytics
- models.dw_northwind_metabase.marts.dm_sales
[0m22:49:58.865145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA51F350>]}
[0m22:49:59.066920 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:49:59.072805 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:49:59.142669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA768C80>]}
[0m22:49:59.144713 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 5 sources, 449 macros
[0m22:49:59.145580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA3684B0>]}
[0m22:49:59.149887 [info ] [MainThread]: 
[0m22:49:59.150881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:59.151927 [info ] [MainThread]: 
[0m22:49:59.153347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:59.155430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase'
[0m22:49:59.441656 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase"
[0m22:49:59.442462 [debug] [ThreadPool]: On list_dw_northwind_metabase: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase"} */

    select distinct nspname from pg_namespace
  
[0m22:49:59.443851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.528019 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.084 seconds
[0m22:49:59.530804 [debug] [ThreadPool]: On list_dw_northwind_metabase: Close
[0m22:49:59.540091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_stg'
[0m22:49:59.550169 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:59.550999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_dw_dw'
[0m22:49:59.551478 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: BEGIN
[0m22:49:59.555165 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:59.556321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_northwind_metabase_snapshots'
[0m22:49:59.556979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.558588 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: BEGIN
[0m22:49:59.563481 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:59.564568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.565095 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: BEGIN
[0m22:49:59.565715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:59.683136 [debug] [ThreadPool]: SQL status: BEGIN in 0.126 seconds
[0m22:49:59.684115 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_stg"
[0m22:49:59.685234 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_stg"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_stg'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_stg'
  
[0m22:49:59.702497 [debug] [ThreadPool]: SQL status: BEGIN in 0.138 seconds
[0m22:49:59.703620 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_dw_dw"
[0m22:49:59.704873 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m22:49:59.706465 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_dw_dw"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m22:49:59.712097 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: ROLLBACK
[0m22:49:59.714806 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_stg: Close
[0m22:49:59.729983 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m22:49:59.731097 [debug] [ThreadPool]: Using postgres connection "list_dw_northwind_metabase_snapshots"
[0m22:49:59.732236 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "list_dw_northwind_metabase_snapshots"} */
select
      'dw_northwind_metabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dw_northwind_metabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:49:59.740720 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m22:49:59.745612 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: ROLLBACK
[0m22:49:59.747304 [debug] [ThreadPool]: On list_dw_northwind_metabase_dw_dw: Close
[0m22:49:59.754926 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.022 seconds
[0m22:49:59.757590 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: ROLLBACK
[0m22:49:59.758784 [debug] [ThreadPool]: On list_dw_northwind_metabase_snapshots: Close
[0m22:49:59.770828 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.771518 [debug] [MainThread]: On master: BEGIN
[0m22:49:59.772376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:59.887238 [debug] [MainThread]: SQL status: BEGIN in 0.115 seconds
[0m22:49:59.888044 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.888597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:49:59.914207 [debug] [MainThread]: SQL status: SELECT 7 in 0.024 seconds
[0m22:49:59.919329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AAC28BB0>]}
[0m22:49:59.920331 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:59.921599 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.922488 [debug] [MainThread]: On master: BEGIN
[0m22:49:59.923942 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:49:59.924979 [debug] [MainThread]: On master: COMMIT
[0m22:49:59.926014 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:59.929636 [debug] [MainThread]: On master: COMMIT
[0m22:49:59.932960 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:49:59.934168 [debug] [MainThread]: On master: Close
[0m22:49:59.949958 [debug] [Thread-1 (]: Began running node model.dw_northwind_metabase.dim_customer
[0m22:49:59.953948 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_dw.dim_customer ................................ [RUN]
[0m22:49:59.958439 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dw_northwind_metabase.dim_customer'
[0m22:49:59.961898 [debug] [Thread-1 (]: Began compiling node model.dw_northwind_metabase.dim_customer
[0m22:49:59.986785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_northwind_metabase.dim_customer"
[0m22:49:59.989991 [debug] [Thread-1 (]: Began executing node model.dw_northwind_metabase.dim_customer
[0m22:50:00.128635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.131195 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.132291 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: BEGIN
[0m22:50:00.133466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:00.215885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m22:50:00.216892 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.217802 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */

  
    

  create  table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

-- Dimens√£o de clientes com controle SCD2 (snapshot) e SK gerado no carregamento.
with latest as (
    select
        *
    from "dw_northwind_metabase"."snapshots"."customers_snapshot"
    where dbt_valid_to is null
)
select
    row_number() over (order by customer_nk)       as customer_sk,
    customer_nk,
    source_system,
    source_customer_id,
    customer_name,
    contact_name,
    contact_title,
    first_name,
    last_name,
    address,
    city,
    region,
    country,
    postal_code,
    plan,
    segment,
    seats,
    trial_converted,
    active_subscription,
    legacy_plan,
    created_at,
    trial_ends_at,
    canceled_at,
    dbt_valid_from,
    dbt_valid_to,
    case when dbt_valid_to is null then true else false end as current_flag
from latest
  );
  
[0m22:50:00.262743 [debug] [Thread-1 (]: SQL status: SELECT 2586 in 0.044 seconds
[0m22:50:00.283401 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.284361 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer" rename to "dim_customer__dbt_backup"
[0m22:50:00.285573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:50:00.290488 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.291461 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
alter table "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m22:50:00.293140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:50:00.413991 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:50:00.414826 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.415527 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: COMMIT
[0m22:50:00.419087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:50:00.429933 [debug] [Thread-1 (]: Applying DROP to: "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup"
[0m22:50:00.439567 [debug] [Thread-1 (]: Using postgres connection "model.dw_northwind_metabase.dim_customer"
[0m22:50:00.440514 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dw_northwind_metabase", "target_name": "dev", "node_id": "model.dw_northwind_metabase.dim_customer"} */
drop table if exists "dw_northwind_metabase"."dw_dw"."dim_customer__dbt_backup" cascade
[0m22:50:00.449460 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m22:50:00.453169 [debug] [Thread-1 (]: On model.dw_northwind_metabase.dim_customer: Close
[0m22:50:00.456884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ca32dd-eea3-44ca-a545-9275defb4a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA8CBAD0>]}
[0m22:50:00.458118 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_dw.dim_customer ........................... [[32mSELECT 2586[0m in 0.50s]
[0m22:50:00.459312 [debug] [Thread-1 (]: Finished running node model.dw_northwind_metabase.dim_customer
[0m22:50:00.462387 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:00.463186 [debug] [MainThread]: On master: BEGIN
[0m22:50:00.463580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:50:00.538976 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m22:50:00.539471 [debug] [MainThread]: On master: COMMIT
[0m22:50:00.539844 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:00.540189 [debug] [MainThread]: On master: COMMIT
[0m22:50:00.540718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:50:00.541086 [debug] [MainThread]: On master: Close
[0m22:50:00.541748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:00.542295 [debug] [MainThread]: Connection 'list_dw_northwind_metabase' was properly closed.
[0m22:50:00.542692 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_stg' was properly closed.
[0m22:50:00.543205 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_dw_dw' was properly closed.
[0m22:50:00.543933 [debug] [MainThread]: Connection 'list_dw_northwind_metabase_snapshots' was properly closed.
[0m22:50:00.544748 [debug] [MainThread]: Connection 'model.dw_northwind_metabase.dim_customer' was properly closed.
[0m22:50:00.545432 [info ] [MainThread]: 
[0m22:50:00.546123 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m22:50:00.547568 [debug] [MainThread]: Command end result
[0m22:50:00.593654 [debug] [MainThread]: Wrote artifact WritableManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\manifest.json
[0m22:50:00.598423 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\semantic_manifest.json
[0m22:50:00.607769 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\OneDrive\Documentos\Profissional\P√≥s IA IFG\Mat√©rias\T√≥picos - Intelig√™ncia de Neg√≥cios - Sirlon Diniz\Exerc√≠cios e Trabalhos\DW\dbt\dw_northwind_metabase\target\run_results.json
[0m22:50:00.608574 [info ] [MainThread]: 
[0m22:50:00.609267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:50:00.610084 [info ] [MainThread]: 
[0m22:50:00.610853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:50:00.613783 [debug] [MainThread]: Command `dbt run` succeeded at 22:50:00.613445 after 3.57 seconds
[0m22:50:00.614617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AA8B7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AAC5F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3AAC5F6B0>]}
[0m22:50:00.615325 [debug] [MainThread]: Flushing usage events
[0m22:50:01.882379 [debug] [MainThread]: An error was encountered while trying to flush usage events
